import{a as r6}from"./LR3AMW7X.js";import{a as Uy}from"./T5PE7DH2.js";import{A as id,B as os,C as jn,D as y6,E as b6,F as tp,G as I6,H as S6,I as Fh,J as ia,K as v6,L as T6,M as op,N as ad,O as yc,P as _r,Q as Gr,R as bc,T as mw,U as dw,V as sd,W as ld,X as w6,a as ci,b as nn,c as Wy,d as Gy,e as kh,f as Fi,g as An,h as jy,i as Lt,j as a6,k as Qa,l as Ql,m as Gs,n as s6,o as Ja,p as l6,q as cw,r as Hi,s as p6,t as c6,u as uw,v as u6,w as x6,x as nd,y as _6,z as rd}from"./DDI5UP4S.js";import{a as n6}from"./JFAM3C4T.js";import{a as Ky,d as qy}from"./KMQZJ4IN.js";import{a as mn,b as i6,e as Qm}from"./FXDTEDOO.js";import{a as iC,b as aC,c as sC,d as lC,e as pC,f as cC,g as zy,h as Ry}from"./FPEP7GH5.js";import{a as Sm,b as Lm,c as Om,d as vh,e as Vy}from"./SITM5SLO.js";import{p as km}from"./XYAU3F2A.js";import{a as vm,i as Do,n as rC}from"./52ECXFJ5.js";import{$ as jC,A as bC,Aa as Gl,B as IC,Ba as Gm,Bb as $m,C as SC,Ca as xe,Cb as Ph,D as Ur,Da as ot,Db as $l,Ea as ny,Eb as Ne,F as vC,Fa as tn,Fb as Py,G as TC,Ga as ry,Gb as Wr,H as MC,Ha as Oi,Hb as ky,I as wC,Ia as Mt,Ib as Xm,J as EC,Ja as qe,Jb as Xa,K as Dm,Ka as Bi,Kb as Xl,L as AC,La as iy,Lb as lw,M as PC,Ma as ay,Mb as Ly,N as Th,Na as uo,O as aw,Oa as jl,P as Fm,Pa as jm,Pb as Oy,Q as DC,Qa as sy,Qb as pw,R as Vl,Rb as By,S as FC,Sb as Dy,T as HC,Ta as py,Tb as Fy,U as NC,Ua as on,Ub as Ge,V as zC,Va as cy,Vb as Hy,W as Mh,Wa as uy,X as RC,Xa as Ws,Xb as Ny,Y as Rl,Ya as my,Z as UC,Za as pi,Zb as Ya,_ as Hm,a as R_,aa as KC,ab as Km,b as U_,ba as wh,bb as Kl,c as re,ca as Nm,cb as En,d as W_,da as Ka,db as ql,e as Wa,fb as dy,g as Fl,ga as Li,gb as Ah,ha as Ul,hb as fy,ia as Vm,ib as hy,j as tw,ja as Gn,jb as gy,ka as Rm,kb as xy,l as fC,la as Eh,lb as _y,ma as XC,mb as Cy,na as Um,nb as yy,o as xr,oa as YC,ob as Fo,p as hC,pa as ZC,pb as by,q as ki,qb as Iy,ra as QC,rb as Di,s as gC,sa as JC,sb as Sy,t as xC,ta as _e,tb as vy,u as hc,ua as Wm,ub as Ty,v as _C,va as ey,vb as My,w as Rr,wa as ty,wb as $a,x as Bm,xa as oy,xb as qm,y as CC,ya as Wl,yb as Ay,z as yC,za as qa}from"./CLPCS5HX.js";import{a as nC,b as zl}from"./5JAHRNIU.js";import{h as Us,i as _h,j as Un,k as j_,m as Hl,n as en,p as Pi,q as K_,r as Ch,s as q_,t as yh,u as $_,v as bh,w as mc,x as X_,y as Vr}from"./YZ5NMKB5.js";import{a as Wn}from"./KKGP7PQX.js";import{c as Sh}from"./XN3JVMCS.js";import{a as sw}from"./JKH3AXBY.js";import{a as $C}from"./2UXEOAF5.js";import{a as na,b as VC,e as WC,f as GC,m as gc,s as qC,t as zm}from"./CRTJIQND.js";import{d as ow,f as Am,g as nw,i as Pm,j as rw,l as iw,m as dc,p as fc,q as U}from"./YOZ5W2GG.js";import{d as G_}from"./GREWFYE3.js";import{a as u_,b as m_,c as Ll,d as Va,e as dh,f as Bl}from"./NQEUUFEJ.js";import{j as _m}from"./IE4E3732.js";import{b as cc,d as mm,e as Ai,h as x_,j as Dl,k as Fe}from"./X2ALZK3D.js";import{b as d_,c as f_,e as h_,f as ew}from"./GGDJOTLD.js";import{a as dm,b as __,c as Ra,e as xm,g as M_,h as co,i as w_,j as E_,k as A_}from"./7LKKTU5H.js";import{a as lr}from"./QGM6CHM5.js";import{a as JM}from"./HDYNK7EV.js";import{a as mh,b as si,c as H_}from"./B7VRG6XU.js";import{d as un}from"./STNCT5QQ.js";import{a as rp}from"./COZ2KBJ7.js";import{a as uC}from"./UGKEWSX5.js";import{a as G2}from"./SVFETRLG.js";import{b as W2}from"./ZD4W36SK.js";import{a as O_}from"./DRWY43PD.js";import{a as zr}from"./4WM5DWTI.js";import{b as k_,c as L_,d as yt}from"./NLYC5QHQ.js";import{a as u2,b as Vs,c as m2,d as d2}from"./JH2RBA22.js";import{G as Zu}from"./Q5NWQDKR.js";import{a as ZM}from"./WMUCJVX3.js";import{a as Nr,b as g_}from"./XKR4REXP.js";import{a as Da,b as Qx,c as Jx,d as e2,e as t2,f as zs,g as ne,h as s2,i as l2,j as p2,k as c2}from"./2QQMSEQI.js";import{a as Zx}from"./LU2HGRXL.js";import{a as he}from"./OD4HJMKT.js";import{a as Yu,b as Fa}from"./B3ZCAZRS.js";import{a as ir}from"./S34QHPYH.js";import{a as So}from"./WJUWA2XU.js";import{C as Xx,D as Yx,G as tt,a as Nu,b as Dx,c as Fx,d as Ns,e as Nx,f as zu,g as Vu,k as Tn,l as Gx,n as ju,p as Aa,q as Pa,r as jx,s as ii,x as vo}from"./MM57Z2BS.js";import{b as qx,c as zn}from"./GSC4ZYB5.js";import{c as tc,f as ct}from"./6T6FEPNJ.js";import{c as ft,e as Vn,f as Hr}from"./OZ6K5KWN.js";import{c as wi}from"./B7SYSBXF.js";import{s as Ux,u as Wx,v as Gu}from"./H5C5R2IB.js";import{D as Ha,E as Ju,K as a2,c as Ve,e as Kx,i as Ct,j as o2,m as n2,n as r2,s as Qu,u as i2}from"./QGTSDQHN.js";import{C as vl,N as Jt,X as $x,Y as La,_ as Dr,f as Ma,ga as $u,ja as Fr,l as Ti,o as vn,pa as Oa,qa as Ba,r as wa,w as Vx,z as Rx}from"./G7W6DI5V.js";import{b as Ea,e as ce}from"./LSIA5SS7.js";import{m as Ku,p as qu,s as oc}from"./BJ5FAZNI.js";import{c as B}from"./NCSJWSK3.js";import{a as Il}from"./F44UP4MI.js";import{i as ka}from"./POF2YL63.js";import{f as Hx}from"./LWSOZ55D.js";import{b as Mi}from"./NS74SLXM.js";import{E as rr,Q as Bx,a as kx,b as XM,c as Lx,d as YM,h as Io,la as T,na as x,q as Ox}from"./PEAOUDRP.js";import{a as bo}from"./PCHDBHHN.js";import{a as E6,b as A6}from"./FHPRHV46.js";import{a as ra,c as ts}from"./JUJJIC7Z.js";import{a as wy}from"./2KEEOA55.js";import{a as Ey}from"./BEL6FLMX.js";import{a as Ol,d as S_,f as gm,g as v_,i as T_,k as Ke,l as fh}from"./BYBP4KRV.js";import{a as fm}from"./UXV3QMB6.js";import{a as cn}from"./2KT44S3D.js";import{A as C6,J as np,a as Jm,c as m6,d as ui,e as Jl,f as d6,g as ed,h as f6,i as h6,k as g6,l as td,m as es,n as ep,o as od}from"./JLO744NT.js";import{a as Cc}from"./LIFUWJGW.js";import{b as M6,d as ip}from"./MC2A5KLN.js";import{c as mC,d as dC}from"./SZXXTBUM.js";import{b as kC,f as LC,p as OC,q as BC,r as ja}from"./VTGOYHJW.js";import{a as p_,b as um,d as c_,h as N_}from"./DQCZLHJM.js";import{I as Zm,J as Zl,a as $y,b as Yl,c as Lh,e as Pn,f as Oh,g as Xy,h as Yy,i as Zy,j as Qy,k as Jy,l as e6,m as Bh,n as t6,o as _c,q as Dh,r as o6,s as Ym}from"./LHOPOZ7S.js";import{b as kt,f as ly}from"./SMGS7QAW.js";import{a as Sl,b as Ru,c as Uu,d as Wu,e as zx,f as Y_,g as Ih,i as Z_,j as Q_,k as J_,l as eC,m as Tm,n as tC,o as Mm,p as wm,q as Ga,r as Nl,t as Em,u as oC}from"./XOTQ5KQV.js";import{c as Za,d as xc}from"./454JMIH7.js";import{b as C_,g as hm,h as y_,i as b_,m as I_}from"./2HIYOEPI.js";import{a as li}from"./PZVNEH53.js";import{a as Cm}from"./UZTKLAY4.js";import{a as ym,b as B_,c as bm,d as D_,e as wn,f as F_,g as Ua,j as Rs,k as Im}from"./Q25QR6DL.js";import{a as z_,d as hh,e as gh,f as xh,j as V_,l as uc}from"./XXMMBCVS.js";import{a as P_}from"./UAWD6KOW.js";import{a as j2,b as oa,c as ph}from"./UXYD27MU.js";import{$ as uh,B as lc,H as Q2,Ja as kl,La as n_,Na as r_,Qa as i_,Ra as pc,S as J2,Ta as sr,Ua as Tt,Y as Al,aa as Pl,c as K2,d as q2,e as $2,f as Mn,g as X2,ha as e_,ia as t_,m as Y2,q as za,r as ch,t as Z2,v as QM,y as cm}from"./VE4EMEBO.js";import{b as Xu,f as ta}from"./UICGGF3X.js";import{A as _2,B as C2,C as b2,D as I2,E as ar,Ea as ah,F as tm,Fa as k2,Ga as L2,H as S2,Ha as O2,Ia as B2,Ka as D2,La as F2,P as v2,Pa as H2,Q as T2,Qa as N2,R as M2,Ra as z2,Sa as V2,T as w2,U as om,Va as rc,Wa as Ml,X as E2,Xa as rm,Ya as im,Za as am,a as Jp,ab as Be,ba as A2,ca as nh,cb as ic,d as E,da as Tl,f as vi,hb as wl,ib as sm,j as vt,ja as P2,jb as lm,k as Br,kb as El,l as po,mb as pm,n as oh,na as nm,nb as sh,o as Bo,oa as rh,pb as lh,q as Na,qb as ac,rb as R2,s as gr,sb as sc,tb as U2,v as f2,wa as nc,xa as ih,y as em,z as it}from"./AUJ76673.js";import{A as Rn,H as s_,I as l_,K as oo,e as De,q as ai,t as Ei,w as o_,y as a_}from"./DOCIOFBQ.js";import{Aa as Jo,H as x2,S as y2,c as ec,o as h2,t as g2}from"./MX3LYTPZ.js";import{b as eh,e as yl,g as th,h as Ax,i as Px,j as Si,k as bl}from"./HFEXSQX6.js";import{a as w}from"./4B6UFNBQ.js";import{D as Zp,E as ea,I as Qp,L as Hu,M as Ta,b as nr,c as Q1,h as Yp,l as Fu,m as lo,n as Or,o as Mx,r as wx,u as J1}from"./XZ5AIA7R.js";import{a as Ex}from"./PJ57C2TE.js";import{c as J,d as $M,f as I,h as Tx}from"./GAV6HCJA.js";var sb=J(gd=>{"use strict";"use client";var Rw=bo();Object.defineProperty(gd,"__esModule",{value:!0});gd.default=void 0;var Uw=Rw(So()),Ww=Io(),IW=gd.default=(0,Uw.default)((0,Ww.jsx)("path",{d:"m19 15-1.41-1.41L13 18.17V2h-2v16.17l-4.59-4.59L5 15l7 7z"}),"South")});var xb=J(xd=>{"use strict";"use client";var iE=bo();Object.defineProperty(xd,"__esModule",{value:!0});xd.default=void 0;var aE=iE(So()),gb=Io(),TG=xd.default=(0,aE.default)([(0,gb.jsx)("path",{d:"m21.67 18.17-5.3-5.3h-.99l-2.54 2.54v.99l5.3 5.3c.39.39 1.02.39 1.41 0l2.12-2.12c.39-.38.39-1.02 0-1.41"},"0"),(0,gb.jsx)("path",{d:"m17.34 10.19 1.41-1.41 2.12 2.12c1.17-1.17 1.17-3.07 0-4.24l-3.54-3.54-1.41 1.41V1.71l-.7-.71-3.54 3.54.71.71h2.83l-1.41 1.41 1.06 1.06-2.89 2.89-4.13-4.13V5.06L4.83 2.04 2 4.87 5.03 7.9h1.41l4.13 4.13-.85.85H7.6l-5.3 5.3c-.39.39-.39 1.02 0 1.41l2.12 2.12c.39.39 1.02.39 1.41 0l5.3-5.3v-2.12l5.15-5.15z"},"1")],"Handyman")});var _b=J(_d=>{"use strict";"use client";var sE=bo();Object.defineProperty(_d,"__esModule",{value:!0});_d.default=void 0;var lE=sE(So()),pE=Io(),wG=_d.default=(0,lE.default)((0,pE.jsx)("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2m1 15h-2v-2h2zm0-4h-2V7h2z"}),"Error")});var Cb=J(Cd=>{"use strict";"use client";var cE=bo();Object.defineProperty(Cd,"__esModule",{value:!0});Cd.default=void 0;var uE=cE(So()),mE=Io(),AG=Cd.default=(0,uE.default)((0,mE.jsx)("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2m1 15h-2v-6h2zm0-8h-2V7h2z"}),"Info")});var Hb=J((jj,Fb)=>{"use strict";function Ob(e){return(Ob=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(e)}function wc(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function kb(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Ec(e,t,o){return t&&kb(e.prototype,t),o&&kb(e,o),e}function vE(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Bb(e,t)}function Gh(e){return(Gh=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(e)}function Bb(e,t){return(Bb=Object.setPrototypeOf||function(o,n){return o.__proto__=n,o})(e,t)}function TE(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch{return!1}}function ME(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function wE(e,t){return!t||typeof t!="object"&&typeof t!="function"?ME(e):t}function EE(e){var t=TE();return function(){var o,n=Gh(e);if(t){var r=Gh(this).constructor;o=Reflect.construct(n,arguments,r)}else o=n.apply(this,arguments);return wE(this,o)}}function Lb(e){return AE(e)||PE(e)||kE(e)||LE()}function AE(e){if(Array.isArray(e))return jh(e)}function PE(e){if(typeof Symbol<"u"&&Symbol.iterator in Object(e))return Array.from(e)}function kE(e,t){if(e){if(typeof e=="string")return jh(e,t);var o=Object.prototype.toString.call(e).slice(8,-1);return o==="Object"&&e.constructor&&(o=e.constructor.name),o==="Map"||o==="Set"?Array.from(e):o==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(o)?jh(e,t):void 0}}function jh(e,t){(t==null||t>e.length)&&(t=e.length);for(var o=0,n=new Array(t);o<t;o++)n[o]=e[o];return n}function LE(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var Kh=function(){function e(t){wc(this,e),this._listeners=[],this._mute=!1,this._accumulate=!1,this._accumulatedEvents=[],this._name=t||"",this._onListenerAdded=null,this._onFirstListenerAdded=null,this._onListenerRemoved=null,this._onLastListenerRemoved=null}return Ec(e,[{key:"addListener",value:function(t,o){this._pushListener(t,o,!1)}},{key:"addOnceListener",value:function(t,o){this._pushListener(t,o,!0)}},{key:"removeListener",value:function(t,o){this._ensureListener(t);var n=this._indexOfListener(t,o);0<=n&&this._spliceListener(n)}},{key:"removeAllListeners",value:function(){for(;this.hasListeners();)this._spliceListener(0)}},{key:"hasListener",value:function(t,o){return this._ensureListener(t),0<=this._indexOfListener(t,o)}},{key:"hasListeners",value:function(){return 0<this._listeners.length}},{key:"dispatch",value:function(){for(var t=arguments.length,o=new Array(t),n=0;n<t;n++)o[n]=arguments[n];this._invokeListeners({args:o,async:!1})}},{key:"dispatchAsync",value:function(){for(var t=arguments.length,o=new Array(t),n=0;n<t;n++)o[n]=arguments[n];this._invokeListeners({args:o,async:!0})}},{key:"mute",value:function(t){var o=0<arguments.length&&t!==void 0?t:{};this._mute=!0,o.accumulate?this._accumulate=!0:(this._accumulate=!1,this._accumulatedEvents=[])}},{key:"unmute",value:function(){this._mute=!1,this._accumulate&&(this._dispatchAccumulated(),this._accumulate=!1)}},{key:"_invokeListeners",value:function(t){var o=this,n=0<arguments.length&&t!==void 0?t:{args:[],async:!1};this._mute?this._accumulate&&this._accumulatedEvents.push(n):this._listeners.slice().forEach(function(r){o._invokeListener(r,n),r.once&&o.removeListener(r.callback,r.context)})}},{key:"_invokeListener",value:function(t,o){var n,r,i=t.callback instanceof e;o.async?i?(n=t.callback).dispatchAsync.apply(n,Lb(o.args)):setTimeout(function(){return t.callback.apply(t.context,o.args)},0):i?(r=t.callback).dispatch.apply(r,Lb(o.args)):t.callback.apply(t.context,o.args)}},{key:"_ensureListener",value:function(t){if(!e.isValidListener(t))throw new Error("Channel "+this._name+": listener is not a function and not a Channel")}},{key:"_dispatchInnerAddEvents",value:function(){var t,o;this._onListenerAdded&&(t=this._onListenerAdded).dispatch.apply(t,arguments),this._onFirstListenerAdded&&this._listeners.length===1&&(o=this._onFirstListenerAdded).dispatch.apply(o,arguments)}},{key:"_dispatchInnerRemoveEvents",value:function(){var t,o;this._onListenerRemoved&&(t=this._onListenerRemoved).dispatch.apply(t,arguments),this._onLastListenerRemoved&&this._listeners.length===0&&(o=this._onLastListenerRemoved).dispatch.apply(o,arguments)}},{key:"_indexOfListener",value:function(t,o){for(var n=0;n<this._listeners.length;n++){var r=this._listeners[n],i=r.callback===t,a=t instanceof e,s=o===void 0&&r.context===void 0,l=o===r.context;if(i&&(a||s||l))return n}}},{key:"_dispatchAccumulated",value:function(){var t=this;this._accumulatedEvents.forEach(function(o){return t._invokeListeners(o)}),this._accumulatedEvents=[]}},{key:"_pushListener",value:function(t,o,n){this._ensureListener(t),this._checkForDuplicates(t,o),this._listeners.push({callback:t,context:o,once:n}),this._dispatchInnerAddEvents(t,o,n)}},{key:"_checkForDuplicates",value:function(t,o){if(this.hasListener(t,o))throw new Error("Channel "+this._name+": duplicating listeners")}},{key:"_spliceListener",value:function(t){var o=this._listeners[t],n=o.callback,r=o.context,i=o.once;this._listeners.splice(t,1),this._dispatchInnerRemoveEvents(n,r,i)}},{key:"onListenerAdded",get:function(){return this._onListenerAdded||(this._onListenerAdded=new e("".concat(this._name,":onListenerAdded"))),this._onListenerAdded}},{key:"onFirstListenerAdded",get:function(){return this._onFirstListenerAdded||(this._onFirstListenerAdded=new e("".concat(this._name,":onFirstListenerAdded"))),this._onFirstListenerAdded}},{key:"onListenerRemoved",get:function(){return this._onListenerRemoved||(this._onListenerRemoved=new e("".concat(this._name,":onListenerRemoved"))),this._onListenerRemoved}},{key:"onLastListenerRemoved",get:function(){return this._onLastListenerRemoved||(this._onLastListenerRemoved=new e("".concat(this._name,":onLastListenerRemoved"))),this._onLastListenerRemoved}}],[{key:"isValidListener",value:function(t){return typeof t=="function"||t instanceof e}}]),e}(),OE=function(){function e(){wc(this,e),this._channels=new Map}return Ec(e,[{key:"addListener",value:function(t,o,n){this._getChannel(t).addListener(o,n)}},{key:"on",value:function(t,o,n){this.addListener(t,o,n)}},{key:"addOnceListener",value:function(t,o,n){this._getChannel(t).addOnceListener(o,n)}},{key:"once",value:function(t,o,n){this.addOnceListener(t,o,n)}},{key:"removeListener",value:function(t,o,n){this._getChannel(t).removeListener(o,n)}},{key:"off",value:function(t,o,n){this.removeListener(t,o,n)}},{key:"hasListener",value:function(t,o,n){return this._getChannel(t).hasListener(o,n)}},{key:"has",value:function(t,o,n){return this.hasListener(t,o,n)}},{key:"hasListeners",value:function(t){return this._getChannel(t).hasListeners()}},{key:"dispatch",value:function(t){for(var o,n=arguments.length,r=new Array(1<n?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];(o=this._getChannel(t)).dispatch.apply(o,r)}},{key:"emit",value:function(t){for(var o=arguments.length,n=new Array(1<o?o-1:0),r=1;r<o;r++)n[r-1]=arguments[r];this.dispatch.apply(this,[t].concat(n))}},{key:"_getChannel",value:function(t){return this._channels.has(t)||this._channels.set(t,new Kh(t)),this._channels.get(t)}}]),e}(),BE=function(){function e(t){wc(this,e),this._params=t,this._isOn=!1,this._assertParams()}return Ec(e,[{key:"on",value:function(){if(!this._isOn){var t=this._params.channel,o=t.addListener||t.addEventListener||t.on;this._applyMethod(o),this._isOn=!0}}},{key:"off",value:function(){if(this._isOn){var t=this._params.channel,o=t.removeListener||t.removeEventListener||t.off;this._applyMethod(o),this._isOn=!1}}},{key:"_applyMethod",value:function(t){var o=this._params,n=o.channel,r=o.event,i=o.listener,a=r?[r,i]:[i];t.apply(n,a)}},{key:"_assertParams",value:function(){var t=this._params,o=t.channel,n=t.event,r=t.listener;if(!o||Ob(o)!=="object")throw new Error("Channel should be object");if(n&&typeof n!="string")throw new Error("Event should be string");if(!r||!Kh.isValidListener(r))throw new Error("Listener should be function or Channel")}}]),e}(),Db=function(){function e(t){wc(this,e),this._items=t.map(function(o){return new BE(o)})}return Ec(e,[{key:"on",value:function(){return this._items.forEach(function(t){return t.on()}),this}},{key:"off",value:function(){return this._items.forEach(function(t){return t.off()}),this}}]),e}(),DE=function(){vE(t,Db);var e=EE(t);function t(o,n){var r;return wc(this,t),(r=e.call(this,n))._overrideComponentCallback(o,"componentDidMount","on"),r._overrideComponentCallback(o,"componentWillUnmount","off"),r}return Ec(t,[{key:"_overrideComponentCallback",value:function(o,n,r){var i=this,a=o[n];o[n]=function(){if(i[r](),typeof a=="function"){for(var s=arguments.length,l=new Array(s),p=0;p<s;p++)l[p]=arguments[p];return a.apply(o,l)}}}}]),t}(),Id=Kh;Id.EventEmitter=OE,Id.Subscription=Db,Id.ReactSubscription=DE,Fb.exports=Id});var zb=J((Kj,Nb)=>{Nb.exports={timeout:0,timeoutReason:"Promise rejected by PromiseController timeout {timeout} ms.",resetReason:"Promise rejected by PromiseController reset."}});var Vb=J(Sd=>{Sd.isPromise=function(e){return e&&typeof e.then=="function"};Sd.tryCall=function(e){return typeof e=="function"?e():e};Sd.createErrorType=function(e){function t(o){Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack,this.message=o}return t.prototype=new Error,t.prototype.name=e,t.prototype.constructor=t,t}});var qh=J(($j,Gb)=>{var FE=zb(),{isPromise:Rb,createErrorType:Wb,tryCall:Ub}=Vb(),Ac=class e{constructor(t){this._options=Object.assign({},FE,t),this._resolve=null,this._reject=null,this._isPending=!1,this._isFulfilled=!1,this._isRejected=!1,this._value=void 0,this._promise=null,this._timer=null}get promise(){return this._promise}get value(){return this._value}get isPending(){return this._isPending}get isFulfilled(){return this._isFulfilled}get isRejected(){return this._isRejected}get isSettled(){return this._isFulfilled||this._isRejected}call(t){return this._isPending||(this.reset(),this._createPromise(),this._createTimer(),this._callFn(t)),this._promise}resolve(t){this._isPending&&(Rb(t)?this._tryAttachToPromise(t):(this._settle(t),this._isFulfilled=!0,this._resolve(t)))}reject(t){this._isPending&&(this._settle(t),this._isRejected=!0,this._reject(t))}reset(){if(this._isPending){let t=Ub(this._options.resetReason),o=new e.ResetError(t);this.reject(o)}this._promise=null,this._isPending=!1,this._isFulfilled=!1,this._isRejected=!1,this._value=void 0,this._clearTimer()}configure(t){Object.assign(this._options,t)}_createPromise(){this._promise=new Promise((t,o)=>{this._isPending=!0,this._resolve=t,this._reject=o})}_handleTimeout(){let t=Ub(this._options.timeoutReason),o=typeof t=="string"?t.replace("{timeout}",this._options.timeout):"",n=new e.TimeoutError(o);this.reject(n)}_createTimer(){this._options.timeout&&(this._timer=setTimeout(()=>this._handleTimeout(),this._options.timeout))}_clearTimer(){this._timer&&(clearTimeout(this._timer),this._timer=null)}_settle(t){this._isPending=!1,this._value=t,this._clearTimer()}_callFn(t){if(typeof t=="function")try{let o=t();this._tryAttachToPromise(o)}catch(o){this.reject(o)}}_tryAttachToPromise(t){Rb(t)&&t.then(o=>this.resolve(o),o=>this.reject(o))}};Ac.TimeoutError=Wb("TimeoutError");Ac.ResetError=Wb("ResetError");Gb.exports=Ac});var jb=J(vd=>{"use strict";Object.defineProperty(vd,"__esModule",{value:!0});vd.PromisedMap=void 0;var HE=function(){function e(){this.map=new Map}return Object.defineProperty(e.prototype,"size",{get:function(){return this.map.size},enumerable:!1,configurable:!0}),e.prototype.set=function(t,o){var n=this.createMapItem(o);return this.map.set(t,n),n.promise},e.prototype.get=function(t){var o=this.map.get(t);return o&&o.data},e.prototype.has=function(t){return this.map.has(t)},e.prototype.delete=function(t){return this.map.delete(t)},e.prototype.resolve=function(t,o){var n=this.map.get(t);n&&(this.delete(t),n.resolve(o))},e.prototype.reject=function(t,o){var n=this.map.get(t);n&&(this.delete(t),n.reject(o))},e.prototype.resolveAll=function(t){this.map.forEach(function(o){return o.resolve(t)}),this.map.clear()},e.prototype.rejectAll=function(t){this.map.forEach(function(o){return o.reject(t)}),this.map.clear()},e.prototype.forEach=function(t){this.map.forEach(function(o,n,r){return t(o.data,n,r)})},e.prototype.clear=function(){return this.map.clear()},e.prototype.createMapItem=function(t){var o={data:t};return o.promise=new Promise(function(n,r){o.resolve=n,o.reject=r}),o},e}();vd.PromisedMap=HE});var $b=J((Yj,qb)=>{"use strict";var NE="Function.prototype.bind called on incompatible ",zE=Object.prototype.toString,VE=Math.max,RE="[object Function]",Kb=function(t,o){for(var n=[],r=0;r<t.length;r+=1)n[r]=t[r];for(var i=0;i<o.length;i+=1)n[i+t.length]=o[i];return n},UE=function(t,o){for(var n=[],r=o||0,i=0;r<t.length;r+=1,i+=1)n[i]=t[r];return n},WE=function(e,t){for(var o="",n=0;n<e.length;n+=1)o+=e[n],n+1<e.length&&(o+=t);return o};qb.exports=function(t){var o=this;if(typeof o!="function"||zE.apply(o)!==RE)throw new TypeError(NE+o);for(var n=UE(arguments,1),r,i=function(){if(this instanceof r){var u=o.apply(this,Kb(n,arguments));return Object(u)===u?u:this}return o.apply(t,Kb(n,arguments))},a=VE(0,o.length-n.length),s=[],l=0;l<a;l++)s[l]="$"+l;if(r=Function("binder","return function ("+WE(s,",")+"){ return binder.apply(this,arguments); }")(i),o.prototype){var p=function(){};p.prototype=o.prototype,r.prototype=new p,p.prototype=null}return r}});var Td=J((Zj,Xb)=>{"use strict";var GE=$b();Xb.exports=Function.prototype.bind||GE});var Zb=J((Qj,Yb)=>{"use strict";Yb.exports=Error});var Jb=J((Jj,Qb)=>{"use strict";Qb.exports=EvalError});var t5=J((eK,e5)=>{"use strict";e5.exports=RangeError});var n5=J((tK,o5)=>{"use strict";o5.exports=ReferenceError});var Md=J((oK,r5)=>{"use strict";r5.exports=SyntaxError});var Cr=J((nK,i5)=>{"use strict";i5.exports=TypeError});var s5=J((rK,a5)=>{"use strict";a5.exports=URIError});var p5=J((iK,l5)=>{"use strict";l5.exports=function(){if(typeof Symbol!="function"||typeof Object.getOwnPropertySymbols!="function")return!1;if(typeof Symbol.iterator=="symbol")return!0;var t={},o=Symbol("test"),n=Object(o);if(typeof o=="string"||Object.prototype.toString.call(o)!=="[object Symbol]"||Object.prototype.toString.call(n)!=="[object Symbol]")return!1;var r=42;t[o]=r;for(o in t)return!1;if(typeof Object.keys=="function"&&Object.keys(t).length!==0||typeof Object.getOwnPropertyNames=="function"&&Object.getOwnPropertyNames(t).length!==0)return!1;var i=Object.getOwnPropertySymbols(t);if(i.length!==1||i[0]!==o||!Object.prototype.propertyIsEnumerable.call(t,o))return!1;if(typeof Object.getOwnPropertyDescriptor=="function"){var a=Object.getOwnPropertyDescriptor(t,o);if(a.value!==r||a.enumerable!==!0)return!1}return!0}});var m5=J((aK,u5)=>{"use strict";var c5=typeof Symbol<"u"&&Symbol,jE=p5();u5.exports=function(){return typeof c5!="function"||typeof Symbol!="function"||typeof c5("foo")!="symbol"||typeof Symbol("bar")!="symbol"?!1:jE()}});var f5=J((sK,d5)=>{"use strict";var $h={__proto__:null,foo:{}},KE=Object;d5.exports=function(){return{__proto__:$h}.foo===$h.foo&&!($h instanceof KE)}});var Pc=J((lK,h5)=>{"use strict";var qE=Function.prototype.call,$E=Object.prototype.hasOwnProperty,XE=Td();h5.exports=XE.call(qE,$E)});var Ui=J((pK,y5)=>{"use strict";var $e,YE=Zb(),ZE=Jb(),QE=t5(),JE=n5(),fp=Md(),dp=Cr(),eA=s5(),C5=Function,Xh=function(e){try{return C5('"use strict"; return ('+e+").constructor;")()}catch{}},$s=Object.getOwnPropertyDescriptor;if($s)try{$s({},"")}catch{$s=null}var Yh=function(){throw new dp},tA=$s?function(){try{return arguments.callee,Yh}catch{try{return $s(arguments,"callee").get}catch{return Yh}}}():Yh,up=m5()(),oA=f5()(),rn=Object.getPrototypeOf||(oA?function(e){return e.__proto__}:null),mp={},nA=typeof Uint8Array>"u"||!rn?$e:rn(Uint8Array),Xs={__proto__:null,"%AggregateError%":typeof AggregateError>"u"?$e:AggregateError,"%Array%":Array,"%ArrayBuffer%":typeof ArrayBuffer>"u"?$e:ArrayBuffer,"%ArrayIteratorPrototype%":up&&rn?rn([][Symbol.iterator]()):$e,"%AsyncFromSyncIteratorPrototype%":$e,"%AsyncFunction%":mp,"%AsyncGenerator%":mp,"%AsyncGeneratorFunction%":mp,"%AsyncIteratorPrototype%":mp,"%Atomics%":typeof Atomics>"u"?$e:Atomics,"%BigInt%":typeof BigInt>"u"?$e:BigInt,"%BigInt64Array%":typeof BigInt64Array>"u"?$e:BigInt64Array,"%BigUint64Array%":typeof BigUint64Array>"u"?$e:BigUint64Array,"%Boolean%":Boolean,"%DataView%":typeof DataView>"u"?$e:DataView,"%Date%":Date,"%decodeURI%":decodeURI,"%decodeURIComponent%":decodeURIComponent,"%encodeURI%":encodeURI,"%encodeURIComponent%":encodeURIComponent,"%Error%":YE,"%eval%":eval,"%EvalError%":ZE,"%Float32Array%":typeof Float32Array>"u"?$e:Float32Array,"%Float64Array%":typeof Float64Array>"u"?$e:Float64Array,"%FinalizationRegistry%":typeof FinalizationRegistry>"u"?$e:FinalizationRegistry,"%Function%":C5,"%GeneratorFunction%":mp,"%Int8Array%":typeof Int8Array>"u"?$e:Int8Array,"%Int16Array%":typeof Int16Array>"u"?$e:Int16Array,"%Int32Array%":typeof Int32Array>"u"?$e:Int32Array,"%isFinite%":isFinite,"%isNaN%":isNaN,"%IteratorPrototype%":up&&rn?rn(rn([][Symbol.iterator]())):$e,"%JSON%":typeof JSON=="object"?JSON:$e,"%Map%":typeof Map>"u"?$e:Map,"%MapIteratorPrototype%":typeof Map>"u"||!up||!rn?$e:rn(new Map()[Symbol.iterator]()),"%Math%":Math,"%Number%":Number,"%Object%":Object,"%parseFloat%":parseFloat,"%parseInt%":parseInt,"%Promise%":typeof Promise>"u"?$e:Promise,"%Proxy%":typeof Proxy>"u"?$e:Proxy,"%RangeError%":QE,"%ReferenceError%":JE,"%Reflect%":typeof Reflect>"u"?$e:Reflect,"%RegExp%":RegExp,"%Set%":typeof Set>"u"?$e:Set,"%SetIteratorPrototype%":typeof Set>"u"||!up||!rn?$e:rn(new Set()[Symbol.iterator]()),"%SharedArrayBuffer%":typeof SharedArrayBuffer>"u"?$e:SharedArrayBuffer,"%String%":String,"%StringIteratorPrototype%":up&&rn?rn(""[Symbol.iterator]()):$e,"%Symbol%":up?Symbol:$e,"%SyntaxError%":fp,"%ThrowTypeError%":tA,"%TypedArray%":nA,"%TypeError%":dp,"%Uint8Array%":typeof Uint8Array>"u"?$e:Uint8Array,"%Uint8ClampedArray%":typeof Uint8ClampedArray>"u"?$e:Uint8ClampedArray,"%Uint16Array%":typeof Uint16Array>"u"?$e:Uint16Array,"%Uint32Array%":typeof Uint32Array>"u"?$e:Uint32Array,"%URIError%":eA,"%WeakMap%":typeof WeakMap>"u"?$e:WeakMap,"%WeakRef%":typeof WeakRef>"u"?$e:WeakRef,"%WeakSet%":typeof WeakSet>"u"?$e:WeakSet};if(rn)try{null.error}catch(e){g5=rn(rn(e)),Xs["%Error.prototype%"]=g5}var g5,rA=function e(t){var o;if(t==="%AsyncFunction%")o=Xh("async function () {}");else if(t==="%GeneratorFunction%")o=Xh("function* () {}");else if(t==="%AsyncGeneratorFunction%")o=Xh("async function* () {}");else if(t==="%AsyncGenerator%"){var n=e("%AsyncGeneratorFunction%");n&&(o=n.prototype)}else if(t==="%AsyncIteratorPrototype%"){var r=e("%AsyncGenerator%");r&&rn&&(o=rn(r.prototype))}return Xs[t]=o,o},x5={__proto__:null,"%ArrayBufferPrototype%":["ArrayBuffer","prototype"],"%ArrayPrototype%":["Array","prototype"],"%ArrayProto_entries%":["Array","prototype","entries"],"%ArrayProto_forEach%":["Array","prototype","forEach"],"%ArrayProto_keys%":["Array","prototype","keys"],"%ArrayProto_values%":["Array","prototype","values"],"%AsyncFunctionPrototype%":["AsyncFunction","prototype"],"%AsyncGenerator%":["AsyncGeneratorFunction","prototype"],"%AsyncGeneratorPrototype%":["AsyncGeneratorFunction","prototype","prototype"],"%BooleanPrototype%":["Boolean","prototype"],"%DataViewPrototype%":["DataView","prototype"],"%DatePrototype%":["Date","prototype"],"%ErrorPrototype%":["Error","prototype"],"%EvalErrorPrototype%":["EvalError","prototype"],"%Float32ArrayPrototype%":["Float32Array","prototype"],"%Float64ArrayPrototype%":["Float64Array","prototype"],"%FunctionPrototype%":["Function","prototype"],"%Generator%":["GeneratorFunction","prototype"],"%GeneratorPrototype%":["GeneratorFunction","prototype","prototype"],"%Int8ArrayPrototype%":["Int8Array","prototype"],"%Int16ArrayPrototype%":["Int16Array","prototype"],"%Int32ArrayPrototype%":["Int32Array","prototype"],"%JSONParse%":["JSON","parse"],"%JSONStringify%":["JSON","stringify"],"%MapPrototype%":["Map","prototype"],"%NumberPrototype%":["Number","prototype"],"%ObjectPrototype%":["Object","prototype"],"%ObjProto_toString%":["Object","prototype","toString"],"%ObjProto_valueOf%":["Object","prototype","valueOf"],"%PromisePrototype%":["Promise","prototype"],"%PromiseProto_then%":["Promise","prototype","then"],"%Promise_all%":["Promise","all"],"%Promise_reject%":["Promise","reject"],"%Promise_resolve%":["Promise","resolve"],"%RangeErrorPrototype%":["RangeError","prototype"],"%ReferenceErrorPrototype%":["ReferenceError","prototype"],"%RegExpPrototype%":["RegExp","prototype"],"%SetPrototype%":["Set","prototype"],"%SharedArrayBufferPrototype%":["SharedArrayBuffer","prototype"],"%StringPrototype%":["String","prototype"],"%SymbolPrototype%":["Symbol","prototype"],"%SyntaxErrorPrototype%":["SyntaxError","prototype"],"%TypedArrayPrototype%":["TypedArray","prototype"],"%TypeErrorPrototype%":["TypeError","prototype"],"%Uint8ArrayPrototype%":["Uint8Array","prototype"],"%Uint8ClampedArrayPrototype%":["Uint8ClampedArray","prototype"],"%Uint16ArrayPrototype%":["Uint16Array","prototype"],"%Uint32ArrayPrototype%":["Uint32Array","prototype"],"%URIErrorPrototype%":["URIError","prototype"],"%WeakMapPrototype%":["WeakMap","prototype"],"%WeakSetPrototype%":["WeakSet","prototype"]},kc=Td(),wd=Pc(),iA=kc.call(Function.call,Array.prototype.concat),aA=kc.call(Function.apply,Array.prototype.splice),_5=kc.call(Function.call,String.prototype.replace),Ed=kc.call(Function.call,String.prototype.slice),sA=kc.call(Function.call,RegExp.prototype.exec),lA=/[^%.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|%$))/g,pA=/\\(\\)?/g,cA=function(t){var o=Ed(t,0,1),n=Ed(t,-1);if(o==="%"&&n!=="%")throw new fp("invalid intrinsic syntax, expected closing `%`");if(n==="%"&&o!=="%")throw new fp("invalid intrinsic syntax, expected opening `%`");var r=[];return _5(t,lA,function(i,a,s,l){r[r.length]=s?_5(l,pA,"$1"):a||i}),r},uA=function(t,o){var n=t,r;if(wd(x5,n)&&(r=x5[n],n="%"+r[0]+"%"),wd(Xs,n)){var i=Xs[n];if(i===mp&&(i=rA(n)),typeof i>"u"&&!o)throw new dp("intrinsic "+t+" exists, but is not available. Please file an issue!");return{alias:r,name:n,value:i}}throw new fp("intrinsic "+t+" does not exist!")};y5.exports=function(t,o){if(typeof t!="string"||t.length===0)throw new dp("intrinsic name must be a non-empty string");if(arguments.length>1&&typeof o!="boolean")throw new dp('"allowMissing" argument must be a boolean');if(sA(/^%?[^%]*%?$/,t)===null)throw new fp("`%` may not be present anywhere but at the beginning and end of the intrinsic name");var n=cA(t),r=n.length>0?n[0]:"",i=uA("%"+r+"%",o),a=i.name,s=i.value,l=!1,p=i.alias;p&&(r=p[0],aA(n,iA([0,1],p)));for(var u=1,c=!0;u<n.length;u+=1){var m=n[u],d=Ed(m,0,1),f=Ed(m,-1);if((d==='"'||d==="'"||d==="`"||f==='"'||f==="'"||f==="`")&&d!==f)throw new fp("property names with quotes must have matching quotes");if((m==="constructor"||!c)&&(l=!0),r+="."+m,a="%"+r+"%",wd(Xs,a))s=Xs[a];else if(s!=null){if(!(m in s)){if(!o)throw new dp("base intrinsic for "+t+" exists, but the property is not available.");return}if($s&&u+1>=n.length){var h=$s(s,m);c=!!h,c&&"get"in h&&!("originalValue"in h.get)?s=h.get:s=s[m]}else c=wd(s,m),s=s[m];c&&!l&&(Xs[a]=s)}}return s}});var Lc=J((cK,b5)=>{"use strict";var mA=Ui(),Ad=mA("%Object.defineProperty%",!0)||!1;if(Ad)try{Ad({},"a",{value:1})}catch{Ad=!1}b5.exports=Ad});var Zh=J((uK,I5)=>{"use strict";var dA=Ui(),Pd=dA("%Object.getOwnPropertyDescriptor%",!0);if(Pd)try{Pd([],"length")}catch{Pd=null}I5.exports=Pd});var kd=J((mK,T5)=>{"use strict";var S5=Lc(),fA=Md(),hp=Cr(),v5=Zh();T5.exports=function(t,o,n){if(!t||typeof t!="object"&&typeof t!="function")throw new hp("`obj` must be an object or a function`");if(typeof o!="string"&&typeof o!="symbol")throw new hp("`property` must be a string or a symbol`");if(arguments.length>3&&typeof arguments[3]!="boolean"&&arguments[3]!==null)throw new hp("`nonEnumerable`, if provided, must be a boolean or null");if(arguments.length>4&&typeof arguments[4]!="boolean"&&arguments[4]!==null)throw new hp("`nonWritable`, if provided, must be a boolean or null");if(arguments.length>5&&typeof arguments[5]!="boolean"&&arguments[5]!==null)throw new hp("`nonConfigurable`, if provided, must be a boolean or null");if(arguments.length>6&&typeof arguments[6]!="boolean")throw new hp("`loose`, if provided, must be a boolean");var r=arguments.length>3?arguments[3]:null,i=arguments.length>4?arguments[4]:null,a=arguments.length>5?arguments[5]:null,s=arguments.length>6?arguments[6]:!1,l=!!v5&&v5(t,o);if(S5)S5(t,o,{configurable:a===null&&l?l.configurable:!a,enumerable:r===null&&l?l.enumerable:!r,value:n,writable:i===null&&l?l.writable:!i});else if(s||!r&&!i&&!a)t[o]=n;else throw new fA("This environment does not support defining a property as non-configurable, non-writable, or non-enumerable.")}});var Oc=J((dK,w5)=>{"use strict";var Qh=Lc(),M5=function(){return!!Qh};M5.hasArrayLengthDefineBug=function(){if(!Qh)return null;try{return Qh([],"length",{value:1}).length!==1}catch{return!0}};w5.exports=M5});var L5=J((fK,k5)=>{"use strict";var hA=Ui(),E5=kd(),gA=Oc()(),A5=Zh(),P5=Cr(),xA=hA("%Math.floor%");k5.exports=function(t,o){if(typeof t!="function")throw new P5("`fn` is not a function");if(typeof o!="number"||o<0||o>4294967295||xA(o)!==o)throw new P5("`length` must be a positive 32-bit integer");var n=arguments.length>2&&!!arguments[2],r=!0,i=!0;if("length"in t&&A5){var a=A5(t,"length");a&&!a.configurable&&(r=!1),a&&!a.writable&&(i=!1)}return(r||i||!n)&&(gA?E5(t,"length",o,!0,!0):E5(t,"length",o)),t}});var Bd=J((hK,Ld)=>{"use strict";var Jh=Td(),Od=Ui(),_A=L5(),CA=Cr(),D5=Od("%Function.prototype.apply%"),F5=Od("%Function.prototype.call%"),H5=Od("%Reflect.apply%",!0)||Jh.call(F5,D5),O5=Lc(),yA=Od("%Math.max%");Ld.exports=function(t){if(typeof t!="function")throw new CA("a function is required");var o=H5(Jh,F5,arguments);return _A(o,1+yA(0,t.length-(arguments.length-1)),!0)};var B5=function(){return H5(Jh,D5,arguments)};O5?O5(Ld.exports,"apply",{value:B5}):Ld.exports.apply=B5});var eg=J((gK,z5)=>{"use strict";var N5=Object.prototype.toString;z5.exports=function(t){var o=N5.call(t),n=o==="[object Arguments]";return n||(n=o!=="[object Array]"&&t!==null&&typeof t=="object"&&typeof t.length=="number"&&t.length>=0&&N5.call(t.callee)==="[object Function]"),n}});var $5=J((xK,q5)=>{"use strict";var K5;Object.keys||(Bc=Object.prototype.hasOwnProperty,tg=Object.prototype.toString,V5=eg(),og=Object.prototype.propertyIsEnumerable,R5=!og.call({toString:null},"toString"),U5=og.call(function(){},"prototype"),Dc=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"],Dd=function(e){var t=e.constructor;return t&&t.prototype===e},W5={$applicationCache:!0,$console:!0,$external:!0,$frame:!0,$frameElement:!0,$frames:!0,$innerHeight:!0,$innerWidth:!0,$onmozfullscreenchange:!0,$onmozfullscreenerror:!0,$outerHeight:!0,$outerWidth:!0,$pageXOffset:!0,$pageYOffset:!0,$parent:!0,$scrollLeft:!0,$scrollTop:!0,$scrollX:!0,$scrollY:!0,$self:!0,$webkitIndexedDB:!0,$webkitStorageInfo:!0,$window:!0},G5=function(){if(typeof window>"u")return!1;for(var e in window)try{if(!W5["$"+e]&&Bc.call(window,e)&&window[e]!==null&&typeof window[e]=="object")try{Dd(window[e])}catch{return!0}}catch{return!0}return!1}(),j5=function(e){if(typeof window>"u"||!G5)return Dd(e);try{return Dd(e)}catch{return!1}},K5=function(t){var o=t!==null&&typeof t=="object",n=tg.call(t)==="[object Function]",r=V5(t),i=o&&tg.call(t)==="[object String]",a=[];if(!o&&!n&&!r)throw new TypeError("Object.keys called on a non-object");var s=U5&&n;if(i&&t.length>0&&!Bc.call(t,0))for(var l=0;l<t.length;++l)a.push(String(l));if(r&&t.length>0)for(var p=0;p<t.length;++p)a.push(String(p));else for(var u in t)!(s&&u==="prototype")&&Bc.call(t,u)&&a.push(String(u));if(R5)for(var c=j5(t),m=0;m<Dc.length;++m)!(c&&Dc[m]==="constructor")&&Bc.call(t,Dc[m])&&a.push(Dc[m]);return a});var Bc,tg,V5,og,R5,U5,Dc,Dd,W5,G5,j5;q5.exports=K5});var Q5=J((_K,Z5)=>{"use strict";var bA=Array.prototype.slice,IA=eg(),X5=Object.keys,Fd=X5?function(t){return X5(t)}:$5(),Y5=Object.keys;Fd.shim=function(){if(Object.keys){var t=function(){var o=Object.keys(arguments);return o&&o.length===arguments.length}(1,2);t||(Object.keys=function(n){return IA(n)?Y5(bA.call(n)):Y5(n)})}else Object.keys=Fd;return Object.keys||Fd};Z5.exports=Fd});var ng=J((CK,o4)=>{"use strict";var SA=Q5(),vA=typeof Symbol=="function"&&typeof Symbol("foo")=="symbol",TA=Object.prototype.toString,MA=Array.prototype.concat,J5=kd(),wA=function(e){return typeof e=="function"&&TA.call(e)==="[object Function]"},e4=Oc()(),EA=function(e,t,o,n){if(t in e){if(n===!0){if(e[t]===o)return}else if(!wA(n)||!n())return}e4?J5(e,t,o,!0):J5(e,t,o)},t4=function(e,t){var o=arguments.length>2?arguments[2]:{},n=SA(t);vA&&(n=MA.call(n,Object.getOwnPropertySymbols(t)));for(var r=0;r<n.length;r+=1)EA(e,n[r],t[n[r]],o[n[r]])};t4.supportsDescriptors=!!e4;o4.exports=t4});var Hd=J((yK,n4)=>{"use strict";n4.exports=function(){if(typeof Promise!="function")throw new TypeError("`Promise.prototype.finally` requires a global `Promise` be available.")}});var s4=J((bK,a4)=>{"use strict";var AA=Ui(),PA=Bd(),kA=Md(),r4=AA("%Promise.resolve%",!0),i4=r4&&PA(r4);a4.exports=function(t,o){if(!i4)throw new kA("This environment does not support Promises.");return i4(t,o)}});var u4=J((IK,c4)=>{"use strict";var p4=Function.prototype.toString,gp=typeof Reflect=="object"&&Reflect!==null&&Reflect.apply,ig,Nd;if(typeof gp=="function"&&typeof Object.defineProperty=="function")try{ig=Object.defineProperty({},"length",{get:function(){throw Nd}}),Nd={},gp(function(){throw 42},null,ig)}catch(e){e!==Nd&&(gp=null)}else gp=null;var LA=/^\s*class\b/,ag=function(t){try{var o=p4.call(t);return LA.test(o)}catch{return!1}},rg=function(t){try{return ag(t)?!1:(p4.call(t),!0)}catch{return!1}},zd=Object.prototype.toString,OA="[object Object]",BA="[object Function]",DA="[object GeneratorFunction]",FA="[object HTMLAllCollection]",HA="[object HTML document.all class]",NA="[object HTMLCollection]",zA=typeof Symbol=="function"&&!!Symbol.toStringTag,VA=!(0 in[,]),sg=function(){return!1};typeof document=="object"&&(l4=document.all,zd.call(l4)===zd.call(document.all)&&(sg=function(t){if((VA||!t)&&(typeof t>"u"||typeof t=="object"))try{var o=zd.call(t);return(o===FA||o===HA||o===NA||o===OA)&&t("")==null}catch{}return!1}));var l4;c4.exports=gp?function(t){if(sg(t))return!0;if(!t||typeof t!="function"&&typeof t!="object")return!1;try{gp(t,null,ig)}catch(o){if(o!==Nd)return!1}return!ag(t)&&rg(t)}:function(t){if(sg(t))return!0;if(!t||typeof t!="function"&&typeof t!="object")return!1;if(zA)return rg(t);if(ag(t))return!1;var o=zd.call(t);return o!==BA&&o!==DA&&!/^\[object HTML/.test(o)?!1:rg(t)}});var lg=J((SK,m4)=>{"use strict";m4.exports=u4()});var f4=J((vK,d4)=>{"use strict";d4.exports=Ui()});var Vd=J((TK,h4)=>{"use strict";var RA=Cr(),Fc=Pc(),UA={__proto__:null,"[[Configurable]]":!0,"[[Enumerable]]":!0,"[[Get]]":!0,"[[Set]]":!0,"[[Value]]":!0,"[[Writable]]":!0};h4.exports=function(t){if(!t||typeof t!="object")return!1;for(var o in t)if(Fc(t,o)&&!UA[o])return!1;var n=Fc(t,"[[Value]]")||Fc(t,"[[Writable]]"),r=Fc(t,"[[Get]]")||Fc(t,"[[Set]]");if(n&&r)throw new RA("Property Descriptors may not be both accessor and data descriptors");return!0}});var pg=J((MK,_4)=>{"use strict";var g4=Ui(),x4=Bd(),WA=x4(g4("String.prototype.indexOf"));_4.exports=function(t,o){var n=g4(t,!!o);return typeof n=="function"&&WA(t,".prototype.")>-1?x4(n):n}});var b4=J((wK,y4)=>{"use strict";var GA=Ui(),C4=GA("%Array%"),jA=!C4.isArray&&pg()("Object.prototype.toString");y4.exports=C4.isArray||function(t){return jA(t)==="[object Array]"}});var T4=J((EK,v4)=>{"use strict";var KA=Oc(),I4=Lc(),S4=KA.hasArrayLengthDefineBug(),qA=S4&&b4(),$A=pg(),XA=$A("Object.prototype.propertyIsEnumerable");v4.exports=function(t,o,n,r,i,a){if(!I4){if(!t(a)||!a["[[Configurable]]"]||!a["[[Writable]]"]||i in r&&XA(r,i)!==!!a["[[Enumerable]]"])return!1;var s=a["[[Value]]"];return r[i]=s,o(r[i],s)}return S4&&i==="length"&&"[[Value]]"in a&&qA(r)&&r.length!==a["[[Value]]"]?(r.length=a["[[Value]]"],r.length===a["[[Value]]"]):(I4(r,i,n(a)),!0)}});var w4=J((AK,M4)=>{"use strict";M4.exports=function(t){if(typeof t>"u")return t;var o={};return"[[Value]]"in t&&(o.value=t["[[Value]]"]),"[[Writable]]"in t&&(o.writable=!!t["[[Writable]]"]),"[[Get]]"in t&&(o.get=t["[[Get]]"]),"[[Set]]"in t&&(o.set=t["[[Set]]"]),"[[Enumerable]]"in t&&(o.enumerable=!!t["[[Enumerable]]"]),"[[Configurable]]"in t&&(o.configurable=!!t["[[Configurable]]"]),o}});var A4=J((PK,E4)=>{"use strict";var YA=Cr(),ZA=Vd(),QA=w4();E4.exports=function(t){if(typeof t<"u"&&!ZA(t))throw new YA("Assertion failed: `Desc` must be a Property Descriptor");return QA(t)}});var L4=J((kK,k4)=>{"use strict";var JA=Cr(),P4=Pc(),eP=Vd();k4.exports=function(t){if(typeof t>"u")return!1;if(!eP(t))throw new JA("Assertion failed: `Desc` must be a Property Descriptor");return!(!P4(t,"[[Value]]")&&!P4(t,"[[Writable]]"))}});var B4=J((LK,O4)=>{"use strict";O4.exports=function(t){return typeof t=="string"||typeof t=="symbol"}});var F4=J((OK,D4)=>{"use strict";D4.exports=Number.isNaN||function(t){return t!==t}});var z4=J((BK,N4)=>{"use strict";var H4=F4();N4.exports=function(t,o){return t===o?t===0?1/t===1/o:!0:H4(t)&&H4(o)}});var R4=J((DK,V4)=>{"use strict";V4.exports=function(t){if(t===null)return"Null";if(typeof t>"u")return"Undefined";if(typeof t=="function"||typeof t=="object")return"Object";if(typeof t=="number")return"Number";if(typeof t=="boolean")return"Boolean";if(typeof t=="string")return"String"}});var Hc=J((FK,U4)=>{"use strict";var tP=R4();U4.exports=function(t){return typeof t=="symbol"?"Symbol":typeof t=="bigint"?"BigInt":tP(t)}});var G4=J((HK,W4)=>{"use strict";W4.exports=function(t){return!!t}});var q4=J((NK,K4)=>{"use strict";var Wi=Pc(),Rd=Cr(),oP=Hc(),cg=G4(),j4=lg();K4.exports=function(t){if(oP(t)!=="Object")throw new Rd("ToPropertyDescriptor requires an object");var o={};if(Wi(t,"enumerable")&&(o["[[Enumerable]]"]=cg(t.enumerable)),Wi(t,"configurable")&&(o["[[Configurable]]"]=cg(t.configurable)),Wi(t,"value")&&(o["[[Value]]"]=t.value),Wi(t,"writable")&&(o["[[Writable]]"]=cg(t.writable)),Wi(t,"get")){var n=t.get;if(typeof n<"u"&&!j4(n))throw new Rd("getter must be a function");o["[[Get]]"]=n}if(Wi(t,"set")){var r=t.set;if(typeof r<"u"&&!j4(r))throw new Rd("setter must be a function");o["[[Set]]"]=r}if((Wi(o,"[[Get]]")||Wi(o,"[[Set]]"))&&(Wi(o,"[[Value]]")||Wi(o,"[[Writable]]")))throw new Rd("Invalid property descriptor. Cannot both specify accessors and a value or writable attribute");return o}});var Y4=J((zK,X4)=>{"use strict";var ug=Cr(),$4=Vd(),nP=T4(),rP=A4(),iP=L4(),aP=B4(),sP=z4(),lP=q4(),pP=Hc();X4.exports=function(t,o,n){if(pP(t)!=="Object")throw new ug("Assertion failed: Type(O) is not Object");if(!aP(o))throw new ug("Assertion failed: IsPropertyKey(P) is not true");var r=$4(n)?n:lP(n);if(!$4(r))throw new ug("Assertion failed: Desc is not a valid Property Descriptor");return nP(iP,sP,rP,t,o,r)}});var Q4=J((VK,fg)=>{"use strict";var cP=f4(),Z4=cP("%Reflect.construct%",!0),Ud=Y4();try{Ud({},"",{"[[Get]]":function(){}})}catch{Ud=null}Ud&&Z4?(mg={},dg={},Ud(dg,"length",{"[[Get]]":function(){throw mg},"[[Enumerable]]":!0}),fg.exports=function(t){try{Z4(t,dg)}catch(o){return o===mg}}):fg.exports=function(t){return typeof t=="function"&&!!t.prototype};var mg,dg});var oI=J((RK,tI)=>{"use strict";var uP=Ui(),J4=uP("%Symbol.species%",!0),hg=Cr(),mP=Q4(),eI=Hc();tI.exports=function(t,o){if(eI(t)!=="Object")throw new hg("Assertion failed: Type(O) is not Object");var n=t.constructor;if(typeof n>"u")return o;if(eI(n)!=="Object")throw new hg("O.constructor is not an Object");var r=J4?n[J4]:void 0;if(r==null)return o;if(mP(r))return r;throw new hg("no constructor found")}});var rI=J((UK,nI)=>{"use strict";var zc=function(){return typeof function(){}.name=="string"},Nc=Object.getOwnPropertyDescriptor;if(Nc)try{Nc([],"length")}catch{Nc=null}zc.functionsHaveConfigurableNames=function(){if(!zc()||!Nc)return!1;var t=Nc(function(){},"name");return!!t&&!!t.configurable};var dP=Function.prototype.bind;zc.boundFunctionsHaveNames=function(){return zc()&&typeof dP=="function"&&function(){}.bind().name!==""};nI.exports=zc});var sI=J((WK,aI)=>{"use strict";var iI=kd(),fP=Oc()(),hP=rI().functionsHaveConfigurableNames(),gP=Cr();aI.exports=function(t,o){if(typeof t!="function")throw new gP("`fn` is not a function");var n=arguments.length>2&&!!arguments[2];return(!n||hP)&&(fP?iI(t,"name",o,!0,!0):iI(t,"name",o)),t}});var gg=J((GK,pI)=>{"use strict";var xP=Hd();xP();var _P=Cr(),lI=s4(),CP=lg(),yP=oI(),bP=Hc(),IP=sI(),SP=Promise,vP=function(t,o){return function(n){var r=o(),i=lI(t,r),a=function(){return n};return i.then(a)}},TP=function(t,o){return function(n){var r=o(),i=lI(t,r),a=function(){throw n};return i.then(a)}};pI.exports=IP(function(t){var o=this;if(bP(o)!=="Object")throw new _P("receiver is not an Object");var n=yP(o,SP),r=t,i=t;return CP(t)&&(r=vP(n,t),i=TP(n,t)),o.then(r,i)},"finally",!0)});var xg=J((jK,cI)=>{"use strict";var MP=Hd(),wP=gg();cI.exports=function(){return MP(),typeof Promise.prototype.finally=="function"?Promise.prototype.finally:wP}});var mI=J((KK,uI)=>{"use strict";var EP=Hd(),AP=xg(),PP=ng();uI.exports=function(){EP();var t=AP();return PP(Promise.prototype,{finally:t},{finally:function(){return Promise.prototype.finally!==t}}),t}});var gI=J((qK,hI)=>{"use strict";var kP=Bd(),LP=ng(),OP=gg(),dI=xg(),BP=mI(),fI=kP(dI());LP(fI,{getPolyfill:dI,implementation:OP,shim:BP});hI.exports=fI});var _I=J((XK,xI)=>{var DP=qh(),FP=gI();xI.exports=class{constructor(){this._items=new Map}create(t,o,n){return this._rejectExistingRequest(t),this._createNewRequest(t,o,n)}resolve(t,o){t&&this._items.has(t)&&this._items.get(t).resolve(o)}rejectAll(t){this._items.forEach(o=>o.isPending?o.reject(t):null)}_rejectExistingRequest(t){let o=this._items.get(t);o&&o.isPending&&o.reject(new Error(`WebSocket request is replaced, id: ${t}`))}_createNewRequest(t,o,n){let r=new DP({timeout:n,timeoutReason:`WebSocket request was rejected by timeout (${n} ms). RequestId: ${t}`});return this._items.set(t,r),FP(r.call(o),()=>this._deleteRequest(t,r))}_deleteRequest(t,o){this._items.get(t)===o&&this._items.delete(t)}}});var yI=J((YK,CI)=>{CI.exports={createWebSocket:e=>new WebSocket(e),packMessage:null,unpackMessage:null,attachRequestId:null,extractRequestId:null,extractMessageData:e=>e.data,timeout:0,connectionTimeout:0}});var bI=J(_g=>{_g.throwIf=(e,t)=>{if(e)throw new Error(t)};_g.isPromise=e=>e&&typeof e.then=="function"});var TI=J((QK,vI)=>{var ls=Hb(),II=qh(),{PromisedMap:HP}=jb(),NP=_I(),SI=yI(),{throwIf:Wd,isPromise:zP}=bI(),Gd={CONNECTING:0,OPEN:1,CLOSING:2,CLOSED:3},Cg=class{constructor(t,o){this._assertOptions(o),this._url=t,this._options=Object.assign({},SI,o),this._requests=new NP,this._promisedMap=new HP,this._ws=null,this._wsSubscription=null,this._createOpeningController(),this._createClosingController(),this._createChannels()}get ws(){return this._ws}get url(){return this._url}get isOpening(){return!!(this._ws&&this._ws.readyState===Gd.CONNECTING)}get isOpened(){return!!(this._ws&&this._ws.readyState===Gd.OPEN)}get isClosing(){return!!(this._ws&&this._ws.readyState===Gd.CLOSING)}get isClosed(){return!this._ws||this._ws.readyState===Gd.CLOSED}get onOpen(){return this._onOpen}get onSend(){return this._onSend}get onMessage(){return this._onMessage}get onUnpackedMessage(){return this._onUnpackedMessage}get onResponse(){return this._onResponse}get onClose(){return this._onClose}get onError(){return this._onError}open(){return this.isClosing?Promise.reject(new Error("Can't open WebSocket while closing.")):this.isOpened?this._opening.promise:this._opening.call(()=>{this._opening.promise.catch(t=>this._cleanup(t)),this._createWS()})}sendRequest(t,o={}){let n=o.requestId||`${Math.random()}`,r=o.timeout!==void 0?o.timeout:this._options.timeout;return this._requests.create(n,()=>{this._assertRequestIdHandlers();let i=this._options.attachRequestId(t,n);this.sendPacked(i)},r)}sendPacked(t){this._assertPackingHandlers();let o=this._options.packMessage(t);this.send(o)}send(t){Wd(!this.isOpened,"Can't send data because WebSocket is not opened."),this._ws.send(t),this._onSend.dispatchAsync(t)}waitUnpackedMessage(t,o={}){return Wd(typeof t!="function",`Predicate must be a function, got ${typeof t}`),o.timeout&&setTimeout(()=>{if(this._promisedMap.has(t)){let n=o.timeoutError||new Error("Timeout");this._promisedMap.reject(t,n)}},o.timeout),this._promisedMap.set(t)}close(t,o){return this.isClosed?Promise.resolve(this._closing.value):this._closing.call(()=>this._ws.close(t,o))}removeAllListeners(){this._onOpen.removeAllListeners(),this._onMessage.removeAllListeners(),this._onUnpackedMessage.removeAllListeners(),this._onResponse.removeAllListeners(),this._onSend.removeAllListeners(),this._onClose.removeAllListeners(),this._onError.removeAllListeners()}_createOpeningController(){let t=this._options.connectionTimeout||this._options.timeout;this._opening=new II({timeout:t,timeoutReason:`Can't open WebSocket within allowed timeout: ${t} ms.`})}_createClosingController(){let t=this._options.timeout;this._closing=new II({timeout:t,timeoutReason:`Can't close WebSocket within allowed timeout: ${t} ms.`})}_createChannels(){this._onOpen=new ls,this._onMessage=new ls,this._onUnpackedMessage=new ls,this._onResponse=new ls,this._onSend=new ls,this._onClose=new ls,this._onError=new ls}_createWS(){this._ws=this._options.createWebSocket(this._url),this._wsSubscription=new ls.Subscription([{channel:this._ws,event:"open",listener:t=>this._handleOpen(t)},{channel:this._ws,event:"message",listener:t=>this._handleMessage(t)},{channel:this._ws,event:"error",listener:t=>this._handleError(t)},{channel:this._ws,event:"close",listener:t=>this._handleClose(t)}]).on()}_handleOpen(t){this._onOpen.dispatchAsync(t),this._opening.resolve(t)}_handleMessage(t){let o=this._options.extractMessageData(t);this._onMessage.dispatchAsync(o),this._tryUnpack(o)}_tryUnpack(t){this._options.unpackMessage&&(t=this._options.unpackMessage(t),zP(t)?t.then(o=>this._handleUnpackedData(o)):this._handleUnpackedData(t))}_handleUnpackedData(t){t!==void 0&&(this._onUnpackedMessage.dispatchAsync(t),this._tryHandleResponse(t)),this._tryHandleWaitingMessage(t)}_tryHandleResponse(t){if(this._options.extractRequestId){let o=this._options.extractRequestId(t);o&&(this._onResponse.dispatchAsync(t,o),this._requests.resolve(o,t))}}_tryHandleWaitingMessage(t){this._promisedMap.forEach((o,n)=>{let r=!1;try{r=n(t)}catch(i){this._promisedMap.reject(n,i);return}r&&this._promisedMap.resolve(n,t)})}_handleError(t){this._onError.dispatchAsync(t)}_handleClose(t){this._onClose.dispatchAsync(t),this._closing.resolve(t);let o=new Error(`WebSocket closed with reason: ${t.reason||t.message} (${t.code}).`);this._opening.isPending&&this._opening.reject(o),this._cleanup(o)}_cleanupWS(){this._wsSubscription&&(this._wsSubscription.off(),this._wsSubscription=null),this._ws=null}_cleanup(t){this._cleanupWS(),this._requests.rejectAll(t)}_assertOptions(t){Object.keys(t||{}).forEach(o=>{if(!SI.hasOwnProperty(o))throw new Error(`Unknown option: ${o}`)})}_assertPackingHandlers(){let{packMessage:t,unpackMessage:o}=this._options;Wd(!t||!o,"Please define 'options.packMessage / options.unpackMessage' for sending packed messages.")}_assertRequestIdHandlers(){let{attachRequestId:t,extractRequestId:o}=this._options;Wd(!t||!o,"Please define 'options.attachRequestId / options.extractRequestId' for sending requests.")}};vI.exports=Cg});var HI=J($d=>{"use strict";"use client";var KP=bo();Object.defineProperty($d,"__esModule",{value:!0});$d.default=void 0;var qP=KP(So()),$P=Io(),Bq=$d.default=(0,qP.default)((0,$P.jsx)("path",{d:"M12 14c1.66 0 3-1.34 3-3V5c0-1.66-1.34-3-3-3S9 3.34 9 5v6c0 1.66 1.34 3 3 3m-1-9c0-.55.45-1 1-1s1 .45 1 1v6c0 .55-.45 1-1 1s-1-.45-1-1zm6 6c0 2.76-2.24 5-5 5s-5-2.24-5-5H5c0 3.53 2.61 6.43 6 6.92V21h2v-3.08c3.39-.49 6-3.39 6-6.92z"}),"MicNoneOutlined")});var Vc=J(Xd=>{"use strict";"use client";var JP=bo();Object.defineProperty(Xd,"__esModule",{value:!0});Xd.default=void 0;var ek=JP(So()),tk=Io(),t$=Xd.default=(0,ek.default)((0,tk.jsx)("path",{d:"M2.01 21 23 12 2.01 3 2 10l15 2-15 2z"}),"Send")});var Sg=J(Yd=>{"use strict";"use client";var ok=bo();Object.defineProperty(Yd,"__esModule",{value:!0});Yd.default=void 0;var nk=ok(So()),rk=Io(),n$=Yd.default=(0,nk.default)((0,rk.jsx)("path",{d:"M6 6h12v12H6z"}),"Stop")});var KI=J(Qd=>{"use strict";"use client";var ck=bo();Object.defineProperty(Qd,"__esModule",{value:!0});Qd.default=void 0;var uk=ck(So()),mk=Io(),M$=Qd.default=(0,uk.default)((0,mk.jsx)("path",{d:"M11 7h2v2h-2zm0 4h2v6h-2zm1-9C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2m0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8"}),"InfoOutlined")});var Q8=J(Qf=>{"use strict";"use client";var oD=bo();Object.defineProperty(Qf,"__esModule",{value:!0});Qf.default=void 0;var nD=oD(So()),rD=Io(),hfe=Qf.default=(0,nD.default)((0,rD.jsx)("path",{d:"M7.41 15.41 12 10.83l4.59 4.58L18 14l-6-6-6 6z"}),"KeyboardArrowUp")});var m9=J(e1=>{"use strict";"use client";var yD=bo();Object.defineProperty(e1,"__esModule",{value:!0});e1.default=void 0;var bD=yD(So()),ID=Io(),Z1e=e1.default=(0,bD.default)((0,ID.jsx)("path",{d:"m12 8-6 6 1.41 1.41L12 10.83l4.59 4.58L18 14z"}),"ExpandLess")});var b9=J((B0,D0)=>{(function(e,t){typeof define=="function"&&define.amd?define([],t):typeof B0<"u"?t():(t(),e.FileSaver={})})(B0,function(){"use strict";function e(s,l){return typeof l>"u"?l={autoBom:!1}:typeof l!="object"&&(l={autoBom:!l}),l.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(s.type)?new Blob(["\uFEFF",s],{type:s.type}):s}function t(s,l,p){var u=new XMLHttpRequest;u.open("GET",s),u.responseType="blob",u.onload=function(){a(u.response,l,p)},u.onerror=function(){},u.send()}function o(s){var l=new XMLHttpRequest;l.open("HEAD",s,!1);try{l.send()}catch{}return 200<=l.status&&299>=l.status}function n(s){try{s.dispatchEvent(new MouseEvent("click"))}catch{var l=document.createEvent("MouseEvents");l.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),s.dispatchEvent(l)}}var r=typeof window=="object"&&window.window===window?window:typeof self=="object"&&self.self===self?self:typeof global=="object"&&global.global===global?global:void 0,i=r.navigator&&/Macintosh/.test(navigator.userAgent)&&/AppleWebKit/.test(navigator.userAgent)&&!/Safari/.test(navigator.userAgent),a=r.saveAs||(typeof window!="object"||window!==r?function(){}:"download"in HTMLAnchorElement.prototype&&!i?function(s,l,p){var u=r.URL||r.webkitURL,c=document.createElement("a");l=l||s.name||"download",c.download=l,c.rel="noopener",typeof s=="string"?(c.href=s,c.origin===location.origin?n(c):o(c.href)?t(s,l,p):n(c,c.target="_blank")):(c.href=u.createObjectURL(s),setTimeout(function(){u.revokeObjectURL(c.href)},4e4),setTimeout(function(){n(c)},0))}:"msSaveOrOpenBlob"in navigator?function(s,l,p){if(l=l||s.name||"download",typeof s!="string")navigator.msSaveOrOpenBlob(e(s,p),l);else if(o(s))t(s,l,p);else{var u=document.createElement("a");u.href=s,u.target="_blank",setTimeout(function(){n(u)})}}:function(s,l,p,u){if(u=u||open("","_blank"),u&&(u.document.title=u.document.body.innerText="downloading..."),typeof s=="string")return t(s,l,p);var c=s.type==="application/octet-stream",m=/constructor/i.test(r.HTMLElement)||r.safari,d=/CriOS\/[\d]+/.test(navigator.userAgent);if((d||c&&m||i)&&typeof FileReader<"u"){var f=new FileReader;f.onloadend=function(){var g=f.result;g=d?g:g.replace(/^data:[^;]*;/,"data:attachment/file;"),u?u.location.href=g:location=g,u=null},f.readAsDataURL(s)}else{var h=r.URL||r.webkitURL,_=h.createObjectURL(s);u?u.location=_:location.href=_,u=null,setTimeout(function(){h.revokeObjectURL(_)},4e4)}});r.saveAs=a.saveAs=a,typeof D0<"u"&&(D0.exports=a)})});var z0=J(r1=>{"use strict";"use client";var oF=bo();Object.defineProperty(r1,"__esModule",{value:!0});r1.default=void 0;var nF=oF(So()),rF=Io(),k2e=r1.default=(0,nF.default)((0,rF.jsx)("path",{d:"m19 15-6 6-1.42-1.42L15.17 16H4V4h2v10h9.17l-3.59-3.58L13 9z"}),"SubdirectoryArrowRight")});var q9=J(s1=>{"use strict";"use client";var CF=bo();Object.defineProperty(s1,"__esModule",{value:!0});s1.default=void 0;var yF=CF(So()),bF=Io(),B_e=s1.default=(0,yF.default)((0,bF.jsx)("path",{d:"M9.4 16.6 4.8 12l4.6-4.6L8 6l-6 6 6 6zm5.2 0 4.6-4.6-4.6-4.6L16 6l6 6-6 6z"}),"Code")});var p7=J(_1=>{"use strict";"use client";var vH=bo();Object.defineProperty(_1,"__esModule",{value:!0});_1.default=void 0;var TH=vH(So()),MH=Io(),hSe=_1.default=(0,TH.default)((0,MH.jsx)("path",{d:"M19 6H5c-1.1 0-2 .9-2 2v8c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V8c0-1.1-.9-2-2-2m0 10H5V8h14z"}),"Crop32Outlined")});var c7=J(C1=>{"use strict";"use client";var wH=bo();Object.defineProperty(C1,"__esModule",{value:!0});C1.default=void 0;var EH=wH(So()),AH=Io(),xSe=C1.default=(0,EH.default)((0,AH.jsx)("path",{d:"M19 4H5c-1.1 0-2 .9-2 2v12c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2m0 14H5V6h14z"}),"Crop54Outlined")});var u7=J(y1=>{"use strict";"use client";var PH=bo();Object.defineProperty(y1,"__esModule",{value:!0});y1.default=void 0;var kH=PH(So()),LH=Io(),CSe=y1.default=(0,kH.default)((0,LH.jsx)("path",{d:"M19 5H5c-1.1 0-2 .9-2 2v10c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2m0 12H5V7h14z"}),"Crop75Outlined")});var m7=J(b1=>{"use strict";"use client";var OH=bo();Object.defineProperty(b1,"__esModule",{value:!0});b1.default=void 0;var BH=OH(So()),DH=Io(),bSe=b1.default=(0,BH.default)((0,DH.jsx)("path",{d:"M19 7H5c-1.1 0-2 .9-2 2v6c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V9c0-1.1-.9-2-2-2m0 8H5V9h14z"}),"Crop169Outlined")});var d7=J(I1=>{"use strict";"use client";var FH=bo();Object.defineProperty(I1,"__esModule",{value:!0});I1.default=void 0;var HH=FH(So()),NH=Io(),SSe=I1.default=(0,HH.default)((0,NH.jsx)("path",{d:"M18 4H6c-1.1 0-2 .9-2 2v12c0 1.1.9 2 2 2h12c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2m0 14H6V6h12z"}),"CropSquareOutlined")});var ET=J(H1=>{"use strict";"use client";var az=bo();Object.defineProperty(H1,"__esModule",{value:!0});H1.default=void 0;var sz=az(So()),lz=Io(),Cke=H1.default=(0,sz.default)((0,lz.jsx)("path",{fillRule:"evenodd",d:"M16 9V4h1c.55 0 1-.45 1-1s-.45-1-1-1H7c-.55 0-1 .45-1 1s.45 1 1 1h1v5c0 1.66-1.34 3-3 3v2h5.97v7l1 1 1-1v-7H19v-2c-1.66 0-3-1.34-3-3"}),"PushPin")});var AT=J(N1=>{"use strict";"use client";var pz=bo();Object.defineProperty(N1,"__esModule",{value:!0});N1.default=void 0;var cz=pz(So()),uz=Io(),bke=N1.default=(0,cz.default)((0,uz.jsx)("path",{d:"M14 4v5c0 1.12.37 2.16 1 3H9c.65-.86 1-1.9 1-3V4zm3-2H7c-.55 0-1 .45-1 1s.45 1 1 1h1v5c0 1.66-1.34 3-3 3v2h5.97v7l1 1 1-1v-7H19v-2c-1.66 0-3-1.34-3-3V4h1c.55 0 1-.45 1-1s-.45-1-1-1"}),"PushPinOutlined")});var OT=J(V1=>{"use strict";"use client";var dz=bo();Object.defineProperty(V1,"__esModule",{value:!0});V1.default=void 0;var fz=dz(So()),hz=Io(),Ake=V1.default=(0,fz.default)((0,hz.jsx)("path",{d:"M15.61 7.41 14.2 6l-6 6 6 6 1.41-1.41L11.03 12z"}),"NavigateBeforeOutlined")});var BT=J(R1=>{"use strict";"use client";var gz=bo();Object.defineProperty(R1,"__esModule",{value:!0});R1.default=void 0;var xz=gz(So()),_z=Io(),kke=R1.default=(0,xz.default)((0,_z.jsx)("path",{d:"M10.02 6 8.61 7.41 13.19 12l-4.58 4.59L10.02 18l6-6z"}),"NavigateNextOutlined")});var wM=J((Ou,X1)=>{(function(e,t){"use strict";var o="1.0.38",n="",r="?",i="function",a="undefined",s="object",l="string",p="major",u="model",c="name",m="type",d="vendor",f="version",h="architecture",_="console",g="mobile",y="tablet",C="smarttv",b="wearable",v="embedded",S=500,P="Amazon",k="Apple",L="ASUS",H="BlackBerry",W="Browser",O="Chrome",D="Edge",V="Firefox",N="Google",z="Huawei",j="LG",G="Microsoft",q="Motorola",A="Opera",Y="Samsung",Q="Sharp",M="Sony",K="Xiaomi",F="Zebra",pe="Facebook",ae="Chromium OS",te="Mac OS",Te=function($,fe){var ie={};for(var R in $)fe[R]&&fe[R].length%2===0?ie[R]=fe[R].concat($[R]):ie[R]=$[R];return ie},Ie=function($){for(var fe={},ie=0;ie<$.length;ie++)fe[$[ie].toUpperCase()]=$[ie];return fe},Nt=function($,fe){return typeof $===l?lt(fe).indexOf(lt($))!==-1:!1},lt=function($){return $.toLowerCase()},Le=function($){return typeof $===l?$.replace(/[^\d\.]/g,n).split(".")[0]:t},nt=function($,fe){if(typeof $===l)return $=$.replace(/^\s\s*/,n),typeof fe===a?$:$.substring(0,S)},At=function($,fe){for(var ie=0,R,Z,de,se,oe,Rt;ie<fe.length&&!oe;){var ue=fe[ie],X=fe[ie+1];for(R=Z=0;R<ue.length&&!oe&&ue[R];)if(oe=ue[R++].exec($),oe)for(de=0;de<X.length;de++)Rt=oe[++Z],se=X[de],typeof se===s&&se.length>0?se.length===2?typeof se[1]==i?this[se[0]]=se[1].call(this,Rt):this[se[0]]=se[1]:se.length===3?typeof se[1]===i&&!(se[1].exec&&se[1].test)?this[se[0]]=Rt?se[1].call(this,Rt,se[2]):t:this[se[0]]=Rt?Rt.replace(se[1],se[2]):t:se.length===4&&(this[se[0]]=Rt?se[3].call(this,Rt.replace(se[1],se[2])):t):this[se]=Rt||t;ie+=2}},Ze=function($,fe){for(var ie in fe)if(typeof fe[ie]===s&&fe[ie].length>0){for(var R=0;R<fe[ie].length;R++)if(Nt(fe[ie][R],$))return ie===r?t:ie}else if(Nt(fe[ie],$))return ie===r?t:ie;return $},dt={"1.0":"/8","1.2":"/1","1.3":"/3","2.0":"/412","2.0.2":"/416","2.0.3":"/417","2.0.4":"/419","?":"/"},It={ME:"4.90","NT 3.11":"NT3.51","NT 4.0":"NT4.0",2e3:"NT 5.0",XP:["NT 5.1","NT 5.2"],Vista:"NT 6.0",7:"NT 6.1",8:"NT 6.2","8.1":"NT 6.3",10:["NT 6.4","NT 10.0"],RT:"ARM"},Zt={browser:[[/\b(?:crmo|crios)\/([\w\.]+)/i],[f,[c,"Chrome"]],[/edg(?:e|ios|a)?\/([\w\.]+)/i],[f,[c,"Edge"]],[/(opera mini)\/([-\w\.]+)/i,/(opera [mobiletab]{3,6})\b.+version\/([-\w\.]+)/i,/(opera)(?:.+version\/|[\/ ]+)([\w\.]+)/i],[c,f],[/opios[\/ ]+([\w\.]+)/i],[f,[c,A+" Mini"]],[/\bop(?:rg)?x\/([\w\.]+)/i],[f,[c,A+" GX"]],[/\bopr\/([\w\.]+)/i],[f,[c,A]],[/\bb[ai]*d(?:uhd|[ub]*[aekoprswx]{5,6})[\/ ]?([\w\.]+)/i],[f,[c,"Baidu"]],[/(kindle)\/([\w\.]+)/i,/(lunascape|maxthon|netfront|jasmine|blazer)[\/ ]?([\w\.]*)/i,/(avant|iemobile|slim)\s?(?:browser)?[\/ ]?([\w\.]*)/i,/(?:ms|\()(ie) ([\w\.]+)/i,/(flock|rockmelt|midori|epiphany|silk|skyfire|bolt|iron|vivaldi|iridium|phantomjs|bowser|quark|qupzilla|falkon|rekonq|puffin|brave|whale(?!.+naver)|qqbrowserlite|qq|duckduckgo)\/([-\w\.]+)/i,/(heytap|ovi)browser\/([\d\.]+)/i,/(weibo)__([\d\.]+)/i],[c,f],[/\bddg\/([\w\.]+)/i],[f,[c,"DuckDuckGo"]],[/(?:\buc? ?browser|(?:juc.+)ucweb)[\/ ]?([\w\.]+)/i],[f,[c,"UC"+W]],[/microm.+\bqbcore\/([\w\.]+)/i,/\bqbcore\/([\w\.]+).+microm/i,/micromessenger\/([\w\.]+)/i],[f,[c,"WeChat"]],[/konqueror\/([\w\.]+)/i],[f,[c,"Konqueror"]],[/trident.+rv[: ]([\w\.]{1,9})\b.+like gecko/i],[f,[c,"IE"]],[/ya(?:search)?browser\/([\w\.]+)/i],[f,[c,"Yandex"]],[/slbrowser\/([\w\.]+)/i],[f,[c,"Smart Lenovo "+W]],[/(avast|avg)\/([\w\.]+)/i],[[c,/(.+)/,"$1 Secure "+W],f],[/\bfocus\/([\w\.]+)/i],[f,[c,V+" Focus"]],[/\bopt\/([\w\.]+)/i],[f,[c,A+" Touch"]],[/coc_coc\w+\/([\w\.]+)/i],[f,[c,"Coc Coc"]],[/dolfin\/([\w\.]+)/i],[f,[c,"Dolphin"]],[/coast\/([\w\.]+)/i],[f,[c,A+" Coast"]],[/miuibrowser\/([\w\.]+)/i],[f,[c,"MIUI "+W]],[/fxios\/([-\w\.]+)/i],[f,[c,V]],[/\bqihu|(qi?ho?o?|360)browser/i],[[c,"360 "+W]],[/(oculus|sailfish|huawei|vivo)browser\/([\w\.]+)/i],[[c,/(.+)/,"$1 "+W],f],[/samsungbrowser\/([\w\.]+)/i],[f,[c,Y+" Internet"]],[/(comodo_dragon)\/([\w\.]+)/i],[[c,/_/g," "],f],[/metasr[\/ ]?([\d\.]+)/i],[f,[c,"Sogou Explorer"]],[/(sogou)mo\w+\/([\d\.]+)/i],[[c,"Sogou Mobile"],f],[/(electron)\/([\w\.]+) safari/i,/(tesla)(?: qtcarbrowser|\/(20\d\d\.[-\w\.]+))/i,/m?(qqbrowser|2345Explorer)[\/ ]?([\w\.]+)/i],[c,f],[/(lbbrowser)/i,/\[(linkedin)app\]/i],[c],[/((?:fban\/fbios|fb_iab\/fb4a)(?!.+fbav)|;fbav\/([\w\.]+);)/i],[[c,pe],f],[/(Klarna)\/([\w\.]+)/i,/(kakao(?:talk|story))[\/ ]([\w\.]+)/i,/(naver)\(.*?(\d+\.[\w\.]+).*\)/i,/safari (line)\/([\w\.]+)/i,/\b(line)\/([\w\.]+)\/iab/i,/(alipay)client\/([\w\.]+)/i,/(twitter)(?:and| f.+e\/([\w\.]+))/i,/(chromium|instagram|snapchat)[\/ ]([-\w\.]+)/i],[c,f],[/\bgsa\/([\w\.]+) .*safari\//i],[f,[c,"GSA"]],[/musical_ly(?:.+app_?version\/|_)([\w\.]+)/i],[f,[c,"TikTok"]],[/headlesschrome(?:\/([\w\.]+)| )/i],[f,[c,O+" Headless"]],[/ wv\).+(chrome)\/([\w\.]+)/i],[[c,O+" WebView"],f],[/droid.+ version\/([\w\.]+)\b.+(?:mobile safari|safari)/i],[f,[c,"Android "+W]],[/(chrome|omniweb|arora|[tizenoka]{5} ?browser)\/v?([\w\.]+)/i],[c,f],[/version\/([\w\.\,]+) .*mobile\/\w+ (safari)/i],[f,[c,"Mobile Safari"]],[/version\/([\w(\.|\,)]+) .*(mobile ?safari|safari)/i],[f,c],[/webkit.+?(mobile ?safari|safari)(\/[\w\.]+)/i],[c,[f,Ze,dt]],[/(webkit|khtml)\/([\w\.]+)/i],[c,f],[/(navigator|netscape\d?)\/([-\w\.]+)/i],[[c,"Netscape"],f],[/mobile vr; rv:([\w\.]+)\).+firefox/i],[f,[c,V+" Reality"]],[/ekiohf.+(flow)\/([\w\.]+)/i,/(swiftfox)/i,/(icedragon|iceweasel|camino|chimera|fennec|maemo browser|minimo|conkeror|klar)[\/ ]?([\w\.\+]+)/i,/(seamonkey|k-meleon|icecat|iceape|firebird|phoenix|palemoon|basilisk|waterfox)\/([-\w\.]+)$/i,/(firefox)\/([\w\.]+)/i,/(mozilla)\/([\w\.]+) .+rv\:.+gecko\/\d+/i,/(polaris|lynx|dillo|icab|doris|amaya|w3m|netsurf|sleipnir|obigo|mosaic|(?:go|ice|up)[\. ]?browser)[-\/ ]?v?([\w\.]+)/i,/(links) \(([\w\.]+)/i,/panasonic;(viera)/i],[c,f],[/(cobalt)\/([\w\.]+)/i],[c,[f,/master.|lts./,""]]],cpu:[[/(?:(amd|x(?:(?:86|64)[-_])?|wow|win)64)[;\)]/i],[[h,"amd64"]],[/(ia32(?=;))/i],[[h,lt]],[/((?:i[346]|x)86)[;\)]/i],[[h,"ia32"]],[/\b(aarch64|arm(v?8e?l?|_?64))\b/i],[[h,"arm64"]],[/\b(arm(?:v[67])?ht?n?[fl]p?)\b/i],[[h,"armhf"]],[/windows (ce|mobile); ppc;/i],[[h,"arm"]],[/((?:ppc|powerpc)(?:64)?)(?: mac|;|\))/i],[[h,/ower/,n,lt]],[/(sun4\w)[;\)]/i],[[h,"sparc"]],[/((?:avr32|ia64(?=;))|68k(?=\))|\barm(?=v(?:[1-7]|[5-7]1)l?|;|eabi)|(?=atmel )avr|(?:irix|mips|sparc)(?:64)?\b|pa-risc)/i],[[h,lt]]],device:[[/\b(sch-i[89]0\d|shw-m380s|sm-[ptx]\w{2,4}|gt-[pn]\d{2,4}|sgh-t8[56]9|nexus 10)/i],[u,[d,Y],[m,y]],[/\b((?:s[cgp]h|gt|sm)-\w+|sc[g-]?[\d]+a?|galaxy nexus)/i,/samsung[- ]([-\w]+)/i,/sec-(sgh\w+)/i],[u,[d,Y],[m,g]],[/(?:\/|\()(ip(?:hone|od)[\w, ]*)(?:\/|;)/i],[u,[d,k],[m,g]],[/\((ipad);[-\w\),; ]+apple/i,/applecoremedia\/[\w\.]+ \((ipad)/i,/\b(ipad)\d\d?,\d\d?[;\]].+ios/i],[u,[d,k],[m,y]],[/(macintosh);/i],[u,[d,k]],[/\b(sh-?[altvz]?\d\d[a-ekm]?)/i],[u,[d,Q],[m,g]],[/\b((?:ag[rs][23]?|bah2?|sht?|btv)-a?[lw]\d{2})\b(?!.+d\/s)/i],[u,[d,z],[m,y]],[/(?:huawei|honor)([-\w ]+)[;\)]/i,/\b(nexus 6p|\w{2,4}e?-[atu]?[ln][\dx][012359c][adn]?)\b(?!.+d\/s)/i],[u,[d,z],[m,g]],[/\b(poco[\w ]+|m2\d{3}j\d\d[a-z]{2})(?: bui|\))/i,/\b; (\w+) build\/hm\1/i,/\b(hm[-_ ]?note?[_ ]?(?:\d\w)?) bui/i,/\b(redmi[\-_ ]?(?:note|k)?[\w_ ]+)(?: bui|\))/i,/oid[^\)]+; (m?[12][0-389][01]\w{3,6}[c-y])( bui|; wv|\))/i,/\b(mi[-_ ]?(?:a\d|one|one[_ ]plus|note lte|max|cc)?[_ ]?(?:\d?\w?)[_ ]?(?:plus|se|lite)?)(?: bui|\))/i],[[u,/_/g," "],[d,K],[m,g]],[/oid[^\)]+; (2\d{4}(283|rpbf)[cgl])( bui|\))/i,/\b(mi[-_ ]?(?:pad)(?:[\w_ ]+))(?: bui|\))/i],[[u,/_/g," "],[d,K],[m,y]],[/; (\w+) bui.+ oppo/i,/\b(cph[12]\d{3}|p(?:af|c[al]|d\w|e[ar])[mt]\d0|x9007|a101op)\b/i],[u,[d,"OPPO"],[m,g]],[/\b(opd2\d{3}a?) bui/i],[u,[d,"OPPO"],[m,y]],[/vivo (\w+)(?: bui|\))/i,/\b(v[12]\d{3}\w?[at])(?: bui|;)/i],[u,[d,"Vivo"],[m,g]],[/\b(rmx[1-3]\d{3})(?: bui|;|\))/i],[u,[d,"Realme"],[m,g]],[/\b(milestone|droid(?:[2-4x]| (?:bionic|x2|pro|razr))?:?( 4g)?)\b[\w ]+build\//i,/\bmot(?:orola)?[- ](\w*)/i,/((?:moto[\w\(\) ]+|xt\d{3,4}|nexus 6)(?= bui|\)))/i],[u,[d,q],[m,g]],[/\b(mz60\d|xoom[2 ]{0,2}) build\//i],[u,[d,q],[m,y]],[/((?=lg)?[vl]k\-?\d{3}) bui| 3\.[-\w; ]{10}lg?-([06cv9]{3,4})/i],[u,[d,j],[m,y]],[/(lm(?:-?f100[nv]?|-[\w\.]+)(?= bui|\))|nexus [45])/i,/\blg[-e;\/ ]+((?!browser|netcast|android tv)\w+)/i,/\blg-?([\d\w]+) bui/i],[u,[d,j],[m,g]],[/(ideatab[-\w ]+)/i,/lenovo ?(s[56]000[-\w]+|tab(?:[\w ]+)|yt[-\d\w]{6}|tb[-\d\w]{6})/i],[u,[d,"Lenovo"],[m,y]],[/(?:maemo|nokia).*(n900|lumia \d+)/i,/nokia[-_ ]?([-\w\.]*)/i],[[u,/_/g," "],[d,"Nokia"],[m,g]],[/(pixel c)\b/i],[u,[d,N],[m,y]],[/droid.+; (pixel[\daxl ]{0,6})(?: bui|\))/i],[u,[d,N],[m,g]],[/droid.+ (a?\d[0-2]{2}so|[c-g]\d{4}|so[-gl]\w+|xq-a\w[4-7][12])(?= bui|\).+chrome\/(?![1-6]{0,1}\d\.))/i],[u,[d,M],[m,g]],[/sony tablet [ps]/i,/\b(?:sony)?sgp\w+(?: bui|\))/i],[[u,"Xperia Tablet"],[d,M],[m,y]],[/ (kb2005|in20[12]5|be20[12][59])\b/i,/(?:one)?(?:plus)? (a\d0\d\d)(?: b|\))/i],[u,[d,"OnePlus"],[m,g]],[/(alexa)webm/i,/(kf[a-z]{2}wi|aeo[c-r]{2})( bui|\))/i,/(kf[a-z]+)( bui|\)).+silk\//i],[u,[d,P],[m,y]],[/((?:sd|kf)[0349hijorstuw]+)( bui|\)).+silk\//i],[[u,/(.+)/g,"Fire Phone $1"],[d,P],[m,g]],[/(playbook);[-\w\),; ]+(rim)/i],[u,d,[m,y]],[/\b((?:bb[a-f]|st[hv])100-\d)/i,/\(bb10; (\w+)/i],[u,[d,H],[m,g]],[/(?:\b|asus_)(transfo[prime ]{4,10} \w+|eeepc|slider \w+|nexus 7|padfone|p00[cj])/i],[u,[d,L],[m,y]],[/ (z[bes]6[027][012][km][ls]|zenfone \d\w?)\b/i],[u,[d,L],[m,g]],[/(nexus 9)/i],[u,[d,"HTC"],[m,y]],[/(htc)[-;_ ]{1,2}([\w ]+(?=\)| bui)|\w+)/i,/(zte)[- ]([\w ]+?)(?: bui|\/|\))/i,/(alcatel|geeksphone|nexian|panasonic(?!(?:;|\.))|sony(?!-bra))[-_ ]?([-\w]*)/i],[d,[u,/_/g," "],[m,g]],[/droid.+; ([ab][1-7]-?[0178a]\d\d?)/i],[u,[d,"Acer"],[m,y]],[/droid.+; (m[1-5] note) bui/i,/\bmz-([-\w]{2,})/i],[u,[d,"Meizu"],[m,g]],[/; ((?:power )?armor(?:[\w ]{0,8}))(?: bui|\))/i],[u,[d,"Ulefone"],[m,g]],[/(blackberry|benq|palm(?=\-)|sonyericsson|acer|asus|dell|meizu|motorola|polytron|infinix|tecno)[-_ ]?([-\w]*)/i,/(hp) ([\w ]+\w)/i,/(asus)-?(\w+)/i,/(microsoft); (lumia[\w ]+)/i,/(lenovo)[-_ ]?([-\w]+)/i,/(jolla)/i,/(oppo) ?([\w ]+) bui/i],[d,u,[m,g]],[/(kobo)\s(ereader|touch)/i,/(archos) (gamepad2?)/i,/(hp).+(touchpad(?!.+tablet)|tablet)/i,/(kindle)\/([\w\.]+)/i,/(nook)[\w ]+build\/(\w+)/i,/(dell) (strea[kpr\d ]*[\dko])/i,/(le[- ]+pan)[- ]+(\w{1,9}) bui/i,/(trinity)[- ]*(t\d{3}) bui/i,/(gigaset)[- ]+(q\w{1,9}) bui/i,/(vodafone) ([\w ]+)(?:\)| bui)/i],[d,u,[m,y]],[/(surface duo)/i],[u,[d,G],[m,y]],[/droid [\d\.]+; (fp\du?)(?: b|\))/i],[u,[d,"Fairphone"],[m,g]],[/(u304aa)/i],[u,[d,"AT&T"],[m,g]],[/\bsie-(\w*)/i],[u,[d,"Siemens"],[m,g]],[/\b(rct\w+) b/i],[u,[d,"RCA"],[m,y]],[/\b(venue[\d ]{2,7}) b/i],[u,[d,"Dell"],[m,y]],[/\b(q(?:mv|ta)\w+) b/i],[u,[d,"Verizon"],[m,y]],[/\b(?:barnes[& ]+noble |bn[rt])([\w\+ ]*) b/i],[u,[d,"Barnes & Noble"],[m,y]],[/\b(tm\d{3}\w+) b/i],[u,[d,"NuVision"],[m,y]],[/\b(k88) b/i],[u,[d,"ZTE"],[m,y]],[/\b(nx\d{3}j) b/i],[u,[d,"ZTE"],[m,g]],[/\b(gen\d{3}) b.+49h/i],[u,[d,"Swiss"],[m,g]],[/\b(zur\d{3}) b/i],[u,[d,"Swiss"],[m,y]],[/\b((zeki)?tb.*\b) b/i],[u,[d,"Zeki"],[m,y]],[/\b([yr]\d{2}) b/i,/\b(dragon[- ]+touch |dt)(\w{5}) b/i],[[d,"Dragon Touch"],u,[m,y]],[/\b(ns-?\w{0,9}) b/i],[u,[d,"Insignia"],[m,y]],[/\b((nxa|next)-?\w{0,9}) b/i],[u,[d,"NextBook"],[m,y]],[/\b(xtreme\_)?(v(1[045]|2[015]|[3469]0|7[05])) b/i],[[d,"Voice"],u,[m,g]],[/\b(lvtel\-)?(v1[12]) b/i],[[d,"LvTel"],u,[m,g]],[/\b(ph-1) /i],[u,[d,"Essential"],[m,g]],[/\b(v(100md|700na|7011|917g).*\b) b/i],[u,[d,"Envizen"],[m,y]],[/\b(trio[-\w\. ]+) b/i],[u,[d,"MachSpeed"],[m,y]],[/\btu_(1491) b/i],[u,[d,"Rotor"],[m,y]],[/(shield[\w ]+) b/i],[u,[d,"Nvidia"],[m,y]],[/(sprint) (\w+)/i],[d,u,[m,g]],[/(kin\.[onetw]{3})/i],[[u,/\./g," "],[d,G],[m,g]],[/droid.+; (cc6666?|et5[16]|mc[239][23]x?|vc8[03]x?)\)/i],[u,[d,F],[m,y]],[/droid.+; (ec30|ps20|tc[2-8]\d[kx])\)/i],[u,[d,F],[m,g]],[/smart-tv.+(samsung)/i],[d,[m,C]],[/hbbtv.+maple;(\d+)/i],[[u,/^/,"SmartTV"],[d,Y],[m,C]],[/(nux; netcast.+smarttv|lg (netcast\.tv-201\d|android tv))/i],[[d,j],[m,C]],[/(apple) ?tv/i],[d,[u,k+" TV"],[m,C]],[/crkey/i],[[u,O+"cast"],[d,N],[m,C]],[/droid.+aft(\w+)( bui|\))/i],[u,[d,P],[m,C]],[/\(dtv[\);].+(aquos)/i,/(aquos-tv[\w ]+)\)/i],[u,[d,Q],[m,C]],[/(bravia[\w ]+)( bui|\))/i],[u,[d,M],[m,C]],[/(mitv-\w{5}) bui/i],[u,[d,K],[m,C]],[/Hbbtv.*(technisat) (.*);/i],[d,u,[m,C]],[/\b(roku)[\dx]*[\)\/]((?:dvp-)?[\d\.]*)/i,/hbbtv\/\d+\.\d+\.\d+ +\([\w\+ ]*; *([\w\d][^;]*);([^;]*)/i],[[d,nt],[u,nt],[m,C]],[/\b(android tv|smart[- ]?tv|opera tv|tv; rv:)\b/i],[[m,C]],[/(ouya)/i,/(nintendo) ([wids3utch]+)/i],[d,u,[m,_]],[/droid.+; (shield) bui/i],[u,[d,"Nvidia"],[m,_]],[/(playstation [345portablevi]+)/i],[u,[d,M],[m,_]],[/\b(xbox(?: one)?(?!; xbox))[\); ]/i],[u,[d,G],[m,_]],[/((pebble))app/i],[d,u,[m,b]],[/(watch)(?: ?os[,\/]|\d,\d\/)[\d\.]+/i],[u,[d,k],[m,b]],[/droid.+; (glass) \d/i],[u,[d,N],[m,b]],[/droid.+; (wt63?0{2,3})\)/i],[u,[d,F],[m,b]],[/(quest( \d| pro)?)/i],[u,[d,pe],[m,b]],[/(tesla)(?: qtcarbrowser|\/[-\w\.]+)/i],[d,[m,v]],[/(aeobc)\b/i],[u,[d,P],[m,v]],[/droid .+?; ([^;]+?)(?: bui|; wv\)|\) applew).+? mobile safari/i],[u,[m,g]],[/droid .+?; ([^;]+?)(?: bui|\) applew).+?(?! mobile) safari/i],[u,[m,y]],[/\b((tablet|tab)[;\/]|focus\/\d(?!.+mobile))/i],[[m,y]],[/(phone|mobile(?:[;\/]| [ \w\/\.]*safari)|pda(?=.+windows ce))/i],[[m,g]],[/(android[-\w\. ]{0,9});.+buil/i],[u,[d,"Generic"]]],engine:[[/windows.+ edge\/([\w\.]+)/i],[f,[c,D+"HTML"]],[/webkit\/537\.36.+chrome\/(?!27)([\w\.]+)/i],[f,[c,"Blink"]],[/(presto)\/([\w\.]+)/i,/(webkit|trident|netfront|netsurf|amaya|lynx|w3m|goanna)\/([\w\.]+)/i,/ekioh(flow)\/([\w\.]+)/i,/(khtml|tasman|links)[\/ ]\(?([\w\.]+)/i,/(icab)[\/ ]([23]\.[\d\.]+)/i,/\b(libweb)/i],[c,f],[/rv\:([\w\.]{1,9})\b.+(gecko)/i],[f,c]],os:[[/microsoft (windows) (vista|xp)/i],[c,f],[/(windows (?:phone(?: os)?|mobile))[\/ ]?([\d\.\w ]*)/i],[c,[f,Ze,It]],[/windows nt 6\.2; (arm)/i,/windows[\/ ]?([ntce\d\. ]+\w)(?!.+xbox)/i,/(?:win(?=3|9|n)|win 9x )([nt\d\.]+)/i],[[f,Ze,It],[c,"Windows"]],[/ip[honead]{2,4}\b(?:.*os ([\w]+) like mac|; opera)/i,/(?:ios;fbsv\/|iphone.+ios[\/ ])([\d\.]+)/i,/cfnetwork\/.+darwin/i],[[f,/_/g,"."],[c,"iOS"]],[/(mac os x) ?([\w\. ]*)/i,/(macintosh|mac_powerpc\b)(?!.+haiku)/i],[[c,te],[f,/_/g,"."]],[/droid ([\w\.]+)\b.+(android[- ]x86|harmonyos)/i],[f,c],[/(android|webos|qnx|bada|rim tablet os|maemo|meego|sailfish)[-\/ ]?([\w\.]*)/i,/(blackberry)\w*\/([\w\.]*)/i,/(tizen|kaios)[\/ ]([\w\.]+)/i,/\((series40);/i],[c,f],[/\(bb(10);/i],[f,[c,H]],[/(?:symbian ?os|symbos|s60(?=;)|series60)[-\/ ]?([\w\.]*)/i],[f,[c,"Symbian"]],[/mozilla\/[\d\.]+ \((?:mobile|tablet|tv|mobile; [\w ]+); rv:.+ gecko\/([\w\.]+)/i],[f,[c,V+" OS"]],[/web0s;.+rt(tv)/i,/\b(?:hp)?wos(?:browser)?\/([\w\.]+)/i],[f,[c,"webOS"]],[/watch(?: ?os[,\/]|\d,\d\/)([\d\.]+)/i],[f,[c,"watchOS"]],[/crkey\/([\d\.]+)/i],[f,[c,O+"cast"]],[/(cros) [\w]+(?:\)| ([\w\.]+)\b)/i],[[c,ae],f],[/panasonic;(viera)/i,/(netrange)mmh/i,/(nettv)\/(\d+\.[\w\.]+)/i,/(nintendo|playstation) ([wids345portablevuch]+)/i,/(xbox); +xbox ([^\);]+)/i,/\b(joli|palm)\b ?(?:os)?\/?([\w\.]*)/i,/(mint)[\/\(\) ]?(\w*)/i,/(mageia|vectorlinux)[; ]/i,/([kxln]?ubuntu|debian|suse|opensuse|gentoo|arch(?= linux)|slackware|fedora|mandriva|centos|pclinuxos|red ?hat|zenwalk|linpus|raspbian|plan 9|minix|risc os|contiki|deepin|manjaro|elementary os|sabayon|linspire)(?: gnu\/linux)?(?: enterprise)?(?:[- ]linux)?(?:-gnu)?[-\/ ]?(?!chrom|package)([-\w\.]*)/i,/(hurd|linux) ?([\w\.]*)/i,/(gnu) ?([\w\.]*)/i,/\b([-frentopcghs]{0,5}bsd|dragonfly)[\/ ]?(?!amd|[ix346]{1,2}86)([\w\.]*)/i,/(haiku) (\w+)/i],[c,f],[/(sunos) ?([\w\.\d]*)/i],[[c,"Solaris"],f],[/((?:open)?solaris)[-\/ ]?([\w\.]*)/i,/(aix) ((\d)(?=\.|\)| )[\w\.])*/i,/\b(beos|os\/2|amigaos|morphos|openvms|fuchsia|hp-ux|serenityos)/i,/(unix) ?([\w\.]*)/i],[c,f]]},pt=function($,fe){if(typeof $===s&&(fe=$,$=t),!(this instanceof pt))return new pt($,fe).getResult();var ie=typeof e!==a&&e.navigator?e.navigator:t,R=$||(ie&&ie.userAgent?ie.userAgent:n),Z=ie&&ie.userAgentData?ie.userAgentData:t,de=fe?Te(Zt,fe):Zt,se=ie&&ie.userAgent==R;return this.getBrowser=function(){var oe={};return oe[c]=t,oe[f]=t,At.call(oe,R,de.browser),oe[p]=Le(oe[f]),se&&ie&&ie.brave&&typeof ie.brave.isBrave==i&&(oe[c]="Brave"),oe},this.getCPU=function(){var oe={};return oe[h]=t,At.call(oe,R,de.cpu),oe},this.getDevice=function(){var oe={};return oe[d]=t,oe[u]=t,oe[m]=t,At.call(oe,R,de.device),se&&!oe[m]&&Z&&Z.mobile&&(oe[m]=g),se&&oe[u]=="Macintosh"&&ie&&typeof ie.standalone!==a&&ie.maxTouchPoints&&ie.maxTouchPoints>2&&(oe[u]="iPad",oe[m]=y),oe},this.getEngine=function(){var oe={};return oe[c]=t,oe[f]=t,At.call(oe,R,de.engine),oe},this.getOS=function(){var oe={};return oe[c]=t,oe[f]=t,At.call(oe,R,de.os),se&&!oe[c]&&Z&&Z.platform&&Z.platform!="Unknown"&&(oe[c]=Z.platform.replace(/chrome os/i,ae).replace(/macos/i,te)),oe},this.getResult=function(){return{ua:this.getUA(),browser:this.getBrowser(),engine:this.getEngine(),os:this.getOS(),device:this.getDevice(),cpu:this.getCPU()}},this.getUA=function(){return R},this.setUA=function(oe){return R=typeof oe===l&&oe.length>S?nt(oe,S):oe,this},this.setUA(R),this};pt.VERSION=o,pt.BROWSER=Ie([c,f,p]),pt.CPU=Ie([h]),pt.DEVICE=Ie([u,d,m,_,g,C,y,b,v]),pt.ENGINE=pt.OS=Ie([c,f]),typeof Ou!==a?(typeof X1!==a&&X1.exports&&(Ou=X1.exports=pt),Ou.UAParser=pt):typeof define===i&&define.amd?define(function(){return pt}):typeof e!==a&&(e.UAParser=pt);var Lo=typeof e!==a&&(e.jQuery||e.Zepto);if(Lo&&!Lo.ua){var St=new pt;Lo.ua=St.getResult(),Lo.ua.get=function(){return St.getUA()},Lo.ua.set=function($){St.setUA($);var fe=St.getResult();for(var ie in fe)Lo.ua[ie]=fe[ie]}}})(typeof window=="object"?window:Ou)});var pd=I(w()),P6=()=>{let e=(0,pd.useRef)(null);return(0,pd.useEffect)(()=>{let t=async o=>{e.current?.onMouseUp(o)};return window.addEventListener("contextmenu",t),()=>{window.removeEventListener("contextmenu",t)}},[]),e};var kn=I(w()),k6=(0,kn.forwardRef)(e=>{let{title:t,showConfirmButton:o=!0,showCancelButton:n=!0,confirmButtonText:r,cancelButtonText:i,onConfirm:a,onCancel:s,onClose:l,confirmButtonDisabled:p,cancelButtonDisabled:u,PaperProps:c,children:m,ConfirmButtonProps:d,CancelButtonProps:f,hideCloseButton:h=!1,loading:_,actionRef:g,...y}=e,[C,b]=(0,kn.useState)(!1),{t:v}=E(),S=async()=>{if(a){b(!0);try{if(!await a())return}catch{}finally{b(!1)}}l?.({},"confirm")},P=async()=>{if(s){b(!0);try{if(!await s())return}catch{}finally{b(!1)}}l?.({},"backdropClick")};return(0,kn.useImperativeHandle)(g,()=>({submit:S,cancel:P})),kn.default.createElement(Ti,{onClose:l,...y,disableScrollLock:!0},kn.default.createElement(B,{sx:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",outline:"none"}},kn.default.createElement(vn,{...c,sx:{overflowY:"auto",maxHeight:"calc(100vh - 32px)",position:"relative",borderRadius:"16px",maxWidth:"768px!important",width:"calc(100vw - 32px)",margin:"0 auto",p:"24px",display:"flex",flexDirection:"column",gap:"24px",boxSizing:"border-box",bgcolor:k=>k.palette.mode==="dark"?"#2C2C2C":"#FFFFFF",...c?.sx}},!h&&kn.default.createElement(ne,{sx:{padding:"8px",width:"36px",height:"36px",position:"absolute",top:"18px",right:"18px"},onClick:()=>{s?.(),l?.({},"backdropClick")}},kn.default.createElement(U,{sx:{fontSize:"20px!important"},icon:"Close"})),t&&kn.default.createElement(T,{sx:{fontSize:"20px",lineHeight:"1.2",textAlign:"left",fontWeight:500}},t),m,o||n?kn.default.createElement(x,{sx:{flexDirection:"row",justifyContent:"flex-end",gap:"8px",width:"100%"}},n&&kn.default.createElement(si,{variant:"outlined",onClick:P,disabled:u||C||_,...f,sx:{borderRadius:"9999px",height:"44px",borderColor:k=>k.palette.mode==="dark"?"rgba(255, 255, 255, 0.12)":"rgba(0, 0, 0, 0.12)",...f?.sx}},i||v("package__features:context_menu__lite_editor__modal__common__cancel")),o&&kn.default.createElement(si,{loading:C||_,variant:"contained",onClick:S,disabled:p,...d,sx:{borderRadius:"9999px",height:"44px",...d?.sx}},r||v("package__features:context_menu__lite_editor__modal__common__confirm"))):null)))});k6.displayName="LiteModal";var ns=k6;var L6=I(w()),fw=({open:e,title:t,description:o,confirmButtonText:n,onClose:r,onConfirm:i})=>{let{openConfirm:a}=j_();return(0,L6.useEffect)(()=>{e&&a({title:t,content:o,confirmButtonText:n,confirmDangerColor:!0,contentSx:{lineHeight:"1.4",fontSize:"14px",textAlign:"left",fontWeight:400,color:s=>s.palette.mode==="dark"?"rgba(255, 255, 255, 0.7)":"rgba(0, 0, 0, 0.6)"},onConfirm:async s=>(s&&await i(),!0),onClose:r})},[n,o,r,i,e,a,t]),null},rs=fw;var O6=I(w()),hw=()=>{let{t:e}=E(),{groupData:t,isOpenDeleteGroupConfirm:o,closeDeleteGroupConfirm:n}=ci(),{refetch:r}=nn();return O6.default.createElement(rs,{open:o,onClose:()=>{n()},title:e("package__features:context_menu__lite_editor__modal__delete_group__title"),description:e("package__features:context_menu__lite_editor__modal__delete_group__description"),confirmButtonText:e("package__features:context_menu__lite_editor__modal__delete_group__button__delete"),onConfirm:async()=>{if(t?.prompt_id){let i=await on.deleteContextMenuNode(t.prompt_id,t.parent_prompt_id);i.success&&i.data?.data?oo.error(e("package__features:chat__inputbox__my_own_tools__modal__group__delete_success")):oo.error(e("package__features:chat__inputbox__my_own_tools__modal__delete_error")),await r("LiteContextMenuGroupDeleteConfirm")}return!0}})},B6=hw;var Kn=I(w()),gw=()=>{let{t:e}=E(),t=co(),o=(0,Kn.createRef)(),{groupData:n,updateGroup:r,isOpen:i,closeEditor:a}=ci(),{changeMode:s}=uo(),[l,p]=(0,Kn.useState)(!1),[u,c]=(0,Kn.useState)(!1),[m,d]=(0,Kn.useState)(""),{refetch:f}=nn(),h=!n?.prompt_id,_=e(h?"package__features:context_menu__lite_editor__modal__edit_group__title__add":"package__features:context_menu__lite_editor__modal__edit_group__title__edit"),g=async()=>{try{if(p(!0),n){let y=De(n),C=await on.addOrUpdateContextMenuGroup(y);return C.data&&C.success?(d(""),await f("LiteContextMenuGroupEditor"),s("edit")):d(C.error),c(!C.success),C.success}return!0}catch{return!1}finally{p(!1)}};return(0,Kn.useEffect)(()=>{i?setTimeout(()=>{o.current&&o.current.focus(),h&&o.current?.select()},100):(c(!1),d(""))},[i]),Kn.default.createElement(Kn.default.Fragment,null,Kn.default.createElement(ns,{container:t,loading:l,title:_,PaperProps:{sx:{maxWidth:"448px"}},open:i,onConfirm:async()=>await g(),onClose:()=>{a()},confirmButtonText:e(h?"package__common:create":"package__common:done")},n&&Kn.default.createElement(x,{gap:"8px"},Kn.default.createElement(Ct,{error:u,helperText:m,inputProps:{style:{fontSize:"16px",textAlign:"left"}},FormHelperTextProps:{sx:{fontSize:"12px"}},inputRef:o,onKeyUpCapture:y=>{y.stopPropagation()},onKeyDown:y=>{y.stopPropagation()},onKeyUp:y=>{y.stopPropagation()},onKeyPress:y=>{y.stopPropagation()},onKeyPressCapture:y=>{y.stopPropagation()},onKeyDownCapture:async y=>{y.stopPropagation(),!y.nativeEvent.isComposing&&(y.key==="Enter"&&!y.shiftKey?n&&await g()&&a():y.key==="Escape"&&a())},value:n.prompt_title,onChange:y=>{r({prompt_title:y.target.value})},size:"small",placeholder:e("package__features:context_menu__lite_editor__modal__edit_group__variable_name__label")}))),Kn.default.createElement(B6,null))},D6=gw;var js=I(w()),xw=e=>{let{sx:t,groupData:o,icon:n,onChange:r}=e,{t:i}=E(),{createNewGroup:a,editGroup:s}=ci(),{isOpen:l}=ci(),p=(0,js.useRef)(!1),u=o?.prompt_id?i("package__features:context_menu__lite_editor__modal__edit_group__title__edit"):i("package__features:context_menu__lite_editor__modal__edit_group__title__add"),c=async()=>{await Fe({emitEvent:!0})&&(p.current=!0,o?.prompt_id?s(o):await a())};return(0,js.useEffect)(()=>{!l&&p.current&&(p.current=!1,r?.())},[l,r]),js.default.createElement(ne,{disabledClickEvent:!0,placement:"top-end",onClick:c,tooltipProps:{PopperProps:{disablePortal:!0},disableInteractive:!0},title:u,sx:t},typeof n=="string"?js.default.createElement(U,{icon:n||"PromptEdit"}):n)},F6=xw;var Ni=I(w()),Hh=async e=>{let o=(await on.getContextMenuChildren(e)).filter(n=>n.type==="group");if(e==="/my_own_tools"){let n=await on.getContextMenuByPath(e);n&&(n.prompt_title="",o.unshift(n))}return jC(o,{labelKey:"prompt_title",valueKey:"prompt_id"})},_w=e=>{let{defaultValue:t,onChange:o,contextMenuPath:n,...r}=e,[i,a]=(0,Ni.useState)(t||""),s=Ni.default.useRef(null),{data:l,isLoading:p,refetch:u}=G_({queryKey:[z_.GET_LITE_CONTEXT_MENU_GROUP,n],queryFn:async()=>{let c=await Hh(n);if(c.length>0)return c;let m=await on.getContextMenuByPath(n);if(!m)throw new Error("Parent prompt not found");return n!=="/my_own_tools"&&await on.addOrUpdateContextMenuGroup({parent_prompt_id:m.prompt_id,prompt_title:"My prompts",prompt_icon:void 0,visibility_settings:{blocked_domains:[],allowed_domains:[],use_allow_list:!1},prompt_id:Bo()}),await Hh(n)},enabled:!!n,initialData:[]});return(0,Ni.useEffect)(()=>{if(l&&l.length>0){if(s.current){a(s.current.prompt_id),o?.(s.current.prompt_id,s.current),s.current=null;return}l.some(m=>m.value===i)||n!=="/my_own_tools"&&(a(l[0].value),o?.(l[0].value,l[0].origin))}},[l,i]),Ni.default.createElement(Uy,{value:i,onChange:(c,m)=>{a(c),o?.(c,m.origin)},sx:{padding:0},MenuProps:{slotProps:{paper:{sx:{textAlign:"left",marginTop:"8px","& > ul":{padding:"8px 0 0 0"}}}}},renderFooter:Ni.default.createElement(x,{direction:"row",sx:{justifyContent:"flex-end",alignItems:"center",gap:"8px",padding:"4px",borderTop:"1px solid",borderColor:"border.main"}},Ni.default.createElement(F6,{icon:Ni.default.createElement(o2,null),onChange:async()=>{let m=(await Hh(n)).find(d=>!l.some(f=>f.value===d.value));m?.origin&&(s.current=m.origin,u())},sx:{minWidth:"26px",width:"26px",height:"26px",padding:"4px"}})),loading:p,options:l,...r})},H6=_w;var N6=I(w()),Cw=()=>{let{t:e}=E(),{promptData:t,isOpenDeletePromptConfirm:o,closeDeletePromptConfirm:n}=An(),{refetch:r}=nn();return N6.default.createElement(rs,{open:o,onClose:()=>{n()},title:e("package__features:context_menu__lite_editor__modal__delete_tool__title"),description:e("package__features:context_menu__lite_editor__modal__delete_tool__description"),confirmButtonText:e("package__features:context_menu__lite_editor__modal__delete_tool__button__delete"),onConfirm:async()=>{if(t?.prompt_id){let i=await on.deleteContextMenuNode(t.prompt_id,t.parent_prompt_id);i.success&&i.data?.data?oo.error(e("package__features:chat__inputbox__my_own_tools__modal__prompt__delete_success")):oo.error(e("package__features:chat__inputbox__my_own_tools__modal__delete_error")),await r("LiteContextMenuPromptDeleteConfirm")}return!0}})},z6=Cw;var Vi=I(w()),yw=e=>{let{onCreateVariable:t,onUpdateVariable:o}=e,{t:n}=E(),{isOpenEditVariableModal:r,closeEditVariableModal:i,editVariable:a,updateVariable:s,saveEditVariable:l,variables:p}=Fi(),[u,c]=(0,Vi.useState)(""),m=Vi.default.createRef(),d=!a.hint?.trim(),f=()=>{let h=De(a);if(h.hint=h.hint.trim(),p.find(g=>g.hint===h.hint&&g.name!==h.name))return c(n("package__features:context_menu__lite_editor__modal__edit_variable__variable_name__error__name_repeated")),!1;if(h.name)l(h),o?.(h);else{let g=py(h.hint),y={...h,name:g};l(y),t?.(y)}return!0};return(0,Vi.useEffect)(()=>{r&&(c(""),setTimeout(()=>{m.current&&m.current.focus()},100))},[r]),Vi.default.createElement(ns,{disableRestoreFocus:!0,title:a.name?n("package__features:context_menu__lite_editor__modal__edit_variable__title__edit"):n("package__features:context_menu__lite_editor__modal__edit_variable__title__add"),open:r,confirmButtonDisabled:d,onClose:()=>{i()},onConfirm:async()=>f(),sx:{zIndex:2147483623}},Vi.default.createElement(x,{gap:"8px"},Vi.default.createElement(T,{fontSize:"16px",fontWeight:500,textAlign:"left",color:"text.primary"},n("package__features:context_menu__lite_editor__modal__edit_variable__variable_name__title")),Vi.default.createElement(Ct,{inputRef:m,error:u!=="",helperText:u,inputProps:{style:{fontSize:"16px",textAlign:"left"}},FormHelperTextProps:{sx:{fontSize:"12px"}},value:a.hint,onChange:h=>{s({...a,hint:h.target.value})},onKeyUpCapture:h=>{h.stopPropagation()},onKeyDown:h=>{h.stopPropagation()},onKeyUp:h=>{h.stopPropagation()},onKeyPress:h=>{h.stopPropagation()},onKeyPressCapture:h=>{h.stopPropagation()},onKeyDownCapture:h=>{if(h.stopPropagation(),!h.nativeEvent.isComposing)if(h.key==="Enter"&&!h.shiftKey){if(h.preventDefault(),d)return;a&&f()&&i()}else h.key==="Escape"&&(h.preventDefault(),i())},size:"small",placeholder:n("package__features:context_menu__lite_editor__modal__edit_variable__variable_name__label")})))},V6=yw;var qn=I(w()),bw=rr(({className:e,...t})=>qn.default.createElement(Hr,{...t,classes:{popper:e}}))(({theme:e})=>({[`& > .${Vn.tooltip}`]:{backgroundColor:"#fff",color:"rgba(0, 0, 0, 0.87)",maxWidth:"unset",border:"1px solid #E0E0E0",boxShadow:e.shadows[5]},"& button > svg":{color:"rgba(0, 0, 0, 0.87)!important"},'&[data-popper-placement="bottom"] > div':{marginTop:"8px !important"},'&[data-popper-placement="top"] > div':{marginBottom:"8px !important"},[`& > .${Vn.arrow}`]:{color:"#fff"}})),Iw=e=>{let{variable:t,onClick:o,onDelete:n,onEdit:r}=e,{t:i}=E(),{theme:a}=lr(),[s,l]=(0,qn.useState)(!1),p=a.palette.mode==="dark",u=Wy(t.name,p),c=Gy(u,p?.3:.8,p?.1:.3);return qn.default.createElement("div",null,qn.default.createElement(bw,{title:qn.default.createElement(x,{direction:"row",gap:"4px"},qn.default.createElement(ne,{placement:"top",tooltipProps:{disableInteractive:!0,PopperProps:{disablePortal:!0}},sx:{width:"20px",height:"20px",minWidth:"20px",borderRadius:"2px"},title:i("package__features:context_menu__lite_editor__modal__edit_variable__title__edit"),onClick:()=>{r&&r()}},qn.default.createElement(U,{sx:{fontSize:"16px!important"},icon:"PromptEdit"})),qn.default.createElement(ne,{placement:"top",tooltipProps:{disableInteractive:!0,PopperProps:{disablePortal:!0}},sx:{width:"20px",height:"20px",minWidth:"20px",borderRadius:"2px"},title:i("package__features:context_menu__lite_editor__modal__delete_variable__title__delete"),onClick:()=>{l(!0)}},qn.default.createElement(U,{sx:{fontSize:"16px!important"},icon:"Delete"}))),placement:"top",PopperProps:{disablePortal:!0}},qn.default.createElement(ce,{key:t.name,sx:{minWidth:"unset",padding:"2px 6px",color:u,bgcolor:c,"&:hover":{color:u,bgcolor:c}},onClick:()=>{o&&o()}},qn.default.createElement(T,{lineHeight:"20px",fontSize:"14px",fontWeight:400,textAlign:"left",color:"inherit",noWrap:!0,maxWidth:"240px"},`{{${t.hint}}}`))),qn.default.createElement(ns,{PaperProps:{sx:{maxWidth:"448px"}},open:s,onClose:()=>{l(!1)},title:i("package__features:context_menu__lite_editor__modal__delete_variable__title__delete"),confirmButtonText:i("package__features:context_menu__lite_editor__modal__delete_variable__button__delete"),ConfirmButtonProps:{sx:{bgcolor:"#ED5050",color:"white","&:hover":{bgcolor:"rgba(255, 14, 39, 1)",color:"white"}}},onConfirm:async()=>(n&&n(),l(!1),!0)},qn.default.createElement(T,{lineHeight:"24px",fontSize:"16px",textAlign:"left",color:"text.primary",fontWeight:400},i("package__features:context_menu__lite_editor__modal__delete_variable__description"))))},R6=Iw;var U6=I(JM());var is=I(w()),Sw=e=>{let{sx:t,onInsertVariable:o,children:n}=e,{t:r}=E(),{variables:i,openEditVariableModal:a,deleteVariable:s}=Fi(),{secondaryElementMouseLeave:l,secondaryElementMouseEnter:p,secondaryElementSx:u}=An(),c=m=>{a(m)};return is.default.createElement(x,{onMouseLeave:l,onMouseEnter:p,direction:"row",sx:{flexWrap:"wrap",gap:"8px",alignItems:"center",bgcolor:m=>m.palette.mode==="dark"?"#363839":"#f9f9f9",...u,...t}},i.map(m=>m.hidden||m.type==="select"?null:is.default.createElement(R6,{variable:m,onClick:()=>o(m),onEdit:()=>c(m),onDelete:()=>{s(m)},key:m.name+m.hint})),is.default.createElement(ce,{sx:{padding:"2px 6px",gap:"4px",display:"flex",alignItems:"center",bgcolor:m=>m.palette.mode==="dark"?"rgba(255, 255, 255, 0.08)":"rgba(0, 0, 0, 0.06)","&:hover":{bgcolor:m=>m.palette.mode==="dark"?"rgba(255, 255, 255, 0.08)":"rgba(0, 0, 0, 0.06)"}},onClick:()=>{a({name:"",hint:"",type:"text"})}},is.default.createElement(T,{lineHeight:"20px",fontSize:"14px",fontWeight:400,textAlign:"left",color:"inherit",noWrap:!0},r("package__features:context_menu__lite_editor__modal__edit_variable__button__new_variable")),is.default.createElement(he,{title:r("package__features:context_menu__lite_editor__modal__edit_variable__button__new_variable__tooltip"),PopperProps:{disablePortal:!0},disableInteractive:!0},is.default.createElement(U6.default,{sx:{fontSize:"12px"}}))),is.default.createElement(V6,{onCreateVariable:m=>{o(m)}}),n)},W6=Sw;var ap=I(w()),vw=typeof Element<"u",Tw=typeof Map=="function",Mw=typeof Set=="function",ww=typeof ArrayBuffer=="function"&&!!ArrayBuffer.isView,cd=(e,t)=>{if(e===t)return!0;if(e&&t&&typeof e=="object"&&typeof t=="object"){if(e.constructor!==t.constructor)return!1;let o,n,r;if(Array.isArray(e)){if(o=e.length,o!=t.length)return!1;for(n=o;n--!==0;)if(!cd(e[n],t[n]))return!1;return!0}let i;if(Tw&&e instanceof Map&&t instanceof Map){if(e.size!==t.size)return!1;for(i=e.entries();!(n=i.next()).done;)if(!t.has(n.value[0]))return!1;for(i=e.entries();!(n=i.next()).done;)if(!cd(n.value[1],t.get(n.value[0])))return!1;return!0}if(Mw&&e instanceof Set&&t instanceof Set){if(e.size!==t.size)return!1;for(i=e.entries();!(n=i.next()).done;)if(!t.has(n.value[0]))return!1;return!0}if(ww&&ArrayBuffer.isView(e)&&ArrayBuffer.isView(t)){if(o=e.length,o!=t.length)return!1;for(n=o;n--!==0;)if(e[n]!==t[n])return!1;return!0}if(e.constructor===RegExp)return e.source===t.source&&e.flags===t.flags;if(e.valueOf!==Object.prototype.valueOf&&typeof e.valueOf=="function"&&typeof t.valueOf=="function")return e.valueOf()===t.valueOf();if(e.toString!==Object.prototype.toString&&typeof e.toString=="function"&&typeof t.toString=="function")return e.toString()===t.toString();if(r=Object.keys(e),o=r.length,o!==Object.keys(t).length)return!1;for(n=o;n--!==0;)if(!Object.prototype.hasOwnProperty.call(t,r[n]))return!1;if(vw&&e instanceof Element)return!1;for(n=o;n--!==0;)if(!((r[n]==="_owner"||r[n]==="__v"||r[n]==="__o")&&e.$$typeof)&&!cd(e[r[n]],t[r[n]]))return!1;return!0}return e!==e&&t!==t};function G6(e){return e&&e.replace(/&nbsp;|\u202F|\u00A0/g," ").replace(/<br\s*\/>/g,"<br>")}function j6(e){return e.replace(/(<br\s*\/?>)+$/i,"")}function Nh(e){if(!e)return"";let t=e.replace(/<br\s*\/>/gi,"<br>");return/<br>$/i.test(t)?t:t+"<br>"}function K6(e){let t=document.createTextNode("");e.appendChild(t);let o=document.activeElement===e;if(t.nodeValue!==null&&o){let n=window.getSelection();if(n!==null){let r=document.createRange();r.setStart(t,t.nodeValue.length),r.collapse(!0),n.removeAllRanges(),n.addRange(r)}e.focus()}}var Ic=class extends ap.Component{constructor(){super(...arguments);this.lastHtml=this.props.html;this.el=typeof this.props.innerRef=="function"?{current:null}:ap.createRef();this.getEl=()=>(this.props.innerRef&&typeof this.props.innerRef!="function"?this.props.innerRef:this.el).current;this.emitChange=o=>{let n=this.getEl();if(!n)return;let r=j6(n.innerHTML);if(this.props.onChange&&r!==this.lastHtml){let i=Object.assign({},o,{target:{value:r}});this.props.onChange(i)}this.lastHtml=r};this._recordCompositionPrevElement=null;this._recordCompositionPrevElementParentNode=null}_focusRecordCompositionPrevElement(){if(!this._recordCompositionPrevElement)return;let o=document.createRange(),n=window.getSelection();n&&(this._recordCompositionPrevElement===this.getEl()?o.setStart(this.getEl(),0):this._recordCompositionPrevElement.nextSibling?this._recordCompositionPrevElement.nextSibling.contentEditable==="false"&&this._recordCompositionPrevElementParentNode?o.setStart(this._recordCompositionPrevElementParentNode,Array.from(this._recordCompositionPrevElementParentNode.childNodes).indexOf(this._recordCompositionPrevElement.nextSibling)):o.setStart(this._recordCompositionPrevElement.nextSibling,0):this._recordCompositionPrevElementParentNode&&o.setStart(this._recordCompositionPrevElementParentNode,this._recordCompositionPrevElementParentNode.childNodes.length),o.collapse(!0),n.removeAllRanges(),n.addRange(o),this.getEl()?.focus())}getPreviousElementFromCaret(){let n=(this.getEl()?.getRootNode()||window).getSelection();if(!n?.rangeCount)return null;let r=this.getEl();if(!r)return null;let i=n.getRangeAt(0);if(!r.contains(i.commonAncestorContainer))return null;let a=i.startContainer,s=i.startOffset;if(a===r){if(s===0)return r;if(s<=r.childNodes.length)return r.childNodes[s-1]}return a.nodeType===Node.TEXT_NODE&&s===0?a.previousSibling:null}shouldComponentUpdate(o){let n=this.getEl();if(!n)return!0;let r=j6(n.innerHTML);return G6(o.html)!==G6(r)?!0:this.props.disabled!==o.disabled||this.props.tagName!==o.tagName||this.props.className!==o.className||this.props.innerRef!==o.innerRef||this.props.placeholder!==o.placeholder||!cd(this.props.style,o.style)}componentDidUpdate(){let o=this.getEl();if(!o)return;let n=Nh(this.props.html);n!==o.innerHTML&&(o.innerHTML=n),this.lastHtml=this.props.html,K6(o)}componentDidMount(){let o=this.getEl();if(!o)return;let n=Nh(this.props.html);n!==o.innerHTML&&(o.innerHTML=n),this.lastHtml=this.props.html,K6(o)}render(){let{tagName:o,html:n,innerRef:r,children:i,...a}=this.props,s=Nh(n);return ap.createElement(o||"div",{...a,ref:typeof r=="function"?l=>{r(l),this.el.current=l}:r||this.el,onInput:this.emitChange,onBlur:this.props.onBlur||this.emitChange,onKeyUp:this.props.onKeyUp||this.emitChange,onKeyDown:this.props.onKeyDown||this.emitChange,onCompositionStart:l=>{this._recordCompositionPrevElement=this.getPreviousElementFromCaret(),this._recordCompositionPrevElementParentNode=this._recordCompositionPrevElement?.parentNode||null,this.props.onCompositionStart?.(l)},onCompositionEnd:l=>{l.data||this._focusRecordCompositionPrevElement(),this.props.onCompositionEnd?.(l)},contentEditable:!this.props.disabled,dangerouslySetInnerHTML:{__html:s}},i)}};var zt=I(w()),Ew=e=>{let{promptId:t,error:o,disabled:n,placeholder:r,minHeight:i=80,maxHeight:a=80,sx:s,onData:l,onClose:p,...u}=e,[c,m]=(0,zt.useState)(!1),{t:d}=E(),{theme:f}=lr(),h=E_(),{template:_,setTemplate:g,variables:y,html:C,setIsDarkMode:b,htmlToTemplate:v}=Fi(),S=(0,zt.useRef)(null),P=(0,zt.useRef)(""),k=(0,zt.useRef)(!1),L=!!t,H=(0,zt.useMemo)(()=>Jo([{pointerEvents:n?"none":"auto",borderRadius:"8px",display:"flex",flexDirection:"column",width:"100%",border:"1px solid",outline:"0px solid",height:"100%",outlineColor:N=>N.palette.mode==="dark"?"rgba(255, 255, 255, 0.2)":"rgba(0,0,0,0.12)",borderColor:N=>N.palette.mode==="dark"?"rgba(255, 255, 255, 0.2)":"rgba(0,0,0,0.12)",boxSizing:"border-box","& > div":{"&:first-of-type":{borderRadius:"8px 8px 0 0"},"&:last-of-type":{borderRadius:"0 0 8px 8px"},padding:"8px",fontFamily:"Roboto, Helvetica, Arial, sans-serif!important"},"&:hover":{outlineColor:N=>N.palette.mode==="dark"?"#fff":"rgba(0, 0, 0,.87)",borderColor:N=>N.palette.mode==="dark"?"#fff":"rgba(0, 0, 0,.87)"},"&:has( > div:active),&:has( > div:focus)":{outlineColor:N=>N.palette.mode==="dark"?"#fff":"rgba(0, 0, 0,.87)",borderColor:N=>N.palette.mode==="dark"?"#fff":"rgba(0, 0, 0,.87)",outlineWidth:1},".prompt-template-input[contenteditable=true]:empty:before":{content:"attr(data-placeholder)",display:"block",color:"#aaa",fontFamily:"Roboto, Helvetica, Arial, sans-serif!important"},".prompt-template-input":{display:"block",outline:"none!important",boxSizing:"border-box",width:"calc(100% - 4px)",minHeight:c?"unset":`${i}px`,height:c?"unset":`calc(95vh - ${L?"364":"447"}px)`,flex:c?1:"unset",overflow:"auto",fontSize:16,lineHeight:1.4,letterSpacing:"0.4px",WebkitUserModify:"read-write-plaintext-only"}},s,o?{"&:":{"--borderColor":N=>`${N.palette.error.main}!important`}}:{}]),[n,i,a,s,o,c,L]);(0,zt.useEffect)(()=>{b(f.palette.mode==="dark")},[f.palette.mode]);let W=()=>{S.current&&setTimeout(()=>{kh(S.current,P.current,h)},0)},O=async N=>{if(S.current){let z=S.current.innerText.replace(/\n$/,""),j=P.current;z.startsWith(j)?(P.current=j+`{{${N.hint}}}`,z=P.current+z.slice(j.length)):(P.current=z+`{{${N.hint}}}`,z+=`{{${N.hint}}}`);let G=new Map;y.forEach(Q=>{G.set(Q.hint,Q.name)}),G.set(N.hint,N.name);let q=/\{\{([^{}]+?)\}\}/g,A=document.createElement("textarea");A.textContent=z;let Y=A.innerHTML;A.remove(),z=Y.replace(q,(Q,M)=>{let K=G.get(M);return K?`{{${K}}}`:Q}),g(z),W()}},D=N=>{if(S.current)if(h()?.rangeCount){let j=h()?.getRangeAt(0),G=j?.cloneRange();j&&G&&(j.collapsed&&j.startContainer.parentElement?.tagName==="SPAN"&&j.setStartAfter(j.startContainer.parentElement),G.selectNodeContents(S.current),G.setEnd(j.startContainer,j.startOffset),P.current=G.toString())}else S.current.focus()};(0,zt.useEffect)(()=>{l?.({template:_,variables:y})},[_,y]),(0,zt.useEffect)(()=>{setTimeout(()=>{S.current&&(P.current=S.current.innerText,S.current.focus(),kh(S.current,P.current,h))},100)},[t,c]);let V=()=>zt.default.createElement(B,{sx:H},zt.default.createElement(Ic,{style:{textAlign:"left"},innerRef:S,html:C,className:"prompt-template-input",id:"prompt-template-input","data-testid":"prompt-template-input","data-placeholder":r,onChange:N=>{if(k.current)return;let z=N.target.value;D("onChange"),v(z)},onCompositionStart:N=>{k.current=!0},onCompositionEnd:N=>{if(k.current=!1,!N.data)return;let z=N.target.innerHTML;D("onCompositionEnd"),v(z)},onKeyDownCapture:N=>{N.stopPropagation(),N.key==="Escape"&&(c?m(!1):p?.())},onKeyUpCapture:N=>{N.stopPropagation(),!k.current&&D("onKeyUp")},onKeyPress:N=>{N.stopPropagation()},onKeyPressCapture:N=>{N.stopPropagation()},onKeyDown:N=>{N.stopPropagation()},onKeyUp:N=>{N.stopPropagation()},onMouseUp:()=>{D("onMouseUp")},...u}),zt.default.createElement(x,{direction:"row",alignItems:"center",justifyContent:"end",sx:{padding:"4px!important","&:empty":{display:"none"}}},!c&&zt.default.createElement(ne,{placement:"top",tooltipProps:{disableInteractive:!0,PopperProps:{disablePortal:!0}},sx:{alignItems:"flex-end",marginLeft:"auto"},title:d("package__features:context_menu__lite_editor__modal__edit_tool__prompt_template__expand"),onClick:()=>{m(!0)},"data-testid":"maxai-prompt-template-input--expand"},zt.default.createElement(U,{icon:"ExpandContent"}))),zt.default.createElement(W6,{onInsertVariable:O}));return c?zt.default.createElement(Ti,{open:!0,sx:{position:"fixed",zIndex:2147483622},onClose:()=>{m(!1)}},zt.default.createElement(vn,{component:"div",sx:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%,-50%)",my:0,boxShadow:"none",overflow:"hidden",height:"95vh",width:"80vw",padding:"24px",alignItems:"center",justifyContent:"center",boxSizing:"border-box"}},zt.default.createElement(x,{width:"100%",gap:"24px",height:"100%"},zt.default.createElement(x,{width:"100%",height:0,flex:1},V()),zt.default.createElement(x,{direction:"row",sx:{flexShrink:0,alignItems:"center",justifyContent:"end",height:"40px"}},zt.default.createElement(ce,{sx:{borderRadius:"9999px"},variant:"contained",onClick:()=>{m(!1)}},d("package__features:context_menu__lite_editor__modal__edit_tool__prompt_template__close")))))):zt.default.createElement(zt.default.Fragment,null,V())},q6=Ew;var Ot=I(w()),$6=De(fc).filter(e=>e!=="Empty").map(e=>({label:e,value:e})),Aw=({defaultValue:e="",placement:t="bottom-start",tooltipProps:o,onChange:n,disabled:r})=>{let i=co(),{t:a}=E(),s=(0,Ot.useRef)(null),l=(0,Ot.useRef)(null),[p,u]=(0,Ot.useState)(!1),[c,m]=(0,Ot.useState)(""),d=(0,Ot.useMemo)(()=>$6.filter(_=>_.label.toLowerCase().includes(c.toLowerCase())||_.value.toLowerCase().includes(c.toLowerCase())),[c]),[f,h]=(0,Ot.useState)(()=>$6.find(_=>_.value===e)||void 0);return(0,Ot.useEffect)(()=>{p?setTimeout(()=>{l.current?.focus()},100):m("")},[p]),Ot.default.createElement(he,{title:a("package__ui:contextmenu_icon_selector__title"),PopperProps:{container:i},...o,disabled:r},Ot.default.createElement("div",{style:{flexShrink:0}},Ot.default.createElement(ce,{ref:s,variant:"outlined",sx:{height:"40px",padding:"8px",display:"flex",alignItems:"center",gap:"8px",width:"fit-content",boxSizing:"border-box",borderColor:_=>_.palette.mode==="dark"?"rgba(255, 255, 255, 0.2)":"rgba(0,0,0,0.12)"},onClick:()=>{r||u(!p)}},f?Ot.default.createElement(U,{sx:{fontSize:"24px"},icon:f.value}):Ot.default.createElement(B,{sx:{bgcolor:_=>_.palette.mode==="dark"?"rgba(255, 255, 255, 0.06)":"rgba(0, 0, 0, 0.06)",width:"24px",height:"24px"}}),Ot.default.createElement(U,{sx:{fontSize:"18px",color:"text.secondary"},icon:p?"ArrowDropUp":"ArrowDropDown"})),Ot.default.createElement(zl,{anchorEl:s.current,open:p,placement:t,container:i,onClose:()=>{u(!1)}},Ot.default.createElement(x,{sx:{padding:"8px",gap:"24px"}},Ot.default.createElement(Ct,{onKeyUpCapture:_=>{_.stopPropagation()},onKeyDown:_=>{_.stopPropagation()},onKeyUp:_=>{_.stopPropagation()},onKeyPress:_=>{_.stopPropagation()},onKeyPressCapture:_=>{_.stopPropagation()},inputRef:l,placeholder:a("package__ui:contextmenu_icon_selector__filter_label"),inputProps:{style:{fontSize:"16px",textAlign:"left"}},size:"small",InputProps:{startAdornment:Ot.default.createElement(zn,{position:"start"},Ot.default.createElement(U,{icon:"Search"}))},value:c,onChange:_=>{m(_.target.value)}}),Ot.default.createElement(x,{direction:"row",sx:{gap:"16px",flexWrap:"wrap",width:"288px",maxHeight:"224px",overflowY:"auto"}},d.map((_,g)=>Ot.default.createElement("div",{key:g},Ot.default.createElement(ne,{title:_.label,tooltipProps:{PopperProps:{disablePortal:!0},disableInteractive:!0},sx:{backgroundColor:_.value===f?.value?"rgba(0, 0, 0, 0.04)":"transparent"},onClick:()=>{h(_),u(!1),n?.(_.value)}},Ot.default.createElement(U,{icon:_.value})))),d.length===0&&Ot.default.createElement(T,{sx:{color:"text.secondary"},textAlign:"center",fontSize:"14px",fontWeight:400,width:"100%"},a("package__ui:contextmenu_icon_selector__no_result")))))))},X6=Aw;var ht=I(w());var Y6=I(w());var Pw=()=>{let{t:e}=E(),{isOpenDiscardConfirmModal:t,closeDiscardConfirmModal:o,closeEditor:n}=An();return Y6.default.createElement(rs,{open:t,title:e("package__features:context_menu__lite_editor__modal__discard_edits__title"),description:e("package__features:context_menu__lite_editor__modal__discard_edits__description"),confirmButtonText:e("package__common:discard"),onClose:()=>{o()},onConfirm:async()=>(n(),!0)})},Z6=Pw;var kw=e=>{let{sx:t}=e,o=co(),{t:n}=E(),{contextMenuPath:r,changeMode:i}=uo(),[a,s]=ht.default.useState(!1),[l,p]=ht.default.useState(""),u=(0,ht.useRef)(null),{updatePrompt:c,closeEditor:m,isOpen:d,promptData:f,secondaryElementSx:h,secondaryElementMouseLeave:_,secondaryElementMouseEnter:g,openDiscardConfirmModal:y,originalPromptData:C}=An(),{refetch:b}=nn();(0,ht.useEffect)(()=>{d||(s(!1),p(""))},[d]);let v=Ke(f),S=Ke(C),P=L=>({template:L?.prompt_template?.default?.trim()||"",title:L?.prompt_title?.trim()||"",icon:L?.prompt_icon,variables:L?.variables||[]}),k=()=>{let L=v.current,H=S.current;if(!L||!H)return!1;let W=P(L),O=P(H);return W.template!==O.template||W.title!==O.title||W.icon!==O.icon||!KC(W.variables,O.variables)?(y(),!0):!1};return ht.default.createElement(ht.default.Fragment,null,ht.default.createElement(ns,{actionRef:u,container:o,open:d,PaperProps:{sx:{height:"95vh"}},title:f?.prompt_id?n("package__features:context_menu__lite_editor__modal__edit_tool__title__edit"):n("package__features:context_menu__lite_editor__modal__edit_tool__title__add"),confirmButtonDisabled:f?.prompt_template?.default===""||f?.prompt_title==="",onConfirm:async()=>{if(f){let L=De(f);if(L.variables=L.variables.filter(W=>!!(W.hidden||L.prompt_template?.default?.includes(W.name))),!L.parent_prompt_id&&r){let W=await on.getContextMenuByPath(r);W&&(L.parent_prompt_id=W.prompt_id)}let H=await on.addOrUpdateContextMenu(L);return H.data&&H.success?(p(""),await b("LiteContextMenuPromptEditor"),i("edit")):p(H.error),s(!H.success),H.success}return!0},onClose:(L,H)=>{H!=="confirm"&&k()||m()}},ht.default.createElement(x,{width:"100%",sx:{...t}},ht.default.createElement(x,{gap:"16px"},f&&ht.default.createElement(x,{gap:"4px"},ht.default.createElement(x,{direction:"row",alignItems:"center",justifyContent:"space-between"},ht.default.createElement(x,{direction:"row",gap:"4px",alignItems:"center"},ht.default.createElement(T,{fontSize:"16px",fontWeight:500,color:"text.primary"},n("package__features:context_menu__lite_editor__modal__edit_tool__variable_prompt__label"))),ht.default.createElement(x,{direction:"row",gap:"4px",alignItems:"center"},ht.default.createElement(T,{fontSize:"14px",fontWeight:400,color:"text.secondary"},n("package__features:context_menu__lite_editor__modal__edit_tool__variable_prompt__help_1")),ht.default.createElement(T,{href:"https://www.maxai.me/docs/help/my-own-prompts/ai-prompt-writing-guide/",target:"_blank",component:"a",fontSize:"14px",fontWeight:400,color:"text.primary",sx:{textDecoration:"underline",cursor:"pointer"}},n("package__features:context_menu__lite_editor__modal__edit_tool__variable_prompt__help_2")))),ht.default.createElement(q6,{promptId:f?.prompt_id,onClose:()=>{k()||m()},onData:L=>{c({prompt_template:{default:L.template},variables:L.variables})},placeholder:n("package__features:context_menu__lite_editor__modal__edit_tool__prompt_template__placeholder")}))),ht.default.createElement(x,{onMouseEnter:g,onMouseLeave:_,sx:{gap:"16px",flexWrap:"wrap",width:"100%",pt:"16px",...h}},ht.default.createElement(x,{gap:"4px"},ht.default.createElement(T,{fontWeight:500,fontSize:"16px",color:"text.primary",textAlign:"left"},n("package__features:context_menu__lite_editor__modal__edit_tool__variable_name__label")),ht.default.createElement(x,{direction:"row",gap:"4px"},ht.default.createElement(X6,{defaultValue:f?.prompt_icon,onChange:L=>{c({prompt_icon:L})}}),ht.default.createElement(Ct,{error:a,helperText:l,inputProps:{style:{fontSize:"16px",textAlign:"left"}},FormHelperTextProps:{sx:{fontSize:"12px"}},size:"small",fullWidth:!0,placeholder:n("package__features:context_menu__lite_editor__modal__edit_tool__variable_name__placeholder"),defaultValue:f?.prompt_title||"",onKeyDownCapture:L=>{if(!L.nativeEvent.isComposing){if(L.stopPropagation(),L.key==="Escape"){if(k())return;m()}L.key==="Enter"&&f?.prompt_title&&f.prompt_template?.default&&(L.preventDefault(),u.current?.submit())}},onKeyUpCapture:L=>{L.stopPropagation()},onKeyDown:L=>{L.stopPropagation()},onKeyUp:L=>{L.stopPropagation()},onKeyPress:L=>{L.stopPropagation()},onKeyPressCapture:L=>{L.stopPropagation()},onChange:L=>{c({prompt_title:L.target.value})}}))),!f?.prompt_id&&ht.default.createElement(x,{gap:"4px"},ht.default.createElement(T,{fontWeight:500,fontSize:"16px",color:"text.primary",textAlign:"left"},n("package__features:context_menu__lite_editor__modal__edit_tool__variable_parent_group__label")),ht.default.createElement(H6,{contextMenuPath:r||"",sx:{width:"100%",height:"40px"},defaultValue:f?.parent_prompt_id||"",onChange:L=>{c({parent_prompt_id:L})}}))))),ht.default.createElement(z6,null),ht.default.createElement(Z6,null))},Q6=kw;var mi=I(w()),Lw=e=>{let{defaultContextMenuPath:t,defaultMode:o,children:n,panelId:r}=e,[i,a]=(0,mi.useState)(o||"list"),[s,l]=(0,mi.useState)(t!==void 0?t:null),u={panelId:(0,mi.useRef)(r||Bo()).current,contextMenuPath:s,mode:i,changeMode:a,changeContextMenuPath:l};return mi.default.createElement(iy.Provider,{value:u},mi.default.createElement(mi.default.Fragment,null,n,mi.default.createElement(Q6,null),mi.default.createElement(D6,null)))},as=Lw;var Ks=I(w()),ib=I(ec());var md=I(w()),Ow=function(){var e=function(t,o){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,r){n.__proto__=r}||function(n,r){for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(n[i]=r[i])},e(t,o)};return function(t,o){e(t,o);function n(){this.constructor=t}t.prototype=o===null?Object.create(o):(n.prototype=o.prototype,new n)}}(),Ho=function(){return Ho=Object.assign||function(e){for(var t,o=1,n=arguments.length;o<n;o++){t=arguments[o];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}return e},Ho.apply(this,arguments)},J6={width:"100%",height:"10px",top:"0px",left:"0px",cursor:"row-resize"},eb={width:"10px",height:"100%",top:"0px",left:"0px",cursor:"col-resize"},ud={width:"20px",height:"20px",position:"absolute"},Bw={top:Ho(Ho({},J6),{top:"-5px"}),right:Ho(Ho({},eb),{left:void 0,right:"-5px"}),bottom:Ho(Ho({},J6),{top:void 0,bottom:"-5px"}),left:Ho(Ho({},eb),{left:"-5px"}),topRight:Ho(Ho({},ud),{right:"-10px",top:"-10px",cursor:"ne-resize"}),bottomRight:Ho(Ho({},ud),{right:"-10px",bottom:"-10px",cursor:"se-resize"}),bottomLeft:Ho(Ho({},ud),{left:"-10px",bottom:"-10px",cursor:"sw-resize"}),topLeft:Ho(Ho({},ud),{left:"-10px",top:"-10px",cursor:"nw-resize"})},tb=function(e){Ow(t,e);function t(){var o=e!==null&&e.apply(this,arguments)||this;return o.onMouseDown=function(n){o.props.onResizeStart(n,o.props.direction)},o.onTouchStart=function(n){o.props.onResizeStart(n,o.props.direction)},o}return t.prototype.render=function(){return md.createElement("div",{className:this.props.className||"",style:Ho(Ho({position:"absolute",userSelect:"none"},Bw[this.props.direction]),this.props.replaceStyles||{}),onMouseDown:this.onMouseDown,onTouchStart:this.onTouchStart},this.props.children)},t}(md.PureComponent);var Dw=function(){var e=function(t,o){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,r){n.__proto__=r}||function(n,r){for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(n[i]=r[i])},e(t,o)};return function(t,o){e(t,o);function n(){this.constructor=t}t.prototype=o===null?Object.create(o):(n.prototype=o.prototype,new n)}}(),Ri=function(){return Ri=Object.assign||function(e){for(var t,o=1,n=arguments.length;o<n;o++){t=arguments[o];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}return e},Ri.apply(this,arguments)},Fw={width:"auto",height:"auto"},dd=function(e,t,o){return Math.max(Math.min(e,o),t)},ob=function(e,t,o){var n=Math.round(e/t);return n*t+o*(n-1)},sp=function(e,t){return new RegExp(e,"i").test(t)},fd=function(e){return!!(e.touches&&e.touches.length)},Hw=function(e){return!!((e.clientX||e.clientX===0)&&(e.clientY||e.clientY===0))},nb=function(e,t,o){o===void 0&&(o=0);var n=t.reduce(function(i,a,s){return Math.abs(a-e)<Math.abs(t[i]-e)?s:i},0),r=Math.abs(t[n]-e);return o===0||r<o?t[n]:e},zh=function(e){return e=e.toString(),e==="auto"||e.endsWith("px")||e.endsWith("%")||e.endsWith("vh")||e.endsWith("vw")||e.endsWith("vmax")||e.endsWith("vmin")?e:e+"px"},hd=function(e,t,o,n){if(e&&typeof e=="string"){if(e.endsWith("px"))return Number(e.replace("px",""));if(e.endsWith("%")){var r=Number(e.replace("%",""))/100;return t*r}if(e.endsWith("vw")){var r=Number(e.replace("vw",""))/100;return o*r}if(e.endsWith("vh")){var r=Number(e.replace("vh",""))/100;return n*r}}return e},Nw=function(e,t,o,n,r,i,a){return n=hd(n,e.width,t,o),r=hd(r,e.height,t,o),i=hd(i,e.width,t,o),a=hd(a,e.height,t,o),{maxWidth:typeof n>"u"?void 0:Number(n),maxHeight:typeof r>"u"?void 0:Number(r),minWidth:typeof i>"u"?void 0:Number(i),minHeight:typeof a>"u"?void 0:Number(a)}},zw=function(e){return Array.isArray(e)?e:[e,e]},Vw=["as","ref","style","className","grid","gridGap","snap","bounds","boundsByDirection","size","defaultSize","minWidth","minHeight","maxWidth","maxHeight","lockAspectRatio","lockAspectRatioExtraWidth","lockAspectRatioExtraHeight","enable","handleStyles","handleClasses","handleWrapperStyle","handleWrapperClass","children","onResizeStart","onResize","onResizeStop","handleComponent","scale","resizeRatio","snapGap"],rb="__resizable_base__",ab=function(e){Dw(t,e);function t(o){var n,r,i,a,s=e.call(this,o)||this;return s.ratio=1,s.resizable=null,s.parentLeft=0,s.parentTop=0,s.resizableLeft=0,s.resizableRight=0,s.resizableTop=0,s.resizableBottom=0,s.targetLeft=0,s.targetTop=0,s.appendBase=function(){if(!s.resizable||!s.window)return null;var l=s.parentNode;if(!l)return null;var p=s.window.document.createElement("div");return p.style.width="100%",p.style.height="100%",p.style.position="absolute",p.style.transform="scale(0, 0)",p.style.left="0",p.style.flex="0 0 100%",p.classList?p.classList.add(rb):p.className+=rb,l.appendChild(p),p},s.removeBase=function(l){var p=s.parentNode;p&&p.removeChild(l)},s.state={isResizing:!1,width:(r=(n=s.propsSize)===null||n===void 0?void 0:n.width)!==null&&r!==void 0?r:"auto",height:(a=(i=s.propsSize)===null||i===void 0?void 0:i.height)!==null&&a!==void 0?a:"auto",direction:"right",original:{x:0,y:0,width:0,height:0},backgroundStyle:{height:"100%",width:"100%",backgroundColor:"rgba(0,0,0,0)",cursor:"auto",opacity:0,position:"fixed",zIndex:9999,top:"0",left:"0",bottom:"0",right:"0"},flexBasis:void 0},s.onResizeStart=s.onResizeStart.bind(s),s.onMouseMove=s.onMouseMove.bind(s),s.onMouseUp=s.onMouseUp.bind(s),s}return Object.defineProperty(t.prototype,"parentNode",{get:function(){return this.resizable?this.resizable.parentNode:null},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"window",{get:function(){return!this.resizable||!this.resizable.ownerDocument?null:this.resizable.ownerDocument.defaultView},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"propsSize",{get:function(){return this.props.size||this.props.defaultSize||Fw},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"size",{get:function(){var o=0,n=0;if(this.resizable&&this.window){var r=this.resizable.offsetWidth,i=this.resizable.offsetHeight,a=this.resizable.style.position;a!=="relative"&&(this.resizable.style.position="relative"),o=this.resizable.style.width!=="auto"?this.resizable.offsetWidth:r,n=this.resizable.style.height!=="auto"?this.resizable.offsetHeight:i,this.resizable.style.position=a}return{width:o,height:n}},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"sizeStyle",{get:function(){var o=this,n=this.props.size,r=function(s){var l;if(typeof o.state[s]>"u"||o.state[s]==="auto")return"auto";if(o.propsSize&&o.propsSize[s]&&(!((l=o.propsSize[s])===null||l===void 0)&&l.toString().endsWith("%"))){if(o.state[s].toString().endsWith("%"))return o.state[s].toString();var p=o.getParentSize(),u=Number(o.state[s].toString().replace("px","")),c=u/p[s]*100;return c+"%"}return zh(o.state[s])},i=n&&typeof n.width<"u"&&!this.state.isResizing?zh(n.width):r("width"),a=n&&typeof n.height<"u"&&!this.state.isResizing?zh(n.height):r("height");return{width:i,height:a}},enumerable:!1,configurable:!0}),t.prototype.getParentSize=function(){if(!this.parentNode)return this.window?{width:this.window.innerWidth,height:this.window.innerHeight}:{width:0,height:0};var o=this.appendBase();if(!o)return{width:0,height:0};var n=!1,r=this.parentNode.style.flexWrap;r!=="wrap"&&(n=!0,this.parentNode.style.flexWrap="wrap"),o.style.position="relative",o.style.minWidth="100%",o.style.minHeight="100%";var i={width:o.offsetWidth,height:o.offsetHeight};return n&&(this.parentNode.style.flexWrap=r),this.removeBase(o),i},t.prototype.bindEvents=function(){this.window&&(this.window.addEventListener("mouseup",this.onMouseUp),this.window.addEventListener("mousemove",this.onMouseMove),this.window.addEventListener("mouseleave",this.onMouseUp),this.window.addEventListener("touchmove",this.onMouseMove,{capture:!0,passive:!1}),this.window.addEventListener("touchend",this.onMouseUp))},t.prototype.unbindEvents=function(){this.window&&(this.window.removeEventListener("mouseup",this.onMouseUp),this.window.removeEventListener("mousemove",this.onMouseMove),this.window.removeEventListener("mouseleave",this.onMouseUp),this.window.removeEventListener("touchmove",this.onMouseMove,!0),this.window.removeEventListener("touchend",this.onMouseUp))},t.prototype.componentDidMount=function(){if(!(!this.resizable||!this.window)){var o=this.window.getComputedStyle(this.resizable);this.setState({width:this.state.width||this.size.width,height:this.state.height||this.size.height,flexBasis:o.flexBasis!=="auto"?o.flexBasis:void 0})}},t.prototype.componentWillUnmount=function(){this.window&&this.unbindEvents()},t.prototype.createSizeForCssProperty=function(o,n){var r=this.propsSize&&this.propsSize[n];return this.state[n]==="auto"&&this.state.original[n]===o&&(typeof r>"u"||r==="auto")?"auto":o},t.prototype.calculateNewMaxFromBoundary=function(o,n){var r=this.props.boundsByDirection,i=this.state.direction,a=r&&sp("left",i),s=r&&sp("top",i),l,p;if(this.props.bounds==="parent"){var u=this.parentNode;u&&(l=a?this.resizableRight-this.parentLeft:u.offsetWidth+(this.parentLeft-this.resizableLeft),p=s?this.resizableBottom-this.parentTop:u.offsetHeight+(this.parentTop-this.resizableTop))}else this.props.bounds==="window"?this.window&&(l=a?this.resizableRight:this.window.innerWidth-this.resizableLeft,p=s?this.resizableBottom:this.window.innerHeight-this.resizableTop):this.props.bounds&&(l=a?this.resizableRight-this.targetLeft:this.props.bounds.offsetWidth+(this.targetLeft-this.resizableLeft),p=s?this.resizableBottom-this.targetTop:this.props.bounds.offsetHeight+(this.targetTop-this.resizableTop));return l&&Number.isFinite(l)&&(o=o&&o<l?o:l),p&&Number.isFinite(p)&&(n=n&&n<p?n:p),{maxWidth:o,maxHeight:n}},t.prototype.calculateNewSizeFromDirection=function(o,n){var r=this.props.scale||1,i=zw(this.props.resizeRatio||1),a=i[0],s=i[1],l=this.state,p=l.direction,u=l.original,c=this.props,m=c.lockAspectRatio,d=c.lockAspectRatioExtraHeight,f=c.lockAspectRatioExtraWidth,h=u.width,_=u.height,g=d||0,y=f||0;return sp("right",p)&&(h=u.width+(o-u.x)*a/r,m&&(_=(h-y)/this.ratio+g)),sp("left",p)&&(h=u.width-(o-u.x)*a/r,m&&(_=(h-y)/this.ratio+g)),sp("bottom",p)&&(_=u.height+(n-u.y)*s/r,m&&(h=(_-g)*this.ratio+y)),sp("top",p)&&(_=u.height-(n-u.y)*s/r,m&&(h=(_-g)*this.ratio+y)),{newWidth:h,newHeight:_}},t.prototype.calculateNewSizeFromAspectRatio=function(o,n,r,i){var a=this.props,s=a.lockAspectRatio,l=a.lockAspectRatioExtraHeight,p=a.lockAspectRatioExtraWidth,u=typeof i.width>"u"?10:i.width,c=typeof r.width>"u"||r.width<0?o:r.width,m=typeof i.height>"u"?10:i.height,d=typeof r.height>"u"||r.height<0?n:r.height,f=l||0,h=p||0;if(s){var _=(m-f)*this.ratio+h,g=(d-f)*this.ratio+h,y=(u-h)/this.ratio+f,C=(c-h)/this.ratio+f,b=Math.max(u,_),v=Math.min(c,g),S=Math.max(m,y),P=Math.min(d,C);o=dd(o,b,v),n=dd(n,S,P)}else o=dd(o,u,c),n=dd(n,m,d);return{newWidth:o,newHeight:n}},t.prototype.setBoundingClientRect=function(){var o=1/(this.props.scale||1);if(this.props.bounds==="parent"){var n=this.parentNode;if(n){var r=n.getBoundingClientRect();this.parentLeft=r.left*o,this.parentTop=r.top*o}}if(this.props.bounds&&typeof this.props.bounds!="string"){var i=this.props.bounds.getBoundingClientRect();this.targetLeft=i.left*o,this.targetTop=i.top*o}if(this.resizable){var a=this.resizable.getBoundingClientRect(),s=a.left,l=a.top,p=a.right,u=a.bottom;this.resizableLeft=s*o,this.resizableRight=p*o,this.resizableTop=l*o,this.resizableBottom=u*o}},t.prototype.onResizeStart=function(o,n){if(!(!this.resizable||!this.window)){var r=0,i=0;if(o.nativeEvent&&Hw(o.nativeEvent)?(r=o.nativeEvent.clientX,i=o.nativeEvent.clientY):o.nativeEvent&&fd(o.nativeEvent)&&(r=o.nativeEvent.touches[0].clientX,i=o.nativeEvent.touches[0].clientY),this.props.onResizeStart&&this.resizable){var a=this.props.onResizeStart(o,n,this.resizable);if(a===!1)return}this.props.size&&(typeof this.props.size.height<"u"&&this.props.size.height!==this.state.height&&this.setState({height:this.props.size.height}),typeof this.props.size.width<"u"&&this.props.size.width!==this.state.width&&this.setState({width:this.props.size.width})),this.ratio=typeof this.props.lockAspectRatio=="number"?this.props.lockAspectRatio:this.size.width/this.size.height;var s,l=this.window.getComputedStyle(this.resizable);if(l.flexBasis!=="auto"){var p=this.parentNode;if(p){var u=this.window.getComputedStyle(p).flexDirection;this.flexDir=u.startsWith("row")?"row":"column",s=l.flexBasis}}this.setBoundingClientRect(),this.bindEvents();var c={original:{x:r,y:i,width:this.size.width,height:this.size.height},isResizing:!0,backgroundStyle:Ri(Ri({},this.state.backgroundStyle),{cursor:this.window.getComputedStyle(o.target).cursor||"auto"}),direction:n,flexBasis:s};this.setState(c)}},t.prototype.onMouseMove=function(o){var n=this;if(!(!this.state.isResizing||!this.resizable||!this.window)){if(this.window.TouchEvent&&fd(o))try{o.preventDefault(),o.stopPropagation()}catch{}var r=this.props,i=r.maxWidth,a=r.maxHeight,s=r.minWidth,l=r.minHeight,p=fd(o)?o.touches[0].clientX:o.clientX,u=fd(o)?o.touches[0].clientY:o.clientY,c=this.state,m=c.direction,d=c.original,f=c.width,h=c.height,_=this.getParentSize(),g=Nw(_,this.window.innerWidth,this.window.innerHeight,i,a,s,l);i=g.maxWidth,a=g.maxHeight,s=g.minWidth,l=g.minHeight;var y=this.calculateNewSizeFromDirection(p,u),C=y.newHeight,b=y.newWidth,v=this.calculateNewMaxFromBoundary(i,a);this.props.snap&&this.props.snap.x&&(b=nb(b,this.props.snap.x,this.props.snapGap)),this.props.snap&&this.props.snap.y&&(C=nb(C,this.props.snap.y,this.props.snapGap));var S=this.calculateNewSizeFromAspectRatio(b,C,{width:v.maxWidth,height:v.maxHeight},{width:s,height:l});if(b=S.newWidth,C=S.newHeight,this.props.grid){var P=ob(b,this.props.grid[0],this.props.gridGap?this.props.gridGap[0]:0),k=ob(C,this.props.grid[1],this.props.gridGap?this.props.gridGap[1]:0),L=this.props.snapGap||0,H=L===0||Math.abs(P-b)<=L?P:b,W=L===0||Math.abs(k-C)<=L?k:C;b=H,C=W}var O={width:b-d.width,height:C-d.height};if(f&&typeof f=="string"){if(f.endsWith("%")){var D=b/_.width*100;b=D+"%"}else if(f.endsWith("vw")){var V=b/this.window.innerWidth*100;b=V+"vw"}else if(f.endsWith("vh")){var N=b/this.window.innerHeight*100;b=N+"vh"}}if(h&&typeof h=="string"){if(h.endsWith("%")){var D=C/_.height*100;C=D+"%"}else if(h.endsWith("vw")){var V=C/this.window.innerWidth*100;C=V+"vw"}else if(h.endsWith("vh")){var N=C/this.window.innerHeight*100;C=N+"vh"}}var z={width:this.createSizeForCssProperty(b,"width"),height:this.createSizeForCssProperty(C,"height")};this.flexDir==="row"?z.flexBasis=z.width:this.flexDir==="column"&&(z.flexBasis=z.height);var j=this.state.width!==z.width,G=this.state.height!==z.height,q=this.state.flexBasis!==z.flexBasis,A=j||G||q;A&&(0,ib.flushSync)(function(){n.setState(z)}),this.props.onResize&&A&&this.props.onResize(o,m,this.resizable,O)}},t.prototype.onMouseUp=function(o){var n,r,i=this.state,a=i.isResizing,s=i.direction,l=i.original;if(!(!a||!this.resizable)){var p={width:this.size.width-l.width,height:this.size.height-l.height};this.props.onResizeStop&&this.props.onResizeStop(o,s,this.resizable,p),this.props.size&&this.setState({width:(n=this.props.size.width)!==null&&n!==void 0?n:"auto",height:(r=this.props.size.height)!==null&&r!==void 0?r:"auto"}),this.unbindEvents(),this.setState({isResizing:!1,backgroundStyle:Ri(Ri({},this.state.backgroundStyle),{cursor:"auto"})})}},t.prototype.updateSize=function(o){var n,r;this.setState({width:(n=o.width)!==null&&n!==void 0?n:"auto",height:(r=o.height)!==null&&r!==void 0?r:"auto"})},t.prototype.renderResizer=function(o){var n=this,r=this.props,i=r.enable,a=r.handleStyles,s=r.handleClasses,l=r.handleWrapperStyle,p=r.handleWrapperClass,u=r.handleComponent;if(!i)return null;var c=o.filter(function(m){return i[m]!==!1}).map(function(m){return i[m]!==!1?Ks.createElement(tb,{key:m,direction:m,onResizeStart:n.onResizeStart,replaceStyles:a&&a[m],className:s&&s[m]},u&&u[m]?u[m]:null):null});return Ks.createElement("div",{className:p,style:l},c)},t.prototype.render=function(){var o=this,n=Object.keys(this.props).reduce(function(a,s){return Vw.indexOf(s)!==-1||(a[s]=o.props[s]),a},{}),r=Ri(Ri(Ri({position:"relative",userSelect:this.state.isResizing?"none":"auto"},this.props.style),this.sizeStyle),{maxWidth:this.props.maxWidth,maxHeight:this.props.maxHeight,minWidth:this.props.minWidth,minHeight:this.props.minHeight,boxSizing:"border-box",flexShrink:0});this.state.flexBasis&&(r.flexBasis=this.state.flexBasis);var i=this.props.as||"div";return Ks.createElement(i,Ri({style:r,className:this.props.className},n,{ref:function(a){a&&(o.resizable=a)}}),this.state.isResizing&&Ks.createElement("div",{style:this.state.backgroundStyle}),this.renderResizer(["topLeft","top","topRight","left"]),this.props.children,this.renderResizer(["right","bottomLeft","bottom","bottomRight"]))},t.defaultProps={as:"div",onResizeStart:function(){},onResize:function(){},onResizeStop:function(){},enable:{top:!0,right:!0,bottom:!0,left:!0,topRight:!0,bottomRight:!0,bottomLeft:!0,topLeft:!0},style:{},grid:[1,1],gridGap:[0,0],lockAspectRatio:!1,lockAspectRatioExtraWidth:0,lockAspectRatioExtraHeight:0,scale:1,resizeRatio:1,snapGap:0},t}(Ks.PureComponent);var lp=I(sb());var Ee=I(w()),lb=e=>{let{conversationId:t}=e,o=(0,Ee.useRef)(null),[n,r]=(0,Ee.useState)([]),i=Rn(()=>{if(o.current){let s=o.current?.querySelector(".max-ai__action_status__loading");s?o.current?.scrollTo({top:s.offsetTop-s.offsetHeight/2-o.current.offsetHeight/2,behavior:"smooth"}):o.current?.scrollTo({top:o.current?.scrollHeight,behavior:"smooth"})}},200);(0,Ee.useEffect)(()=>{let{shortcutsEngine:s}=qm(t);if(!s)return;let l=(p,u)=>{let c=De(u.shortcutsEngine.actions);r(c)};return s.addListener(l),()=>{s.removeListener(l)}},[t]),(0,Ee.useEffect)(()=>{i()},[n]);let a=(s,l=0)=>s.map((p,u)=>{let c="#ebebeb",m="text.primary";p.status==="running"?(c="primary.main",m="primary.main"):p.status==="error"?(c="error.main",m="error.main"):p.status==="complete"&&(c="success.main",m="success.main");let d=p.type==="ASK_CHATGPT",f=d?p.question:"",h=p.status==="complete",_=h?p.output:p.error;typeof f=="object"&&(f=JSON.stringify(f,null,2)),p.type==="SET_VARIABLES_MODAL"?_=JSON.stringify(p.parameters.SetVariablesModalConfig,null,2):p.type==="SET_VARIABLE_MAP"?_=JSON.stringify(p.parameters.VariableMap,null,2):typeof _=="object"&&(_=JSON.stringify(_,null,2));let g=JSON.stringify(p.parameters,null,2);return Ee.default.createElement(x,{key:p.type+u+l,sx:{px:1,alignItems:"center"}},Ee.default.createElement(Hr,{PopperProps:{disablePortal:!0,sx:{zIndex:2147483647}},placement:"right",title:Ee.default.createElement(x,{sx:{maxHeight:500,overflowY:"auto",gap:1}},`[${p.type}]`,d&&Ee.default.createElement(x,null,Ee.default.createElement(T,{fontSize:"12px",display:"flex",alignItems:"center",gap:1},"[Question]",Ee.default.createElement(Gn,{copyText:f,sx:{color:"text.primary",height:"12px"}})),Ee.default.createElement(T,{sx:{whiteSpace:"pre-wrap"},fontSize:"12px"},f)),Ee.default.createElement(T,{fontSize:"12px",display:"flex",alignItems:"center",gap:1},"[parameters]",Ee.default.createElement(Gn,{copyText:g,sx:{color:"text.primary",height:"12px"}})),Ee.default.createElement(T,{sx:{whiteSpace:"pre-wrap"},fontSize:"12px"},g),Ee.default.createElement(T,{fontSize:"12px",display:"flex",alignItems:"center",gap:1},h?"[Answer]":"[Error]",Ee.default.createElement(Gn,{copyText:_,sx:{color:"text.primary",height:"12px"}})),Ee.default.createElement(T,{sx:{whiteSpace:"pre-wrap"},fontSize:"12px"},_))},Ee.default.createElement(x,{className:p.status==="running"?"max-ai__action_status__loading":"",sx:{width:"100%",border:"1px solid",alignItems:"center",justifyContent:"center",borderColor:c,color:m,fontSize:"12px",borderRadius:"4px",position:"relative",padding:"8px 4px"}},p.status==="running"&&Ee.default.createElement(x,{sx:{position:"absolute",right:1,top:1}},Ee.default.createElement(Jt,{size:16,thickness:4,color:"inherit",variant:"indeterminate",sx:{color:m}})),Ee.default.createElement(x,{direction:"row",alignItems:"center",gap:1,height:16,width:"100%"},p.status!=="idle"&&p.status!=="running"&&Ee.default.createElement(Gn,{sx:{flexShrink:0},size:"small",copyText:JSON.stringify(p)}),Ee.default.createElement(T,{noWrap:!0,fontSize:"12px"},p.type)))),p.type==="SCRIPTS_CONDITIONAL"&&p.status==="complete"&&Ee.default.createElement(x,{direction:"row",gap:1,mt:1},Ee.default.createElement(x,null,p.output==="true"?Ee.default.createElement(lp.default,{sx:{fontSize:"11px",mt:.5,transform:"rotate(45deg)",marginLeft:"auto"}}):Ee.default.createElement(x,{height:16}),Ee.default.createElement(x,{sx:{p:.5,borderRadius:"4px",border:"1px solid",borderColor:p.output==="true"?"success.main":"error.main"}},a(p.parameters.WFConditionalIfTrueActions||[],l+1)),p.output==="true"?Ee.default.createElement(lp.default,{sx:{fontSize:"11px",mt:.5,transform:"rotate(-45deg)",marginLeft:"auto"}}):Ee.default.createElement(x,{height:16})),Ee.default.createElement(x,null,p.output==="false"?Ee.default.createElement(lp.default,{sx:{fontSize:"11px",mt:.5,transform:"rotate(-45deg)"}}):Ee.default.createElement(x,{height:16}),Ee.default.createElement(x,{sx:{p:.5,borderRadius:"4px",border:"1px solid",borderColor:p.output==="false"?"success.main":"error.main"}},a(p.parameters.WFConditionalIfFalseActions||[],l+1)),p.output==="false"?Ee.default.createElement(lp.default,{sx:{fontSize:"11px",mt:.5,transform:"rotate(45deg)"}}):Ee.default.createElement(x,{height:16}))),p.type!=="SCRIPTS_CONDITIONAL"&&u+1!==s.length&&Ee.default.createElement(lp.default,{sx:{fontSize:"11px",mt:.5}}))});return Ee.default.createElement(Yu,null,Ee.default.createElement(x,{width:"100%",sx:{flexShrink:0,gap:1,overflowY:"auto",maxHeight:500},ref:o},Ee.default.createElement(x,null,"ConversationId: ",t),Ee.default.createElement(x,{sx:{position:"sticky",top:0,p:1,bgcolor:"background.paper",zIndex:1}},"Actions"),a(n)))};var No=I(w());var Gw=()=>{let[e,t]=No.default.useState(!1),{conversationIds:o,chatDocuments:n}=re(r=>({conversationIds:r.conversationIds,chatDocuments:r.chatDocuments}));return No.default.createElement(x,null,No.default.createElement(ce,{onClick:()=>t(!e)},e?"Collapse":"Expand"),No.default.createElement(x,{gap:"8px",direction:"row"},No.default.createElement(x,{width:"66%",gap:"8px",direction:"row",flexWrap:"wrap"},o.map((r,i)=>No.default.createElement(Kw,{expanded:e,key:r,conversationId:r,order:i}))),No.default.createElement(x,{width:"33%",gap:"8px"},No.default.createElement(T,{color:"text.primary"},"Chat Documents"),n.map(r=>No.default.createElement(jw,{expanded:e,key:r.id,chatDocument:r})))))},jw=e=>{let{chatDocument:t,expanded:o}=e,{document:n}=GC(t.maxAIDocumentId);return No.default.createElement(x,{sx:{width:"100%",border:"1px solid",borderColor:"border.main",padding:"8px",fontSize:"12px",color:"text.primary",gap:"8px",whiteSpace:"pre-wrap",overflow:"auto",wordBreak:"break-all",maxHeight:o?"unset":"auto"}},JSON.stringify(t,null,2),No.default.createElement("br",null),o&&JSON.stringify(n||{},null,2))},Kw=e=>{let{conversationId:t,order:o,expanded:n}=e,r=Wl(t),i=vt(XC(t)),a=vt(Um(t));return No.default.createElement(x,{sx:{width:"calc(50% - 4px)",border:"1px solid",borderColor:"border.main",padding:"8px",fontSize:"12px",color:"text.primary",gap:"8px",maxHeight:n?"unset":"auto"}},No.default.createElement("div",null,"conversationId:",No.default.createElement("br",null),t),No.default.createElement("div",null,"order: ",o),No.default.createElement("div",null,"chatBoxLoading: ",i?"\u{1F4AB}":"\u2705"),No.default.createElement("div",null,"chatBoxShortcutsStatus: ",a),No.default.createElement(lb,{conversationId:t}),n&&No.default.createElement("pre",{style:{whiteSpace:"pre-wrap",wordBreak:"break-all"}},JSON.stringify(r,null,2)))},pb=Gw;var Qt=I(w()),qw=fc.reduce((e,t)=>{let o=t[0].toUpperCase();return e[o]||(e[o]=[]),e[o].push(t),e},{}),$w=ai(Object.entries(qw).map(([e,t])=>({key:e,value:t})),"key","asc"),Xw=Object.keys(u2),Yw=Xw.reduce((e,t)=>{let o=t[0].toUpperCase();return e[o]||(e[o]=[]),e[o].push(t),e},{}),Zw=ai(Object.entries(Yw).map(([e,t])=>({key:e,value:t})),"key","asc"),Qw=()=>Qt.default.createElement(x,{gap:"16px"},Qt.default.createElement(x,null,Qt.default.createElement(T,{color:"text.primary",fontSize:20,fontWeight:500},"Contextmenu icons")),Qt.default.createElement(x,null,Qt.default.createElement(wi,{href:"https://mui.com/material-ui/material-icons/?theme=Outlined",target:"_blank"},"MUI icons")),Qt.default.createElement(T,{color:"text.primary"},"Total"),Qt.default.createElement(x,{direction:"row",flexWrap:"wrap",gap:"8px"},fc.map(e=>Qt.default.createElement(ne,{onClick:()=>{navigator.clipboard.writeText(e)},title:e,sx:{border:"1px solid",borderColor:"border.main",padding:"0"}},Qt.default.createElement(U,{icon:e,sx:{fontSize:"24px"}})))),$w.map(e=>Qt.default.createElement(x,{key:e.key,gap:"4px"},Qt.default.createElement(T,{color:"text.primary"},e.key),Qt.default.createElement(x,{direction:"row",flexWrap:"wrap",gap:"8px"},e.value.map(t=>Qt.default.createElement(ne,{onClick:()=>{navigator.clipboard.writeText(`
                        <ContextMenuIcon icon={'${t}'} />
                        `)},sx:{width:"unset",border:"1px solid",borderColor:"border.main",padding:"0 8px",gap:"4px"}},Qt.default.createElement(U,{icon:t,sx:{fontSize:"24px"}}),Qt.default.createElement(T,{color:"text.primary"},t)))))),Qt.default.createElement(ft,null),Qt.default.createElement(x,null,Qt.default.createElement(T,{color:"text.primary",fontSize:20,fontWeight:500},"MaxAIIcon icons")),Zw.map(e=>Qt.default.createElement(x,{key:e.key,gap:"4px"},Qt.default.createElement(T,{color:"text.primary"},e.key),Qt.default.createElement(x,{direction:"row",flexWrap:"wrap",gap:"8px"},e.value.map(t=>Qt.default.createElement(ne,{onClick:()=>{navigator.clipboard.writeText(`
                        <${t} />
                      `)},sx:{width:"unset",border:"1px solid",borderColor:"border.main",padding:"0 8px",gap:"4px"}},Qt.default.createElement(Vs,{icon:t.replace("Icon",""),sx:{fontSize:"24px"}}),Qt.default.createElement(T,{color:"text.primary"},t))))))),cb=Qw;var ss=I(w()),Jw=()=>{let{devShowAuxiliaryLine:e,devAlwaysShowTooltip:t,devAlwaysExpandAllButtons:o,updateQuickAccessDevContent:n}=jy();return ss.default.createElement(x,null,ss.default.createElement("label",null,ss.default.createElement("input",{type:"checkbox",checked:e,onChange:()=>n({showAuxiliaryLine:!e})}),"\u663E\u793A\u8F85\u52A9\u7EBF"),ss.default.createElement("label",null,ss.default.createElement("input",{type:"checkbox",checked:t,onChange:()=>n({alwaysShowTooltip:!t})}),"\u603B\u662F\u663E\u793Atooltip"),ss.default.createElement("label",null,ss.default.createElement("input",{type:"checkbox",checked:o,onChange:()=>n({alwaysExpandAllButtons:!o})}),"\u603B\u662F\u5C55\u5F00\u6240\u6709\u6309\u94AE"))},ub=Jw;var aa=I(w()),eE=()=>aa.default.createElement(x,null,aa.default.createElement(x,null,aa.default.createElement(T,null,"Indexed DB")),aa.default.createElement(x,null,aa.default.createElement(ce,{onClick:async()=>{await N_(BC,"documents").clear().then(),window.location.reload()}},"Clear Document"),aa.default.createElement(ce,{onClick:async()=>{await gr.set({CHROME_EXTENSION_USE_CHAT_GPT_AI_ON_BOARDING_SAVE_KEY:""}),await gr.set({[Fy]:""})}},"Clear Onboarding"),aa.default.createElement(ce,{onClick:async()=>{await Ge.resetOnboardingData()}},"Clear maxai-client Onboarding settings"),aa.default.createElement(ce,{onClick:async()=>{await Dm.getService("CONTEXT_MENU_SUGGEST").clearUsageHistory()}},"Clear [CONTEXT_MENU] suggestion"))),mb=eE;var Ln=I(w());var pp=I(w()),tE=()=>{let e=document.createElement("style");e.id="debug-react-component-style",e.textContent=`
    .maxai_debug_react_component {
      outline: 1px solid red;
    }

    .maxai_need_relative {
      position: relative;
    }
  `;let t=Vh();return t&&!t.getElementById("debug-react-component-style")&&t.insertBefore(e,t.firstChild),()=>{let r=Vh()?.getElementById("debug-react-component-style");r&&r.parentNode&&r.parentNode.removeChild(r)}},Vh=()=>document.querySelector("use-chat-gpt-ai")?.shadowRoot,oE=({name:e})=>{let t=document.createElement("div");return t.classList.add("maxai_debug_react_component_helper"),t.style.position="absolute",t.style.top="0",t.style.left="0",t.style.width="100%",t.style.height="100%",t.style.backgroundColor="rgba(0, 0, 0, 0)",t.style.color="white",t.style.zIndex="1",t.textContent=e,t},nE=()=>{let[e,t]=(0,pp.useState)(!1),o=()=>{let n=!e;t(n);let r=Vh()?.querySelectorAll("[data-debug-react-component]");r&&(r.forEach(i=>{}),r.forEach(i=>{n?(i.classList.add("maxai_debug_react_component"),window.getComputedStyle(i).getPropertyValue("position")==="static"&&i.classList.add("maxai_need_relative"),i.querySelector(".maxai_debug_react_component_name")||i.appendChild(oE({name:i.getAttribute("data-debug-react-component")}))):(i.classList.remove("maxai_debug_react_component"),i.classList.remove("maxai_need_relative"),i.querySelector(".maxai_debug_react_component_name")?.remove())}))};return(0,pp.useEffect)(()=>{let n=tE();return()=>n()},[]),pp.default.createElement("button",{onClick:o},e?"\u5173\u95ED":"\u5F00\u542F")},db=nE;var fb=[{label:"ChatHub",value:"ChatHub"},{label:"ReactComponent",value:"ReactComponent"},{label:"QuickAccess",value:"QuickAccess"},{label:"Storage",value:"Storage"},{label:"Icons",value:"Icons"}],rE=()=>{let[e,t]=Ln.default.useState(fb[0].value);return Ln.default.createElement(x,{sx:{width:"100%",height:"100%",flex:1}},Ln.default.createElement(Yx,{value:e,onChange:(n,r)=>{t(r)},variant:"scrollable",scrollButtons:"auto"},fb.map(n=>Ln.default.createElement(Xx,{key:n.value,value:n.value,label:n.label}))),Ln.default.createElement(Sc,{active:e==="ChatHub",keepAlive:!0},Ln.default.createElement(pb,null)),Ln.default.createElement(Sc,{active:e==="ReactComponent"},Ln.default.createElement(db,null)),Ln.default.createElement(Sc,{active:e==="QuickAccess"},Ln.default.createElement(ub,null)),Ln.default.createElement(Sc,{active:e==="Storage"},Ln.default.createElement(mb,null)),Ln.default.createElement(Sc,{active:e==="Icons"},Ln.default.createElement(cb,null)))},Sc=e=>{let{active:t,keepAlive:o=!1}=e;return Ln.default.createElement(x,{sx:{width:"100%",height:0,flex:1,display:t?"block":"none",padding:2,textAlign:"left"}},o||t?e.children:null)},hb=rE;var Tb=I(xb());var Wt=I(w());var yb=I(Am()),bb=I(_b()),Ib=I(Cb());var sa=I(w());var yd=Dl(e=>({message:"",type:"info",show:!1,setToast:(t,o)=>e({message:t,type:o,show:!0}),hideToast:()=>e({show:!1})})),Rh={info:e=>yd.getState().setToast(e,"info"),success:e=>yd.getState().setToast(e,"success"),error:e=>yd.getState().setToast(e,"error")},dE=()=>{let{message:e,type:t,show:o,hideToast:n}=yd(),[r,i]=(0,sa.useState)(!1);if((0,sa.useEffect)(()=>{if(o){let l=setTimeout(()=>{i(!0),setTimeout(()=>{n(),i(!1)},200)},1e3);return()=>clearTimeout(l)}},[o,n]),!o)return null;let a=()=>{switch(t){case"success":return"#4caf50";case"error":return"#f44336";default:return"#2196f3"}};return sa.default.createElement(x,{direction:"row",alignItems:"center",gap:1.5,sx:{position:"fixed",bottom:"24px",right:"24px",backgroundColor:"rgba(33, 33, 33, 0.95)",color:"#fff",padding:"10px 16px",borderRadius:"6px",zIndex:2147483701,transition:"all 0.2s ease",opacity:r?0:1,transform:r?"translateY(10px)":"translateY(0)",boxShadow:"0 4px 12px rgba(0, 0, 0, 0.15)",fontSize:"14px",fontWeight:500,minWidth:"200px",maxWidth:"400px",backdropFilter:"blur(8px)","&::before":{content:'""',position:"absolute",inset:0,borderRadius:"6px",padding:"1px",background:"linear-gradient(to bottom right, rgba(255, 255, 255, 0.2), rgba(255, 255, 255, 0.05))",WebkitMask:"linear-gradient(#fff 0 0) content-box, linear-gradient(#fff 0 0)",WebkitMaskComposite:"xor",maskComposite:"exclude"}}},(()=>{let l={sx:{color:a(),fontSize:20}};switch(t){case"success":return sa.default.createElement(yb.default,{...l});case"error":return sa.default.createElement(bb.default,{...l});default:return sa.default.createElement(Ib.default,{...l})}})(),e)},Sb=dE;var Ut=I(w());var fE={position:"fixed",border:"2px solid #1976d2",background:"rgba(25, 118, 210, 0.1)",pointerEvents:"none",zIndex:2147483700,boxSizing:"border-box",borderRadius:"4px"},hE={position:"fixed",background:"rgba(0, 0, 0, 0.8)",color:"#fff",padding:"4px 8px",borderRadius:"4px",fontSize:"12px",pointerEvents:"none",zIndex:2147483701,left:"16px",bottom:"16px",whiteSpace:"nowrap"},vb=(e,t)=>{let{sourcePathAttribute:o,tooltipConfig:n}=t,[r,i]=(0,Ut.useState)(!1),[a,s]=(0,Ut.useState)(null),l=(0,Ut.useRef)(null),p=(0,Ut.useRef)(null),u=(0,Ut.useRef)(null),c=(0,Ut.useCallback)(k=>e.querySelector('[data-testid="dev-tools-button"]')?.contains(k),[e]),m=(0,Ut.useCallback)(()=>{if(!e||l.current)return;let k=document.createElement("div");return k.id="component-highlight",Object.assign(k.style,fE),e.appendChild(k),l.current=k,k},[e]),d=(0,Ut.useCallback)(()=>{if(!e||p.current)return;let k=document.createElement("div");return k.id="component-tooltip",Object.assign(k.style,hE),e.appendChild(k),p.current=k,k},[e]),f=(0,Ut.useCallback)(k=>{let L=k.getAttribute(o);if(!L||n?.show===!1)return null;let H=L,W="\u6587\u4EF6\u8DEF\u5F84";if(!n?.attribute)return{title:W,content:H};let O=k.getAttribute(n.attribute);return O?(W=n.attribute,H=O,{title:W,content:H}):n.showDefaultInfo?{title:W,content:H}:null},[o,n]),h=(0,Ut.useCallback)(k=>{if(!e)return;let L=l.current||m(),H=p.current||d();if(!L||!H)return;let W=k.getBoundingClientRect();Object.assign(L.style,{left:`${W.left}px`,top:`${W.top}px`,width:`${W.width}px`,height:`${W.height}px`,display:"block"});let O=f(k);if(O){let{title:D,content:V}=O;H.textContent=`${D}: ${V}\uFF08\u6309 C \u590D\u5236\uFF09`,H.style.display="block",u.current=V}else u.current=null,H.style.display="none"},[e,m,d,f]),_=(0,Ut.useCallback)(k=>{if(!r||c(k.target))return;let L=k.target;s(L),h(L)},[r,h,c]),g=(0,Ut.useCallback)(()=>{l.current&&(l.current.style.display="none"),p.current&&(p.current.style.display="none")},[]),y=(0,Ut.useCallback)(()=>{i(!1),s(null),g()},[g]),C=(0,Ut.useCallback)(k=>{y(),requestAnimationFrame(()=>{window.open(k,"_blank")})},[y]),b=(0,Ut.useCallback)(k=>{!r||c(k.target)||(g(),s(null))},[r,g,c]),v=(0,Ut.useCallback)(k=>{if(!r||c(k.target))return;let H=k.target.getAttribute(o);H&&(k.stopPropagation(),k.preventDefault(),C(H))},[r,C,c,o]),S=(0,Ut.useCallback)(k=>{r&&(k.preventDefault(),k.stopPropagation(),i(!1),s(null),g())},[r,g]),P=(0,Ut.useRef)(null);return(0,Ut.useEffect)(()=>{r?Rh.success("\u5DF2\u5F00\u542F\u7EC4\u4EF6\u6620\u5C04\u5DE5\u5177"):P.current&&Rh.info("\u5DF2\u5173\u95ED\u7EC4\u4EF6\u6620\u5C04\u5DE5\u5177"),P.current=r},[r]),(0,Ut.useEffect)(()=>{let k=L=>{if(L.code==="KeyX"&&L.metaKey&&L.altKey){if(L.preventDefault(),L.stopPropagation(),L.shiftKey){i(!1),s(null),g(),l.current&&(l.current.remove(),l.current=null);return}r?(i(!1),s(null),g()):i(!0)}L.code==="KeyC"&&r&&u.current&&(L.preventDefault(),navigator.clipboard.writeText(u.current).then(()=>{let H=p.current.textContent;p.current.textContent="\u5DF2\u590D\u5236\uFF01",setTimeout(()=>{p.current&&(p.current.textContent=H)},1e3)}).catch(console.error)),L.key==="Escape"&&r&&(i(!1),s(null),g())};return window.addEventListener("keydown",k,!0),()=>{window.removeEventListener("keydown",k,!0)}},[r,g]),(0,Ut.useEffect)(()=>{if(e)return r&&(e.addEventListener("mouseover",_,!0),e.addEventListener("mouseout",b,!0),e.addEventListener("click",v,!0),e.addEventListener("contextmenu",S,!0)),()=>{e.removeEventListener("mouseover",_,!0),e.removeEventListener("mouseout",b,!0),e.removeEventListener("click",v,!0),e.removeEventListener("contextmenu",S,!0)}},[r,_,b,v,S,e]),(0,Ut.useEffect)(()=>()=>{l.current&&(l.current.remove(),l.current=null),p.current&&(p.current.remove(),p.current=null)},[]),{needOpenIDE:r,setNeedOpenIDE:i,currentHoverElement:a}};var bd="maxa-devtools-cache",cp=Dl(e=>({open:!1,setOpen:t=>e({open:t}),position:{x:0,y:0},size:{width:300,height:200},setPosition:t=>e({position:t}),setSize:t=>e({size:t})})),gE=e=>{let o=Math.max(Math.min(e.position.x,window.innerWidth-e.size.width),10),n=Math.max(Math.min(e.position.y,window.innerHeight-e.size.height),10),r=Math.min(e.size.width,window.innerWidth-10),i=Math.min(e.size.height,window.innerHeight-10);return{position:{x:o,y:n},size:{width:r,height:i}}},Uh=()=>{let e=cp(p=>p.open),t=cp(p=>p.position),o=cp(p=>p.size),n=cp(p=>p.setPosition),r=cp(p=>p.setSize),i=cp(p=>p.setOpen);return(0,Wt.useEffect)(()=>{gr.getItem(bd).then(p=>{if(p){let{position:u,size:c}=gE(p);n(u),r(c),i(p.open)}})},[]),{position:t,size:o,setPosition:p=>{n(p),gr.setItem(bd,{open:e,position:p,size:o})},setSize:p=>{r(p),gr.setItem(bd,{open:e,position:t,size:p})},setOpen:p=>{i(p),gr.setItem(bd,{open:p,position:t,size:o})},open:e}},xE=e=>{let{sx:t,...o}=e.fabProps||{},{position:n,setPosition:r}=Uh(),i=(0,Wt.useRef)(null),a=(0,Wt.useRef)(!1),s=(0,Wt.useRef)(!1),l=(0,Wt.useRef)({x:0,y:0}),p=f=>{if(i.current){a.current=!0;let h=i.current.getBoundingClientRect();l.current={x:f.clientX-h.left,y:f.clientY-h.top}}},u=()=>{s.current||e.onToolsClick()},c=(0,Wt.useCallback)(f=>{if(a.current){s.current=!0;let h=f.clientX-l.current.x,_=f.clientY-l.current.y,g=window.innerWidth-44,y=window.innerHeight-44;r({x:Math.min(Math.max(0,h),g),y:Math.min(Math.max(0,_),y)})}},[a,l,r]),m=()=>{s.current&&(s.current=!1),a.current=!1};(0,Wt.useEffect)(()=>(window.addEventListener("mousemove",c),window.addEventListener("mouseup",m),()=>{window.removeEventListener("mousemove",c),window.removeEventListener("mouseup",m)}),[c]);let d=e.onComponentToIDEClick&&e.needOpenIDE!==void 0;return Wt.default.createElement(jx,{"data-testid":"dev-tools-button",ref:i,size:"small","aria-label":"add",onMouseDown:p,sx:{color:"text.primary",backgroundColor:"background.paper","&:hover":{backgroundColor:"background.paper"},position:"fixed",left:`${n.x}px`,top:`${n.y}px`,width:"44px",height:"44px",cursor:"move",px:1,touchAction:"none",userSelect:"none",zIndex:2047483647,...t},...o},Wt.default.createElement(x,{direction:"row",alignItems:"center",justifyContent:"center",gap:1},Wt.default.createElement(Tb.default,{onMouseUp:u}),d&&Wt.default.createElement(Ky,{onMouseUp:()=>{s.current||e.onComponentToIDEClick&&e.onComponentToIDEClick()},sx:{color:e.needOpenIDE?"text.primary":"text.secondary"}})))},_E=e=>{let{open:t}=e,{position:o,size:n,setSize:r}=Uh(),i=P6(),a=(s,l,p,u)=>{let c={width:Math.min(p.offsetWidth,window.innerWidth),height:Math.min(p.offsetHeight,window.innerHeight)};r(c)};return Wt.default.createElement(x,{sx:{position:"fixed",left:`${o.x}px`,top:`${o.y}px`,zIndex:2047483646,display:t?"block":"none"}},Wt.default.createElement(ab,{ref:i,size:n,onResize:a,minWidth:100,minHeight:100,style:{position:"fixed",zIndex:2047483646,display:t?"block":"none"}},Wt.default.createElement(vn,{elevation:3,style:{width:"100%",height:"100%",overflow:"auto",boxSizing:"border-box"},sx:{padding:"36px"}},Wt.default.createElement(hb,null))))},CE={sourcePathAttribute:"debug-open-path",tooltipConfig:{attribute:"data-testid",showDefaultInfo:!1}},yE=()=>{let e=co(),{setOpen:t,open:o}=Uh(),{needOpenIDE:n,setNeedOpenIDE:r}=vb(e,CE);return Wt.default.createElement(Wt.default.Fragment,null,Wt.default.createElement(Sb,null),Wt.default.createElement(xE,{needOpenIDE:n,onToolsClick:()=>t(!o),onComponentToIDEClick:()=>r(!n),fabProps:{variant:"extended",sx:{width:"auto"}}}),Wt.default.createElement(_E,{open:o}))},bE=()=>Wt.default.createElement(Yu,null,Wt.default.createElement(yE,null)),Mb=bE;var Wh=vi({key:"ExtensionTourOnBoardingOpened",default:!lo});var pr=()=>({extensionTourOnBoardingOpened:vt(Wh)}),sj=()=>({setExtensionTourOnBoardingOpened:po(Wh)});var wb=e=>{let{sigOutMaxAIAccount:t}=n_();cn(()=>{ar.request.use(b2(async()=>{await za.checkAccessToken();let o=await za.getAccessToken();return Or&&za.isTokenExpired(o)&&(o=await za.getRefreshToken()),{userId:await cm.getUserId()||"",token:o||""}},["/app/send_mixpanel_log","/app/uplog",...Object.values(Y2),...e??[]])),ar.response.use(I2(()=>{t()}))})};var vc=class{constructor(){this.cacheStorage=new ch({saveKey:"MAXAI_CLIENT__FEATURES__MARKETING__REWARDS_STATUS",cacheTime:ch.DAILY*2})}async fetchRewardDashboard(){let t=await ar.fetch("/user/get_referral_dashboard",{method:"GET"});return t.success&&t.data?.data?t.data.data:null}async getRewardDashboard(t=!1){let o=await this.cacheStorage.get();if(t||o.expired){let n=await this.fetchRewardDashboard();n&&(o.data=n,await this.cacheStorage.sync(n))}return o.data}async uploadRewardScreenshot(t){let o=Date.now(),n=new FormData;n.append("file",t);let{success:r,message:i}=await ar.fetch("/app/upload_review_screenshot",{method:"POST",body:n}),a=Date.now()-o;a<J1.SECOND*2&&await new Promise(l=>setTimeout(l,J1.SECOND*2-a)),r&&await cc.refreshModelUsage();let s=await this.getRewardDashboard(r);return{success:r,data:s,message:i}}async clearRewardDashboard(){await this.cacheStorage.clear()}};Tx([X2({cacheArgs:!0})],vc.prototype,"getRewardDashboard",1);var Tc=new vc;var Mc=I(w());var qs=Dl(e=>({loading:!1,dashboard:null,setLoading:t=>e({loading:t}),setDashboard:t=>e({dashboard:t})})),IE=()=>qs(),SE=()=>{let{loadModelUsage:e}=mm(),t=(0,Mc.useCallback)(async()=>{qs.setState({loading:!0});let i=await Tc.getRewardDashboard();qs.setState({loading:!1,dashboard:i})},[]),o=(0,Mc.useCallback)(async()=>{qs.setState({loading:!0});let i=await Tc.getRewardDashboard(!0);qs.setState({loading:!1,dashboard:i})},[]),n=(0,Mc.useCallback)(async()=>{await Tc.clearRewardDashboard(),qs.setState({loading:!1,dashboard:null})},[]),r=(0,Mc.useCallback)(async i=>{let{success:a,data:s,message:l}=await Tc.uploadRewardScreenshot(i);return a?e():oo.error(l),qs.setState({dashboard:s}),{success:a,data:s,message:l}},[]);return{loadRewardDashboard:t,refreshRewardDashboard:o,clearRewardDashboard:n,uploadRewardScreenshot:r}},Eb=()=>{let e=IE(),t=SE();return{...e,...t}};var Ab=I(w()),Pb=()=>{let{loading:e,dashboard:t,loadRewardDashboard:o,refreshRewardDashboard:n,clearRewardDashboard:r}=Eb(),i=Ke({loading:e,dashboard:t});(0,Ab.useEffect)(()=>{o();let a=(s,l)=>{l.proChatReward&&!i.current.loading&&!i.current.dashboard?.is_webstore_commented&&n()};return cc.addListener("onUsageChange",a),()=>{cc.removeListener("onUsageChange",a)}},[]),wy(()=>{n()}),Ey(()=>{r()})};var Sn=I(w());var MI=I(TI());var VP=()=>{let e=new Map,t=new ym,o=async(n,r,i)=>{await t.postMessage({event:"Client_ListenProxyWebsocketResponse",data:{data:r,taskId:n,listenerType:i}})};Zm(async(n,r)=>{switch(n){case"Client_ListenProxyWebsocket":{let{taskId:i,data:a,type:s}=r;switch(s){case"Open":{let l=new MI.default(a.url,{});return l.onUnpackedMessage.addListener(p=>{o(i,p,"onUnpackedMessage")}),l.onMessage.addListener(async p=>{o(i,p,"onMessage")}),l.onClose.addListener(()=>{o(i,{},"onClose")}),await l.open(),e.set(i,l),{success:!0,data:"success",message:"ok"}}break;case"Close":{let l=e.get(i);return l?(l.removeAllListeners(),await l.close(),e.delete(i),{success:!0,data:"success",message:"ok"}):{success:!1,message:"websocket not found",data:!1}}break;case"SendPacked":{let l=e.get(i);return l?(l.sendPacked(a),{success:!0,data:"success",message:"ok"}):{success:!1,message:"websocket not found",data:!1}}break;default:return{success:!0,data:"success",message:"ok"}}}break}})},wI=VP;var xp=I(w());var EI=(e,t)=>{for(let o=e.length-1;o>=0;o--){let n=e[o];if(t(n))return n}};var AI=()=>{let e=(0,xp.useRef)(!1),{conversationMessages:t,conversationIdRef:o}=Bi(),{createMessage:n}=Di(),r=(0,xp.useRef)(!1),i=(0,xp.useRef)("");return h_(a=>{a.name!=="free"&&(r.current=!0,a.name==="elite"?i.current="You have successfully upgraded to MaxAI Elite.":a.name==="pro"?i.current="You have successfully upgraded to MaxAI Pro.":a.name==="basic"&&(i.current="You have successfully upgraded to MaxAI Basic."))}),(0,xp.useEffect)(()=>{!r.current||!i.current||e.current||o.current&&!EI(t,a=>a.text==="You have successfully upgraded to MaxAI Elite."||a.text==="You have successfully upgraded to MaxAI Pro."||a.text==="You have successfully upgraded to MaxAI Basic.")&&n(o.current,{messageId:Bo(),type:"system",parentMessageId:void 0,text:i.current,meta:{status:"success"}}).then().catch().finally(()=>{e.current=!0})},[t]),null};var jd=I(w()),PI={},yg=jd.default.createContext({}),kI=()=>(0,jd.useContext)(yg);var OI=I(Mi());var di=I(w()),RP=e=>{let{children:t,onClick:o,link:n,dataTestId:r,tooltip:i,tooltipProps:a,...s}=e,[l,p]=(0,di.useState)(!1),u=dm("maxai-animation-hover-left-bottom-slide-in",{duration:200});return di.default.createElement(he,{title:i,...a},di.default.createElement(B,null,di.default.createElement(ce,{"data-testid":r,component:n?"a":"button",...n?{href:n,target:"_blank"}:{},sx:{minWidth:"unset",textAlign:"center",color:"text.primary",opacity:.55,"&:hover":{opacity:1},[`& .${Hx.root}`]:{borderRadius:"7px"}},onClick:o,onMouseEnter:()=>p(!0),onMouseLeave:()=>p(!1),...s},di.default.createElement(T,{component:"h2",sx:{fontSize:"12px",fontWeight:400,lineHeight:"150%"}},t),l?di.default.createElement(OI.default,{sx:{ml:"4px",fontSize:"16px",color:"inherit",...u}},di.default.createElement("svg",{width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg"},di.default.createElement("path",{d:"M4.03076 11.9679L11.9687 4.02991M11.9687 4.02991H5.51913M11.9687 4.02991V10.2039",stroke:"currentColor",strokeWidth:"1.24031",strokeLinecap:"round",strokeLinejoin:"round"}))):di.default.createElement(B,{sx:{width:"20px",height:"16px"}}))))},bg=RP;var Kd=I(w()),UP=e=>{let{sx:t}=e,{t:o}=E();return Kd.default.createElement(x,{direction:"row",flexWrap:"wrap",alignItems:"center",justifyContent:"center",sx:{position:"absolute",bottom:"16px",left:"50%",transform:"translateX(-50%)",zIndex:1502,...t}},Kd.default.createElement(bg,{dataTestId:"maxai--chat-home-view--chat-with-any-content--write",link:`${nr}/ai-writing-tools/`},o("package__features:home_view__chat_with_any_content__tab__write__title")),Kd.default.createElement(bg,{dataTestId:"maxai--chat-home-view--chat-with-any-content--create-image",link:`${nr}/ai-tools/ai-art/`},o("package__features:home_view__chat_with_any_content__tab__create_image__title")))},qd=UP;var Gt=I(w());var WP=30*1e3,BI=async(e,t)=>{let{signal:o}=t||{};try{let n=new FormData;n.append("audio_file",e),n.append("feature_name",Or?"immersive_chat":"sidebar"),n.append("prompt_name","Use microphone"),n.append("event_source",p_);let r=new AbortController,i=r.signal;return new Promise(a=>{let s=setTimeout(()=>{r.abort()},WP);ar.fetch("/gpt/speech_to_text",{signal:o?AbortSignal.any([i,o]):i,method:"POST",body:n}).then(async l=>{clearTimeout(s);let p=await l.data;p.status!=="OK"&&a({status:"error",data:{speechText:""},error:p.detail||""}),a({status:"success",data:{speechText:p?.data?.speech_text||""}})}).catch(l=>{if(l.name==="AbortError"){a({status:"timeout",data:{speechText:""}});return}clearTimeout(s),a({status:"error",data:{speechText:""}})})})}catch{return{status:"error",data:{speechText:""}}}};var yr=I(w()),GP=(e,t,o)=>{let[n,r]=(0,yr.useState)(!1),[i,a]=(0,yr.useState)(!1),[s,l]=(0,yr.useState)(0),[p,u]=(0,yr.useState)(),[c,m]=(0,yr.useState)(),[d,f]=(0,yr.useState)(),h=(0,yr.useCallback)(()=>{let b=setInterval(()=>{l(v=>v+1)},1e3);m(b)},[l,m]),_=(0,yr.useCallback)(()=>{c!=null&&clearInterval(c),m(void 0)},[c,m]),g=(0,yr.useCallback)(()=>{c==null&&navigator.mediaDevices.getUserMedia({audio:e??!0}).then(b=>{r(!0);let v=new MediaRecorder(b,o);u(v),v.start(),h(),v.addEventListener("dataavailable",S=>{f(S.data),v.stream.getTracks().forEach(P=>P.stop()),u(void 0)})}).catch(b=>{t?.(b)})},[c,r,u,h,f,t,o]),y=(0,yr.useCallback)(()=>{p?.stop(),_(),l(0),r(!1),a(!1)},[p,l,r,a,_]),C=(0,yr.useCallback)(()=>{i?(a(!1),p?.resume(),h()):(a(!0),_(),p?.pause())},[p,a,h,_]);return{startRecording:g,stopRecording:y,togglePauseResume:C,recordingBlob:d,isRecording:n,isPaused:i,recordingTime:s,mediaRecorder:p}},DI=GP;var zo=I(w()),jP=({stream:e,boxStyle:t,barStyle:o,leftMaskStyle:n,rightMaskStyle:r,barWidth:i=2,barGap:a=2})=>{let s=(0,zo.useRef)(null),[l,p]=(0,zo.useState)([]),u=(0,zo.useRef)([]),c=(0,zo.useRef)(0),{isDarkMode:m,theme:{palette:d}}=lr();(0,zo.useEffect)(()=>{if(!s.current)return;let g=()=>{if(s.current){let b=s.current.clientWidth,v=i+a,S=Math.floor(b/v);if(c.current===0){let P=Array(S).fill({type:"idle",volume:8});p(P),u.current=[...P],c.current=S}else if(S!==c.current){let P=[...u.current];if(S>c.current){let k={type:"idle",volume:8},W=[...Array(S-c.current).fill(k),...P].slice(-S);p(W),u.current=W}else{let k=P.slice(-S);p(k),u.current=k}c.current=S}}};g();let y=new ResizeObserver(g),C=s.current;return y.observe(C),()=>{C&&y.unobserve(C),y.disconnect()}},[i,a]);let f=(0,zo.useRef)(new Uint8Array(0));(0,zo.useEffect)(()=>{if(!e)return;let g=window.AudioContext||window.webkitAudioContext,y=new g,C=y.createMediaStreamSource(e),b=y.createAnalyser();b.fftSize=2048,b.smoothingTimeConstant=.5,f.current=new Uint8Array(b.frequencyBinCount),C.connect(b);let v,S=()=>{b.getByteFrequencyData(f.current);let P={type:"idle",volume:3},k=14,L=Math.min(140,f.current.length-1),H=0,W=0;for(let Y=k;Y<=L;Y++)H+=f.current[Y],W++;let O=W>0?H/W:0,D=8,V=24,N=V-D,z=O/255,G=Math.pow(z,.8),q=Math.max(D,Math.min(V,D+Math.round(N*G)));P.type="recording",P.volume=q;let A=u.current;A.length!==0&&(A.shift(),A.push(P),p([...A]),v=requestAnimationFrame(S))};return v=requestAnimationFrame(S),()=>{cancelAnimationFrame(v),b.disconnect(),C.disconnect(),y.close().catch(console.error)}},[e]);let h=(0,zo.useMemo)(()=>wh(d.background.paper,0),[d.background.paper]),_=(0,zo.useMemo)(()=>wh(d.background.paper,1),[d.background.paper]);return zo.default.createElement("div",{ref:s,style:{flex:1,height:"32px",display:"flex",alignItems:"center",position:"relative",overflow:"hidden",gap:`${a}px`,...t}},l.map((g,y)=>{let C=m?"rgba(255, 255, 255, 0.08)":"rgba(0, 0, 0, 0.08)",b=g.type==="recording";return zo.default.createElement("div",{key:y,style:{width:`${i}px`,height:`${g.volume}px`,backgroundColor:b?d.primary.main:C,borderRadius:"1px",flexShrink:0,...o}})}),zo.default.createElement("div",{style:{position:"absolute",left:0,top:0,width:"12px",height:"100%",background:`linear-gradient(to left, ${h}, ${_})`,pointerEvents:"none",...n}}),zo.default.createElement("div",{style:{position:"absolute",right:0,top:0,width:"12px",height:"100%",background:`linear-gradient(to right, ${h}, ${_})`,pointerEvents:"none",...r}}))},FI=(0,zo.memo)(jP);var VI=I(ir()),RI=I(HI());var Re=I(w()),UI=I(ec());var _p=I(w()),NI=(0,_p.createContext)({isVoiceInput:!1,setIsVoiceInput:()=>{},isUseInternalState:!0}),zI=()=>(0,_p.useContext)(NI),ps=({children:e,value:t})=>_p.default.createElement(NI.Provider,{value:t},e);var XP=6*60,Ig=e=>e===3||e===4||e===5||e===6,YP=async(e,t,o={canceled:!1})=>{let r=new Set,i=window.AudioContext||window.webkitAudioContext,a=new i,s=a.createMediaStreamSource(e),l=a.createAnalyser();l.fftSize=2048,s.connect(l);let p=new Uint8Array(l.frequencyBinCount),u=!1,c=()=>{l.getByteTimeDomainData(p);for(let f of Array.from(p))if(r.add(f),f>138||f<118){u=!0;break}},m=a.currentTime,d=t;return new Promise(f=>{let h=()=>{if(c(),u||a.currentTime-m>=d||o.canceled){a.close(),f(u);return}setTimeout(h,100)};h()})},ZP="max-ai__actions__button--voice-input",QP=e=>{let{sx:t,onStartRecording:o,onStopRecording:n,onVoiceInputStatusChange:r,onSpeechToTextSuccess:i,onSpeechToTextFinally:a,disabled:s,...l}=e,{t:p}=E(),{conversationId:u,inputMediator:c}=_e(),m=xe(u),[d,f]=(0,Re.useState)(""),[h,_]=(0,Re.useState)(!1),[g,y]=(0,Re.useState)(0),{startRecording:C,stopRecording:b,recordingBlob:v,isRecording:S,mediaRecorder:P,recordingTime:k}=DI(void 0,()=>{y(3)}),L=(0,Re.useRef)(0);k&&(L.current=k);let H=Ke(r),W=(0,Re.useRef)(new AbortController),O=(0,Re.useMemo)(()=>({0:p("package__features:chat__inputbox__button__voice_input__idle__tooltip"),1:p("package__features:chat__inputbox__button__voice_input__done__tooltip"),2:p("package__features:chat__inputbox__button__voice_input__transcribing__tooltip"),3:p("package__features:chat__inputbox__button__voice_input__permission_denied__tooltip"),4:p("package__features:chat__inputbox__button__voice_input__no_speech__tooltip"),5:p("package__features:chat__inputbox__button__voice_input__timeout__tooltip"),6:d})[g],[g,d,p]),D=(0,Re.useMemo)(()=>Ig(g)||h,[g,h]),V=(0,Re.useRef)(!1),N=(0,Re.useRef)(g),z=(0,Re.useRef)(!1),j=(0,Re.useRef)(null),G=(0,Re.useCallback)(()=>{j.current&&(j.current.getTracks().forEach(Ze=>Ze.stop()),j.current=null)},[]),q=Ke(o),A=(0,Re.useCallback)(async()=>{try{if(z.current)return;z.current=!0,j.current=await navigator.mediaDevices.getUserMedia({audio:!0}),z.current=!1,L.current=0,W.current=new AbortController,C(),y(1),q.current?.()}catch{y(3),z.current=!1}},[q,C]),Y=Ke(n),Q=(0,Re.useCallback)(Ze=>{b(),G(),y(2),Y.current?.(Ze)},[Y,b,G]),M=async()=>{S?Q("done"):await A()},K=async Ze=>{Ze.key==="Enter"?S?Q("done"):await A():Ze.key==="Escape"&&S&&(b(),G(),y(0),Y.current?.("cancel"),Ze.stopPropagation())},F=()=>{_(!0)},pe=()=>{_(!1)};(0,Re.useEffect)(()=>{if(N.current=g,Ig(g)){let Ze=setTimeout(()=>{y(dt=>Ig(dt)?0:dt)},3e3);return()=>{clearTimeout(Ze)}}},[g]),(0,Re.useEffect)(()=>{H.current?.(g)},[H,g]),(0,Re.useEffect)(()=>{if(S&&P){let Ze=XP,dt=setInterval(()=>{Ze--,Ze<=0&&S&&Q("timeout")},1e3),It={canceled:!1};return YP(P.stream,5,It).then(Zt=>{Zt||(y(pt=>pt===1?4:pt),b(),G(),N.current!==2&&Y.current?.("timeout"))}).catch(Zt=>{}),()=>{It.canceled=!0,clearTimeout(dt)}}},[Q,S,P,b,G,Y]);let ae=Ke(i),te=Ke(a);(0,Re.useEffect)(()=>{if(v&&g===2&&!V.current){V.current=!0;let Ze=new File([v],"audio.webm",{type:"audio/webm"});BI(Ze,{signal:W.current.signal}).then(dt=>{if(dt.status==="success"){let It=dt.data.speechText;ae.current?ae.current(It):c.updateInputValue(c.getInputValue()+It),(0,UI.flushSync)(()=>{y(0)})}else dt.status==="timeout"?y(5):dt.error?(f(dt.error),y(6)):y(0)}).catch().finally(()=>{V.current=!1,te.current?.()})}},[c,ae,te,v,g]);let Te=(0,Re.useMemo)(()=>({height:"30px"}),[]),Ie=g!==0&&g!==3&&g!==4,Nt=g===2,{isVoiceInput:lt,setIsVoiceInput:Le,isUseInternalState:nt}=zI();(0,Re.useEffect)(()=>{Le(Ie)},[Ie,Le]);let At=nt?Ie:lt;return m?null:Re.default.createElement(x,{direction:"row",spacing:1,flex:At?1:void 0,justifyContent:"flex-end",overflow:"hidden"},At&&Re.default.createElement(Re.default.Fragment,null,Re.default.createElement(ne,{title:p("package__common:cancel"),placement:"top",variant:"secondary",onClick:()=>{W.current.abort(),b(),G(),y(0),Y.current?.("cancel")}},Re.default.createElement(VI.default,null)),Re.default.createElement(x,{direction:"row",gap:1,sx:{flex:1,alignItems:"center",justifyContent:"center",height:"32px",overflow:"hidden"}},Re.default.createElement(FI,{stream:P?.stream,boxStyle:Te}),Re.default.createElement(T,{sx:{fontSize:"14px",color:"text.primary"}},dC(L.current)))),Re.default.createElement(he,{key:g,title:O,open:D,onOpen:F,onClose:pe,disableInteractive:!0},Re.default.createElement("span",null,Re.default.createElement(si,{onKeyDownCapture:K,tabIndex:-1,loading:Nt,onClick:M,id:"MaxAISidebarVoiceInputButton",variant:"contained","data-testid":ZP,disabled:Nt||s,sx:{width:32,height:32,minWidth:"unset",borderRadius:1,boxSizing:"border-box",boxShadow:"none",[`&.${mh.loading}`]:{backgroundColor:"transparent"},[`& .${mh.loadingIndicator}`]:{color:"text.secondary"},...t},...l},At?Re.default.createElement(U,{icon:"Done",sx:{color:"inherit!important",fontSize:"20px"}}):Re.default.createElement(RI.default,{sx:{color:"inherit!important",fontSize:"20px"}})))))},Cp=QP;var WI=I(Vc()),GI=I(Sg()),Ys=I(w()),ik=e=>{let{onSpeechToTextSuccess:t,voiceButtonProps:o,loading:n,inputMediator:r,onSend:i,...a}=e,{t:s}=E(),{conversationId:l}=_e(),p=xe(l),u=ql(r),{askAIQuestionV2:c,stopGenerate:m}=Ne(),d=u.getInputValue(),{localSettings:f}=yt(),{loading:h}=$a(),{loading:_}=gy(),g=n||p,y=async()=>{if(!await Fe({emitEvent:!0})){u.focus();return}h||_||(g?m?.():d&&(await c({type:"user",text:d,meta:{includeHistory:!0}}),i?.()))},C=(0,Ys.useRef)(null);return f.chatMode==="pro_chat"&&d===""&&!g?Ys.default.createElement(Cp,{onSpeechToTextSuccess:t,...o}):Ys.default.createElement(ne,{title:h||_?"":s(g?"package__features:chat__inputbox__button__stop_generating__tooltip":"package__features:chat__inputbox__button__send_to_ai__tooltip"),description:g?void 0:"\u23CE",tooltipProps:{controlsRef:C,sx:{minWidth:"unset",p:1},disableInteractive:!0},onBlur:()=>{C.current?.closeTooltip()},variant:"contained","data-testid":"sidebar_actions__send_btn",sx:{width:32,height:32,minWidth:"unset",borderRadius:1,boxSizing:"border-box","&[disabled]":{color:"background.paper"},"&:hover":{color:b=>b.palette.mode==="dark"?"rgba(0, 0, 0, 0.87)":"rgba(255, 255, 255, 1)"}},disabled:h||_||!d&&!g,onClick:y,styleType:"default",...a},g?Ys.default.createElement(GI.default,{sx:{fontSize:"16px",color:"inherit !important"}}):Ys.default.createElement(WI.default,{sx:{fontSize:"16px",color:"inherit !important"}}))},yp=ik;var dn=I(w()),cs=24,vg=0,ak=e=>{let t=e||window.innerHeight*.4;return Math.max(Math.floor(t/cs),5)},Rc=(e,t)=>{let o=e?.parentElement;if(e&&o){let n=window.getComputedStyle(e),r=Number(e.getAttribute("data-min-line"))||1,i=parseInt(n.paddingTop??vg,10)+parseInt(n.paddingBottom??vg,10);e.style.cssText="height:0px";let a=e.value?e.scrollHeight:cs*r+i,s=e?.previousElementSibling?.offsetHeight||0,l=Math.min(cs*ak(t),a),p=Math.max(cs*r+i,s),u=Math.max(p,l);e.style.cssText=`height: ${u}px`,o.style.cssText=`height: ${u}px`}},sk=(e,t)=>{Rc(e,t),setTimeout(()=>{if(Rc(e,t),!e)return;let o=e.value;e.focus(),e.setSelectionRange(o.length,o.length)},100)},lk=(e,t)=>{if(!e)return;let o=document.querySelector('div[data-testid=sentinelStart][tabindex="0"]');if(o?.nextElementSibling&&o.nextElementSibling.getAttribute("tabindex")==="-1"&&o.nextElementSibling.removeAttribute("tabindex"),window.location.host==="www.linkedin.com"){let r=document.querySelector('div[tabindex="-1"][role="dialog"]');r&&(r.removeAttribute("tabindex"),document.activeElement?.blur(),setTimeout(()=>{r.setAttribute("tabindex","-1")},100))}let n=document.activeElement;n?.shadowRoot&&(n=n.shadowRoot.activeElement),(!n||!e.isSameNode(n))&&sk(e,t)},jI=(0,dn.forwardRef)((e,t)=>{let{t:o}=E(),{loading:n,value:r,placeholder:i=o("package__features:chat__input__chat__placeholder"),onChange:a,onChangeText:s,onPasteFiles:l,onPaste:p,onEnter:u,sx:c,stopPropagation:m=!0,minLine:d=1,maxHeight:f,...h}=e,_=(0,dn.useRef)(null),g=T_(_,t),y=(0,dn.useRef)(!1),C=(0,dn.useMemo)(()=>li(Rc,200),[]),b=(0,dn.useCallback)(v=>{let S=v.target.value;a?.(v),s?.(S)},[a,s]);return(0,dn.useEffect)(()=>{C(_.current,f);let v=setTimeout(()=>{Rc(_.current,f)},0);return()=>clearTimeout(v)},[r,f,C]),(0,dn.useEffect)(()=>{let v=()=>{Rc(_.current,f)};return window.addEventListener("resize",v),()=>{window.removeEventListener("resize",v)}},[f]),dn.default.createElement(B,{component:"div",className:n?"chat-box__input--loading":"",borderRadius:1,width:"100%",minHeight:cs*d+vg*2,sx:{overflow:"hidden","& .chat-box__input-skeleton":{opacity:0,zIndex:-1,position:"absolute",top:0,padding:"8px",left:0,width:"100%",display:"none"},"&.chat-box__input--loading":{maxHeight:"106.5px",overflow:"hidden",position:"relative","& textarea":{opacity:0},"& .chat-box__input-skeleton":{opacity:1,zIndex:1,display:"block"}},...c}},dn.default.createElement(B,{component:"div",className:"chat-box__input-skeleton"},dn.default.createElement(vo,{height:cs})),dn.default.createElement(B,{component:"textarea",sx:{boxSizing:"border-box",display:"block",maxHeight:n?cs*d+16:"unset",color:v=>v.palette.mode==="dark"?"#fff":"rgba(0,0,0,.87)!important",fontSize:"16px",lineHeight:cs+"px",background:"transparent!important",borderColor:"transparent!important",margin:"0!important",border:"0!important",outline:"0!important",boxShadow:"none!important",width:"100%",resize:"none",overflow:"hidden",overflowY:"auto",fontFamily:'"Roboto","Helvetica","Arial",sans-serif!important',"&::placeholder":{fontWeight:"400",color:v=>v.palette.mode==="dark"?"rgba(255, 255, 255, 0.38)":"rgba(0, 0, 0, 0.38)"},"&::-webkit-scrollbar":{width:0,background:"transparent"},"&::-webkit-scrollbar-thumb":{background:"transparent"}},placeholder:i,disabled:n,ref:g,value:r,rows:1,"data-min-line":d,onCopy:v=>{v.stopPropagation()},onCut:v=>{v.stopPropagation()},onPaste:v=>{if(v.stopPropagation(),p&&p(v),l){let S=v.clipboardData,P=Array.from(S?.items||[]).map(k=>k.getAsFile?.()).filter(k=>k!==null);P&&P.length>0&&(v.preventDefault(),l(P,v))}},onKeyUp:v=>{m&&v.stopPropagation()},onKeyPress:v=>{m&&v.stopPropagation()},onKeyDown:v=>{if(m&&v.stopPropagation(),!y.current&&!(v.key==="Enter"&&v.shiftKey)){if(v.key==="Enter"){v.preventDefault();let S=v.currentTarget.value;u?.(S)}else if(v.code==="Space"){v.stopPropagation();return}}},onClick:v=>{lk(v.currentTarget,f)},onCompositionUpdate:v=>{m&&v.stopPropagation()},onCompositionStart:v=>{m&&v.stopPropagation(),y.current=!0},onCompositionEnd:v=>{m&&v.stopPropagation(),y.current=!1,b(v)},onInput:v=>{m&&v.stopPropagation(),y.current?s?.(v.currentTarget.value):b(v)},onBlur:v=>{C(v.currentTarget,f)},...h}))});jI.displayName="AutoHeightTextarea";var bp=jI;var Zd=class{async sendUserAction(t,o){let n=await ar.fetch("/user/send_user_action",{method:"POST",body:JSON.stringify({action:t,...o})});return n.data?.paywall&&(n.data.info&&(n.data.paywall.info=n.data.info),Object.keys(n.data.paywall).forEach(r=>{let i=r,a=n.data?.paywall?.[i]||{};Object.keys(a).length===0&&delete n.data?.paywall?.[i]})),n.data}};var pk=new Zd,Zs=pk;var qI=I(KI());var we=I(w()),dk=(e,t)=>e.left<=t.right&&e.right>=t.left&&e.top<=t.bottom&&e.bottom>=t.top,fk=(e,t)=>!(e.left>=t.left&&e.right<=t.right&&e.top>=t.top&&e.bottom<=t.bottom),hk=e=>{let{total:t,remaining:o}=e;return we.default.createElement(x,{direction:"row",sx:{width:"100%",gap:"2px"}},Array.from({length:t},(n,r)=>we.default.createElement(B,{key:r,sx:{flex:1,height:"4px",bgcolor:i=>i.palette.mode==="light"?r<o?"primary.main":"#d9d9d9":r<o?"primary.main":"#4f4f4f",borderRadius:"2px"}})))},gk=e=>{let{total:t,remaining:o}=e;return we.default.createElement(B,{position:"relative"},we.default.createElement(B,{sx:{flex:1,height:"4px",bgcolor:n=>n.palette.mode==="light"?"#d9d9d9":"#4f4f4f",borderRadius:"2px"}}),we.default.createElement(B,{sx:{position:"absolute",top:0,width:`${o/t*100}%`,height:"4px",bgcolor:"primary.main",borderRadius:"2px"}}))},Tg=()=>{let{t:e}=E(),{modelUsage:t}=Ai(),{showPricingHooksPopup:o}=Fl(),n=re(r=>r.conversationIds[0]);return we.default.createElement(x,{sx:{gap:"8px",width:"100%"}},we.default.createElement(T,{sx:{fontSize:"18px",fontWeight:500,color:"text.primary",textAlign:"left",lineHeight:1.5}},"Pro chat"),we.default.createElement(T,{sx:{fontSize:"14px",fontWeight:400,color:"text.secondary",textAlign:"left",lineHeight:1.4}},e("package__features:chat__pro_chat_switch__usage_card__description")),we.default.createElement(x,{sx:{padding:"8px 0 16px 0",gap:"8px",width:"100%"}},t.proChatReward?we.default.createElement(we.default.Fragment,null,we.default.createElement(gk,{total:pm+sh,remaining:t.proChat+t.proChatReward}),we.default.createElement(x,{direction:"row",alignItems:"center",gap:1},we.default.createElement(T,{sx:{fontSize:"14px",fontWeight:400,color:t.proChat+t.proChatReward<=0?"#f44336":"text.secondary",textAlign:"left",lineHeight:1.4}},e("package__features:chat__pro_chat_switch__usage_card__daily_left_single__title",{LEFT_COUNT:t.proChat+t.proChatReward,NAME:t.proChat+t.proChatReward<=1?"Pro chat":"Pro chats"})),we.default.createElement(d2,{title:we.default.createElement(x,{minWidth:250},we.default.createElement(T,{fontSize:"14px",fontWeight:600,mb:1},e("package__features:chat__pro_chat_switch__usage_card__daily_left_single__title",{LEFT_COUNT:"",NAME:"Pro chats"})),we.default.createElement(x,{direction:"row",justifyContent:"space-between",gap:1,mb:.5},we.default.createElement(T,{fontSize:"14px",color:"rgba(255, 255, 255, 0.7)"},e("package__features:chat__pro_chat_switch__usage_card__daily_free__title")),we.default.createElement(T,{fontSize:"14px",color:"rgba(255, 255, 255, 0.7)"},t.proChat," / ",pm)),we.default.createElement(x,{direction:"row",justifyContent:"space-between",gap:1},we.default.createElement(T,{fontSize:"14px",color:"rgba(255, 255, 255, 0.7)"},e("package__features:chat__pro_chat_switch__usage_card__rewarded__title")),we.default.createElement(T,{fontSize:"14px",color:"rgba(255, 255, 255, 0.7)"},t.proChatReward," /"," ",sh))),arrow:!0},we.default.createElement(qI.default,{sx:{fontSize:18,color:"text.secondary"}})))):we.default.createElement(we.default.Fragment,null,we.default.createElement(hk,{total:pm,remaining:t.proChat}),we.default.createElement(T,{sx:{fontSize:"14px",fontWeight:400,color:t.proChat<=0?"#f44336":"text.secondary",textAlign:"left",lineHeight:1.4}},e("package__features:chat__pro_chat_switch__usage_card__daily_left_single__title",{LEFT_COUNT:t.proChat,NAME:t.proChat<=1?"Pro chat":"Pro chats"})))),we.default.createElement(ce,{variant:"contained",sx:{width:"100%",minHeight:"44px",gap:1},onClick:async r=>{Us("click",{paywallType:"pro_chat_card",paywallReason:"ProChat",buttonType:"upgrade",targetElement:r?.currentTarget});let i=await Zs.sendUserAction("click_upgrade_cta_pro_chat");i?.paywall&&o(n,i.paywall,"pro_chat_modal")}},we.default.createElement(Ju,{sx:{fontSize:"20px",color:"inherit"}}),we.default.createElement(T,{sx:{fontSize:"16x",fontWeight:500,textAlign:"left",color:"inherit"}},e("package__features:chat__pro_chat_switch__usage_card__button__upgrade",{NAME:"Pro chat"}))))},xk=e=>{let{children:t}=e,[o,n]=(0,we.useState)("bottom-start"),r=(0,we.useMemo)(()=>Zx(o,8),[o]),i=we.default.useRef(null),a=we.default.useRef(null),[s,l]=we.default.useState(!1),p=we.default.useRef({width:320,height:240}),{paywallShowDebounce:u}=Wa(),c=()=>{let m=p.current;if(i.current){let d=i.current.getBoundingClientRect(),f={left:0,right:window.innerWidth,top:0,bottom:window.innerHeight},_=[{placement:"bottom-start",top:d.bottom+8,bottom:d.bottom+m.height+8,left:d.left,right:m.width+d.left},{placement:"top-start",top:d.top-m.height-8,bottom:d.top-8,left:d.left,right:m.width+d.left},{placement:"left",left:d.left-m.width-8,right:d.left-8,top:d.top-m.height/2-20,bottom:d.top+m.height/2},{placement:"right",...m,left:d.right+8,right:d.right+m.width+8,top:d.top-m.height/2,bottom:d.top+m.height/2},{placement:"left",left:d.left-m.width-8,right:d.left-8,top:0,bottom:m.height},{placement:"right",...m,left:d.right+8,right:d.right+m.width+8,top:0,bottom:m.height}].find(g=>!fk(g,f)&&!dk(g,d));n(_?.placement||"top")}};return(0,we.useEffect)(()=>{s&&u({paywallType:"pro_chat_card",paywallReason:"ProChat"})},[s,u]),we.default.createElement(e2,{popupId:"maxai_client__features__chat__pro_chat_switch",variant:"popover",disableAutoFocus:!0},m=>{let d=Jx(m);return l(d.open),d.open&&c(),we.default.createElement("div",null,we.default.createElement("div",{ref:i,...Qx(m),onMouseEnter:()=>{c()}},t),we.default.createElement(t2,{...d,anchorOrigin:r.anchorOrigin,transformOrigin:r.transformOrigin,disableScrollLock:!0,slotProps:{paper:{elevation:0,sx:{background:"transparent",overflow:"unset"}}}},we.default.createElement(vn,{ref:a,elevation:0,sx:{width:"280px",padding:"16px",marginBottom:"6px",border:"1px solid",borderColor:"border.main",boxShadow:"0px 0px 1px 0px rgba(0, 0, 0, 0.20), 0px 0px 16px 0px rgba(0, 0, 0, 0.10), 0px 16px 24px 0px rgba(0, 0, 0, 0.08);"}},we.default.createElement(Tg,null))))})},$I=xk;var Mg=I(w()),_k=()=>{let e=re(m=>m.conversationIds[0]),{localSettings:t,setLocalSettings:o}=yt(),{isFreeUser:n}=Tt(),{modelUsage:r,refreshModelUsage:i}=Ai(),{showPricingHooksPopup:a}=Fl(),s=(0,Mg.useRef)(null),l=(0,Mg.useRef)(!1),{paywallShow:p}=Wa(),u=async m=>(l.current=!1,new Promise(d=>{s.current=setTimeout(()=>{Zs.sendUserAction("turn_on_pro_chat_mode").then(f=>{l.current||(f?.paywall?(a(e,f.paywall),p({paywallType:"modal",paywallReason:"ProChat"}),o({chatMode:"free_chat"}),d(!1)):(i(),d(!0)))})},m)})),c=async(m,d)=>{let{asyncConfirm:f=!0,asyncConfirmDelay:h=100}=d||{};return await Fe({emitEvent:!0})?(l.current=!0,s.current&&clearTimeout(s.current),m==="pro_chat"?(await o({chatMode:"pro_chat"}),n&&f&&r.proChat===0&&r.proChatReward===0?await u(h):!0):(await o({chatMode:m}),!0)):!1};return{chatMode:t.chatMode,updateChatMode:c}},us=_k;var la=I(w());var Ck=e=>{let{anchorElementSelectors:t='[data-testid="maxai--chat-pro-chat-switch"]',placement:o="top-start",onTryIt:n,...r}=e,{t:i}=E(),{modelUsage:a}=Ai(),{isPayingUser:s}=Tt(),{localSettings:l}=yt(),[p,u]=(0,la.useState)(!1),[c,m]=la.default.useState(!0),{extensionTourOnBoardingOpened:d}=pr();return(0,la.useEffect)(()=>{d&&Ge.getOnboardingDataByKey("ON_BOARDING__RECORD_FIRST_AUTO_CLOSE_PRO_CHAT_SWITCH_TOOLTIP").then(f=>m(!!f))},[d]),(0,la.useEffect)(()=>{let f=!1;return!s&&a.proChat===0&&a.proChatReward===0&&l.chatMode==="free_chat"&&Ge.getOnboardingData().then(h=>{f||h.ON_BOARDING__RECORD_FIRST_AUTO_CLOSE_PRO_CHAT_SWITCH_TOOLTIP||h.ON_BOARDING__RECORD_FIRST_AUTO_CLOSE_PRO_CHAT_SWITCH&&u(!0)}),()=>{f=!0}},[s,a.proChat,l.chatMode]),c?null:la.default.createElement(Lt,{trigger:p,arrow:!1,hideCTAButton:!0,placement:o,anchorElementSelectors:t,onShow:()=>{Ge.setOnboardingData("ON_BOARDING__RECORD_FIRST_AUTO_CLOSE_PRO_CHAT_SWITCH_TOOLTIP",!0)},ctaButtonText:i("package__features:onboarding__onboarding_popover__cta_button__try_it"),onCTAButtonClick:async()=>{n&&n()},PaperProps:{sx:{...o.includes("top")?{transform:"translate(-4px, -12px)"}:{}}},...r},la.default.createElement(Tg,null))},XI=Ck;var Uc="ON_BOARDING_POPOVER__PRO_CHAT__OPENED",Jd="ON_BOARDING_POPOVER__PRO_CHAT__CLOSED",Wc="ON_BOARDING_POPOVER__NEW_CHAT",dX="ON_BOARDING_POPOVER__CHAT_IN_FULL_PAGE",wg="ON_BOARDING_POPOVER__CHAT_HISTORY",Eg="ON_BOARDING_POPOVER__CHAT_HUB_SELECTOR",Gc="ON_BOARDING_POPOVER__AI_MODEL_SELECTOR";var br=I(w());var yk=e=>{let{anchorElementSelectors:t='[data-testid="maxai--chat-pro-chat-switch"]',placement:o="top-start",onTryIt:n,...r}=e,{t:i}=E(),[a,s]=br.default.useState(!1),[l,p]=br.default.useState(!0),u=re(y=>y.conversationIds),c=tn(u[0]),m=xe(u[0]),d=(0,br.useRef)(!1),{localSettings:f}=yt(),{isFreeUser:h}=Tt(),_=Fo.use.setChatAIModelAndProvider(),{extensionTourOnBoardingOpened:g}=pr();return(0,br.useEffect)(()=>{g&&Ge.getOnboardingDataByKey(Uc).then(y=>p(!!y))},[g]),(0,br.useEffect)(()=>{if(l)return;let y=c.find(C=>C.type==="ai");y&&y.originalMessage?.metadata?.chatMode==="free_chat"&&f.chatMode==="free_chat"&&!m&&d.current&&s(!0)},[c,f.chatMode,l,m]),(0,br.useEffect)(()=>{m&&(d.current=!0)},[m]),l?null:br.default.createElement(Lt,{trigger:a,placement:o,anchorElementSelectors:t,onShow:()=>{Ge.setOnboardingData(Uc,!0),h&&_({AIModel:nc.value,AIProvider:nc.AIProvider})},onClose:()=>{Ge.setOnboardingData(Jd,!0)},ctaButtonText:i("package__features:onboarding__onboarding_popover__cta_button__try_it"),onCTAButtonClick:async()=>{n&&n()},CtaButtonProps:{"data-button-clicked-name":"Onboarding > Pro chat > Try it"},...r},br.default.createElement(x,{spacing:.5},br.default.createElement(T,{fontSize:20,lineHeight:1.4,color:"text.primary",fontWeight:700,textAlign:"left"},"Pro chat"),br.default.createElement(T,{fontSize:14,lineHeight:1.4,color:"text.primary",fontWeight:400,textAlign:"left"},i("package__features:onboarding__onboarding_popover__pro_chat__description"))))},YI=yk;var fi=I(w());var bk=e=>{let{anchorElementSelectors:t='[data-testid="maxai--chat-pro-chat-switch"]',placement:o="top-start",onTryIt:n,...r}=e,{t:i}=E(),{modelUsage:a}=Ai(),{isPayingUser:s}=Tt(),{localSettings:l}=yt(),[p,u]=(0,fi.useState)(!1),[c,m]=fi.default.useState(!0),{extensionTourOnBoardingOpened:d}=pr();return(0,fi.useEffect)(()=>{d&&Ge.getOnboardingData().then(f=>{f.ON_BOARDING__RECORD_FIRST_AUTO_CLOSE_PRO_CHAT_SWITCH_TOOLTIP&&m(f.ON_BOARDING__RECORD_FIRST_RESET_DAILY_USAGE_PRO_CHAT_SWITCH_TOOLTIP===!0)})},[d]),(0,fi.useEffect)(()=>{!s&&a.proChat>0&&l.chatMode==="free_chat"&&u(!0)},[s,a.proChat,l.chatMode]),c?null:fi.default.createElement(Lt,{trigger:p,placement:o,anchorElementSelectors:t,onShow:()=>{Ge.setOnboardingData("ON_BOARDING__RECORD_FIRST_RESET_DAILY_USAGE_PRO_CHAT_SWITCH_TOOLTIP",!0)},ctaButtonText:i("package__features:onboarding__onboarding_popover__cta_button__try_it"),onCTAButtonClick:async f=>{n&&n(f)},CtaButtonProps:{"data-button-clicked-name":"Onboarding > Pro chat > Got it"},...r},fi.default.createElement(x,{spacing:.5},fi.default.createElement(T,{fontSize:20,lineHeight:1.4,color:"text.primary",fontWeight:700,textAlign:"left"},"Pro chat"),fi.default.createElement(T,{fontSize:14,lineHeight:1.4,color:"text.primary",fontWeight:400,textAlign:"left"},i("package__features:onboarding__onboarding_popover__pro_chat__first_reset_daily_usage__description",{NAME:"Pro chats"}))))},ZI=bk;var To=I(w()),QI=e=>{let{sx:t,children:o,...n}=e;return To.default.createElement(x,{direction:"row",alignItems:"center",sx:{padding:"6px 4px",gap:"4px",cursor:"pointer",transform:"translateY(0)",lineHeight:"1!important",...t},...n},o,To.default.createElement(T,{sx:{fontSize:"14px",fontWeight:500,color:"text.primary",textAlign:"left"}},"Pro"))},JI=e=>{let{children:t,title:o}=e;return To.default.createElement(he,{disableInteractive:!0,testId:"maxai--chat-pro-chat-switch--tooltip",placement:"top",title:o},To.default.createElement("div",null,t))},Ik=()=>{let{t:e}=E();return To.default.createElement(JI,{title:e("package__features:chat__pro_chat_switch__pay_user_tooltip")},To.default.createElement(QI,{sx:{cursor:"default"}},To.default.createElement(Ha,{sx:{color:"text.primary"},"data-testid":"maxai--chat-pro-chat-switch"})))},Sk=e=>{let{hideOnboarding:t=!1}=e,{chatMode:o,updateChatMode:n}=us(),{isLogin:r}=Mn(),{t:i}=E(),a=async l=>{await Ge.setOnboardingData("ON_BOARDING__RECORD_FIRST_CLICK_PRO_CHAT_SWITCH",!0),await n(o==="free_chat"?"pro_chat":"free_chat")===!1&&Us("click",{paywallType:"pro_chat_card",paywallReason:"ProChat",buttonType:"pro_switch",targetElement:l?.target})},s=To.default.createElement(QI,{onClick:a},To.default.createElement("div",{"data-testid":"maxai--chat-pro-chat-switch"},To.default.createElement(Rm,{...e,checked:o==="pro_chat"})));return r?To.default.createElement("div",null,To.default.createElement($I,null,s),To.default.createElement(XI,null),To.default.createElement(ZI,{onTryIt:a}),!t&&To.default.createElement(YI,{onTryIt:a})):To.default.createElement(JI,{title:i("package__features:chat__pro_chat_switch__not_login_user_tooltip",{NAME:"Pro chat"})},s)},vk=e=>{let{isPayingUser:t}=Tt(),{isLogin:o}=Mn(),{setLocalSettings:n,localSettings:r}=yt();return(0,To.useEffect)(()=>{o&&t&&r.chatMode!=="pro_chat"&&n({chatMode:"pro_chat"})},[o,t,r.chatMode]),o&&t?To.default.createElement(Ik,null):To.default.createElement(Sk,{...e})},ms=vk;var eS=I(w()),Tk=e=>{let{onChanged:t,...o}=e,{userSettings:n,setUserSettings:r}=sr(),i=K2(),a=Or&&typeof i.query.locale=="string"?i.query.locale:"",s=async p=>{r({language:p}),t?.(p)},l=i_(n?.language||"",a||n?.preferredLanguage||"");return eS.default.createElement(r6,{options:wx,value:l,onChange:s,...o})},tS=Tk;var oS=I(w()),Mk=e=>{let{onChanged:t,tooltipProps:o,popoverProps:n,...r}=e,{t:i}=E(),{conversationId:a,inputMediator:s}=Oi(),l=xe(a);return oS.default.createElement(tS,{onChanged:p=>{s.focus(),t?.(p)},disabled:l,tooltipProps:{title:i("package__features:chat__ai_language_selector__button__tooltip"),...o},popoverProps:{offset:5,...n},...r})},ds=Mk;var wk=e=>{let{enableChatMode:t,disableChatMode:o,children:n}=e,{localSettings:r}=k_(),i=r.chatMode||"free_chat";return typeof n=="function"?n(i):t&&i!==t||o&&i===o?null:n},ef=wk;var jc=I(w()),nS=I(w()),Ek=e=>{let{type:t="floating",sx:o}=e,{t:n}=E(),r=(0,nS.useMemo)(()=>[{value:"clear_suggested",label:n("package__features:context_menu__more_button__clear_suggested_tools"),ButtonProps:{tooltipProps:{placement:"right",disabled:!1}},labelSx:{color:"rgba(255, 14, 39, 1) !important"},icon:jc.default.createElement(U,{icon:"Delete",sx:{color:"rgba(255, 14, 39, 1) !important"}})}],[n]),i=async c=>{if(c==="clear_suggested"){if(!await Fe({emitEvent:!0}))return;await l()}},{contextMenuPath:a}=uo(),{contextMenuSuggestions:s,resetContextMenuSuggestions:l}=Ja(a||""),{contextMenuSuggestions:p}=Ja("/rewrite"),{contextMenuSuggestions:u}=Ja("/my_own_tools");return a&&s.length===0||p.length===u.length&&p.length===0?null:jc.default.createElement(B,{sx:{padding:0,...o}},jc.default.createElement(ne,{options:r,placement:"bottom-end",onSelectOption:c=>{i(c)},OptionsCardProps:{sx:{width:"auto",marginRight:"-13px"}},sx:{width:"26px",height:"26px",padding:"8px"}},jc.default.createElement(U,{size:t==="floating"?18:16,icon:"More"})))},Ip=Ek;var Kc=class{constructor(){this.menuList=[];this.path=[];this.onUpdate=()=>{}}setOnUpdate(t){this.onUpdate=t}updatePath(t){this.path=t,this.onUpdate()}setMenuList(t){if(t!==this.menuList)if(this.menuList=t,this.menuList.length===0)this.updatePath([]);else{let o=null,n=[];for(let r of this.menuList){if(r.type==="chat_complete"){o=r,n=this.menuList;break}if(r.type==="group"){let i=!1;for(let a of r.children)if(a.type==="chat_complete"){o=a,n=r.children,i=!0;break}if(i)break}}this.updatePath(o?[{item:o,siblingList:n,triggerByHover:!1}]:[])}}onHover(t){let o=[];function n(r){let i=r;for(let a of r){if(a.prompt_id===t.prompt_id)return o.unshift({item:a,siblingList:i,triggerByHover:!0}),!0;a.type==="group"&&n(a.children??[])&&o.unshift({item:a,siblingList:i,triggerByHover:!0})}return!1}n(this.menuList),this.updatePath(o)}proxyKeyboardEvent(t){return t.key==="ArrowUp"||t.key==="ArrowDown"||t.key==="ArrowLeft"||t.key==="ArrowRight"?this.onNavigate(t.key.slice(5)):!1}onNavigate(t){if(this.path.length===0)return!1;let o=this.path[this.path.length-1];switch(t){case"Up":{let n=o.siblingList.indexOf(o.item);if(n===-1)throw Error("onNavigate up index = -1");return n===0?!1:(o.item=o.siblingList[n-1],this.updatePath(this.path.map(r=>({...r,triggerByHover:!1}))),!0)}case"Down":{let n=o.siblingList.indexOf(o.item);if(n===-1)throw Error("onNavigate down index = -1");return n===o.siblingList.length-1?!1:(o.item=o.siblingList[n+1],this.updatePath(this.path.map(r=>({...r,triggerByHover:!1}))),!0)}case"Left":return this.path.length===1?!1:(this.updatePath(this.path.slice(0,this.path.length-1).map(n=>({...n,triggerByHover:!1}))),!0);case"Right":{if(o.item.type!=="group")return!1;let n=o.item;return!n.children||n.children.length===0?!1:(this.path.push({item:n.children[0],siblingList:n.children,triggerByHover:!1}),this.updatePath(this.path.map(r=>({...r,triggerByHover:!1}))),!0)}}}getSelectedItem(){let t=Ei(this.path);if(t&&t.item.type==="chat_complete")return t.item}match(t){return!!this.path.find(n=>n.item===t)}matchOpenGroup(t){let o=this.path.findIndex(n=>n.item===t);return o===-1?!1:o!==this.path.length-1||this.path[o].triggerByHover}onLeave(){this.updatePath(this.path.slice(0,1).map(t=>({...t,triggerByHover:!1})))}};var iS=I(l6()),aS=I(cw());var gt=I(w()),Ag=I(w()),Pg=(0,gt.forwardRef)(function({disabled:t,data:o,onHover:n,isActive:r,label:i,iconKey:a,includeChildren:s,onClick:l,stopClickEventPropagation:p,...u},c){let m=(0,gt.useRef)();(0,gt.useEffect)(()=>{if(r&&m.current&&m.current.parentElement){let f=m.current,h=m.current.parentElement,_={top:h.scrollTop,bottom:h.clientHeight+h.scrollTop};if(f.offsetTop+f.clientHeight>_.bottom)h.scrollTo({behavior:"instant",top:f.offsetTop+f.clientHeight-h.clientHeight,left:h.scrollLeft});else if(f.offsetTop<_.top){let g=f;f.previousElementSibling instanceof HTMLElement&&f.previousElementSibling.classList.contains("maxai-context-menu-group-label")&&(g=f.previousElementSibling),h.scrollTo({behavior:"instant",top:g.offsetTop,left:h.scrollLeft})}}},[r]);let d=(0,Ag.useMemo)(()=>{try{return`dropdown-menu--item--${o.text.replace(/\s+/g,"-").toLowerCase()}`}catch{return""}},[o.text]);return gt.default.createElement(B,{"data-testid":d,...u,"aria-disabled":t,className:`floating-context-menu-item ${r?"floating-context-menu-item--active":""}`,tabIndex:r?0:-1,sx:{display:"flex",alignItems:"center",flexDirection:"row",gap:1,boxSizing:"border-box",px:1,borderRadius:"3px",height:"28px",fontSize:"14px",width:"100%",cursor:"pointer","&.floating-context-menu-item--active":{bgcolor:f=>f.palette.mode==="dark"?"rgba(255, 255, 255, 0.08)":"rgba(55, 53, 47, 0.08)","& .floating-context-menu-item__footer-icon":{display:"flex"}},"& .floating-context-menu-item__footer-icon":{display:"none",flexShrink:0},"& .floating-context-menu-item__footer-icon--active":{display:"flex"},"&:hover":{bgcolor:f=>f.palette.mode==="dark"?"rgba(255, 255, 255, 0.08)":"rgba(55, 53, 47, 0.08)","& .floating-context-menu-item__footer-icon":{display:"flex"}}},ref:f=>{f&&(c&&(typeof c=="function"?c(f):c.current=f),m.current=f)},component:"div",role:"menuitem",onMouseEnter:()=>{n?.(o)},onClick:f=>{l?.(o),p&&f.stopPropagation()}},a&&gt.default.createElement(U,{size:16,icon:a,sx:{color:"primary.main",flexShrink:0}}),gt.default.createElement(T,{fontSize:14,textAlign:"left",color:"text.primary",width:0,noWrap:!0,flex:1,lineHeight:"28px"},i),gt.default.createElement("span",{className:"floating-context-menu-item__footer-icon "+(s?"floating-context-menu-item__footer-icon--active":"")},s?gt.default.createElement(iS.default,{sx:{color:f=>f.palette.mode==="dark"?"#ffffff85":"rgba(55, 53, 47, 0.45)",fontSize:16}}):gt.default.createElement(aS.default,{className:"floating-context-menu-item__footer-hover-icon",sx:{color:f=>f.palette.mode==="dark"?"#ffffff85":"rgba(55, 53, 47, 0.45)",fontSize:16}})))}),Ak=(e,t,o)=>Sl(e,t,o,{animationFrame:!0}),rS=(0,gt.forwardRef)(function({referenceElement:t,referenceElementRef:o,zIndex:n=1,children:r,root:i=document.body,open:a,needAutoUpdate:s=!0,sx:l,defaultPlacement:p,defaultFallbackPlacements:u,data:c,menuMaxHeight:m,menuWidth:d,onHover:f,onLeave:h,stopClickEventPropagation:_,...g},y){let C=Z_(),b=Ih(),v=!b,S=!!b,[P,k]=(0,gt.useState)(a??!1),L=(0,Ag.useMemo)(()=>P||a,[a,P]),H=p||(v?"bottom-start":"right-start"),W=u||(v?["bottom-start","left","left-end","top-start","right"]:["right","right-start","right-end","left","left-start","left-end"]),{x:O,y:D,strategy:V,placement:N,refs:z,context:j}=Ga({nodeId:C,open:L,onOpenChange:(F,pe,ae)=>{k(F),ae==="hover"&&(F?f?.(c):h?.(c))},placement:H,middleware:[Ru({mainAxis:v?4:0,alignmentAxis:v?0:-4}),Wu({fallbackPlacements:W}),Uu()],whileElementsMounted:s?Ak:void 0}),G=Em(j,{role:"menu"}),q=wm(j),A=eC(j,{delay:{open:70,close:70},handleClose:oC({blockPointerEvents:!0})}),{getReferenceProps:Y,getFloatingProps:Q,getItemProps:M}=Nl([G,q,A]),K=Y_([z.setReference,y,o]);return gt.default.createElement(Q_,{id:C},t&&gt.default.isValidElement(t)&&gt.default.cloneElement(t,{...Y({...g,className:`${S?"MenuItem":"RootMenu"}`,...S&&{role:"menuitem"},ref:K})}),gt.default.createElement(Tm,{root:i},L&&gt.default.Children.count(r)!==0&&gt.default.createElement(tC,{context:j,modal:!1,initialFocus:-1,visuallyHiddenDismiss:!0},gt.default.createElement(x,{sx:{zIndex:n+1,display:"flex",flexDirection:"column",p:gt.default.Children.count(r)===0?0:.5,outline:"none!important",maxHeight:m||340,boxSizing:"border-box",overflowY:"auto",border:"1px solid",borderColor:F=>F.palette.mode==="dark"?"rgba(255, 255, 255, 0.2)":"rgba(0,0,0,0.12)",bgcolor:"background.paper",borderRadius:1,boxShadow:N.includes("top")?"rgba(15, 15, 15, 0.05) 0px 0px 0px 1px, rgba(15, 15, 15, 0.1) 0px -3px 6px, rgba(15, 15, 15, 0.05) 0px -9px 24px":"rgba(15, 15, 15, 0.05) 0px 0px 0px 1px, rgba(15, 15, 15, 0.1) 0px 3px 6px, rgba(15, 15, 15, 0.2) 0px 9px 24px","& *":{outline:"none!important"},"&:has(.max-ai--popper-wrapper)":{overflowY:"unset"},width:d,...l},component:"div",ref:z.setFloating,className:"Menu dropdown-menu",onClick:F=>{_&&F.stopPropagation()},style:{position:V,top:D??0,left:O??0},...Q()},gt.default.Children.map(r,F=>gt.default.isValidElement(F)&&gt.default.cloneElement(F,{...M({})}))))))}),Pk=(0,gt.forwardRef)(function(t,o){return Ih()?gt.default.createElement(rS,{...t,ref:o}):gt.default.createElement(J_,null,gt.default.createElement(rS,{...t,ref:o}))}),kg=Pk;var Bt=I(w()),tf=(0,Bt.forwardRef)((e,t)=>{let{menuItem:o,onClick:n,root:r,zIndex:i,menuWidth:a,contextMenuNavigator:s,onClickGroup:l,platformFeatureCover:p,...u}=e,{t:c}=E(),m=(0,Bt.useMemo)(()=>{let d=`context_menu__prompt__${o.prompt_id.replace(mn,"")}`,f=`package__features:${d}`,h=c(f);return h!==f&&h!==d?h:o.prompt_title},[o.prompt_title,c]);if(o.type==="group"){let d="";try{d=`maxai--rewrite--menu-item--${o.prompt_title.replace(/\s+/g,"-").toLowerCase()}`}catch{d=`maxai--rewrite--menu-item--${o.prompt_id}`}return Bt.default.createElement(kg,{zIndex:i,ref:t,root:r,label:m,data:o,menuWidth:a,open:s.matchOpenGroup(o),onHover:()=>{s.onHover(o)},stopClickEventPropagation:!0,referenceElement:Bt.default.createElement(Pg,{label:m,data:o,"data-testid":d,includeChildren:!0,onClick:l,iconKey:o.prompt_icon,isActive:s.match(o)})},(o.children??[]).map(f=>Bt.default.createElement(tf,{...u,platformFeatureCover:p,zIndex:i+1,onClick:n,root:r,contextMenuNavigator:s,key:f.prompt_id,menuItem:f,menuWidth:a})))}return Bt.default.createElement(Pg,{data:o,"data-platform-feature":p,"data-testid":`maxai--rewrite--menu-item--${o.prompt_id}`,"data-promptid":o.prompt_id,ref:t,label:m,iconKey:o.prompt_icon,onClick:n,isActive:s.match(o),onHover:()=>{s.onHover(o)}})});tf.displayName="DropdownItemWrapper";var sS=()=>Bt.default.createElement(B,{"data-testid":"max-ai-context-menu-divider","aria-disabled":!0,onClick:e=>{e.stopPropagation(),e.preventDefault()},component:"div",sx:{pointerEvents:"none",borderTop:"1px solid",borderColor:e=>e.palette.mode==="dark"?"rgba(255, 255, 255, 0.2)":"rgba(0,0,0,0.12)",my:.5}}),kk=(0,Bt.forwardRef)(function(t,o){let{root:n,referenceElement:r,referenceElementRef:i,menuList:a=[],open:s,needAutoUpdate:l,defaultPlacement:p,defaultFallbackPlacements:u,onClickItem:c,menuWidth:m=450,zIndex:d=Hu()?0:2147483601,menuMaxHeight:f,noOptionFallback:h,onClickGroup:_,sx:g,platformFeatureCover:y}=t,C=v_(),b=(0,Bt.useMemo)(()=>{let v=new Kc;return v.setOnUpdate(C),v},[]);return(0,Bt.useImperativeHandle)(o,()=>({proxyKeyboardEvent:v=>b.proxyKeyboardEvent(v),getSelectedItem:()=>b.getSelectedItem()})),(0,Bt.useEffect)(()=>{b.setMenuList(a.filter(v=>typeof v=="object"))},[a]),Bt.default.createElement(kg,{zIndex:d,root:n,open:s,needAutoUpdate:l,referenceElement:r,referenceElementRef:i,defaultPlacement:p,defaultFallbackPlacements:u,onClick:c,menuMaxHeight:f,menuWidth:m,stopClickEventPropagation:!0,onLeave:()=>{b.onLeave()},sx:g},a.length===0&&h,a.map((v,S)=>{if(typeof v=="string"){let P=v.split("__CONTEXT_MENU_LABEL_SLOT_PLACEHOLDER__")[0],k=v.split("__CONTEXT_MENU_LABEL_SLOT_PLACEHOLDER__")[1];return Bt.default.createElement(Bt.Fragment,{key:k+"_group_name"},S!==0&&sS(),Bt.default.createElement(B,{"aria-disabled":!0,sx:{display:"flex",justifyContent:"space-between",alignItems:"center",width:"100%",boxSizing:"border-box",direction:"row",pl:"8px"},className:"maxai-context-menu-group-label",onClick:L=>{L.stopPropagation(),L.preventDefault()}},Bt.default.createElement(B,{sx:{p:"3px 0 6px 0",pointerEvents:"none"}},Bt.default.createElement(T,{textAlign:"left",fontSize:12,color:"text.secondary"},P)),k===mn&&Bt.default.createElement(Ip,{sx:{ml:"auto"}})))}return v.type==="group"?Bt.default.createElement(Bt.Fragment,{key:v.prompt_id+"_group_name"},i6.includes(v.prompt_id)&&sS(),Bt.default.createElement(tf,{platformFeatureCover:y,menuItem:v,root:n,zIndex:d+1,menuWidth:m,contextMenuNavigator:b,onClick:c,onClickGroup:_})):Bt.default.createElement(tf,{platformFeatureCover:y,key:v.prompt_id,zIndex:d+1,root:n,menuItem:v,menuWidth:m,contextMenuNavigator:b,onClick:c})}))}),of=kk;var rf=I(w());var lS=I(Mi());var qc=I(w()),Lg=[{language_code:"uk",value:"Ukrainian",label:"\u0423\u043A\u0440\u0430\u0457\u043D\u0441\u044C\u043A\u0430"},{language_code:"so",value:"Somali",label:"Af Soomaali"},{language_code:"af",value:"Afrikaans",label:"Afrikaans"},{language_code:"az",value:"Azerbaijani",label:"Az\u0259rbaycan dili"},{language_code:"id",value:"Indonesian",label:"Bahasa Indonesia"},{language_code:"ms-MY",value:"Malaysian Malay",label:"Bahasa Malaysia"},{language_code:"ms",value:"Malay",label:"Bahasa Melayu"},{language_code:"jv",value:"Javanese",label:"Basa Jawa"},{language_code:"su",value:"Sundanese",label:"Basa Sunda"},{language_code:"bs",value:"Bosnian",label:"Bosanski jezik"},{language_code:"ca",value:"Catalan",label:"Catal\xE0"},{language_code:"cs",value:"Czech",label:"\u010Ce\u0161tina"},{language_code:"ny",value:"Chichewa",label:"Chichewa"},{language_code:"cy",value:"Welsh",label:"Cymraeg"},{language_code:"da",value:"Danish",label:"Dansk"},{language_code:"de",value:"German",label:"Deutsch"},{language_code:"et",value:"Estonian",label:"Eesti keel"},{language_code:"en",value:"English",label:"English"},{language_code:"en-GB",value:"English (UK)",label:"English (UK)"},{language_code:"en-US",value:"English (US)",label:"English (US)"},{language_code:"es",value:"Spanish",label:"Espa\xF1ol"},{language_code:"eo",value:"Esperanto",label:"Esperanto"},{language_code:"eu",value:"Basque",label:"Euskara"},{language_code:"fr",value:"French",label:"Fran\xE7ais"},{language_code:"ga",value:"Irish",label:"Gaeilge"},{language_code:"gl",value:"Galician",label:"Galego"},{language_code:"hr",value:"Croatian",label:"Hrvatski jezik"},{language_code:"xh",value:"Xhosa",label:"isiXhosa"},{language_code:"zu",value:"Zulu",label:"isiZulu"},{language_code:"is",value:"Icelandic",label:"\xCDslenska"},{language_code:"it",value:"Italian",label:"Italiano"},{language_code:"sw",value:"Swahili",label:"Kiswahili"},{language_code:"ht",value:"Haitian Creole",label:"Krey\xF2l Ayisyen"},{language_code:"ku",value:"Kurdish",label:"Kurd\xEE"},{language_code:"la",value:"Latin",label:"Lat\u012Bna"},{language_code:"lv",value:"Latvian",label:"Latvie\u0161u valoda"},{language_code:"lb",value:"Luxembourgish",label:"L\xEBtzebuergesch"},{language_code:"lt",value:"Lithuanian",label:"Lietuvi\u0173 kalba"},{language_code:"hu",value:"Hungarian",label:"Magyar"},{language_code:"mg",value:"Malagasy",label:"Malagasy"},{language_code:"mt",value:"Maltese",label:"Malti"},{language_code:"mi",value:"Maori",label:"M\u0101ori"},{language_code:"nl",value:"Dutch",label:"Nederlands"},{language_code:"no",value:"Norwegian",label:"Norsk"},{language_code:"uz",value:"Uzbek",label:"O'zbek tili"},{language_code:"pl",value:"Polish",label:"Polski"},{language_code:"pt",value:"Portuguese",label:"Portugu\xEAs"},{language_code:"ro",value:"Romanian",label:"Rom\xE2n\u0103"},{language_code:"st",value:"Sesotho",label:"Sesotho"},{language_code:"sq",value:"Albanian",label:"Shqip"},{language_code:"sk",value:"Slovak",label:"Sloven\u010Dina"},{language_code:"sl",value:"Slovenian",label:"Sloven\u0161\u010Dina"},{language_code:"fi",value:"Finnish",label:"Suomi"},{language_code:"sv",value:"Swedish",label:"Svenska"},{language_code:"tl",value:"Tagalog",label:"Tagalog"},{language_code:"tt",value:"Tatar",label:"Tatar\xE7a"},{language_code:"tr",value:"Turkish",label:"T\xFCrk\xE7e"},{language_code:"vi",value:"Vietnamese",label:"Vi\u1EC7t ng\u1EEF"},{language_code:"yo",value:"Yoruba",label:"Yor\xF9b\xE1"},{language_code:"el",value:"Greek",label:"\u0395\u03BB\u03BB\u03B7\u03BD\u03B9\u03BA\u03AC"},{language_code:"be",value:"Belarusian",label:"\u0411\u0435\u043B\u0430\u0440\u0443\u0441\u043A\u0430\u044F \u043C\u043E\u0432\u0430"},{language_code:"bg",value:"Bulgarian",label:"\u0411\u044A\u043B\u0433\u0430\u0440\u0441\u043A\u0438 \u0435\u0437\u0438\u043A"},{language_code:"ky",value:"Kyrgyz",label:"\u041A\u044B\u0440"},{language_code:"kk",value:"Kazakh",label:"\u049A\u0430\u0437\u0430\u049B \u0442\u0456\u043B\u0456"},{language_code:"mk",value:"Macedonian",label:"\u041C\u0430\u043A\u0435\u0434\u043E\u043D\u0441\u043A\u0438 \u0458\u0430\u0437\u0438\u043A"},{language_code:"mn",value:"Mongolian",label:"\u041C\u043E\u043D\u0433\u043E\u043B \u0445\u044D\u043B"},{language_code:"ru",value:"Russian",label:"\u0420\u0443\u0441\u0441\u043A\u0438\u0439"},{language_code:"sr",value:"Serbian",label:"\u0421\u0440\u043F\u0441\u043A\u0438 \u0458\u0435\u0437\u0438\u043A"},{language_code:"tg",value:"Tajik",label:"\u0422\u043E\u04B7\u0438\u043A\u04E3"},{language_code:"ka",value:"Georgian",label:"\u10E5\u10D0\u10E0\u10D7\u10E3\u10DA\u10D8"},{language_code:"hy",value:"Armenian",label:"\u0540\u0561\u0575\u0565\u0580\u0565\u0576"},{language_code:"yi",value:"Yiddish",label:"\u05D9\u05D9\u05B4\u05D3\u05D9\u05E9"},{language_code:"he",value:"Hebrew",label:"\u05E2\u05D1\u05E8\u05D9\u05EA"},{language_code:"ug",value:"Uyghur",label:"\u0626\u06C7\u064A\u063A\u06C7\u0631\u0686\u06D5"},{language_code:"ur",value:"Urdu",label:"\u0627\u0631\u062F\u0648"},{language_code:"ar",value:"Arabic",label:"\u0627\u0644\u0639\u0631\u0628\u064A\u0629"},{language_code:"ps",value:"Pashto",label:"\u067E\u069A\u062A\u0648"},{language_code:"fa",value:"Persian",label:"\u0641\u0627\u0631\u0633\u06CC"},{language_code:"ne",value:"Nepali",label:"\u0928\u0947\u092A\u093E\u0932\u0940"},{language_code:"mr",value:"Marathi",label:"\u092E\u0930\u093E\u0920\u0940"},{language_code:"hi",value:"Hindi",label:"\u0939\u093F\u0928\u094D\u0926\u0940"},{language_code:"bn",value:"Bengali",label:"\u09AC\u09BE\u0982\u09B2\u09BE"},{language_code:"pa",value:"Punjabi",label:"\u0A2A\u0A70\u0A1C\u0A3E\u0A2C\u0A40"},{language_code:"gu",value:"Gujarati",label:"\u0A97\u0AC1\u0A9C\u0AB0\u0ABE\u0AA4\u0AC0"},{language_code:"or",value:"Oriya",label:"\u0B13\u0B21\u0B3C\u0B3F\u0B06"},{language_code:"ta",value:"Tamil",label:"\u0BA4\u0BAE\u0BBF\u0BB4\u0BCD"},{language_code:"te",value:"Telugu",label:"\u0C24\u0C46\u0C32\u0C41\u0C17\u0C41"},{language_code:"kn",value:"Kannada",label:"\u0C95\u0CA8\u0CCD\u0CA8\u0CA1"},{language_code:"ml",value:"Malayalam",label:"\u0D2E\u0D32\u0D2F\u0D3E\u0D33\u0D02"},{language_code:"si",value:"Sinhala",label:"\u0DC3\u0DD2\u0D82\u0DC4\u0DBD"},{language_code:"th",value:"Thai",label:"\u0E44\u0E17\u0E22"},{language_code:"lo",value:"Lao",label:"\u0E9E\u0EB2\u0EAA\u0EB2\u0EA5\u0EB2\u0EA7"},{language_code:"my",value:"Burmese",label:"\u1017\u1019\u102C\u1005\u102C"},{language_code:"km",value:"Khmer",label:"\u1797\u17B6\u179F\u17B6\u1781\u17D2\u1798\u17C2\u179A"},{language_code:"ko",value:"Korean",label:"\uD55C\uAD6D\uC5B4"},{language_code:"zh",value:"Chinese",label:"\u4E2D\u6587"},{language_code:"zh-TW",value:"Traditional Chinese",label:"\u7E41\u9AD4\u4E2D\u6587"},{language_code:"ja",value:"Japanese",label:"\u65E5\u672C\u8A9E"}];function Lk(e,{inputValue:t}){return e.filter(o=>{let n=o.label.toLowerCase(),r=o.value.toLowerCase(),i=t.toLowerCase();return n.includes(i)||r.includes(i)})}var Ok=e=>{let{label:t="Output language",defaultValue:o="",onChange:n=l=>{},placeholder:r,sx:i}=e,[a,s]=(0,qc.useState)(()=>Lg.find(l=>l.value===o)||Lg[0]);return qc.default.createElement(Gu,{"data-testid":"system-variable--language-select",disablePortal:!0,disableClearable:!0,value:a,size:"small",sx:{[`.${$x.root}`]:{fontSize:16},[`.${vl.root}`]:{fontSize:16,paddingRight:"28px!important"},[`.${vl.root} fieldset > legend`]:{fontSize:14},[`.${Wx.popupIndicator} .${lS.svgIconClasses.root}`]:{fontSize:24},...i},slotProps:{paper:{sx:{fontSize:16}}},ListboxProps:{style:{maxHeight:"144px"}},autoHighlight:!0,getOptionLabel:l=>l.label,options:Lg,onChange:(l,p)=>{l.stopPropagation(),s(p),n(p.value)},onKeyDown:l=>{l.stopPropagation()},onPaste:l=>{l.stopPropagation()},filterOptions:Lk,renderInput:l=>qc.default.createElement(Ct,{...l,label:t,placeholder:r,InputLabelProps:{sx:{fontSize:"16px"},...l.InputLabelProps},inputProps:{sx:{fontSize:"16px"},...l.inputProps}})})},pS=Ok;var cS=I(Am()),Og=I(dc());var Dt=I(w()),Bk=({onSelectOption:e,options:t,selectedOption:o,menuListBoxSx:n,sx:r})=>{let{t:i}=E(),a=(0,Dt.useRef)(null),s=(0,Dt.useRef)(null),[l,p]=(0,Dt.useState)(""),[u,c]=(0,Dt.useState)(null),m=(0,Dt.useMemo)(()=>l===""?t:t.filter(g=>{let y=g.label.toLowerCase(),C=String(g.value).toLowerCase(),b=l.toLowerCase();return y.includes(b)||C.includes(b)}),[l,t]),d=(0,Dt.useRef)(!1),f=m.length-1,h=g=>{c(y=>{if(y!==null){let C=g==="increase"?y+1:y-1;return C>=f?f:C<=0?0:C}return y})};(0,Dt.useEffect)(()=>{s.current&&(s.current.focus(),setTimeout(()=>{s.current?.focus()},200))},[]),(0,Dt.useEffect)(()=>{l!==""&&c(0)},[l]),(0,Dt.useEffect)(()=>{if(a.current&&u!==null){let g=m[u];if(g){let y=a.current,C=y.querySelector(`[data-testid="maxai-client--ui--select-option--${g.value}"]`);if(C){let b=C.offsetTop-y.offsetTop;y.scrollTo({top:b,behavior:"smooth"})}}}},[u,m]);let _=()=>{if(!m.length)return Dt.default.createElement(x,{width:"100%",justifyContent:"center",alignItems:"center",spacing:1},Dt.default.createElement(Og.default,{sx:{fontSize:32,color:"text.secondary"}}),Dt.default.createElement(T,{fontSize:12,color:"text.secondary"},i("package__ui:select__no_options__title")));let g=(y,C)=>{let b=o===y.value;return Dt.default.createElement(qu,{"data-testid":`maxai-client--ui--select-option--${y.value}`,selected:u===C,key:`${C}-${y.value}`,sx:[{py:"6px",px:"10px",borderRadius:1,mt:.5,"&.Mui-selected":{backgroundColor:"rgba(0, 0, 0, 0.04)"}}],onClick:v=>{v.stopPropagation(),e&&e(y)}},Dt.default.createElement(oc,{sx:{my:0},primary:Dt.default.createElement(x,{direction:"row",alignItems:"center",sx:{color:"text.primary",fontSize:14}},Dt.default.createElement(T,{fontSize:"inherit",noWrap:!0,sx:{color:"inherit"}},y.label),b?Dt.default.createElement(cS.default,{sx:{fontSize:"inherit",color:"text.primary",ml:"auto"}}):null)}))};return Dt.default.createElement(Ku,{sx:{p:0,width:"100%"},onKeyDown:y=>{y.key==="ArrowDown"&&(y.preventDefault(),h("increase")),y.key==="ArrowUp"&&(y.preventDefault(),h("decrease"))}},m.map((y,C)=>g(y,C)))};return Dt.default.createElement(x,{sx:r},Dt.default.createElement(Ct,{inputRef:s,size:"small",value:l,onChange:g=>p(g.target.value),onCompositionStart:()=>d.current=!0,onCompositionEnd:()=>d.current=!1,placeholder:i("package__common:search"),InputProps:{startAdornment:Dt.default.createElement(zn,{position:"start"},Dt.default.createElement(Og.default,null)),sx:{fontSize:16}},inputProps:{autoComplete:"off"},sx:{pt:1,px:1,pb:.5},onKeyUp:g=>{g.stopPropagation()},onKeyDown:g=>{g.stopPropagation();let y=g.key;if((y==="ArrowDown"||y==="ArrowUp")&&(g.preventDefault(),u===null?c(0):h(y==="ArrowDown"?"increase":"decrease")),y==="Enter"&&u!==null&&!d.current){let C=m[u];g.preventDefault(),C&&e&&e(C)}}}),Dt.default.createElement(B,{sx:{overflow:"auto",maxHeight:310,minHeight:310,px:1,pb:0,mb:1,overscrollBehavior:"contain",scrollbarColor:g=>g.palette.mode==="dark"?"rgba(255, 255, 255, 0.6) transparent":"rgba(0, 0, 0, 0.6) transparent",boxSizing:"border-box",display:"flex",...n},ref:a},_()))},uS=Bk;var Ro=I(w()),Dk=e=>{let{title:t,dataTestId:o,options:n,defaultValue:r,value:i="",onChange:a,disabled:s,sx:l,startIcon:p,endIcon:u="ExpandMore",labelMaxWidth:c=64,tooltipProps:m,popoverProps:d,...f}=e,[h,_]=(0,Ro.useState)(!1),[g,y]=(0,Ro.useState)(()=>n.find(P=>P.value===i)||n.find(P=>P.value===r)||n[0]),[C,b]=(0,Ro.useState)(!1),v=(0,Ro.useRef)(null),S=s?!1:h;return(0,Ro.useLayoutEffect)(()=>{let P=n.find(k=>k.value===i);P&&P.value!==g.value&&y(P)},[i]),fm(()=>{_(!1)}),Ro.default.createElement(Ro.default.Fragment,null,Ro.default.createElement(he,{title:t,open:C&&!S,disabled:s,...m},Ro.default.createElement(ce,{ref:v,disableRipple:!0,onMouseEnter:()=>{b(!0)},onMouseLeave:()=>{b(!1)},onClick:()=>{s||_(P=>!P)},className:h?"MAXAI_CLIENT__UI__SELECT":"","data-testid":o,startIcon:p?Ro.default.createElement(zn,{position:"start",sx:{marginRight:0}},typeof p=="string"?Ro.default.createElement(U,{icon:p,sx:{fontSize:"18px",mx:"4px",color:"text.secondary"}}):p):void 0,endIcon:u?Ro.default.createElement(zn,{position:"end",sx:{marginLeft:0,position:"absolute",right:0,top:"50%",transform:"translateY(-50%)",zIndex:1,p:"6px"}},typeof u=="string"?Ro.default.createElement(U,{icon:u,sx:{color:"text.secondary",fontSize:"16px",transform:h?"rotate(180deg)":"rotate(0)"}}):u):void 0,sx:{minWidth:"unset",maxWidth:"120px",borderRadius:1,cursor:s?"default":"pointer","&:focus":{cursor:"default"},color:"text.secondary",transition:"background-color 250ms cubic-bezier(0.4, 0, 0.2, 1)",[`& .${Ea.startIcon}`]:{mr:0},[`& .${Ea.endIcon}`]:{ml:0,p:0},[`& .${Ea.endIcon} .${qx.root}`]:{position:"static",transform:"none"},height:"32px",display:"flex",flexWrap:"nowrap",p:"4px 6px",alignItems:"center",justifyContent:"flex-start",fontSize:14,...l},...f},Ro.default.createElement(T,{noWrap:!0,fontSize:"inherit",maxWidth:c,textAlign:"left"},g.label))),Ro.default.createElement(zl,{transitionDuration:0,disableScrollLock:!0,...d,placement:"bottom-start",fallbackPlacements:["top-start"],open:h,onClose:()=>{_(!1)},anchorEl:v.current},Ro.default.createElement(uS,{selectedOption:i,options:n,onSelectOption:P=>{y(P),a?.(P.value),_(!1)}})))},nf=Dk;var mS=I(w()),Fk=[{label:"Default tone",value:"Default"},{label:"Authoritative",value:"Authoritative"},{label:"Casual",value:"Casual"},{label:"Clinical",value:"Clinical"},{label:"Cold",value:"Cold"},{label:"Confident",value:"Confident"},{label:"Cynical",value:"Cynical"},{label:"Emotional",value:"Emotional"},{label:"Empathetic",value:"Empathetic"},{label:"Formal",value:"Formal"},{label:"Friendly",value:"Friendly"},{label:"Humorous",value:"Humorous"},{label:"Informal",value:"Informal"},{label:"Ironic",value:"Ironic"},{label:"Optimistic",value:"Optimistic"},{label:"Pessimistic",value:"Pessimistic"},{label:"Playful",value:"Playful"},{label:"Professional",value:"Professional"},{label:"Sarcastic",value:"Sarcastic"},{label:"Serious",value:"Serious"},{label:"Straightforward",value:"Straightforward"},{label:"Sympathetic",value:"Sympathetic"},{label:"Tentative",value:"Tentative"},{label:"Warm",value:"Warm"}],Hk=e=>{let{t}=E();return mS.default.createElement(nf,{title:t("package__features:shortcuts__set_variables_modal__system_selector__tone"),labelMaxWidth:"unset",startIcon:"GraphicEqualizer",sx:{maxWidth:"unset"},...e,options:Fk})},dS=Hk;var fS=I(w()),Nk=[{label:"Default writing style",value:"Default"},{value:"Academic",label:"Academic"},{value:"Analytical",label:"Analytical"},{value:"Argumentative",label:"Argumentative"},{value:"Conversational",label:"Conversational"},{value:"Creative",label:"Creative"},{value:"Critical",label:"Critical"},{value:"Descriptive",label:"Descriptive"},{value:"Epigrammatic",label:"Epigrammatic"},{value:"Epistolary",label:"Epistolary"},{value:"Expository",label:"Expository"},{value:"Informative",label:"Informative"},{value:"Instructive",label:"Instructive"},{value:"Journalistic",label:"Journalistic"},{value:"Metaphorical",label:"Metaphorical"},{value:"Narrative",label:"Narrative"},{value:"Persuasive",label:"Persuasive"},{value:"Poetic",label:"Poetic"},{value:"Satirical",label:"Satirical"},{value:"Technical",label:"Technical"}],zk=e=>{let{t}=E();return fS.default.createElement(nf,{title:t("package__features:shortcuts__set_variables_modal__system_selector__writing_style"),labelMaxWidth:"unset",startIcon:"Feather",sx:{maxWidth:"unset"},...e,options:Nk})},hS=zk;var Vk=e=>{let{systemVariableSelectKey:t,...o}=e;switch(t){case"AI_RESPONSE_WRITING_STYLE":return rf.default.createElement(hS,{...o});case"AI_RESPONSE_LANGUAGE":return rf.default.createElement(pS,{...o});case"AI_RESPONSE_TONE":return rf.default.createElement(dS,{...o});default:return null}},af=Vk;var $c=class{constructor(){this.SET_VARIABLES_MODAL_SELECT_KEY="MAXAI_CLIENT__FEATURES__SET_VARIABLES_MODAL_SELECT_KEY"}async getSetVariablesModalSelectCache(){return await gr.getItem(this.SET_VARIABLES_MODAL_SELECT_KEY)||{}}async setVariablesModalSelectCache(t,o){try{let n=await this.getSetVariablesModalSelectCache();return n[t]=o,await gr.setItem(this.SET_VARIABLES_MODAL_SELECT_KEY,n),!0}catch{return!1}}};var Sp=new $c;var xS=I(ir()),_S=I(Vc()),CS=I(Sg());var He=I(w()),yS=I(ec());var gS=!0,bS=(0,He.forwardRef)((e,t)=>{let{title:o,variables:n,modelKey:r,onShow:i,onClose:a,onBeforeRunShortcuts:s,onChange:l,onBeforeClose:p,onInputCustomVariable:u,actions:c,answerInsertMessageId:m,askChatGPTActionParameters:d,showCloseButton:f=!0,isSaveLastRunShortcuts:h,disabled:_,sx:g,notBuiltInVariables:y,includeHistory:C,autoFocusAfterBlur:b=!1,disableCachingSystemVariableValue:v=!1,disabledResetFormOnConfirmModal:S=!1,MaxAIPromptActionConfig:P}=e,{betaSettings:k}=En(),{askAIWithShortcutsV2:L,askAIWithShortcuts:H,shortCutsEngine:W,stopGenerate:O}=Ne(),D=co(),{conversationId:V,conversationType:N}=Oi(),z=xe(V),{localSettings:j}=yt(),{t:G}=E(),[q,A]=(0,He.useState)(!1),Y=(0,He.useMemo)(()=>N!=="Chat"&&!q,[N,q]),Q=Ra(),[M,K]=(0,He.useState)(null),F=(0,He.useRef)(null),[pe,ae]=(0,He.useState)([]),{control:te,getValues:Te,setValue:Ie,register:Nt,trigger:lt,reset:Le,clearErrors:nt,formState:{errors:At,isValid:Ze}}=Bl(),[dt,It]=(0,He.useState)({}),Zt=async ue=>{p&&!p()||(pe.forEach(X=>{X.resolve({data:Te(),type:ue?"cancel":"close",success:!1})}),r!=="PromptPreview"&&(Le(),It({}),A(!1),a?.("close")))},pt=async()=>{let ue=await lt();return!ue&&!q&&A(!0),ue},Lo=async ue=>{if(!(z||_)){if(hm(ue)){let X=F.current?.querySelectorAll("textarea[id]")?.[ue+1];if(X){X.focus();return}}if(M?.waitForUserAction){if(!await pt())return;pe.forEach(X=>{X.resolve({data:Te(),type:"confirm",success:!0})})}else await St(!1)}},St=(0,He.useCallback)(async(ue,X={})=>{let{ignoreChatHubLoading:Se=!1}=X,Me=Object.values(Te()).filter(yo=>String(yo||"").trim()==="").length>0;if(!await pt()){ue&&Me&&nt();return}if(ue&&Me){A(!0);return}let ge=De(Te());r!=="PromptPreview"&&!S&&(It({}),Le(),A(!1)),l?.({data:ge,type:"change",success:!0},"runPromptStart");let ve=[];if(M?.template||M?.MaxAIPromptActionConfig||P){let yo=String(ge?.TEMPLATE||M?.template||M?.title||""),ni={...M?.variables?.reduce((Pe,so)=>({...Pe,[so.name]:so}),{})},Pt={};if(Object.keys(ge).forEach(Pe=>{let so=ni[Pe];if(so?.hidden){if(gS)return;so.hint="(Dev show) "+so.hint}so?(Pt[Pe]={key:Pe,value:ge[Pe],overwrite:!0,label:so.hint},(y||M?.notBuiltInVariables)?.includes(Pe)&&(Pt[Pe].isBuiltIn=!1)):Pt[Pe]={key:Pe,value:ge[Pe],overwrite:!0}}),!Pt.SELECTED_TEXT){let Pe=M?.variables?.find(so=>so.name==="SELECTED_TEXT");Pe&&(Pt.SELECTED_TEXT={key:"SELECTED_TEXT",value:Pe.default_value,isBuiltIn:!0,overwrite:!0,label:"patch selected text not found"})}if(!Pt.SELECTED_TEXT&&Pt.MAXAI_CONTINUE_WRITING_TEXT_DRAFT&&(Pt.MAXAI_CONTINUE_WRITING_TEXT_DRAFT.isBuiltIn=!0,Pt.SELECTED_TEXT={...Pt.MAXAI_CONTINUE_WRITING_TEXT_DRAFT,key:"SELECTED_TEXT"}),j.chatMode!=="pro_chat"){let Pe=Pt.AI_RESPONSE_TONE;Pe&&(Pe.value="Default");let so=Pt.AI_RESPONSE_WRITING_STYLE;so&&(so.value="Default")}ve.push({type:"SET_VARIABLE_MAP",parameters:{VariableMap:Pt}});let Oo=De(c||M?.actions||[]);ve.push(...Oo),ve.push({type:"RENDER_TEMPLATE",parameters:{template:yo}});let rt=m||M?.answerInsertMessageId||"",ri=d||M?.askChatGPTActionParameters||{},Ii=C??M?.includeHistory??void 0,Bu={type:"ASK_CHATGPT",parameters:{template:"{{LAST_ACTION_OUTPUT}}",AskChatGPTActionType:rt?"ASK_CHAT_GPT_HIDDEN":"ASK_CHAT_GPT_WITH_PREFIX",AskChatGPTActionQuestion:{text:"{{LAST_ACTION_OUTPUT}}",meta:Jo([{includeHistory:!0,...rt?{outputMessageId:rt}:{}},M?.questionMeta||{}])},MaxAIPromptActionConfig:De(M?.MaxAIPromptActionConfig||P),...ri}};Ii!==void 0&&(Bu.parameters.AskChatGPTActionQuestion.meta.includeHistory=Ii),ve.push(Bu);let Du=await s?.();await(k?.appearance_v2_enabled?L:H)(ve,{isSaveLastRunShortcuts:h,conversationId:Du?Du.id:void 0}).then(()=>{let Pe=W?.getNextAction()?.error||""}).catch(Pe=>{}).finally(()=>{r!=="PromptPreview"&&!S&&(Le(),It({}),A(!1),a?.("runPrompt")),l?.({data:Te(),type:"change",success:!0},"runPromptEnd")})}},[j.chatMode,L,k?.appearance_v2_enabled,H,nt,Te,h,l,a,Le,W,pt,M,c,m,d,r,y,C,S]),$=(0,He.useMemo)(()=>{let ue={},X=n||M?.variables||[],Se=o||M?.title||"";if(M?.MaxAIPromptActionConfig?.prompt_id){let Pe=M.MaxAIPromptActionConfig.prompt_id,so=`package__features:context_menu__prompt__${Pe}`;Jp().t(so).includes(Pe)||(Se=Jp().t(so))}let Me=[],ge=[],ve=Te();r==="PromptPreview"&&Le(),X.forEach(Pe=>{let so=r==="PromptPreview"&&ve[Pe.name]!==void 0?ve[Pe.name]:Pe.default_value?.trim();if(Pe.hidden){if(gS)return;Pe.hint?.startsWith("(Dev show) ")||(Pe.hint="(Dev show) "+Pe.hint)}Pe.type==="select"&&Me.push(Pe),Pe.type==="text"&&(ge.push(Pe),Object.prototype.hasOwnProperty.call(ve,Pe.name)&&Ie(Pe.name,so));let Cl=Pe.optional?[]:[{required:!0,message:""}];ue[Pe.name]=Nt(Pe.name,{value:so,validate:qM=>{for(let vx of Cl)if(vx.required&&!qM)return vx.message||`${Pe.hint} is required`;return!0}})});let yo=Me.length,ni=typeof window>"u"?580:window.innerHeight*.6,Pt=Me.length+ge.length>0?36:30,Oo=Math.ceil(yo/3),rt=Oo*48+(Oo-1)*16,ri=ge.length,Ii=(ri-1)*16,Bu=16*3,Du=ni-Pt-rt-Ii-Bu,Sx=Math.max(Math.floor(Du/24/ri)-3,2);return Sp.getSetVariablesModalSelectCache().then(Pe=>{let so=Object.keys(ue);so.length!==0&&(so.forEach(Cl=>{Pe[Cl]!==void 0&&Ie(Cl,Pe[Cl])}),It(ue))}),{titleHeight:Pt,currentTitle:Se,currentSelectTotalCount:yo,selectTypeVariables:Me,textTypeVariables:ge,maxTextareaMaxRows:Sx,minTextareaMaxRows:2}},[n,o,r,M]);(0,He.useEffect)(()=>{let ue=ta.receive(`SetVariablesModal_${V}`,X=>new Promise((Se,Me)=>{X.task==="open"&&(It({}),Le(),K(X.config),A(!1),setTimeout(()=>{X.config.waitForUserAction?ae([{resolve:Se,reject:Me}]):Se({data:De(dt),type:"confirm",success:!0})},200))}));return()=>{ue()}},[V]);let fe=(0,He.useRef)(St);fe.current=St,(0,He.useEffect)(()=>{if(!W)return;let ue=(X,{currentAction:Se})=>{X==="afterRunAction"&&Se&&Se.type==="SET_VARIABLES_MODAL"&&fe.current(!0,{ignoreChatHubLoading:!0}).then().catch(Me=>{})};return W.addListener(ue),()=>{W.removeListener(ue)}},[W]);let ie=()=>{let ue=Array.from(F.current?.querySelectorAll("textarea")||[]);if(ue.length===0)return;let X=ue.find(Se=>!Se.hasAttribute("aria-hidden")&&Se.value==="")||ue[0];return X&&(X.focus(),X.setSelectionRange(0,0)),X};(0,He.useEffect)(()=>{if(q){if(Y)a?.("reset");else if(setTimeout(()=>{ie()},500),i?.(),b){let ue=()=>{ie()};return setTimeout(()=>{F.current?.removeEventListener("focusout",ue)},500),F.current?.addEventListener("focusout",ue),()=>{F.current?.removeEventListener("focusout",ue)}}}},[q,Y]);let R=(0,He.useRef)(null),Z=ue=>{R.current=ue},de=()=>{R.current?R.current.focus():ie()};(0,He.useImperativeHandle)(t,()=>({discard:()=>Zt(!0),focusLastFocusInput:de}));let se=xe(V),oe=(0,He.useRef)(!1);return!e.show&&(!q||Y||Object.keys(dt).length===0)||se?null:He.default.createElement(x,{className:"max-ai__action__set_variables_modal",sx:{width:"100%",overflow:"hidden",pb:1,gap:1,boxSizing:"border-box",...g},maxHeight:"60vh",onKeyPressCapture:ue=>{ue.stopPropagation()},onKeyPress:ue=>{ue.stopPropagation()}},He.default.createElement(x,{flexShrink:0,height:$.titleHeight,direction:"row",alignItems:"start",justifyContent:"space-between",width:"100%"},He.default.createElement(B,{width:0,flex:1,component:"div",display:"flex",alignItems:"center"},He.default.createElement(T,{fontSize:"14px",color:"#fff",fontWeight:600,height:30,lineHeight:"30px",sx:{textAlign:"left",borderRadius:"8px",p:"0 8px",bgcolor:"rgba(0, 0, 0, 0.87)",width:r!=="PromptPreview"?"100%":"auto"},noWrap:!0},$.currentTitle)),f&&He.default.createElement(Ve,{"data-testid":"close-modal-button",onClick:async()=>await Zt(!0),sx:{flexShrink:0,position:"relative",top:"-8px",right:"-8px"}},He.default.createElement(xS.default,{sx:{fontSize:"24px"}}))),He.default.createElement(x,{flexShrink:0,flexWrap:"wrap",direction:"row",display:$.selectTypeVariables.length?void 0:"none",sx:{gap:"16px"}},$.selectTypeVariables.map((ue,X)=>{if(ue.type==="select"){let Se=D?.querySelector('div[data-testid="maxai--chat-box--tools--left-container--portal-root"]');return Se?yS.default.createPortal(He.default.createElement(Va,{key:ue.name,control:te,name:ue.name,defaultValue:ue.default_value,render:({field:Me})=>He.default.createElement(af,{systemVariableSelectKey:ue.name,key:ue.name,defaultValue:Me.value,onChange:ge=>{v||Sp.setVariablesModalSelectCache(ue.name,ge),Me.onChange(ge)}})}),Se):void 0}return null})),He.default.createElement(x,{component:"div",direction:"row",flexWrap:"wrap",gap:2,paddingTop:1,ref:F,flex:1,height:0,display:$.textTypeVariables.length?void 0:"none",sx:{overflowY:"auto"}},$.textTypeVariables.map((ue,X)=>{let Se=(Q==="lg"||Q==="xl")&&$.textTypeVariables.length>1?"calc(50% - 8px)":"100%",Me=$.minTextareaMaxRows*23+17;return He.default.createElement(Ct,{"data-testid":`custom-variable--${ue.name}`,sx:{width:Se},size:"small",key:ue.name,label:ue.label||ue.hint||"Label",...dt[ue.name],onKeyUp:ge=>{u?.({data:Te(),type:"input",success:!0,variables:$.textTypeVariables}),ge.stopPropagation()},onKeyDown:async ge=>{ge.key==="Enter"&&!ge.shiftKey&&!oe.current?(ge.stopPropagation(),ge.preventDefault(),await Lo(X)):ge.stopPropagation()},onCompositionStart:()=>{oe.current=!0},onCompositionEnd:()=>{oe.current=!1},onPaste:ge=>{ge.stopPropagation()},InputProps:{sx:{fontSize:"16px",minHeight:Me}},inputProps:{style:{fontSize:"16px",textAlign:"left"}},FormHelperTextProps:{sx:{ml:0,fontSize:"12px"}},error:!!At[ue.name],helperText:At[ue.name]?.message||"",InputLabelProps:{shrink:!0,sx:{fontSize:"16px"}},multiline:!0,placeholder:ue.hint,minRows:$.minTextareaMaxRows,maxRows:$.maxTextareaMaxRows,onFocus:ge=>Z(ge.target)})})),He.default.createElement(x,{direction:"row",alignItems:"center",justifyContent:"end",gap:1,flexShrink:0},He.default.createElement(he,{title:G(z?"package__features:chat__inputbox__button__stop_generating__tooltip":"package__features:chat__inputbox__button__send_to_ai__tooltip"),description:z?void 0:"\u23CE",placement:"bottom",disabled:_||!Ze},He.default.createElement(ce,{"data-testid":"sidebar-variables-modal--send-btn",disabled:z?_:_||!Ze,onClick:()=>{z?O():Lo()},variant:"contained",sx:{width:"32px",height:"32px",minWidth:"unset",borderRadius:"8px"}},z?He.default.createElement(CS.default,{sx:{fontSize:"16px",color:"white !important"}}):He.default.createElement(_S.default,{sx:{fontSize:"16px"}})))))});bS.displayName="ActionSetVariablesModal";var sf=He.default.memo(bS);var HS=I(ir());var be=I(w());var Mp=I(w());var ff=I(w());var jr=I(w());var Rk=e=>{let{anchorElementSelectors:t='[data-testid="max-ai__ai-provider-floating-button"]',placement:o="top",...n}=e,{t:r}=E(),[i,a]=jr.default.useState(!0),{localSettings:s}=yt(),[l,p]=jr.default.useState(!1),u=(0,jr.useCallback)(async()=>{await Ge.getOnboardingDataByKey("ON_BOARDING__RECORD_FIRST_CLICK_PRO_CHAT_SWITCH")&&s.chatMode==="pro_chat"&&p(!0)},[s.chatMode]),{extensionTourOnBoardingOpened:c}=pr();return(0,jr.useEffect)(()=>{c&&Ge.getOnboardingDataByKey(Gc).then(m=>a(!!m))},[c]),(0,jr.useEffect)(()=>{i||u()},[i,u]),i?null:jr.default.createElement(Lt,{placement:o,trigger:l,anchorElementSelectors:t,onShow:()=>{Ge.setOnboardingData(Gc,!0)},CtaButtonProps:{"data-button-clicked-name":"Onboarding > Choose a smarter AI > Got it"},...n},jr.default.createElement(x,{spacing:.5},jr.default.createElement(T,{fontSize:20,lineHeight:1.4,color:"text.primary",fontWeight:700,textAlign:"left"},r("package__features:onboarding__onboarding_popover__ai_model_selector__title")),jr.default.createElement(T,{fontSize:14,lineHeight:1.4,color:"text.primary",fontWeight:400,textAlign:"left"},r("package__features:onboarding__onboarding_popover__ai_model_selector__description"))))},lf=Rk;var pf=class{constructor(t=!1){this.defaultCaptureEvent=t;this.executionIndex=new Map;this.eventMap=new Map}add(t,o,n,r=0,i=this.defaultCaptureEvent){this.eventMap.has(t)||this.eventMap.set(t,new Map);let a=this.eventMap.get(t);if(!a.has(o)){a.set(o,[]);let l=p=>{let u=!0,c=a.get(o).sort((m,d)=>d.priority-m.priority);for(let m of c){let d=new Proxy(p,{get(f,h){if(h==="stopSpread")return()=>{u=!1};let _=f[h];return typeof _=="function"?_.bind(f):_}});if(m.handler(d),!u)break}};t.addEventListener(o,l,i),a.set(`${o}_proxy`,[{handler:l,priority:0}])}a.get(o).push({handler:n,priority:r})}remove(t,o,n,r=this.defaultCaptureEvent){let i=this.eventMap.get(t);if(!i)return;let a=i.get(o);if(!a)return;let s=a.findIndex(l=>l.handler===n);if(s>-1&&a.splice(s,1),a.length===0){let l=i.get(`${o}_proxy`);l&&l[0]&&t.removeEventListener(o,l[0].handler,r),i.delete(o),i.delete(`${o}_proxy`)}i.size===0&&this.eventMap.delete(t)}removeAll(t){let o=this.eventMap.get(t);if(o){for(let n of o.keys()){if(n.endsWith("_proxy"))continue;let r=o.get(`${n}_proxy`);r&&r[0]&&t.removeEventListener(n,r[0].handler)}this.eventMap.delete(t)}}executeOnPriority(t,o,n){let r=this.eventMap.get(t);if(!r)return!0;let i=r.get(o);if(!i||i.length===0)return!0;if(o==="keydown"&&n?.event instanceof KeyboardEvent){let m=n.event;if(n.keys&&!n.keys.includes(m.key))return!0}let a=`${t.toString()}_${String(o)}`,s=this.executionIndex.get(a)??0,l=[...i].sort((m,d)=>d.priority-m.priority);if(s>=l.length)return this.executionIndex.delete(a),!0;let p=l[s],u=n?.event||new Event(o),c=new Proxy(u,{get:(m,d)=>{if(d==="stopSpread")return()=>{this.executionIndex.delete(a)};let f=m[d];return typeof f=="function"?f.bind(m):f}});return p.handler(c),this.executionIndex.set(a,s+1),!1}};var cf=class{static{this.managers=new Map}static getManager(t,o=!1){return this.managers.has(t)||this.managers.set(t,new pf(o)),this.managers.get(t)}static removeManager(t){this.managers.has(t)&&this.managers.delete(t)}static clear(){this.managers.clear()}};var pa=I(w()),IS=(0,pa.createContext)(null);function uf({children:e,managerId:t="default",defaultCaptureEvent:o=!1}){let n=(0,pa.useRef)(cf.getManager(t,o)),r=(0,pa.useRef)((a,s)=>{a.stopPropagation(),a.preventDefault(),s&&a.stopSpread()}),i={domEventManager:n.current,stopPropagation:r.current};return pa.default.createElement(IS.Provider,{value:i},e)}function vp(){let e=(0,pa.useContext)(IS);if(!e)throw new Error("useDomEventManager must be used within DomEventManagerProvider");return e}var bt=I(w());var Mo=I(w());var Bg=class e extends Xu{constructor(){super()}static getInstance(){return this.instance||(this.instance=new e),this.instance}},Tp=()=>Bg.getInstance();var hs=I(w());var Qs=I(w()),Uk=({model:e,selectedModel:t,onSelect:o,listItemIndex:n,focusKey:r,onFocusKey:i,zIndex:a,eventPriority:s,parentOpen:l,MainComponent:p})=>{let{t:u}=E(),{label:c,children:m}=e,d=Na(c||"",u);return Qs.default.createElement(Qs.default.Fragment,null,d&&Qs.default.createElement(ct,{sx:{fontSize:"12px",lineHeight:"18px",fontWeight:500,p:"2px 8px",color:f=>f.palette.mode==="dark"?"rgba(255, 255, 255, 0.38)":"rgba(0, 0, 0, 0.38)",opacity:"1!important",mt:n===0?void 0:"4px",minHeight:"unset"},disabled:!0},d+" AI"),m?.map(f=>Qs.default.createElement(p,{key:f.key,model:f,selectedModel:t,onSelect:o,focusKey:r,onFocusKey:i,zIndex:a,eventPriority:s,parentOpen:l})))},SS=(0,Qs.memo)(Uk);var vS=I(w()),Wk=({sx:e,children:t,...o})=>vS.default.createElement(T,{sx:{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",color:"text.primary",...e},...o},t),fs=Wk;var fn=I(w());var mf=I(w()),Dg=e=>{let{tag:t,...o}=e,{t:n}=E(),r=Na(t,n);return r==="New"?mf.default.createElement(T,{component:"span",bgcolor:"rgba(52, 168, 83, 1)",color:"#fff",fontSize:"9px",fontWeight:500,px:"4px",py:"1px",borderRadius:"4px",lineHeight:1.5,whiteSpace:"nowrap",...o},r):r==="Beta"?mf.default.createElement(T,{component:"span",color:i=>i.palette.mode==="dark"?"rgba(255, 255, 255, 0.5)":"rgba(0, 0, 0, 0.38)",border:"1px solid",borderColor:i=>i.palette.mode==="dark"?"rgba(255, 255, 255, 0.16)":"rgba(0, 0, 0, 0.08)",fontSize:"9px",fontWeight:500,px:"4px",py:"1px",borderRadius:"4px",lineHeight:1.5,whiteSpace:"nowrap",...o},r):mf.default.createElement(T,{component:"span",bgcolor:i=>i.palette.mode==="dark"?"rgba(255, 255, 255, 0.12)":"rgba(0, 0, 0, 0.06)",color:i=>i.palette.mode==="dark"?"rgba(255, 255, 255, 0.6)":"rgba(0, 0, 0, 0.6)",fontSize:"9px",fontWeight:500,px:"4px",py:"1px",borderRadius:"4px",lineHeight:1.5,whiteSpace:"nowrap",...o},r)},TS=Dg;var Gk=({model:e,selectedModel:t,onSelect:o,isKeyOrChildrenFocused:n,onFocusKey:r,zIndex:i,parentOpen:a})=>{let{t:s}=E(),{key:l,label:p,value:u}=e,c=Na(p||"",s),m=u,{open:d,handleOpen:f,handleClose:h}=Nm({delay:{open:100}});(0,fn.useEffect)(()=>{a===!1&&h()},[a,h]),(0,fn.useEffect)(()=>{n===!1&&h()},[n,h]);let _=(0,fn.useCallback)(()=>{f(),r?.(l)},[l,r,f]),g=(0,fn.useRef)(null);return xm(g,y=>{y||requestAnimationFrame(()=>{h()})}),m?fn.default.createElement(he,{open:d,placement:"right",sx:{maxWidth:"200px"},disableInteractive:!0,TransitionProps:{timeout:{enter:300,exit:0}},PopperProps:{modifiers:[{name:"flip",enabled:!0,options:{fallbackPlacements:["right","left"]}}]},zIndex:i,title:$m(m,s)},fn.default.createElement(ct,{component:"div",key:l,ref:g,"data-testid":`maxai--ai-model-selector--menu-item--${m.value}`,"data-menu-item-key":l,disabled:m.disabled,selected:m.value===t,onClick:()=>{o(m),h()},onMouseEnter:_,onMouseLeave:h,sx:{...lm,...n&&{backgroundColor:y=>y.palette.mode==="dark"?"rgba(255, 255, 255, 0.1)":"rgba(0, 0, 0, 0.04)"}}},fn.default.createElement(x,{alignItems:"center",direction:"row",spacing:1,sx:El},fn.default.createElement(Do,{model:m.value}),fn.default.createElement(fs,{fontSize:"14px",lineHeight:"21px",sx:{pr:"8px"}},c),fn.default.createElement(x,{direction:"row",alignItems:"center",sx:{ml:"auto !important"}},m.tag&&fn.default.createElement(TS,{tag:m.tag}))))):null},MS=(0,fn.memo)(Gk);var wS=I(l6());var wt=I(w());var jk=({model:e,selectedModel:t,onSelect:o,onFocusKey:n,zIndex:r,eventPriority:i,parentOpen:a,isKeyOrChildrenFocused:s,MainComponent:l})=>{let{t:p}=E(),{key:u,label:c,children:m}=e,d=Na(c||"",p),{open:f,handleOpen:h,handleClose:_}=Nm({delay:{open:100}}),[g,y]=(0,wt.useState)(!1),C=(0,wt.useRef)(0),[b,v]=(0,wt.useState)(""),S=(0,wt.useCallback)(()=>{_(),C.current=0,v(""),y(!1)},[_]),P=(0,wt.useCallback)((q=!0)=>{h(),q&&y(!0)},[h]);(0,wt.useEffect)(()=>{(!s||a===!1)&&S()},[S,a,s]);let k=(0,wt.useCallback)(q=>{o(q),S()},[o,S]),L=(0,wt.useRef)(null),H=(0,wt.useCallback)(()=>{L.current=setTimeout(()=>{S()},300)},[S]),W=(0,wt.useCallback)(()=>{n?.(u),L.current&&clearTimeout(L.current),P(!1)},[u,n,P]),O=(0,wt.useCallback)(q=>{y(!0),v(q),m&&(C.current=m?.findIndex(A=>A?.key===q))},[m]),{domEventManager:D,stopPropagation:V}=vp(),[N,z]=(0,wt.useState)(!1),j=Tp();(0,wt.useEffect)(()=>{let q=Y=>{if(!m?.length)return;let Q=()=>V(Y,!0);switch(["ArrowDown","ArrowUp"].includes(Y.key)&&m?.length>1&&(z(!0),requestAnimationFrame(()=>{j.emit("scrollToItem",m[C.current].key)})),Y.key){case"ArrowRight":if(!s)return;Q(),m?.[0]&&v(m[0].key),P();break;case"ArrowUp":if(!f||!g||!s)return;Q(),C.current=(C.current-1+m.length)%m.length,v(m[C.current].key);break;case"ArrowDown":if(!f||!g||!s)return;Q(),C.current=(C.current+1)%m.length,v(m[C.current].key);break;case"Enter":{if(!f||!g||!s)return;Q();let M=m[C.current];M?.value&&k(M.value);break}case"Tab":Q();break}},A=()=>{z(!1)};return D.add(document,"keydown",q,i),D.add(document,"mousemove",A),()=>{D.remove(document,"keydown",q),D.remove(document,"mousemove",A)}},[j,m,D,i,P,k,g,s,u,f,V]),(0,wt.useEffect)(()=>{let q=A=>{if(!m?.length)return;let Y=()=>V(A,!0);switch(A.key){case"Escape":case"ArrowLeft":if(!f)return;Y(),S();break}};return s&&D.add(document,"keydown",q,i,!0),()=>{D.remove(document,"keydown",q,!0)}},[m?.length,D,i,S,f,V,s]);let G=(0,wt.useRef)(null);return xm(G,q=>{q||requestAnimationFrame(()=>{S()})}),wt.default.createElement(Ka,{open:f,placement:"right-start",sx:{zIndex:r},contentSx:{display:s?"block":"none",width:"auto",minWidth:"200px"},onMouseEnter:W,onMouseLeave:H,modifiers:[{name:"flip",options:{fallbackPlacements:["left-start"]}}],customTransitionProps:{timeout:{enter:300,exit:0}},referenceElementBoxProps:{component:"li","data-menu-item-key":u,"data-testid":`maxai--ai-model-selector--menu-more-item--${u}`,sx:{display:"flex",alignItems:"center",cursor:"pointer",...lm,...s&&{backgroundColor:q=>q.palette.mode==="dark"?"rgba(255, 255, 255, 0.1)":"rgba(0, 0, 0, 0.04)"}}},referenceElement:wt.default.createElement(x,{ref:G,alignItems:"center",direction:"row",spacing:1,sx:El},wt.default.createElement(U,{icon:"More",size:20,sx:{color:q=>q.palette.mode==="dark"?"#ffffff85":"rgba(55, 53, 47, 0.45)"}}),wt.default.createElement(fs,{fontSize:"14px",lineHeight:"21px"},d),wt.default.createElement(wS.default,{sx:{ml:"auto !important",color:q=>q.palette.mode==="dark"?"#ffffff85":"rgba(55, 53, 47, 0.45)",fontSize:16}}))},wt.default.createElement(Dr,{sx:{scrollPaddingBlock:"6px",cursor:N?"none":"default","& *":{cursor:N?"none !important":"",pointerEvents:N?"none":"auto"}}},m?.map(q=>wt.default.createElement(l,{key:q.key,model:q,selectedModel:t,onSelect:k,focusKey:b,onFocusKey:O,zIndex:r&&r+1,eventPriority:i&&i+1,parentOpen:f}))))},ES=(0,wt.memo)(jk);var Fg=({model:e,selectedModel:t,onSelect:o,listItemIndex:n,focusKey:r,onFocusKey:i,zIndex:a,eventPriority:s,parentOpen:l})=>{let{type:p="item"}=e,u=(0,hs.useMemo)(()=>{let c=m=>m.key===r?!0:m.children?m.children.some(d=>c(d)):!1;return c(e)},[e,r]);switch(p){case"item":return hs.default.createElement(MS,{model:e,selectedModel:t,onSelect:o,onFocusKey:i,zIndex:a,parentOpen:l,isKeyOrChildrenFocused:u});case"group":return hs.default.createElement(SS,{model:e,selectedModel:t,onSelect:o,listItemIndex:n,focusKey:r,onFocusKey:i,zIndex:a,eventPriority:s,parentOpen:l,MainComponent:Fg});case"more":return hs.default.createElement(ES,{model:e,selectedModel:t,onSelect:o,onFocusKey:i,zIndex:a,eventPriority:s,parentOpen:l,MainComponent:Fg,isKeyOrChildrenFocused:u});default:return null}},AS=(0,hs.memo)(Fg);var Kk=e=>{let{conversationType:t,AIModel:o,onSelect:n,onClose:r,buttonRef:i,sx:a,parentOpen:s}=e,l=(0,Mo.useMemo)(()=>X_(t),[t]),p=i?.current?.getBoundingClientRect()??{y:0,height:0},u=p.y-10,c=window.innerHeight-p.y-p.height-10,m=Math.max(u,c),d=Math.min(m,370),f=(0,Mo.useCallback)(async H=>{n?.(t,H.AIProvider,H.value)},[t,n]),h=(0,Mo.useMemo)(()=>l.flatMap(H=>H.children),[l]),_=(0,Mo.useRef)(-1),[g,y]=(0,Mo.useState)(""),C=(0,Mo.useCallback)(H=>{y(H),_.current=h.findIndex(W=>W?.key===H)},[h]),{domEventManager:b,stopPropagation:v}=vp(),[S,P]=(0,Mo.useState)(!1),k=Tp();(0,Mo.useEffect)(()=>{let H=O=>{if(!h?.length)return;let D=()=>v(O);switch(["ArrowDown","ArrowUp"].includes(O.key)&&(P(!0),requestAnimationFrame(()=>{k.emit("scrollToItem",h[_.current]?.key??"")})),O.key){case"ArrowDown":D(),_.current=(_.current+1)%h.length,y(h[_.current]?.key??"");break;case"ArrowUp":D(),_.current=_.current<0?h.length-1:(_.current-1+h.length)%h.length,y(h[_.current]?.key??"");break;case"Escape":D(),r?.();break;case"Enter":{D();let V=h?.[_.current];V?.value&&f(V.value);break}case"Tab":D();break}},W=()=>{P(!1)};return b.add(document,"keydown",H,1),b.add(document,"mousemove",W),()=>{b.remove(document,"keydown",H),b.remove(document,"mousemove",W)}},[h,f,v,r,b,k]),(0,Mo.useEffect)(()=>{let H=W=>{if(!h?.length)return;let O=()=>v(W);switch(W.key){case"Escape":O(),r?.();break}};return b.add(document,"keydown",H,1),()=>{b.remove(document,"keydown",H)}},[b,h?.length,g,r,v]);let L=(0,Mo.useRef)(null);return(0,Mo.useEffect)(()=>{let H=W=>{let O=_.current===0,D=_.current===h.length-1,V=L.current?.querySelector(`[data-menu-item-key="${W}"]`);V&&(V.scrollIntoView({block:"nearest"}),O?L.current?.scrollTo({top:0,behavior:"smooth"}):D&&L.current?.scrollTo({top:L.current.scrollHeight,behavior:"smooth"}))};return k.on("scrollToItem",H),()=>{k.off("scrollToItem",H)}},[h,k]),Mo.default.createElement(Dr,{component:"div",ref:L,id:"maxai-ai-model-selector-menu","data-testid":"maxai--ai-model-selector-card","aria-labelledby":"maxai-ai-model-selector-menu",disableListWrap:!0,sx:{scrollPaddingBlock:"6px",cursor:S?"none":"default","& *":{cursor:S?"none !important":"",pointerEvents:S?"none":"auto"},overflowY:"auto",overflowX:"hidden",flexShrink:0,maxHeight:d,py:"6px",boxSizing:"border-box",bgcolor:H=>H.palette.mode==="dark"?"rgba(61, 61, 61, 1)":"#fff",...a}},l.map((H,W)=>Mo.default.createElement(AS,{key:H.key,listItemIndex:W,model:H,selectedModel:o,onSelect:f,focusKey:g,onFocusKey:C,zIndex:2147483622,eventPriority:2,parentOpen:s})))},PS=(0,Mo.memo)(Kk);var qk=[...Pi.FREE,...Pi.FAST,...Pi.SMART,...Pi.REASONING,...Pi.LEGACY],Hg=(e,t)=>({currentModelDetail:(0,bt.useMemo)(()=>{let n=qk.find(a=>a.value===e);if(n&&n.AIProvider===t)return{label:n.title,value:n.value,AIProvider:n.AIProvider};let r=R2[t],i=r.find(a=>a.value===e)||r?.[0];return i?{label:i?.title||"",value:i?.value||"",AIProvider:t}:{label:ih.title,value:ih.value,AIProvider:"USE_CHAT_GPT_PLUS"}},[t,e])}),$k=e=>{let{mode:t,conversationType:o="Chat",AIProvider:n=lh[o].AIProvider,AIModel:r=lh[o].AIModel,onChange:i,sx:a,disabled:s,labelProps:l,tooltipProps:p,popperProps:u,domEventManagerId:c,defaultCaptureEvent:m=!0,...d}=e,{t:f}=E(),[h,_]=(0,bt.useState)(!1),{currentModelDetail:g}=Hg(r,n),[y,C]=(0,bt.useState)(!1),b=(0,bt.useCallback)(()=>{C(!1)},[C]),v=(0,bt.useCallback)(()=>{C(!y)},[y,C]),S=(0,bt.useRef)(null),P=(0,bt.useCallback)(async(j,G,q)=>{b(),_(!1),await Ge.setOnboardingData("ON_BOARDING__RECORD_FIRST_SELECTOR_AI_MODEL",!0),i?.(j,G,q)},[i,b]),k=[{name:"RTLSupport",enabled:typeof document<"u"&&document.querySelector("body")?.getAttribute("dir")==="rtl",phase:"main",fn({state:j}){if(j.modifiersData.popperOffsets){let q=j.rects.reference.x+j.rects.reference.width-j.rects.popper.width;q>0&&(j.modifiersData.popperOffsets.x=q)}}},{name:"offset",options:{offset:[0,5]}},{name:"flip",options:{fallbackPlacements:["top-start"]}}],L=(0,bt.useRef)(y);(0,bt.useEffect)(()=>{L.current===!0&&y===!1&&S.current.focus(),L.current=y},[y]);let H=(0,bt.useCallback)(()=>{v()},[v]),W=(0,bt.useCallback)(j=>{C(j),j||_(!1)},[C]),O=(0,bt.useCallback)(()=>{W(!1),S.current?.matches(":hover")&&_(!0)},[W]),D=Ke(o),V=Ke(n),N=Ke(r),z=Tp();return(0,bt.useEffect)(()=>{let j=G=>{let q=G({conversationType:D.current,AIProvider:V.current,AIModel:N.current});q&&P(q.conversationType??D.current,q.AIProvider,q.AIModel)};return z.on("closePopper",O),z.on("selectModel",j),()=>{z.off("closePopper",O),z.off("selectModel",j)}},[z,P,O,D,V,N]),bt.default.createElement(uf,{managerId:c,defaultCaptureEvent:m},bt.default.createElement(Ka,{width:220,sx:{zIndex:2147483621},open:y,onOpenChange:W,placement:"bottom-start",isMirror:!0,modifiers:k,referenceElement:bt.default.createElement(he,{title:f("package__features:chat__ai_model_selector__button__tooltip"),testId:"maxai--ai-model-selector--tooltip",open:h&&!y,...p},bt.default.createElement(ce,{disableRipple:!0,disabled:s,id:"max-ai__ai-provider-floating-button","data-testid":"max-ai__ai-provider-floating-button",ref:S,sx:{position:"relative",display:"flex",justifyContent:"center",alignItems:"center",cursor:"pointer",p:.5,pl:"6px",height:32,minWidth:t==="mini"?"auto":void 0,...a},"aria-controls":y?"composition-menu":void 0,"aria-expanded":y?"true":void 0,"aria-haspopup":"true",onClick:H,onMouseEnter:()=>{y||_(!0)},onMouseLeave:()=>{y||_(!1)},...d},bt.default.createElement(x,{direction:"row",alignItems:"center"},Hl(n)?bt.default.createElement(Zu,{sx:{fontSize:"20px"}}):bt.default.createElement(Do,{model:r}),t!=="mini"&&g?.label&&bt.default.createElement(T,{mx:.5,fontSize:14,lineHeight:1.4,color:"text.secondary",...l,sx:{userSelect:"none",...l?.sx}},g.label),bt.default.createElement(U,{icon:"ExpandMore",sx:{color:"text.secondary",fontSize:"18px",transform:y?"rotate(180deg)":"rotate(0)"}})))),...u},bt.default.createElement(PS,{buttonRef:S,conversationType:o,AIProvider:n,AIModel:r,onSelect:P,onClose:O,parentOpen:y})),bt.default.createElement(lf,null))},LS=$k;var Xk=e=>{let{disabled:t,onChanged:o,domEventManagerId:n,defaultCaptureEvent:r,AIModel:i,AIProvider:a,setAIModelAndProvider:s,...l}=e,{conversationId:p,conversationType:u,inputMediator:c}=Oi(),m=xe(p),d=Ke(o),f=(0,ff.useCallback)(async(h,_,g)=>{let y=async()=>{s({AIProvider:_,AIModel:g}),c.focus(),d.current?.(a,i)};if(lo)y();else{if(!await Fe({emitEvent:!0}))return;y()}},[i,a,c,d,s]);return ff.default.createElement(LS,{conversationType:u,AIProvider:a,AIModel:i,onChange:f,disabled:t||m,domEventManagerId:n,defaultCaptureEvent:r,...l})},OS=Xk;var BS=I(Am());var ye=I(w());var Yk=e=>{let{t}=E(),{mode:o,AIProvider:n,AIModel:r,sx:i,disabled:a,labelProps:s,menuIsOpen:l,controlRef:p,...u}=e,{currentModelDetail:c}=Hg(r,n);return ye.default.createElement(ce,{ref:p,disableRipple:!0,disabled:a,id:"max-ai__ai-provider-floating-button","data-testid":"max-ai__ai-provider-floating-button",sx:{position:"relative",display:"flex",justifyContent:"center",alignItems:"center",cursor:"pointer",p:.5,pl:"6px",height:32,minWidth:o==="mini"?"auto":void 0,...i},...u},ye.default.createElement(x,{direction:"row",alignItems:"center"},Hl(n)?ye.default.createElement(Zu,{sx:{fontSize:"20px"}}):ye.default.createElement(Do,{model:r}),o!=="mini"&&c?.label&&ye.default.createElement(T,{ml:"4px",mr:"2px",fontSize:14,lineHeight:1.4,color:"text.secondary",...s,sx:{userSelect:"none",...s?.sx}},t(mc[bh[c.value]]?.label)),ye.default.createElement(U,{icon:"ExpandMore",sx:{color:"text.secondary",fontSize:"18px",transform:l?"rotate(180deg)":"rotate(0)"}})))},Zk=e=>{let{model:t,selectedModel:o,currentKeyboardArrowSelectModel:n,zIndex:r,sx:i,...a}=e,{t:s}=E(),l=(0,ye.useMemo)(()=>t.value===n,[t,n]);return ye.default.createElement(he,{placement:"right",sx:{maxWidth:"200px"},disableInteractive:!0,TransitionProps:{timeout:{enter:300,exit:0}},PopperProps:{modifiers:[{name:"flip",enabled:!0,options:{fallbackPlacements:["right","left"]}}]},zIndex:r,title:$m(t,s)},ye.default.createElement(ct,{component:"div",key:t.value,"data-testid":`maxai--ai-model-selector--menu-item--${t.value}`,"data-menu-item-key":t.value,sx:{borderRadius:"6px",minHeight:"unset",p:"6px 10px 6px 10px",height:"40px","&:hover":{backgroundColor:p=>p.palette.mode==="dark"?"rgba(255, 255, 255, .1)":"rgba(0, 0, 0, 0.04)"},...l&&{backgroundColor:p=>p.palette.mode==="dark"?"rgba(255, 255, 255, 0.1)":"rgba(0, 0, 0, 0.04)"},...i},...a},ye.default.createElement(x,{alignItems:"center",direction:"row",spacing:1,sx:El},ye.default.createElement(Do,{model:t.value}),ye.default.createElement(fs,{fontSize:"14px",lineHeight:"21px"},t.title),ye.default.createElement(x,{direction:"row",alignItems:"center",sx:{}},t.tag&&ye.default.createElement(Dg,{tag:t.tag})),t.value===o&&ye.default.createElement(BS.default,{sx:{color:"text.primary",ml:"auto !important",fontSize:"18px"}}))))},ca=[mc.FAST,mc.SMART,mc.REASONING],Qk=e=>{let{AIModel:t,AIProvider:o,chatHubOrder:n,conversationType:r,onChange:i,onClose:a,open:s,anchorEl:l}=e,{t:p}=E(),{domEventManager:u,stopPropagation:c}=vp(),m=bh[t]||ca[0].key,[d,f]=(0,ye.useState)(!1),[h,_]=(0,ye.useState)(null),g=(0,ye.useRef)(ca.findIndex(O=>O.key===m)||0),[y,C]=(0,ye.useState)(m);(0,ye.useEffect)(()=>{s?(f(!1),C(m),g.current=ca.findIndex(O=>O.key===m)||0,q_().then(O=>{let D=null;n!==void 0?D=O.chatHub[n]:D=O.chat;let V=K_[D];V&&!Object.values(V).some(N=>N.value===t)&&yh(Ch(t),n)})):_(null)},[s,m,n,t]);let b=(0,ye.useMemo)(()=>Pi[y],[y]),v=(0,ye.useMemo)(()=>{let O=b.findIndex(D=>D.value===t);return{nextModel:b[(O+1)%b.length]??b[0],prevModel:b[(O-1+b.length)%b.length]??b[0]}},[t,b]),S=(0,ye.useCallback)(O=>{let D=Ch(O.value);D&&yh(D,n)},[n]),P=(0,ye.useCallback)((O,D,V)=>{V?.isUpdateTemporaryProvider&&S(O),V?.isCloseMenu&&a?.(),i(r,O.AIProvider,O.value,D),_(D==="keyboardArrow"?O.value??null:null)},[i,r,S,a]),k=(0,ye.useCallback)((O,D)=>{P(O,D,{isUpdateTemporaryProvider:!0,isCloseMenu:!0})},[P]),L=(0,ye.useCallback)(async(O,D)=>{C(O);let V=await $_(t,O,n);if(V)P(V,D);else{let N=Pi[O][0];P(N,D)}},[t,n,P]);(0,ye.useEffect)(()=>{let O=V=>{if(!b?.length||!s)return;let N=()=>c(V);switch(["ArrowDown","ArrowUp"].includes(V.key)&&f(!0),V.key){case"ArrowDown":N(),P(v.nextModel,"keyboardArrow",{isUpdateTemporaryProvider:!0});break;case"ArrowUp":N(),P(v.prevModel,"keyboardArrow",{isUpdateTemporaryProvider:!0});break;case"ArrowLeft":N(),g.current=(g.current-1+ca.length)%ca.length,L(ca[g.current].key,"keyboardArrow");break;case"ArrowRight":N(),g.current=(g.current+1)%ca.length,L(ca[g.current].key,"keyboardArrow");break;case"Escape":N(),a?.();break;case"Enter":{N(),a?.();break}case"Tab":N();break}},D=()=>{f(!1)};return u.add(document,"keydown",O,1),u.add(document,"mousemove",D),()=>{u.remove(document,"keydown",O),u.remove(document,"mousemove",D)}},[b,c,a,u,L,k,y,P,v,s]);let H=[{name:"RTLSupport",enabled:typeof document<"u"&&document.querySelector("body")?.getAttribute("dir")==="rtl",phase:"main",fn({state:O}){if(O.modifiersData.popperOffsets){let V=O.rects.reference.x+O.rects.reference.width-O.rects.popper.width;V>0&&(O.modifiersData.popperOffsets.x=V)}}},{name:"offset",options:{offset:[0,5]}},{name:"flip",options:{fallbackPlacements:["top-start"],padding:{top:0,bottom:y==="REASONING"?140:0,left:0,right:0}}}],W=(0,ye.useRef)(null);return(0,ye.useEffect)(()=>{let O=D=>{let V=D.composedPath();W.current&&V.includes(W.current)||setTimeout(()=>{s&&a?.()},0)};return document.addEventListener("mouseup",O),()=>{document.removeEventListener("mouseup",O)}},[a,s]),ye.default.createElement(Rx,{placement:"bottom-start",modifiers:H,open:s,anchorEl:l},ye.default.createElement("div",null,ye.default.createElement(x,{ref:W,sx:{gap:"6px",borderRadius:"8px",border:"1px solid",borderColor:O=>O.palette.mode==="dark"?"rgba(255, 255, 255, 0.12)":"rgba(0, 0, 0, 0.08)",scrollPaddingBlock:"6px",cursor:d?"none":"default","& *":{cursor:d?"none !important":"",pointerEvents:d?"none":"auto"},overflowY:"auto",overflowX:"hidden",flexShrink:0,boxSizing:"border-box",padding:"6px",bgcolor:O=>O.palette.mode==="dark"?"rgba(54, 56, 57, 1)":"#fff",boxShadow:O=>(O.palette.mode==="dark","0px 4px 6px -2px rgba(16, 24, 40, 0.03), 0px 12px 16px -4px rgba(16, 24, 40, 0.08)")}},ye.default.createElement(x,{sx:{flexDirection:"row",gap:"2px"}},ca.map(O=>ye.default.createElement(ce,{key:O.key,onClick:()=>L(O.key,"clickTab"),disableRipple:!0,sx:{flex:1,minWidth:"82px",height:"32px",borderRadius:"8px",fontWeight:"400",fontSize:"12px",color:"text.secondary",transition:"none",...y===O.key&&{fontWeight:"500",color:"text.primary",backgroundColor:D=>D.palette.mode==="dark"?"rgba(59, 61, 62, 1)":"#fff",borderWidth:"0.5px",borderStyle:"solid",borderColor:D=>D.palette.mode==="dark"?"rgba(255, 255, 255, 0.2)":"rgba(0, 0, 0, 0.12)",boxShadow:D=>D.palette.mode==="dark"?"0px 1px 4px 0px rgba(0, 0, 0, 0.16)":"0px 1px 4px 0px rgba(0, 0, 0, 0.08)"}}},p(O.label)))),ye.default.createElement(Dr,{component:"div",id:"maxai-ai-model-selector-menu","data-testid":"maxai--ai-model-selector-card","aria-labelledby":"maxai-ai-model-selector-menu",disableListWrap:!0,sx:{p:0,display:"flex",flexDirection:"column",gap:"4px"}},Pi[y]?.map(O=>ye.default.createElement(Zk,{key:O.value,model:O,selectedModel:e.AIModel,onClick:()=>k(O,"clickModelItem"),currentKeyboardArrowSelectModel:h}))))))},Jk=e=>{let{mode:t,chatHubOrder:o,AIProvider:n,AIModel:r,setAIModelAndProvider:i,onChanged:a,sx:s,disabled:l,labelProps:p,tooltipProps:u,popperProps:c,domEventManagerId:m,defaultCaptureEvent:d=!0,...f}=e,{t:h}=E(),{conversationId:_,conversationType:g,inputMediator:y}=Oi(),C=xe(_),b=(0,ye.useRef)(null),[v,S]=(0,ye.useState)(!1),[P,k]=(0,ye.useState)(!1),L=(0,ye.useCallback)(()=>{k(!1),y.focus()},[k,y]),H=v&&!P,W=(O,D,V,N)=>{let z=()=>{i({AIProvider:D,AIModel:V}),a?.(D,V,N)};lo?z():Fe({emitEvent:!0}).then(j=>{j&&z()}),Ge.setOnboardingData("ON_BOARDING__RECORD_FIRST_SELECTOR_AI_MODEL",!0)};return ye.default.createElement(uf,{managerId:m,defaultCaptureEvent:d},ye.default.createElement(he,{open:H,title:h("package__features:chat__ai_model_selector__button__tooltip")},ye.default.createElement("div",null,ye.default.createElement(Yk,{controlRef:b,mode:t,conversationType:g,AIProvider:n,AIModel:r,sx:s,disabled:l||C,labelProps:p,menuIsOpen:P,onMouseEnter:()=>{S(!0)},onMouseLeave:()=>{S(!1)},onClick:()=>{k(O=>!O)},...f}))),ye.default.createElement(Qk,{open:P,anchorEl:b.current,chatHubOrder:o,conversationType:g,AIProvider:n,AIModel:r,onChange:W,onClose:()=>{L()}}),ye.default.createElement(lf,null))},Ng=Jk;var gs=e=>{let{AIModel:t,AIProvider:o}=Fo.use.chat(),n=Fo.use.setChatAIModelAndProvider();return Mp.default.createElement(Mp.default.Fragment,null,Mp.default.createElement(Ng,{AIModel:t,AIProvider:o,chatHubOrder:void 0,setAIModelAndProvider:n,...e}))},DS=e=>{let{AIModel:t,AIProvider:o}=Fo.use.art(),n=Fo.use.setArtAIModelAndProvider();return Mp.default.createElement(OS,{AIModel:t,AIProvider:o,setAIModelAndProvider:n,...e})},FS=({order:e,...t})=>{let{isPayingUser:o}=Tt(),n=o?Cy:_y,r=Fo.use.chat(),i=Fo.use.chatHub(),a=Fo.use.setChatAIModelAndProvider(),s=Fo.use.setChatHubAIModelAndProvider(),l=e===0?a:m=>{s(e,m)},p=e===0?r:i[e],{AIModel:u,AIProvider:c}=p||n;return Mp.default.createElement(Ng,{chatHubOrder:e,AIModel:u,AIProvider:c,setAIModelAndProvider:l,...t})};var eL=200,tL=({contentHeight:e})=>{let{t}=E(),{palette:o}=Il(),n=(0,be.useMemo)(()=>typeof window>"u"?"immersive_rewrite":Ta()?"sidebar_rewrite":"immersive_rewrite",[]),[r,i]=(0,be.useState)(""),a=Ke(r),[s,l]=(0,be.useState)(!1),[p,u]=(0,be.useState)(!1),{askAIQuestion:c,askAIWithShortcuts:m,stopGenerate:d}=Ne(),f=ql(),{conversationId:h}=_e(),_=xe(h),g=f.getInputValue(),{liteContextMenuActionsItems:y}=Hi(g),C=(0,be.useRef)(null),b=(0,be.useMemo)(()=>p?[]:y,[p,y,t]),v=(0,be.useMemo)(()=>b.flatMap(F=>{if(F.type==="group"){let pe=`context_menu__prompt__${F.prompt_id}`,ae=`package__features:${pe}`,te=t(ae),Te=Or?te==="package__features:"+pe:te===pe;return(!te||te===F.prompt_id||Te||pe===ae)&&(te=F.prompt_title),[te+"__CONTEXT_MENU_LABEL_SLOT_PLACEHOLDER__"+F.prompt_id,...F.children??[]]}return[F]}),[b,t]),S=async()=>{if(!await Fe({emitEvent:!0})){f.focus();return}if(_){d();return}let F=a.current;if(!F){l(!0);return}let pe=C.current?.getSelectedItem();if(pe)O(pe);else if(g.trim()){let ae=`${g}:
"""
{{SELECTED_TEXT}}
"""`;await c({type:"user",text:ae,meta:{includeHistory:!0}},{beforeActions:[{type:"RENDER_TEMPLATE",parameters:{template:"{{POPUP_DRAFT}}"}},{type:"SET_VARIABLE",parameters:{Variable:{key:"SELECTED_TEXT",overwrite:!0,value:F,isBuiltIn:!0}}},{type:"SET_VARIABLE",parameters:{Variable:{key:"ANALYTICS_FEATURE_NAME",value:n,overwrite:!0,isBuiltIn:!0}}}]})}},P=(0,be.useRef)(null),k=(0,be.useRef)(null),L=(0,be.useRef)(null),H=()=>{L.current?.querySelector("textarea")?.focus()},W=()=>{H()},O=async F=>{if(H(),!a.current){l(!0);return}if(!F||!F.prompt_id||F.type==="group")return;let ae=De(F.actions||[]);ae.unshift({type:"SET_VARIABLE",parameters:{Variable:{key:"SELECTED_TEXT",value:a.current.trim(),overwrite:!0,isBuiltIn:!0,label:"Selected text overwrite"}}},{type:"SET_VARIABLE",parameters:{Variable:{key:"VARIABLE_MODAL_KEY",value:"SidebarRewrite",overwrite:!0,isBuiltIn:!0}}},{type:"SET_VARIABLE",parameters:{Variable:{key:"ANALYTICS_FEATURE_NAME",value:n,overwrite:!0,isBuiltIn:!0}}}),ae.length>0&&m(ae,{overwriteParameters:[{key:"SELECTED_TEXT",value:a.current,label:"Selected text",isBuiltIn:!0,overwrite:!0}]})},D=co(),[V,N]=(0,be.useState)(10);(0,be.useEffect)(()=>{let F=Math.floor((e-eL-140)/24);F<=0||N(Math.min(F,10))},[e]);let z=(0,be.useMemo)(()=>Math.min(e-140-V*24,300),[e,V]),j=(0,be.useRef)(null),G=(0,be.useCallback)(()=>{Y.current?.()},[]),q=()=>{k.current?.focus()},A=()=>{f.focus()},Y=(0,be.useRef)(q),Q=F=>{Y.current=F},[M,K]=__([["maxai-animation-slide-in",{duration:200}],["maxai-animation-slide-in",{fillMode:"forwards",delay:-100,duration:200}]]);return be.default.createElement(be.default.Fragment,null,be.default.createElement(x,{gap:1,sx:{boxSizing:"border-box",border:"1px solid",borderColor:"border.main",bgcolor:o.background.paper,borderRadius:1,boxShadow:"rgb(15 15 15 / 5%) 0px 0px 0px 1px, rgb(15 15 15 / 10%) 0px 3px 6px, rgb(15 15 15 / 20%) 0px 9px 24px",overflow:"hidden",isolation:"isolate",width:"100%",py:1,px:1.5,maxWidth:"768px",...M},onKeyUp:F=>{F.stopPropagation()},onKeyDown:F=>{F.stopPropagation()}},be.default.createElement(x,{direction:"row",justifyContent:"space-between",sx:{wordBreak:"break-word",color:F=>F.palette.mode==="dark"?"#FFFFFFDE":"rgba(0,0,0,0.87)"},component:"div"},be.default.createElement(x,{direction:"row",gap:.5},be.default.createElement(ms,null),be.default.createElement(ef,{enableChatMode:"pro_chat"},be.default.createElement(gs,{conversationType:"ContextMenu",tooltipProps:{placement:"bottom"},sx:{height:"32px"},onChanged:G}),be.default.createElement(ds,{onChanged:G}))),be.default.createElement(x,{direction:"row",gap:1,alignItems:"center"},p&&be.default.createElement(he,{title:t("package__common:discard")},be.default.createElement(Ve,{onClick:()=>{j.current?.discard()},sx:{width:"auto",color:"inherit",padding:"3px",marginLeft:"-4px",marginRight:"-3px"}},be.default.createElement(HS.default,{sx:{fontSize:17,color:"text.secondary"}}))))),!p&&be.default.createElement(B,{sx:{width:"100%",p:1,bgcolor:F=>F.palette.mode==="dark"?"#3B3D3E":"#F4F4F4",boxShadow:"0px 1px 2px rgba(16, 24, 40, 0.05)",borderRadius:1,boxSizing:"border-box",border:"1px solid",borderColor:s?Ox[800]:"transparent","& > textarea":{border:"none",outline:"none",background:"transparent",width:"100%",height:"100%",resize:"none",color:"text.primary",lineHeight:"24px",fontFamily:"inherit",fontSize:"16px"}}},be.default.createElement("textarea",{onFocus:()=>Q(q),ref:k,rows:V,onClick:F=>{F.stopPropagation()},value:r,onChange:F=>{l(!1),i(F.target.value)},placeholder:t("package__features:chat__home_view__rewrite__textarea__placeholder"),autoFocus:!0})),be.default.createElement(sf,{ref:j,showCloseButton:!1,onClose:()=>{u(!1)},onShow:()=>{u(!0)},modelKey:"SidebarRewrite"}),!p&&be.default.createElement(x,{direction:"row",alignItems:"end",gap:1},be.default.createElement(x,{direction:"row",width:0,flex:1,alignItems:"center",spacing:1,justifyContent:"left",ref:L},be.default.createElement(bp,{ref:F=>f.bindRef(F),minLine:1,stopPropagation:!0,autoFocus:!0,onKeyDownCapture:F=>{C.current?.proxyKeyboardEvent(F.nativeEvent)?(F.preventDefault(),F.stopPropagation()):F.shiftKey&&F.key.toLowerCase()==="tab"&&(k.current?.focus(),F.preventDefault(),F.stopPropagation())},onFocusCapture:F=>{k.current&&k.current.value===""&&!k.current.getAttribute("data-autofocused")?(k.current.setAttribute("data-autofocused","true"),k.current.focus(),F.preventDefault(),Q(q)):Q(A)},value:g,onChangeText:F=>f.updateInputValue(F),placeholder:t("package__features:chat__home_view__rewrite__input__placeholder"),sx:{border:"none","& > div":{"& > div":{p:0},"& > textarea":{p:0},"& > .max-ai-user-input__expand":{"&:has(> div)":{pr:1}}},borderRadius:0,minHeight:"24px"},onEnter:S})),be.default.createElement(yp,{placement:"bottom-end",disabled:(!g||!r)&&!_,onClick:S}))),be.default.createElement(B,{sx:{maxWidth:"768px",width:"100%",display:v.length<=0?"none":void 0}},be.default.createElement(of,{sx:{opacity:0,...K},ref:C,open:!0,defaultPlacement:"bottom-start",needAutoUpdate:!0,root:D,menuList:v,referenceElementRef:P,menuWidth:415,referenceElement:be.default.createElement(B,{"data-test-id":"ContextMenuList-referenceElementRef"}),onClickItem:O,onClickGroup:W,menuMaxHeight:`${z}px`})))},oL=()=>{let e=(0,be.useRef)(),[t,o]=(0,be.useState)(0);return(0,be.useEffect)(()=>{e.current&&o(e.current.clientHeight)},[]),(0,be.useEffect)(()=>{if(!e.current)return;let n=()=>{e.current&&o(e.current.clientHeight)},r=new ResizeObserver(n);return r.observe(e.current),()=>{r.disconnect()}},[]),be.default.createElement(B,{ref:e,component:"div",width:"100%",padding:"10px",paddingBottom:0,flexGrow:1,display:"flex",flexDirection:"column",alignItems:"center",sx:{boxSizing:"border-box"}},t!==0?be.default.createElement(as,{defaultContextMenuPath:"/rewrite"},be.default.createElement(tL,{contentHeight:t})):null)},NS=oL;var Qc=I(w());var zS={MAXAI_FLUX:ic({prompt_id:O2,prompt_title:"Prompt Optimization FLUX/SD",type:"chat_complete",variables:[{hint:"User input",name:"USER_INPUT",type:"text"},Be.PRESET_VARIABLE__AI_RESPONSE_TONE,Be.PRESET_VARIABLE__AI_RESPONSE_WRITING_STYLE],output:[Be.OUTPUT_PRESET_VARIABLE__CHAT_COMPLETE]}),MAXAI_STABLE_DIFFUSION:ic({prompt_id:B2,prompt_title:"Prompt Optimization FLUX/SD",type:"chat_complete",variables:[{hint:"User input",name:"USER_INPUT",type:"text"},{hint:"The previous user inputs",name:"PREVIOUS_USER_INPUTS",type:"text"},Be.PRESET_VARIABLE__AI_RESPONSE_TONE,Be.PRESET_VARIABLE__AI_RESPONSE_WRITING_STYLE],output:[Be.OUTPUT_PRESET_VARIABLE__CHAT_COMPLETE]}),MAXAI_DALLE:ic({prompt_id:L2,prompt_title:"Prompt Optimization DALL\xB7E",type:"chat_complete",variables:[{hint:"User input",name:"USER_INPUT",type:"text"},Be.PRESET_VARIABLE__AI_RESPONSE_TONE,Be.PRESET_VARIABLE__AI_RESPONSE_WRITING_STYLE],output:[Be.OUTPUT_PRESET_VARIABLE__CHAT_COMPLETE]}),MAXAI_OPENAI_IMAGE:ic({prompt_id:k2,prompt_title:"Prompt Optimization OpenAI",type:"chat_complete",variables:[{hint:"User input",name:"USER_INPUT",type:"text"},Be.PRESET_VARIABLE__AI_RESPONSE_TONE,Be.PRESET_VARIABLE__AI_RESPONSE_WRITING_STYLE],output:[Be.OUTPUT_PRESET_VARIABLE__CHAT_COMPLETE]})};var Xc=class{async createTextToArtActions(t,o,n,r){r=r||yy.getState().art.AIModel;let i=await un.getService().getConversationById(t),a=i?.meta.AIProvider;if(!i||o.trim()===""||!a)return[];let s=await Ur.getService().dangerouslyGetTotalMessages(t),l=Bo(),p=Bo(),u=await wC("MAXAI_DALLE"),c={prompt:o,model:Tl.value,contentType:u?.contentType,resolution:u?.resolution,generateCount:u?.generateCount,aspectRatio:u?.aspectRatio},m=zS[i?.meta.AIProvider||"MAXAI_DALLE"],d=!0,f=[],h={type:"CHAT_MESSAGE",parameters:{ActionChatMessageType:"user",ActionChatMessageOperationType:"add",ActionChatMessageConfig:{conversationId:t,messageId:l,type:"user",meta:{includeHistory:!0,messageChatDocuments:n,messageVisibleText:o,contexts:[],disableEditQuestion:!0},text:o}}};if(d&&m){let _=[];for(let C=s.length-1;C>=0;C--){let b=s[C];if(xr(b)&&b.originalMessage){let v=b.originalMessage.metadata?.title?.title||"",S=b.originalMessage.metadata?.artTextToImagePrompt||"";if(v&&S&&v&&_.unshift(v),b.originalMessage.metadata?.includeHistory===!1)break}}let g=_.map((C,b)=>`${b+1}. ${C}`).join(`
`),y=n?.length?[{type:"SET_VARIABLE",parameters:{Variable:{key:"IMAGE_PROMPT",overwrite:!0,value:o,isBuiltIn:!0}}}]:[{type:"ASK_CHATGPT",parameters:{isEnabledDetectAIResponseLanguage:!1,AskChatGPTActionType:"ASK_CHAT_GPT_HIDDEN",MaxAIPromptActionConfig:m,AskChatGPTActionQuestion:{text:o,meta:{historyMessages:[],outputMessageId:"{{AI_RESPONSE_MESSAGE_ID}}",messageVisibleText:o}}}},{type:"TEXT_HANDLER",parameters:{ActionTextHandleParameters:{trim:!0,noQuotes:!0,noCommand:!0}}},{type:"SET_VARIABLE",parameters:{VariableKey:"IMAGE_PROMPT"}}];f=[h,{type:"CHAT_MESSAGE",parameters:{ActionChatMessageOperationType:"add",ActionChatMessageConfig:{type:"ai",messageId:p,text:"",originalMessage:{metadata:{AIModel:r,shareType:"art",title:{title:o},copilot:{title:{title:"AI art",titleIcon:"Awesome",titleIconSize:24},steps:[{title:"Optimizing art prompt",status:"loading",icon:"CheckCircle"}]},artTextToImageMetadata:c}}}}},{type:"SET_VARIABLE",parameters:{VariableKey:"AI_RESPONSE_MESSAGE_ID"}},{type:"SET_VARIABLE_MAP",parameters:{VariableMap:{PREVIOUS_USER_INPUTS:g,USER_INPUT:o}}},...y,{type:"CHAT_MESSAGE",parameters:{ActionChatMessageOperationType:"update",ActionChatMessageConfig:{type:"ai",messageId:"{{AI_RESPONSE_MESSAGE_ID}}",text:"",originalMessage:{metadata:{isComplete:!1,copilot:{steps:[{title:"Optimizing art prompt",status:"complete",icon:"CheckCircle",value:"{{IMAGE_PROMPT}}",valueType:"text"}]},artTextToImagePrompt:"{{IMAGE_PROMPT}}"},content:{title:{title:"Image",titleIcon:"Image"},contentType:"image",text:""}}}}},{type:"ASK_CHATGPT",parameters:{AskChatGPTActionType:"ASK_CHAT_GPT_HIDDEN",isEnabledDetectAIResponseLanguage:!1,AskChatGPTActionQuestion:{text:"{{IMAGE_PROMPT}}",meta:{outputMessageId:"{{AI_RESPONSE_MESSAGE_ID}}",messageVisibleText:"{{IMAGE_PROMPT}}",messageChatDocuments:n,contextMenu:{id:ah,droppable:!1,parent:"",text:"[Art] text to image",data:{editable:!1,type:"shortcuts",actions:[]}}}}}},{type:"SCRIPTS_LIST",parameters:{}},{type:"CHAT_MESSAGE",parameters:{ActionChatMessageOperationType:"update",ActionChatMessageConfig:{type:"ai",text:"",messageId:"{{AI_RESPONSE_MESSAGE_ID}}",originalMessage:{content:{text:"",contentType:"image"},metadata:{attachments:"{{LAST_ACTION_OUTPUT}}"}}}}}]}else f=[h,{type:"CHAT_MESSAGE",parameters:{ActionChatMessageOperationType:"add",ActionChatMessageConfig:{type:"ai",messageId:p,text:"",originalMessage:{metadata:{includeHistory:!1,artTextToImagePrompt:o,shareType:"art",title:{title:o},copilot:{title:{title:"Pro art",titleIcon:"Awesome",titleIconSize:24},steps:[{title:"Generating art",status:"complete",icon:"CheckCircle",value:o}]},artTextToImageMetadata:c}}}}},{type:"SET_VARIABLE",parameters:{VariableKey:"AI_RESPONSE_MESSAGE_ID"}},{type:"CHAT_MESSAGE",parameters:{ActionChatMessageOperationType:"update",ActionChatMessageConfig:{type:"ai",messageId:"{{AI_RESPONSE_MESSAGE_ID}}",text:"",originalMessage:{content:{title:{title:"Image",titleIcon:"Image"},contentType:"image",text:""}}}}},{type:"ASK_CHATGPT",parameters:{AskChatGPTActionType:"ASK_CHAT_GPT_HIDDEN",isEnabledDetectAIResponseLanguage:!1,AskChatGPTActionQuestion:{text:o,meta:{includeHistory:!1,outputMessageId:"{{AI_RESPONSE_MESSAGE_ID}}",messageVisibleText:o,messageChatDocuments:n,contextMenu:{id:ah,droppable:!1,parent:"",text:"[Art] text to image",data:{editable:!1,type:"shortcuts",actions:[]}}}}}},{type:"SCRIPTS_LIST",parameters:{}},{type:"CHAT_MESSAGE",parameters:{ActionChatMessageOperationType:"update",ActionChatMessageConfig:{type:"ai",text:"",messageId:"{{AI_RESPONSE_MESSAGE_ID}}",originalMessage:{content:{text:"",contentType:"image"},metadata:{attachments:"{{LAST_ACTION_OUTPUT}}"}}}}}];return f}};var VS=new Xc;var Ko=I(w());var nL=e=>{let{tip:t,sx:o,wrapSx:n,children:r,lineClamp:i=3,resizeListener:a=!1,tooltipZIndex:s,TooltipProps:l,startSlot:p,endSlot:u,hideTooltip:c,...m}=e,d=(0,Ko.useRef)(null),f=(0,Ko.useRef)(null),[h,_]=(0,Ko.useState)(!1),[g,y]=(0,Ko.useState)(!0),C=(0,Ko.useMemo)(()=>t??r,[r,t]),b=(0,Ko.useCallback)(()=>{if(f.current){let v=f.current;y(v.offsetHeight>=v.scrollHeight)}},[]);return(0,Ko.useEffect)(()=>{h&&r&&b()},[h,r,b]),(0,Ko.useEffect)(()=>{r&&!h&&_(!0)},[r,h]),(0,Ko.useEffect)(()=>{if(h&&a){let v=()=>b();d.current=new ResizeObserver(v),f.current&&d.current.observe(f.current)}return()=>{d.current?.disconnect()}},[h,a,b,f]),Ko.default.createElement(he,{title:c||g?"":Ko.default.createElement(T,{fontSize:"14px"},C),PopperProps:{style:{zIndex:s||2147483620,maxWidth:180}},...l},Ko.default.createElement(x,{direction:"row",alignItems:"center",flex:1,gap:"4px",sx:n},p,Ko.default.createElement(T,{ref:f,sx:{MozBoxOrient:"vertical",WebkitBoxOrient:"vertical",WebkitLineClamp:`${i}`,lineClamp:`${i}`,boxOrient:"vertical",display:"-webkit-box",overflow:"hidden",textOverflow:"ellipsis",flex:1,...o},...m},r),u))},hi=nL;var hf=I(w()),rL=({promptData:e,disabled:t,onClick:o,order:n,showLineClamp:r=1})=>hf.default.createElement(Ma,{in:!0,style:{transitionDelay:n?`${n*150}ms`:"0ms"}},hf.default.createElement(vn,{component:"button","data-testid":`sample-prompt-item${n}`,sx:{width:"100%",px:2,py:1.5,bgcolor:t?"background.secondary":"background.paper",border:"1px solid",borderColor:"border.main",boxShadow:t?"none":"0px 1px 2px 0px #0000000D",cursor:t?"default":"pointer",transition:"border-color 0.3s",borderRadius:1,flex:1,"&:hover":{borderColor:t?"border.main":"primary.main"}},onClick:()=>{t||o&&o(e)}},hf.default.createElement(hi,{textAlign:"left",tip:e.title,resizeListener:!0,lineClamp:r,sx:{fontSize:"14px",lineHeight:"21px",whiteSpace:"normal",wordBreak:"break-word",minHeight:r*21,color:t?"text.disabled":"text.primary"}},e.title))),gf=rL;var RS=[{title:"Product mockups",prompt:"Generate a realistic product mockup for an Elegant Glass Meal Prep Set, which will allow customers to envision the product before making a purchase."},{title:"Social media graphics ",prompt:"Design an attention-grabbing graphic for a social post on healthy eating trends. Focus on food and without human faces or text."},{title:"Email banners",prompt:"Create an email banner for email sharing Christmas holiday greetings. With clear text: Merry Christmas!. Without human faces or other texts."},{title:"Logos",prompt:"Generate one single logo for a business eco-friendly packaging firm. Without human faces or texts."},{title:"Ad campaign visuals",prompt:"Generate an image for a banner ad on the theme of fitness, without text or human face."},{title:"Blog post feature image",prompt:"Generate an image that will complement a blog post on the topic mental health."},{title:"Website hero image",prompt:"Generate a hero image for a website dedicated to online learning. With clear beautiful human faces. Highlight the online learning concept."},{title:"Brochure Design",prompt:"Design a visually appealing brochure showcasing the benefits of a premium skincare line, targeting business owners."},{title:"Event Poster",prompt:"Create a vibrant poster promoting an upcoming event hosted by my company that focuses on community events, featuring captivating visuals. Without text."},{title:"Promotional video thumbnails",prompt:"Generate a compelling thumbnail for a promotional video showcasing success stories from customers, designed to attract clicks and drive engagement on platforms like YouTube or social media. If there are human faces, they need to be clear and beautiful."},{title:"Blog images",prompt:"Create a custom graphic for a blog post on remote working best practices. Make sure to include related images. If featuring human faces, ensure they are clear and radiate a sense of beauty and concentration."},{title:"Web page graphic",prompt:"Generate a graphic of homepage for a pet care services website that illustrates care and attention to pets."},{title:"Google ad",prompt:"Create a Google Ads banner to highlight a limited-time offer. Use images of Tablet products, and make sure the image grabs attention. With the text Limited Time Offer as the only text element."},{title:"Poster graphic",prompt:"Design a realistic graphic for a poster for a concert announcement. Make sure to incorporate detailed drawings of musical instruments."},{title:"Travel blogs/websites",prompt:"Generate a photo illustrating the vibrant and intricate rituals during the festival of Carnival. Without human faces."},{title:"E-commerce/online retail platforms",prompt:"Generate photos of a set of modern cookware in various settings, highlighting their non-stick surfaces and ergonomic handles."},{title:"Business websites/corporate blogs",prompt:"Generate photos of an executive team in a strategic retreat setting, fostering a sense of unity and vision. If featuring human faces, ensure they are clear and radiate a sense of beauty and concentration."},{title:"Lifestyle magazines/websites",prompt:"Generate a photo illustrating a mid-century modern home with eclectic decor and cozy corners."},{title:"Educational platforms/e-Learning websites",prompt:"Generate photos of students actively participating in a coding workshop. If featuring human faces, ensure they are clear and radiate a sense of beauty and concentration."},{title:"Event management websites/promotion platforms",prompt:"Capture the excitement of professionals networking and exchanging ideas at an event in a photograph. If featuring human faces, ensure they are front, clear and radiate a sense of beauty and concentration. When the human figure in the picture is relatively small, the complete face does not appear."},{title:"Wellness blogs/healthcare platforms",prompt:"Showcase farmers harvesting organic produce for a healthy and sustainable lifestyle."},{title:"Food and beverage blogs/websites",prompt:"Generate mouthwatering images of pasta dish being cooked, showcasing the blend of colours and textures."},{title:"Fitness and exercise blogs/websites",prompt:"Generate motivational images of individuals engaged in intense workout routines, highlighting their determination and perseverance to achieve their fitness goals.If featuring human faces, ensure they are front, clear and radiate a sense of beauty and concentration. When the human figure in the picture is relatively small, the complete face does not appear."},{title:"Fashion accessories brands/websites",prompt:"Create visually stunning images of a designer handbag, showcasing their elegance and luxury against contrasting backgrounds."},{title:"Product photography",prompt:"Create studio-quality photos of wireless earphones, showcasing them from multiple angles, highlighting the Noise Blocking and Comfortable Fit feature. Without any text."},{title:"Property listings",prompt:"Generate exterior photos of a suburban home. Include shots of the swimming pool and landscaped front yard."},{title:"Hospitality",prompt:"Generate inviting photos of a deluxe king room. Highlight the modern decor and comfortable seating area, ensuring the room looks welcoming and well-appointed."},{title:"Feature articles",prompt:"Generate a photo for a feature story on urban gardening. Include images of community gardens and green rooftops, highlighting sustainability and community spirit. Without any text or human faces."},{title:"Storyboard",prompt:"Generate a storyboard sequence for a romantic comedy where two rival chefs fall in love while competing on a cooking show. Include key scenes like the emotional revelation that changes everything."},{title:"Art for theatrical productions",prompt:"Create a set design concepts for Hamlet. Include elaborate period costumes and props."},{title:"Editorial Art",prompt:"Create a feature illustration for National Geographic exploring climate change and its effects on global migration. Include juxtaposition of contrasting images."},{title:"Art for awareness campaigns",prompt:"Generate a marketing graphic for an ocean plastic pollution awareness campaign. Include emotive photography of affected individuals or environments."},{title:"Literary classics reimagined",prompt:'Reimagine scenes from the literary classic "Pride and Prejudice", blending traditional and modern elements to add a unique artistic touch for a modern graphic novel adaptation. Need to without any texts.'},{title:"Bedtime stories",prompt:"Create warm visuals with soft lighting, cozy setting, and a touch of magic on the theme of nighttime journey through the cosmos, tailored for a bedtime story."},{title:"Philosophical abstract expressions",prompt:"Generate abstract and thought-provoking visuals that resonate with the philosophical concept of the paradox of infinity."},{title:"Surrealistic depiction",prompt:"Create surreal dreamscapes on the theme of the passage of time blending reality and fantasy, using unconventional perspectives and dreamlike elements to evoke a sense of wonder and curiosity."},{title:"Mandalas",prompt:"Craft mandalas incorporating vibrant colors and unique patterns that will inspire feelings of happiness and well-being."},{title:"Artwork from quote",prompt:'"I think, therefore I am." - Ren\xE9 Descartes. Turn this quote into an image artwork.'},{title:"Portrait",prompt:"Generate a portrait of Leonardo da Vinci in impressionism for a blog exploring the history of the Italian Renaissance"},{title:"Pop culture icons redesigned",prompt:"Reimagine iconic characters from Harry Potter with a contemporary twist, incorporating modern fashion and technology elements to breathe new life into familiar favorites."},{title:"Abstract emotions",prompt:"Generate an abstract artwork exploring the depths of human emotion, using color, form, and texture to convey feelings of serenity and chaos."},{title:"Cartoonized web series or online content",prompt:"Create artwork for characters for an animated web series about space adventures. Include robotic appendages in the character design."},{title:"Cartoons and caricatures for promotional material",prompt:"Design a caricature for a social media campaign promoting a food festival. Include exaggerated, humorous depictions of the character eating, highlighting fun atmosphere."},{title:"Custom caricatures for souvenirs ",prompt:"Design beautiful custom caricature for a mug souvenir, showing it exploring landmarks."},{title:"Public Art",prompt:"Create a mural design for a community center. Include environmental sustainability themes in the mural. Without any text."},{title:"Realistic Cartoon",prompt:"Generate a semi-realistic cartoon character with intricate details, blending elements of realism with a cartoon aesthetic into one piece. Need to Without any text."},{title:"Anime Hero",prompt:"Generate an anime character with large, detailed eyes with distinctive Japanese anime aesthetics."},{title:"Minimalist Line Art",prompt:"Design a simple cartoon character using minimalist line art, focusing on clean lines and basic shapes."},{title:"Pixel Art Character",prompt:"Craft a pixel art character, reminiscent of old-school video games, with limited colors and a blocky, pixelated design."},{title:"Comic Book Superhero",prompt:"Create a powerful superhero character in the style of a comic book, complete with bold outlines and vibrant colors."},{title:"Children's Book Illustration",prompt:"Generate a whimsical cartoon character suitable for children's book illustrations, characterized by soft lines and pastel colors to bring a gentle and enchanting vibe to the illustrations."},{title:"Manga Chibi",prompt:"Design a cute and chibi-style manga character with oversized heads, small bodies, and adorable expressions."},{title:"Surreal Art Deco",prompt:"Craft a surreal character in the style of Art Deco, known for its geometric shapes, bold colors, and elegant, vintage feel."},{title:"Retro Cartoon",prompt:"Create a character reminiscent of the classic, retro cartoon era, featuring exaggerated movements and playful antics."},{title:"Historical figure cartoonized",prompt:"Transform a famous historical figure into a lovable cartoon character, depicting them in humorous situations or reimagining their achievements with a playful twist. ! AI image prompts for video game design"},{title:"Color schemes and themes",prompt:"Design a thematic color palette for a fantasy game. I want the colors to evoke a sense of wonder and enchantment."},{title:"Props and objects",prompt:"Create designs for magical props for a role-playing game. Include detailed illustrations of a weathered tome with arcane symbols."},{title:"NPCs and enemies",prompt:"Design a non-playable character for a cyberpunk role-playing game. Include the distinct visual traits of a ruthless corporate enforcer."},{title:"Visuals for the game's website, social media channels",prompt:"I have created a game that explores a fantastical world of magic and adventure. Create a banner image for the game's  Instagram highlight cover. Include the player character wielding a legendary weapon featuring the main characters, set against a backdrop of towering futuristic skyscrapers."},{title:"Epic Fantasy World",prompt:"Design a picture of a stunning fantasy world, complete with enchanted forests, towering castles, and mythical creatures, setting the stage for a grand adventure."},{title:"Cyberpunk Cityscape",prompt:"Craft a futuristic cyberpunk cityscape, with neon-lit skyscrapers, bustling streets, and intricate details that define the urban dystopia."},{title:"Playable Character Concept ",prompt:"Design a character image of a unique playable character, outlining their appearance for a protagonist in an RPG game."},{title:"Alien Planet Ecosystem",prompt:"Create an illusion of an alien planet's ecosystem, with bizarre flora and fauna, strange geology, and atmospheric anomalies."},{title:"Haunted Mansion Interior",prompt:"Generate a chilling interior layout for a haunted mansion, replete with eerie corridors, ghostly apparitions, and secrets waiting to be discovered."},{title:"Melee Weaponry Collection",prompt:"Craft a collection of melee weapons, each with its own distinct design, perfect for a combat-focused game."},{title:"Sci-Fi Space Station",prompt:"Design a massive, intricate space station, teeming with advanced technology, modular compartments, and areas for various in-game activities."},{title:"Ancient Ruins Exploration",prompt:"Generate the environment of a long-forgotten civilization's ruins."},{title:"Interstellar Starship Bridge",prompt:"Craft the interior of an interstellar starship bridge, featuring advanced control panels, holographic displays, and the latest in spacefaring technology."},{title:"Legendary Artifact",prompt:"Craft an iconic legendary artifact for players to discover in-game, featuring intricate detailing, mystical symbols."}];var xf=I(w()),iL=(e,t)=>I_(e).slice(0,t),aL=(e,t=4)=>{let[o,n]=(0,xf.useState)([]);return(0,xf.useLayoutEffect)(()=>{n(iL(e,t))},[]),{samplePromptList:o}},_f=aL;var Yc=I(w()),sL=({promptItemXs:e,showLineClamp:t})=>{let{samplePromptList:o}=_f(RS),{conversationId:n}=_e(),{runShortcutsActions:r}=Ne();return Yc.default.createElement(x,{width:"100%","data-button-clicked-name":"art-sample-prompt-clicked"},Yc.default.createElement(ii,{container:!0,spacing:1.5},o.map((i,a)=>Yc.default.createElement(ii,{key:i.title,item:!0,xs:e},Yc.default.createElement(gf,{promptData:i,disabled:!1,onClick:async s=>{if(s&&s.prompt){let l=await VS.createTextToArtActions(n,s.prompt);l&&r(l)}},order:a+1,showLineClamp:t})))))},US=sL;var WS=async(e,t=0)=>{let o=async()=>{t<=0?await e():setTimeout(async()=>{await e()},t)},n=await lc.isLogin();return new Promise(r=>{if(n)o().then(()=>{r(!0)});else{if(lo){r(!1);return}let i=document.querySelector('[data-testid="maxai--sign-in--button"]');if(i){i.dispatchEvent(new MouseEvent("click",{bubbles:!0}));let a=setInterval(async()=>{await lc.isLogin()?(clearInterval(a),await o(),r(!0)):i.disabled===!1&&(clearInterval(a),r(!1))},250)}}})};var GS=[{title:"Humanity's Last Exam"},{title:"New Blood Group Identified"},{title:"View the Comet of the Century"},{title:"Global Seed Vault Under Threat"},{title:"The Fed\u2019s Big Rate Cut"},{title:"23andMe's Fallout"},{title:"New Insights into the Multiverse"},{title:"Lionsgate's Runway AI Video Deal"},{title:"'Third State' Beyond Life and Death"},{title:"Snap's New Large AR Spectacles"},{title:"Earth's Ancient Ring System"},{title:"Neuralink Gets FDA Breakthrough Device"},{title:"CATL's Million-Mile Bus Battery"},{title:"Bitcoin's 66-bit Puzzle Solved"},{title:"Slack Debuts AI Agents"},{title:"Blue Origin Mars Mission Delayed"},{title:"Lucid's Upcoming Affordable SUV"},{title:"The History of Lehman Brothers Bankruptcy"},{title:"Larry Ellison's Take on AI"}];var Zc=I(w()),pL=({promptItemXs:e,showLineClamp:t})=>{let{conversationId:o}=Mt(),{runShortcutsActions:n}=Ne(),{samplePromptList:r}=_f(GS);return Zc.default.createElement(x,{"data-button-clicked-name":"search-sample-prompt-clicked"},Zc.default.createElement(ii,{container:!0,spacing:1.5},r.map((i,a)=>Zc.default.createElement(ii,{key:i.title,item:!0,xs:e},Zc.default.createElement(gf,{promptData:i,disabled:!1,onClick:async s=>{if(s.title){let l=await my.createShortcutsActions(o,s.title,!0);await WS(()=>{n(l)})}},order:a+1,showLineClamp:t})))))},jS=pL;var cL=()=>{let{conversationType:e}=Mt(),t={promptItemXs:6,showLineClamp:2},o={Art:Qc.default.createElement(US,{...t}),Search:Qc.default.createElement(jS,{...t})}[e]||null;return Qc.default.createElement(Qc.default.Fragment,null,o)},Cf=cL;var uL=e=>{let{sx:t,chatBoxHeight:o}=e,{t:n}=E();return Gt.default.createElement(x,{className:"maxai--chat-home-view",gap:1.5,mb:"12px",sx:{"& *":{boxSizing:"border-box"},overflow:"hidden",...t}},Gt.default.createElement(T,{"data-testid":"maxai--chat-home-view--title",sx:{height:"100%",display:"flex",alignItems:"flex-end",color:"text.primary",fontSize:"24px",fontWeight:700,lineHeight:"33.6px",textAlign:"center"}},lo?Gt.default.createElement(g_,{sx:{fontSize:32,color:"inherit"}}):n("package__features:chat__home_view__website__title")),Gt.default.createElement(qd,{sx:{"@media (max-height: 600px)":{display:"none"}}}))},mL=e=>{let{sx:t,isMessageEmpty:o}=e,{t:n}=E(),r=re(i=>i.conversationType);return Gt.default.createElement(x,{className:"maxai--chat-home-view",flexGrow:1,width:"100%",sx:{overflowY:"auto","& *":{boxSizing:"border-box"},...t}},r==="ContextMenu"&&Gt.default.createElement(x,{direction:"column",sx:{width:"100%",padding:"32px 10px"},flexGrow:1},Gt.default.createElement(x,{direction:"column",alignItems:"center",justifyContent:"center",sx:{height:"175px"}},Gt.default.createElement(U,{icon:"Rewrite",sx:{color:"primary.main",fontSize:"40px",marginBottom:"12px"}}),Gt.default.createElement(T,{component:"h1",marginBottom:"8px",lineHeight:"140%",fontWeight:700,fontSize:20,textAlign:"center",color:i=>i.palette.mode==="dark"?"rgba(255, 255, 255, 0.87)":"rgba(0, 0, 0, 0.87)"},n("package__features:chat__home_view__rewrite__title")),Gt.default.createElement(T,{lineHeight:"150%",fontSize:14,textAlign:"center",color:i=>i.palette.mode==="dark"?"rgba(255, 255, 255, 0.87)":"rgba(0, 0, 0, 0.60)"},n("package__features:chat__home_view__rewrite__description"))),o&&Gt.default.createElement(NS,null)),r==="Art"&&Gt.default.createElement(x,{px:2,width:"100%",height:"100%",justifyContent:"center",alignItems:"center",position:"relative"},Gt.default.createElement(x,{justifyContent:"center",alignItems:"center",maxWidth:680,width:"80%"},Gt.default.createElement(U,{icon:"Art",sx:{color:"primary.main",fontSize:"48px"}}),Gt.default.createElement(T,{component:"h1",mt:1.5,mb:1,fontSize:"20px",fontWeight:700,textAlign:"center",color:"text.primary"},n("package__features:chat__home_view__art__title")),Gt.default.createElement(T,{fontSize:"14px",fontWeight:400,textAlign:"center",color:"text.primary"},n("package__features:chat__home_view__art__description")))),r==="Summary"&&Gt.default.createElement(Wn,{sx:{my:0},loading:!0}),Gt.default.createElement(x,{alignItems:"center",maxWidth:768,mx:"auto",width:"100%",p:1.5,gap:1.5},Gt.default.createElement(Cf,null)))},KS=({sx:e})=>{let{t}=E();return Gt.default.createElement(x,{sx:{gap:1.5,m:1.5,overflow:"hidden",...e}},Gt.default.createElement(T,{component:"h1",sx:{height:"100%",display:"flex",alignItems:"flex-end",color:"text.primary",fontSize:"24px",fontWeight:700,lineHeight:"33.6px",textAlign:"center"}},t("package__features:chat__home_view__art__title")))},dL=e=>re(o=>o.conversationType)==="Chat"?Gt.default.createElement(uL,{...e}):Gt.default.createElement(mL,{...e}),qS=dL;var Er=I(w());var Jc=I(w()),fL=e=>class extends Jc.Component{constructor(o){super(o),this.state={hasError:!1}}componentDidCatch(o,n){this.setState({hasError:!0})}render(){return this.state.hasError?Jc.default.createElement(e,{...this.props,liteMode:!0,hasError:!0}):Jc.default.createElement(e,{...this.props})}},wp=fL;var H0=I(w());var $n=I(w()),yf="chat-message--AI-tools",bf=(0,$n.createContext)({AIMessage:{},usePromptOpen:!1,setUsePromptOpen:()=>{},onClickPromptItem:()=>{},onRegenerate:()=>{},content:{contentType:"text",text:""},metadata:{},processingStep:"RESPONDED",isLoading:!1,isWritingMessage:!1,isLastMessage:!1,isAutoHideTools:!0}),If=e=>{let{message:t,loading:o,children:n}=e,{conversationId:r,inputMediator:i}=_e(),a=qa(r),[s,l]=(0,$n.useState)(!1),{content:p,metadata:u,processingStep:c}=Ty(t,o),m=!!o,d=t?.messageId===a||m,f=!d&&!s,h=!u.isComplete||m,_=Ne(),g=Ke(_),y=(0,$n.useRef)(!1),C=(0,$n.useCallback)(async S=>{if(!y.current)try{if(y.current=!1,S&&S.length>0){let k=(t&&Rr(t,!1)||"").replace(wl,""),L=De(S||[]);L.unshift({type:"SET_VARIABLE",parameters:{Variable:{key:"SELECTED_TEXT",value:k||" ",label:"Selected text",isBuiltIn:!0,overwrite:!0}}},{type:"SET_VARIABLE",parameters:{Variable:{key:"VARIABLE_MODAL_KEY",value:"Sidebar",overwrite:!0,isBuiltIn:!0}}}),i.focus(),await cy(L,async H=>{let W=H.parameters?.AskChatGPTActionQuestion;return W?.meta&&(W.meta.includeHistory=!0),H}),await g.current.askAIWithShortcutsV2(L,{disabledMaxAIDocumentIds:!0})}}catch{}finally{y.current=!1}},[i,t]),b=(0,$n.useCallback)(()=>{g.current.regenerate(r)},[r]),v=(0,$n.useMemo)(()=>({AIMessage:t,usePromptOpen:s,setUsePromptOpen:l,onClickPromptItem:C,onRegenerate:b,content:p,metadata:u,processingStep:c,isLoading:h,isWritingMessage:m,isLastMessage:d,isAutoHideTools:f}),[t,s,l,C,b,p,u,c,h,m,d,f]);return $n.default.createElement(bf.Provider,{value:v},n)},Xe=()=>(0,$n.useContext)(bf);var $S=I(nw()),XS=I(iw());var mo=I(w()),hL=e=>{let{message:t}=e,{t:o}=E(),[n,r]=mo.default.useState(null),[i,a]=(0,mo.useState)(!1),s=!!n,{updateMessage:l}=Di(),{conversationId:p}=_e(),u=g=>{r(g.currentTarget)},c=()=>{r(null)},m=()=>{a(!0)},d=()=>{a(!1)},f=()=>{a(!1);let g=De(t);xr(t)?(g.originalMessage?.metadata&&(g.originalMessage.metadata.includeHistory=!0),g=Jo([g,{originalMessage:{metadata:{includeHistory:!0}}}])):g=Jo([g,{meta:{includeHistory:!0}}]),l(p,g)},h=(0,mo.useMemo)(()=>Ta(),[]);return!0?null:mo.default.createElement(ft,{sx:{mb:2}},mo.default.createElement(x,{direction:"row",alignItems:"center"},mo.default.createElement(T,{color:"text.secondary",fontSize:"12px"},o("package__features:chat__context_cleared__title")),mo.default.createElement(ce,{variant:"text",sx:{width:"30px",height:"30px",color:"inherit",minWidth:"unset",ml:"auto!important"},onClick:u},mo.default.createElement(XS.default,{sx:{fontSize:16,color:"text.primary"}}))),mo.default.createElement(Fr,{anchorEl:n,open:s,onClose:c,slotProps:{}},mo.default.createElement(ct,{onClick:()=>{c(),m()},sx:{color:"error.main"}},mo.default.createElement($S.default,{sx:{fontSize:16,mr:1,color:"inherit"}}),o("package__common:delete"))),mo.default.createElement(m2,{open:i,onClose:g=>{g.stopPropagation(),d()},sx:{position:h?"absolute":"fixed"}},mo.default.createElement(ju,{sx:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",borderRadius:"4px",bgcolor:"background.paper",maxWidth:"512px!important",width:h?"448px":"100%",p:2},onClick:g=>{g.stopPropagation()}},mo.default.createElement(x,{spacing:2},mo.default.createElement(T,{fontSize:"20px",fontWeight:700,lineHeight:"24px",color:"text.primary"},o("package__features:chat__context_cleared__delete__title")),mo.default.createElement(T,{fontSize:"16px",color:"text.primary"},o("package__features:chat__context_cleared__delete__description")),mo.default.createElement(x,{direction:"row",spacing:1,justifyContent:"end"},mo.default.createElement(ce,{variant:"outlined",onClick:d},o("package__common:cancel")),mo.default.createElement(ce,{variant:"contained",color:"error",onClick:f,sx:{bgcolor:"#f44336!important","&:hover":{bgcolor:"#d32f2f!important"}}},o("package__common:confirm")))))))},Sf=hL;var We=I(w());var Ep=I(w()),gL=e=>{let{sx:t,fontSx:o,iconSx:n,showLoading:r}=e,{title:i,titleIcon:a,titleIconSize:s}=e.title,l=`${s||20}px`;return Ep.default.createElement(x,{direction:"row",alignItems:"center",spacing:1,sx:t,className:"chat-message--metadata-title"},typeof a=="string"&&a?Ep.default.createElement(x,{alignItems:"center",justifyContent:"center",width:l,height:l},Ep.default.createElement(U,{sx:{color:"text.primary",fontSize:l,...n},icon:a})):a,Ep.default.createElement(T,{sx:{color:"text.primary",fontWeight:400,fontSize:"18px",...o}},i),r&&Ep.default.createElement(B,{sx:{display:"inline-block",width:"12px",height:"12px",margin:"0 0 0 4px !important",borderRadius:"50%",backgroundColor:p=>p.palette.mode==="dark"?"#fff":"#000"}}))},Gi=gL;var ua=I(w()),YS=e=>{let{AIProvider:t,AIModel:o,icon:n,title:r,sx:i}=e,a=(0,ua.useMemo)(()=>{let s=en(void 0,o),l=n;return!n&&s&&(l=ua.default.createElement(Do,{size:24,provider:t,model:s.value,sx:{outline:"1px solid rgba(0, 0, 0, 0.08)",borderRadius:"8px"}})),{icon:l,title:r||s?.title||""}},[t,o,n,r]);return!a.icon&&!a.title?null:ua.default.createElement(x,{direction:"row",alignItems:"center",gap:1,height:24,className:"chat-ai-message--ai-model",sx:i},a.icon,ua.default.isValidElement(a.title)?a.title:ua.default.createElement(T,{sx:{fontSize:"16px",lineHeight:"24px",color:s=>s.palette.mode==="dark"?"rgba(255, 255, 255, 0.87)":"rgba(0, 0, 0, 0.87)",fontWeight:500}},a.title))},ma=e=>ua.default.createElement(YS,{icon:ua.default.createElement(Nr,null),title:"MaxAI",...e}),Ap=YS;var kp=I(w());var zg=I(w());var xL=()=>{let{processingStep:e}=Xe();return e==="RESPONDING"||e==="RESPONDED"?zg.default.createElement(x,{direction:"row",alignItems:"center",gap:1},zg.default.createElement(ma,{title:"Answer"})):null},ZS=xL;var QS=I(w()),_L=()=>{let{processingStep:e}=Xe();return e==="RESPONDING"||e==="RESPONDED"?QS.default.createElement(ma,{title:"Answer"}):null},JS=_L;var Pp=I(w()),CL=e=>{let{message:t}=e,{content:o,metadata:n}=Xe(),r=t.conversationId||"",i=n?.shareType==="summary",a=Gl(r),s=Gm(r);if(s&&s!==rh.value&&t.originalMessage?.metadata?.AIModel!==rh.value)return Pp.default.createElement(Ap,{AIProvider:a,AIModel:t.originalMessage?.metadata?.AIModel||s});let l=Pp.default.createElement(Jt,{size:18}),p="";return n.isComplete?(l=o.title?.titleIcon&&o.title?.titleIcon!=="Loading"?o.title?.titleIcon:Pp.default.createElement(Vs,{icon:"Read",sx:{fontSize:"24px"}}),p=o.title?.title||"Answer"):(o.contentType==="text"?p="Writing":o.contentType==="image"&&(p="Creating image"),o.title?.title&&(p=o.title.title),o.title?.titleIcon&&o.title?.titleIcon!=="Loading"&&(l=o.title?.titleIcon),i&&o?.title?.titleIcon!=="Loading"&&(l=o.title?.titleIcon||Pp.default.createElement(Vs,{icon:"Read",sx:{fontSize:"24px"}}),p=o.title?.title||"Answer")),Pp.default.createElement(Gi,{title:{title:p,titleIcon:l,titleIconSize:24}})},e3=CL;var yL=e=>{let{message:t}=e,{metadata:o}=Xe(),n=t.conversationId||"",r=Gl(n),i=Gm(n);if(o.chatMode==="free_chat")return kp.default.createElement(ZS,{message:t});if(o.chatMode==="pro_chat"||o.shareType==="art")return kp.default.createElement(JS,{message:t});if(o.shareType==="summary")return kp.default.createElement(e3,{message:t});let a=o.AIModel||i;return a?kp.default.createElement(Ap,{AIProvider:r,AIModel:a}):kp.default.createElement(ma,null)},Vg=yL;var el=I(w());var hn=I(w()),bL=e=>{let{message:t}=e,o=(0,hn.useRef)(null),[n,r]=(0,hn.useState)([0,0]),[i]=(0,hn.useState)(1),[a]=(0,hn.useState)("1:1"),s=(0,hn.useMemo)(()=>{try{let c=t.originalMessage?.metadata?.attachments||[],m=n[0],d=n[1];if(c.length>0&&m&&d){let h=2;c.length>=12?h=4:c.length>=9&&(h=3);let _=Math.ceil(c.length/h),g=c.length>=h,y=g?(h-1)*6*2:0,C=g?(_-1)*6*2:0,b=g?(m-y)/h:m,v=g?(d-C)/_:d,S=Math.min(b,v);return c.map((P,k)=>{let L=a||P?.meta?.aspectRatio||"1:1",[H,W]=L.split(":").map(Number),O=H>=W,D=H/W,V=O?S:S*D,N=O?S/D:S,z=Math.floor(k/h),j=k%h,G=z*(S+6*2),q=j*(S+6*2);return{imageBoxWidth:V,imageBoxHeight:N,imageBoxTop:G,imageBoxLeft:q,image:P}})}else return[]}catch{return[]}},[t.originalMessage?.metadata?.attachments,n,i,a]),l=(0,hn.useMemo)(()=>Rn(()=>{if(o.current){let{width:c,height:m}=o.current.getBoundingClientRect();r([c,m])}},50),[]);(0,hn.useEffect)(()=>{let c=new ResizeObserver(()=>{l()});return o.current&&c.observe(o.current),()=>{c.disconnect()}},[o]);let[p,u]=(0,hn.useState)();return hn.default.createElement(x,{component:"div",ref:o,mt:1,minHeight:"16px",width:"60%",minWidth:sc-16-16,sx:{position:"relative"}},hn.default.createElement(Li,{hideMenu:!0,images:s.map(c=>({src:c.image?.uploadedUrl||"",alt:c.image?.fileName||""})),selectedImage:p,setSelectedImage:u}),s.map(c=>{let d=(o.current?.getBoundingClientRect().width||sc-16-16)/vC(c?.image?.meta?.aspectRatio);return hn.default.createElement(B,{ref:o,key:1,className:"maxai-ai-message__image__content__box",sx:{position:"relative",zIndex:0,display:"inline-flex",alignItems:"center",justifyContent:"center",width:"auto",height:"auto",overflow:"hidden",borderRadius:"4px","& > img":{width:"100%",height:"100%",border:"2px solid rgba(0,0,0,0)",boxSizing:"border-box",borderRadius:"8px",transition:"border .1s cubic-bezier(0.22, 0.61, 0.36, 1)",userSelect:"none",overflow:"hidden"}},onClick:()=>{u(c.image?.uploadedUrl||"")}},hn.default.createElement(Vr,{SkeletonSx:{width:"100%"},fileId:c.image.uploadedFileId,height:d,src:c.image?.uploadedUrl||"",alt:`Variation 1 of ${s.length}`}))}))},t3=bL;var Js=I(w()),IL=e=>{let{message:t,text:o,loading:n}=e,{isDarkMode:r}=lr(),{content:i,isLoading:a}=Xe(),s=n??(i.status===void 0?a:i.status!=="complete"),l=o??i.text;return Js.default.createElement("div",{"data-testid":"chat-ai-message--markdown","data-disabled-button-clicked":!0,className:`markdown-body ${r?"markdown-body-dark":""}`,translate:s?"no":void 0},Js.default.createElement(Js.Suspense,{fallback:Js.default.createElement(Wn,{loading:!0})},Js.default.createElement(Ya,{appendLoadingDot:s,message:t},l)))},o3=IL;var n3=I(w()),qo=I(w()),SL=e=>{let{transcripts:t,loading:o}=e,{t:n}=E(),[r,i]=(0,n3.useState)({}),a=c=>{let m=document.createElement("textarea");return m.innerHTML=c.trim().replace(/\n/g,""),m.value},s=c=>{let d=c.split("[AI KNOWLEDGE]({})"),f=[];return d.forEach((h,_)=>{let g=h.trim();g&&f.push(g),_<d.length-1&&f.push(qo.default.createElement(UC,null))}),f},l=c=>{r[c]=!r[c],i({...r})},p=!t||!Array.isArray(t),u=t?.length===0;return p?qo.default.createElement(T,{fontSize:16,color:"error",sx:{p:0,flex:1}},n("package__features:chat__ai_message__youtube_summary__transcript_timestamped_error")):u?qo.default.createElement(T,{fontSize:16,color:"text.primary",sx:{p:0,flex:1}},n("package__features:chat__ai_message__youtube_summary__not_have__transcript")):qo.default.createElement(x,{gap:2},t.map((c,m)=>{if(c.text||c.status==="error"){let d=c?.children&&c?.children.length>0;return qo.default.createElement(x,{key:c.start},qo.default.createElement(x,{direction:"row",justifyContent:"flex-start",alignItems:"flex-start",spacing:1,key:m},qo.default.createElement(Mh,{time:c.start,docId:c.docId,url:c.url}),c.status!=="error"&&qo.default.createElement(x,{sx:{flex:1,cursor:d?"pointer":"default"},onClick:()=>c.id&&l(c.id)},qo.default.createElement(T,{fontSize:16,color:"text.primary"},s(a(c.text||""))),d&&qo.default.createElement(x,{direction:"row",alignItems:"center"},qo.default.createElement(T,{fontSize:15,color:"text.secondary"},r[c.id||""]?n("package__features:chat__ai_message__youtube_summary__collapse"):n("package__features:chat__ai_message__youtube_summary__expand")),r[c.id||""]?qo.default.createElement(U,{sx:{transform:"rotate(180deg)",color:f=>f.palette.mode==="dark"?"rgba(255, 255, 255, 0.7)":"rgba(0, 0, 0, 0.6)"},size:25,icon:"KeyboardArrowDown"}):qo.default.createElement(U,{sx:{color:f=>f.palette.mode==="dark"?"rgba(255, 255, 255, 0.7)":"rgba(0, 0, 0, 0.6)"},size:25,icon:"KeyboardArrowDown"}))),c.status==="error"&&qo.default.createElement(T,{fontSize:16,color:"error",sx:{p:0,flex:1}},n("package__features:chat__ai_message__youtube_summary__transcript_timestamped_error"))),c?.children&&r[c.id||""]&&c?.children?.map(f=>qo.default.createElement(x,{direction:"row",justifyContent:"flex-start",alignItems:"flex-start",spacing:1,key:f.id,sx:{marginTop:"5px",marginLeft:"10px"}},qo.default.createElement(Mh,{mode:"lite",time:f.start,docId:f.docId,url:f.url}),qo.default.createElement(T,{fontSize:15,color:"text.secondary",onClick:()=>c.id&&l(c.id),sx:{p:0,flex:1,cursor:"pointer"}},s(a(f.text||""))))))}else if(o&&c.status==="loading")return qo.default.createElement(vo,{key:m,variant:"rounded",width:"100%",height:15});return null}))},Rg=SL;var vL=e=>{let{message:t,hasError:o}=e,{content:n,metadata:r,processingStep:i,isLoading:a}=Xe(),s=()=>!xC(t)||i==="RESPONDING"||i==="RESPONDED"?n.contentType==="image"||r.artTextToImageMetadata||r.shareType==="art"?i!=="RESPONDED"?null:el.default.createElement(t3,{message:t}):(r.videoTimestamped?.length||r.videoTranscripts?.length)&&!n.text?null:el.default.createElement(o3,{message:t}):null;return el.default.createElement(el.default.Fragment,null,!o&&r.videoTimestamped&&el.default.createElement(Rg,{transcripts:r.videoTimestamped,loading:a}),!o&&r.videoTranscripts&&el.default.createElement(Rg,{transcripts:r.videoTranscripts,loading:a}),s())},Ug=vL;var tu=I(w()),TL=()=>{let[e,t]=(0,tu.useState)(()=>window.location.href),[o,n]=(0,tu.useState)(document.title),r=(0,tu.useRef)(null),i=()=>{a(),r.current=setInterval(()=>{n(document.title),t(window.location.href)},1e3)},a=()=>{r.current&&clearInterval(r.current)};return{pageUrl:e,documentTitle:o,startListen:i,stopListen:a}},vf=TL;var r3=[{itemId:D2,count:10.2,timestamp:Date.now(),readonly:!0},{itemId:H2,count:10.3,timestamp:Date.now(),readonly:!0},{itemId:z2,count:10.2,timestamp:Date.now(),readonly:!0},{itemId:N2,count:10.1,timestamp:Date.now(),readonly:!0},{itemId:V2,count:10,timestamp:Date.now(),readonly:!0},{itemId:F2,count:10.2,timestamp:Date.now(),readonly:!0},{itemId:rm,count:10.2,timestamp:Date.now(),readonly:!0},{itemId:im,count:10.1,timestamp:Date.now(),readonly:!0},{itemId:am,count:10.2,timestamp:Date.now(),readonly:!0},{itemId:Ml,count:10.2,timestamp:Date.now(),readonly:!0}];var i3=[{title:"Kraft Heinz to eliminate artificial colors by 2027"},{title:"LA businesses reel as immigration raids devastate economy"},{title:"Solar stocks plunge as Senate targets renewable tax credits"},{title:"Russian drone attack kills at least 14 in Kyiv overnight strike"},{title:"US pressures Vietnam to cut Chinese tech use in export manufacturing"},{title:"Trump leaves G7 summit early amid Middle East tensions"},{title:"Trump, Carney set 30-day deadline for new trade deal"},{title:"Japan's PM presses Trump to drop $19B auto tariffs"},{title:"U.S. approves $2B fighter jet parts sale to Australia"},{title:"Senate GOP revives plan to sell 3 million acres of public land"},{title:"Defense giants vie for Trump's $175B missile shield"},{title:"MyPillow's Mike Lindell ordered to pay $2.3M for defaming Dominion executive"},{title:"Costco to build first standalone gas station in California"},{title:"Supreme Court to hear oil giants' bid to move lawsuits"},{title:"Trump declines to endorse G7 consensus on Iran policy"},{title:"Georgia Power completes world's largest hydrogen fuel test"},{title:"Foreign grads earn 32% more than US-born workers"},{title:"House GOP threatens to tank Trump tax bill over deduction cap"},{title:"Purdue Pharma settles with all U.S. states for $7.4B over role in fueling opioid crisis"}];var Tf=I(w()),Lp=(e,t)=>{if(!e)return t;let o=e.toLowerCase();return t.filter(n=>n.prompt_title.toLowerCase().includes(o)||Qa(n.prompt_id,n.prompt_title).toLowerCase().includes(o))},ML=e=>{let{liteContextMenuActionsItems:t}=Hi(e,{selectionInputAble:!0});return{query:e,selectedContextMenuList:t}},wL=e=>{let{t}=E(),{conversationId:o,selectionContent:n}=re(f=>({conversationId:f.conversationIds[0],selectionContent:f.selectionContent})),r=tn(o),{selectedDocuments:i}=$a(),a=s6(),{liteContextMenuList:s,refetch:l}=Hi(e,{selectionInputAble:!0,contextMenuPath:"/my_own_tools",enabledFavorite:!1}),{liteContextMenuList:p,refetch:u}=Hi(e,{selectionInputAble:!0,contextMenuPath:"/rewrite",enabledFavorite:!1}),c=(0,Tf.useMemo)(()=>i3.map(f=>Ql({promptId:Bo(),parentPromptId:rc,promptTitle:f.title,question:f.title,icon:"Search"})),[t]),m=(0,Tf.useMemo)(()=>{let f=[],h=!n&&i.length>0&&i.every(v=>v.maxAIDocumentType==="page_content__webpage"&&v.selected),_=!n&&i.length===1&&i[0].maxAIDocumentType==="page_content__youtube"&&i[0].selected,g=!n&&i.length===1&&i[0].maxAIDocumentType==="page_content__email"&&i[0].selected,y=!n&&i.length==1&&i[0].maxAIDocumentType==="search_results"&&i[0].selected,C=!n&&i.length>0&&i.every(v=>v.maxAIDocumentType==="image"&&v.selected),b=!n&&i.length>0&&i.every(v=>v.maxAIDocumentType!=="search_results"&&v.selected);if(!n){if(h){let v=sm.PAGE_SUMMARY;v&&f.push(...Lp(e,v(i)))}else if(_){let v=sm.YOUTUBE_VIDEO_SUMMARY;v&&f.push(...Lp(e,v(i)))}else if(g){let v=sm.DEFAULT_EMAIL_SUMMARY;v&&f.push(...Lp(e,v(i)))}else if(C){let v=[Ql({promptId:rm,parentPromptId:"",icon:"DocumentScanner",promptTitle:t("package__features:chat_box__auto_suggestion__suggested__prompt__extract_text"),question:t("package__features:chat_box__auto_suggestion__suggested__prompt__extract_text")}),Ql({promptId:im,parentPromptId:"",icon:"Question",question:t("package__features:chat_box__auto_suggestion__suggested__prompt__explain_content"),promptTitle:t("package__features:chat_box__auto_suggestion__suggested__prompt__explain_content")})];f.push(...Lp(e,v))}else if(y)f=Lp(e,c);else if(b){let v=[Ql({promptId:am,parentPromptId:"",promptTitle:t("package__features:chat_box__auto_suggestion__suggested__prompt__summarize"),question:t("package__features:chat_box__auto_suggestion__suggested__prompt__summarize")})];f.push(...Lp(e,v))}}return f},[e,c,i,n,t]),d=(0,Tf.useMemo)(()=>{let f=[],h={prompt_id:rc,parent_prompt_id:"",prompt_title:t("package__features:chat_box__auto_suggestion__suggested__title"),type:"group",children:[],actions:[]};f.push(h);let _=!n&&i.length==1&&i[0].maxAIDocumentType==="search_results"&&i[0].selected,g=e==="",y=[...m,...s.filter(b=>b.type==="chat_complete").map(Gs),...p.filter(b=>b.type==="chat_complete").map(Gs)],C=ai(y,(b,v)=>{let S=a.indexOf(b.prompt_id);return S===-1?1e5+v:S},["asc"]).slice(0,5);if(r.length===0)g?_?h.children=m:h.children=C.filter(b=>a.includes(b.prompt_id.replace(mn,""))):h.children=C;else{if(g)return h.children=[],f;h.children=C}if(e.trim()&&h.children?.length){let b=Ql({promptId:Ml,parentPromptId:h.prompt_id,promptTitle:t("package__features:chat_box__auto_suggestion__suggested__prompt__ask_query",{QUERY:`"${e}"`}),question:e,disableEditQuestion:!1});h.children=[b,...h.children].slice(0,5)}return h.children=h.children.map(b=>(b.parent_prompt_id=h.prompt_id,b)),f},[t,m,s,p,e,r.length,a,i]);return cn(()=>{l("useChatGlobalSuggestedQuery"),u("useChatGlobalSuggestedQuery")}),{query:e,selectedContextMenuList:d}},EL=e=>{let t=ML(e),o=wL(e),{selectedType:n}=Un(),{contextMenuPath:r}=uo();return n==="SUGGESTED"&&r!=="/compose_reply"?o:t},a3=EL;var Wg=I(w()),AL=e=>{let{t}=E(),{onClick:o}=e;return Wg.default.createElement(ne,{onClick:o,title:t("package__common:close"),placement:"bottom",sx:{width:"26px",height:"26px",padding:"8px"}},Wg.default.createElement(U,{icon:"Close"}))},s3=AL;var tl=I(w()),PL=e=>{let{sx:t,children:o,LiteContextMenuEditViewProps:n,LiteContextMenuPositionSettingsProps:r,isBottom:i,hideToolbar:a=!1}=e,{mode:s,contextMenuPath:l}=uo(),{refetch:p}=nn();return(0,tl.useEffect)(()=>{p("SidebarLiteContextMenuLayout")},[l]),tl.default.createElement(x,{sx:{width:"100%",height:"100%",...t}},s==="edit"&&tl.default.createElement(a6,{...r}),s==="list"&&o,s==="edit"&&tl.default.createElement(p6,{...n}),l!==null&&!a&&tl.default.createElement(c6,{sx:{...i?{borderTop:"1px solid",borderColor:"border.main",borderRadius:" 0 0 8px 8px"}:{borderBottom:"1px solid",borderColor:"border.main",borderRadius:"8px 8px 0 0"}}}))},l3=PL;var at=I(w()),kL=e=>{let{isMessageEmpty:t=!0,sx:o,inputElementRef:n,onBeforeRunSuggestion:r,filterContextMenuList:i}=e,{t:a}=E(),{conversationId:s,inputMediator:l}=_e(),p=at.default.useRef(null),{layout:u,conversationType:c}=re(Y=>({layout:Y.layout,conversationType:Y.conversationType})),{selectedType:m,resetMyOwnToolsType:d}=Un(),f=xe(s),h=tn(s),{selectedDocuments:_,loading:g}=$a(),[y,C]=(0,at.useState)(""),{selectedContextMenuList:b}=a3(y),v=_.length===1&&_[0].maxAIDocumentType==="search_results"&&m==="SUGGESTED",S=(0,at.useMemo)(()=>m==="SUGGESTED"&&y===""&&!v||m!=="SUGGESTED",[m,y,v]),P=(0,at.useMemo)(()=>(i?i(b):b).filter(Y=>Y.type==="group"?Y.children.length>0:!0),[b,i]),{askAIWithShortcutsV2:k}=Ne(),L=u<=1&&h.length===0&&t,[H,W]=(0,at.useState)(!1),[O,D]=(0,at.useState)(null),[V,N]=(0,at.useState)(!0),z=f||g,j=async Y=>{if(!await Fe({emitEvent:!0})){l.focus();return}if(Y.actions){if(r&&!r(Y))return;await k(Y.actions,{isClearInput:!0,isFocusInput:!0})}};(0,at.useEffect)(()=>{let Y=n?.current||kt(c).ref;if(Y){let Q=ae=>{if(["ArrowUp","ArrowDown"].includes(ae.key)){let Te=ae.key==="ArrowUp"?-1:1,Ie=p.current?.querySelectorAll("[data-promptid]");if(Ie&&Ie.length>0){ae.preventDefault(),W(!0);let lt=Array.from(Ie).findIndex(nt=>nt.getAttribute("data-promptid")===O)+Te,Le=null;lt<0?Le=Ie[Ie.length-1]:lt>=0&&lt<Ie.length?Le=Ie[lt]:Le=Ie[0],D(Le.getAttribute("data-promptid")),Le.scrollIntoView({behavior:"instant",block:"nearest"})}}else if(ae.key==="Enter"&&!ae.shiftKey&&!l.isComposing){let Te=p.current?.querySelector(`[data-promptid="${O}"]`);Te&&(ae.stopPropagation(),ae.preventDefault(),Te.click())}},M=()=>{C(Y.value)},K=()=>{setTimeout(()=>{C(Y.value)},0),setTimeout(()=>{C(Y.value)},200)},F=()=>{W(!1)};Y.addEventListener("keydown",Q,{capture:!0}),Y.addEventListener("input",M,{capture:!0}),Y.addEventListener("blur",K),C(Y.value);let pe=setInterval(()=>{C(Y.value)},1e3);return window.addEventListener("mousemove",F),()=>{clearInterval(pe),Y.removeEventListener("keydown",Q,{capture:!0}),Y.removeEventListener("input",M,{capture:!0}),Y.removeEventListener("blur",K),window.removeEventListener("mousemove",F)}}},[c,O]),(0,at.useEffect)(()=>{let Y=null;for(let Q of P)if(Q.children.length>0){Y=Q.children[0],Y.prompt_id===Ml&&Q.children[1]&&(Y=Q.children[1]);break}D(Y?.prompt_id||null)},[P]),cn(()=>{Dm.getService("CONTEXT_MENU_SUGGEST").setReadonlyItems(r3)});let G=(0,at.useRef)(!1);(0,at.useEffect)(()=>{if(G.current){G.current=!1;return}N(!0)},[h,_,m]);let q=P.length===0,A=h.length===0;return f?null:at.default.createElement(x,{ref:p,"data-testid":"maxai--chat-auto-suggestion--container",sx:{position:"relative",...L?{borderTop:"1px solid",borderColor:"border.main",order:"2!important"}:{borderBottom:"1px solid",borderColor:"border.main",marginTop:"0px !important",order:"0!important"},...q?{border:"none"}:{},...H?{pointerEvents:"none"}:{},...V?{}:{display:"none"},gap:"10px","&:empty":{display:"none"},...o}},at.default.createElement(l3,{hideToolbar:y!=="",isBottom:L,LiteContextMenuEditViewProps:{sx:{padding:"4px",maxHeight:"max(200px, 14vh)",overflowY:"auto",p:0}}},at.default.createElement(Dr,{sx:{display:q?"none":"block",maxHeight:"max(200px, 14vh)",overflowY:"auto",padding:"4px"}},P.map((Y,Q)=>{let M=Y.prompt_title,K=`package__features:context_menu__prompt__${Y.prompt_id}`;return a(K).includes(Y.prompt_id)||(M=a(K)),at.default.createElement(x,{key:Y.prompt_id},P.length>=1&&at.default.createElement(x,{direction:"row",alignItems:"center",justifyContent:"space-between"},at.default.createElement(T,{fontSize:"12px",fontWeight:400,height:"32px",px:"8px",textAlign:"left",lineHeight:"32px",color:"text.secondary"},M),at.default.createElement(x,{direction:"row",gap:"6px",sx:{pr:"8px"}},S&&[mn,rc].includes(Y.prompt_id)&&at.default.createElement(Ip,null),Q===0&&V&&at.default.createElement(s3,{onClick:()=>{d(),m!=="SUGGESTED"&&(G.current=!0),N(!1)}}))),Y.children?.map(F=>{if(F.type==="group")return F.children.map(ae=>{let te=O===ae.prompt_id;return at.default.createElement(p3,{isSelected:te,key:F.prompt_id+F.prompt_title,contextMenuItem:ae,parent:F,disabled:z,onMouseEnter:()=>{D(ae.prompt_id)},onClick:async()=>{await j(ae)}})});let pe=O===F.prompt_id;return at.default.createElement(p3,{isSelected:pe,key:F.prompt_id+F.prompt_title,contextMenuItem:F,disabled:z,onMouseEnter:()=>{D(F.prompt_id)},onClick:async()=>{await j(F)}})}))}))))},p3=e=>{let{contextMenuItem:t,parent:o,disabled:n,onMouseEnter:r,onMouseLeave:i,onClick:a,isSelected:s}=e,{t:l}=E(),{selectedType:p}=Un(),u=t.prompt_icon||o?.prompt_icon,c=t.origin?.path||"",m=c&&c.startsWith("/rewrite"),d=c&&c.startsWith("/my_own_tools"),f=(0,at.useMemo)(()=>{let h=t.prompt_title,_=t.prompt_id.startsWith(mn)?t.prompt_id.replace(mn,""):t.prompt_id,g=`package__features:context_menu__prompt__${_}`;if(l(g).includes(_)||(h=l(g)),o?.prompt_title&&o?.prompt_id){let y=o.prompt_title,C=`package__features:context_menu__prompt__${o.prompt_id}`;l(C).includes(o.prompt_id)||(y=l(C),h=`${y} -> ${h}`)}return h},[l]);return at.default.createElement(ct,{disabled:n,onClick:a,onMouseEnter:r,onMouseLeave:i,"data-testid":`maxai--chat-auto-suggestion--menu-item--${t.prompt_id}`,"data-promptid":t.prompt_id,key:t.prompt_id,sx:{padding:"6px 8px",height:"32px",boxSizing:"border-box",gap:"12px",alignItems:"center",borderRadius:"4px",color:"text.primary",minHeight:"unset","&:hover":{color:"text.primary"},...s?{bgcolor:h=>h.palette.mode==="dark"?"rgba(255, 255, 255, 0.06)!important":"rgba(0, 0, 0, 0.04)!important"}:{}}},u&&at.default.createElement(U,{sx:{color:"text.secondary",flexShrink:0},icon:u,size:20}),at.default.createElement(T,{width:0,flex:1,fontSize:"14px",fontWeight:400,textAlign:"left",color:"text.primary",noWrap:!0},f),m&&s&&p==="SUGGESTED"&&at.default.createElement(T,{component:"span",sx:{border:"1px solid",borderColor:h=>h.palette.mode==="dark"?"rgba(255, 255, 255, 0.2)":"rgba(0, 0, 0, 0.1)",padding:"2px 4px",fontSize:"12px",borderRadius:"4px",color:h=>h.palette.mode==="dark"?"rgba(255, 255, 255, 0.38)":"rgba(0, 0, 0, 0.38)"}},l("package__features:chat__inputbox__button__my_own_tools__menu__rewrite")),d&&s&&p==="SUGGESTED"&&at.default.createElement(T,{component:"span",sx:{border:"1px solid",borderColor:h=>h.palette.mode==="dark"?"rgba(255, 255, 255, 0.2)":"rgba(0, 0, 0, 0.1)",padding:"1px 4px",fontSize:"12px",borderRadius:"4px",color:h=>h.palette.mode==="dark"?"rgba(255, 255, 255, 0.38)":"rgba(0, 0, 0, 0.38)"}},l("package__features:chat__inputbox__button__my_own_tools__menu__my_own_tools")))},Mf=kL;var c3=I(Vc());var Uo=I(w());var LL=e=>{let{value:t,onChange:o,onEnter:n,TextareaProps:r,error:i,sx:a,hideFooter:s=!1,onClickSuggestion:l,liteContextMenuPath:p}=e,{t:u}=E(),{chatMode:c}=us(),m=vt(ay),d=Uo.default.useRef(null),f=(0,Uo.useCallback)(g=>{if(m==="UNKNOWN"||!p||uc(p)!=="/compose_reply")return g;let y=C=>{let b=[];return m==="CHAT_APP_WEBSITE"&&b.push(...hh,...xh),m==="EMAIL"&&b.push(...gh,...xh),m==="SOCIAL_MEDIA"&&b.push(...gh,...hh),!b.includes(C.prompt_id.replace(mn,""))};return De(g).filter(C=>y(C)?(C.children&&(C.children=C.children.filter(b=>y(b))),!0):!1)},[m,p]),[h,_]=(0,Uo.useState)(!1);return(0,Uo.useEffect)(()=>(d.current&&kt("chatBoxSetVariablesModalInputMediator").bindRef(d.current),()=>{kt("chatBoxSetVariablesModalInputMediator").unbindRef()}),[]),Uo.default.createElement(x,{direction:"column",width:"100%",borderRadius:1,border:"1px solid",borderColor:`${i?"rgb(239, 83, 80)":"border.main"}`,boxShadow:"0px 1px 2px 0px rgba(0, 0, 0, 0.05)",boxSizing:"border-box",sx:{"& > *":{order:1},...a}},Uo.default.createElement(x,{"data-testid":"maxai--chat-box--chat-input--main",spacing:1,sx:{p:"10px"}},Uo.default.createElement(bp,{ref:d,"data-testid":"chat-input-textarea","data-disabled-button-clicked":!0,value:t,onChangeText:g=>{o?.(g)},onEnter:n,stopPropagation:!0,...r}),!s&&Uo.default.createElement(B,{display:"flex",alignItems:"center",justifyContent:"space-between"},Uo.default.createElement(x,{direction:"row",spacing:1,sx:{display:h?"none":"flex"}},e.footerLeftNode),Uo.default.createElement(x,{direction:"row",spacing:1,flex:1,justifyContent:"flex-end"},c==="free_chat"||t!==""?Uo.default.createElement(ne,{title:u("package__features:chat__inputbox__button__send_to_ai__tooltip"),description:"\u23CE",tooltipProps:{sx:{minWidth:"unset",p:1}},variant:"contained","data-testid":"sidebar_actions__send_btn",sx:{width:32,height:32,minWidth:"unset",borderRadius:1,boxSizing:"border-box","&[disabled]":{color:"background.paper"},"&:hover":{color:g=>g.palette.mode==="dark"?"rgba(0, 0, 0, 0.87)":"rgba(255, 255, 255, 1)"}},disabled:!t,onClick:n,styleType:"default"},Uo.default.createElement(c3.default,{sx:{fontSize:"16px",color:"inherit !important"}})):Uo.default.createElement(ps,{value:{isVoiceInput:h,setIsVoiceInput:_}},Uo.default.createElement(Cp,{onSpeechToTextSuccess:g=>{o?.(g),n?.()}}))))),p&&Uo.default.createElement(as,{defaultContextMenuPath:uc(p)},Uo.default.createElement(Mf,{onBeforeRunSuggestion:g=>l?(l(g),!1):!0,inputElementRef:d,filterContextMenuList:f})))},u3=LL;var _s=I(w()),jg=e=>{let{t}=E(),{sx:o,...n}=e;return _s.default.createElement(ne,{placement:"top",title:t("package__features:chat__ai_message__tools__regenerate_button"),sx:{p:"6px",...o},...n},_s.default.createElement(U,{sx:{fontSize:"20px"},icon:"Regenerate"}))},OL=e=>{let{message:t}=e,{t:o}=E(),{isLastMessage:n}=Xe(),r=t.conversationId||"",i=xe(r),{regenerate:a}=Ne(),[s,l]=(0,_s.useState)(!1);return(0,_s.useEffect)(()=>{n&&Ws(r).then(({lastRunActions:u})=>{l(u.length>0)})},[n]),n&&s?_s.default.createElement(jg,{disabled:i,onClick:()=>a(r),testid:"sidebar_actions__regenerate",sx:{p:"6px"}}):null},m3=OL;var f3=I(ir()),h3=I(Vc());var ee=I(w());var BL=({error:e})=>ee.default.createElement(Vu,{severity:"error",sx:{width:"100%",p:"12px",[`& .${zu.message}`]:{p:0,width:"100%"},"& > div:first-of-type":{display:"none"},"& .markdown-body":{"& > p:first-of-type":{mt:0}}},icon:ee.default.createElement(ee.default.Fragment,null)},ee.default.createElement(x,{sx:{fontSize:"0.875rem",lineHeight:"143%",letterSpacing:"0.17px"}},e)),wf=()=>{ta.send("SetVariablesModalClose",{})},DL=e=>{let{onShow:t,onClose:o,sx:n}=e,{t:r}=E(),{setChatHubLoading:i}=ot(),{askAIWithShortcutsV2:a}=Ne(),{chatMode:s}=us(),l=(0,ee.useRef)(null),[p,u]=(0,ee.useState)(!1),{conversationId:c}=_e(),[m,d]=(0,ee.useState)(!1),[f,h]=(0,ee.useState)(null),[_,g]=(0,ee.useState)(null),[y,C]=(0,ee.useState)(!1),[b,v]=(0,ee.useState)(!1),[S,P]=(0,ee.useState)(null),[k,L]=(0,ee.useState)(null);(0,ee.useEffect)(()=>{},[S]);let[H,W]=(0,ee.useState)(null),O=Ke(m),{control:D,trigger:V,reset:N,getValues:z,setValue:j,watch:G}=Bl({defaultValues:{textVariables:[],selectVariables:[]}}),q=Ra(),{fields:A}=dh({control:D,name:"textVariables"}),{fields:Y}=dh({control:D,name:"selectVariables"}),Q=f!==null?G(`textVariables.${f}.default_value`):null,M=(0,ee.useRef)(!1),K=A.filter(X=>!X.hidden).length,F=z().textVariables.filter(X=>!X.hidden&&!X.default_value).length>0,pe=Ke(_),ae=(0,ee.useRef)(null),[te,Te]=(0,ee.useState)(!1),Ie=(0,ee.useMemo)(()=>s==="free_chat"?!1:y||b||te?!0:typeof f=="number"?!Q:!1,[s,y,b,te,f,Q]),Nt=(0,ee.useMemo)(()=>S?.contextMenuId&&["47070ec6-8700-43fd-a519-20fe3841df38","9a65c4c0-c2b8-4fe1-a85e-0e2d84682eb1","b5381aa7-5ba3-4f96-a696-c694da938ef2"].includes(S.contextMenuId),[S?.contextMenuId]),lt=(0,ee.useRef)(),Le=(0,ee.useRef)(null),nt=(0,ee.useRef)(!1),At=(0,ee.useCallback)(X=>{X!=="done"&&C(!1),Te(!1),Le.current&&(Le.current.getTracks().forEach(Se=>Se.stop()),Le.current=null)},[]),Ze=()=>{C(!0)},dt=X=>{At(X),pt(pe.current)},It=(0,ee.useCallback)(()=>{u(!1),N({textVariables:[],selectVariables:[]}),W(null),m&&(d(!1),g(0),o?.())},[o,N,m]),Zt=Ke(It),pt=X=>{let Se=Array.from(l.current?.querySelectorAll('textarea:not([aria-hidden="true"])')||[]);if(typeof X=="number"&&Se[X])return Se[X].focus(),Se[X].setSelectionRange(Se[X].value.length,Se[X].value.length),!0;let Me=Se.find(ge=>!ge.value);return Me?(Me.focus(),Me.setSelectionRange(Me.value.length,Me.value.length),!1):!0},Lo=async()=>{!pt()||!await V()||S&&await St([{type:"ASK_CHATGPT",parameters:{AskChatGPTActionQuestion:{text:"",meta:Jo([{MaxAIPromptActionConfig:S.MaxAIPromptActionConfig},S?.questionMeta||{}])}}}])},St=(0,ee.useCallback)(async(X,Se)=>{try{i(!0);let Me=De(X),ge=Se?De(Se):{};if(!Se){let Pt=De(z());Pt.textVariables.concat(Pt.selectVariables).forEach(Oo=>{ge[Oo.name]={key:Oo.name,value:Oo.default_value,overwrite:!0,isBuiltIn:Oo.hidden,label:Oo.hint}})}if(s==="free_chat"){let Pt=ge.AI_RESPONSE_TONE;Pt&&(Pt.value="Default");let Oo=ge.AI_RESPONSE_WRITING_STYLE;Oo&&(Oo.value="Default")}Me.unshift({type:"SET_VARIABLE_MAP",parameters:{VariableMap:ge}});let ve=Me.some(Pt=>{let Oo=uy(Pt);if(Oo?.path){let rt=uc(Oo.path);return["/refine_draft","/rewrite","/compose_new","/compose_reply"].includes(rt)}return!1});d(!1),o?.(),AC.setOpenType(H?"instant_reply":"normal"),await a(Me,{conversationId:c,disabledMaxAIDocumentIds:ve,keepLoadingAfterExecution:!0,isFocusInput:!0});let yo=pi.getShortcutsEngine(c),ni=!0;if(yo.status!=="stop"&&H&&(ni=!1,Me[Me.length-1].type!=="SET_VARIABLES_MODAL")){let Pt=pi.getShortcutsEngine(c),Oo=await Ur.getService().getMessageByType(c,"ai","latest");if(Oo&&Pt.status==="idle"){ni=!1;let rt=De(sy);rt.variables=[Be.PRESET_VARIABLE__REFINE_DRAFT__FOLLOW_UP_INSTRUCTION,{name:"SELECTED_TEXT",hint:"Text to rewrite",type:"text",hidden:!0,default_value:Rr(Oo,!1)}],await ta.send(`SetVariablesModal_${c}`,{task:"open",config:{title:H,contextMenuId:rt.prompt_id,variables:rt.variables,MaxAIPromptActionConfig:rt}})}}ni&&i(!1)}catch{i(!1)}},[a,s,c,H,z,o]),$=(0,ee.useCallback)(async(X,Se)=>{try{return u(!0),await PC.usePromptAction(c,Se,{chatMode:"free_chat",jsonMode:!0,taskId:X})}catch{return{error:Mx,data:null}}finally{u(!1)}},[c]),fe=(0,ee.useRef)(""),ie=(0,ee.useRef)(null),R=(0,ee.useCallback)(async X=>{L(null),ie.current=X;let{task:Se,config:Me}=X||{};fe.current&&ar.abort(fe.current);let ge=Bo();if(fe.current=ge,Se==="open"&&Me){i(!0);let ve=Me;ve?.contextMenuId&&["d833ef67-36fb-4228-8e04-4b6d7583a341","1cc8f601-27ac-474f-a70c-20ed1177711a","47070ec6-8700-43fd-a519-20fe3841df38","9a65c4c0-c2b8-4fe1-a85e-0e2d84682eb1","b5381aa7-5ba3-4f96-a696-c694da938ef2","8c0c38d4-1dfe-498e-8229-05e758b2dc03"].includes(ve.contextMenuId)&&W(Qa(ve?.MaxAIPromptActionConfig?.prompt_id||"",ve?.title||""));let yo=await Sp.getSetVariablesModalSelectCache();ve.variables=ve.variables?.map(rt=>(Object.prototype.hasOwnProperty.call(yo,rt.name)&&(rt.default_value=yo[rt.name]),rt))||[];let ni=(ve.variables||[]).filter(rt=>rt.type==="text"),Pt=(ve.variables||[]).filter(rt=>rt.type==="select");if(N({textVariables:ni,selectVariables:Pt}),ve.description?.label&&ve.extraDataByPromptAction?.prompt_id&&(ve.description.label=Qa(ve.extraDataByPromptAction.prompt_id,ve.description.label)),P(ve),ve.extraDataByPromptAction&&$(fe.current,ve.extraDataByPromptAction).then(rt=>{!rt||ge!==fe.current||(rt.error?L(rt.error):P(ri=>rt.data?{...ri,description:{icon:"LightBulb",label:"Intent",...ri?.description,content:rt.data.intent}}:ri))}).catch(rt=>{}),!(ni.length>0&&ni.some(rt=>!rt.hidden&&!rt.default_value))&&!Me.disableAutoExecuteWhenAllVariableHaveValue){let rt=ve.variables||[],ri={};rt.forEach(Ii=>{ri[Ii.name]={key:Ii.name,value:Ii.default_value,overwrite:!0,isBuiltIn:Ii.hidden,label:Ii.hint}}),St([{type:"ASK_CHATGPT",parameters:{AskChatGPTActionQuestion:{text:"",meta:Jo([{MaxAIPromptActionConfig:ve?.MaxAIPromptActionConfig},ve?.questionMeta||{}])}}}],ri)}else d(!0),t?.(),setTimeout(()=>{pt()},0),i(!1);return{data:{},type:"confirm",success:!0}}},[St,$,t,N,i]);(0,ee.useEffect)(()=>{let X=ta.receive(`SetVariablesModal_${c}`,R);return()=>{X()}},[c,R]),(0,ee.useEffect)(()=>{c&&Zt.current()},[c]),(0,ee.useEffect)(()=>{let X=ta.receive("SetVariablesModalClose",()=>{O.current&&Zt.current()});return()=>{X()}},[]);let Z=(0,ee.useRef)(null);w_("keydown",X=>{X.key==="Escape"&&Zt.current()});let[de,se]=(0,ee.useState)(!1),oe=(0,ee.useMemo)(()=>ee.default.createElement(ee.default.Fragment,null,ee.default.createElement(ms,null),s!=="free_chat"&&ee.default.createElement(gs,null),s!=="free_chat"&&ee.default.createElement(ds,null)),[s]),Rt=co(),ue=(0,ee.useCallback)(()=>{let X=ae.current?.closest('[data-testid="maxai--chat-box--center--container"]');if(X||(X=Rt?.querySelector('[data-testid="maxai--chat-box--center--container"]')),X){let Se=0;m&&ae.current?.clientHeight&&(Se=ae.current.clientHeight-16),X.style.setProperty("--chatGptMarginTopExcludeAIReplyDescription",`${Se}px`)}},[Rt,m]);return(0,ee.useEffect)(()=>(ue(),()=>{ue()}),[S?.description,m,ue]),m?ee.default.createElement(x,{className:"max-ai__action__set_variables_modal",sx:{width:"100%",overflow:"hidden",pb:1,boxSizing:"border-box",...n},maxHeight:"100%",onKeyPressCapture:X=>{X.stopPropagation()},onKeyPress:X=>{X.stopPropagation()}},ee.default.createElement(x,{width:"100%",flexShrink:0,ref:ae},ee.default.createElement(x,{direction:"row",alignItems:"start",justifyContent:"space-between",width:"100%",sx:{bgcolor:"rgba(0, 0, 0, 0.87)",borderRadius:"8px",padding:"2px 2px 2px 12px",gap:"10px","&:has(+ .max-ai__action__set_variables_modal--description)":{borderRadius:"8px 8px 0 0"}}},ee.default.createElement(B,{width:0,flex:1,component:"div",display:"flex",alignItems:"center"},ee.default.createElement(T,{fontSize:"14px",color:"#fff",fontWeight:600,height:"32px",lineHeight:"30px",sx:{textAlign:"left",width:"100%"},noWrap:!0},Qa(S?.MaxAIPromptActionConfig?.prompt_id||"",S?.title||""))),ee.default.createElement(ne,{"data-testid":"close-modal-button",sx:{width:"32px",height:"32px",flexShrink:0},onMouseDown:()=>{Zt.current()}},ee.default.createElement(f3.default,{sx:{fontSize:"20px",color:"#fff!important"}}))),S?.description&&ee.default.createElement(x,{className:"max-ai__action__set_variables_modal--description",sx:{padding:"8px",border:"1px solid",borderTop:"none",borderColor:"border.main",gap:"4px",width:"100%",borderRadius:"0 0 8px 8px"}},ee.default.createElement(x,{direction:"row",alignItems:"center",gap:"8px"},ee.default.createElement(U,{icon:S.description.icon,sx:{flexShrink:0,fontSize:"20px",color:"text.primary"}}),ee.default.createElement(T,{fontSize:"14px",color:"text.primary",fontWeight:500,lineHeight:"20px",width:0,flex:1,noWrap:!0},r(`package__features:context_menu__prompt__${S.extraDataByPromptAction?.prompt_id}`)||S.description.label)),p?ee.default.createElement(x,null,ee.default.createElement(vo,{height:21,animation:"wave"})):k?ee.default.createElement(x,{sx:{alignItems:"flex-start"}},ee.default.createElement(BL,{error:k}),ee.default.createElement(jg,{sx:{marginTop:"8px"},onClick:()=>{R(ie.current)}})):ee.default.createElement(Ma,{in:!0},ee.default.createElement(T,{fontSize:"14px",color:"text.secondary",fontWeight:400,lineHeight:"21px"},S.description.content)))),ee.default.createElement(x,{direction:"row",alignItems:"center",gap:"4px",sx:{padding:"8px 0",width:"100%"}},s!=="free_chat"&&Y.length>0&&Y.map((X,Se)=>X.hidden?null:ee.default.createElement(Va,{key:X.name,control:D,name:`selectVariables.${Se}.default_value`,defaultValue:X.default_value,render:({field:Me})=>ee.default.createElement(af,{systemVariableSelectKey:X.name,key:X.name,defaultValue:Me.value,onChange:ge=>{Sp.setVariablesModalSelectCache(X.name,ge),Me.onChange(ge)}})}))),ee.default.createElement(x,{component:"div",direction:"row",flexWrap:"wrap",flex:1,height:0,sx:{gap:"8px",overflowY:"auto",scrollbarColor:"auto","&::-webkit-scrollbar":{width:"7px"},"&::-webkit-scrollbar-thumb":{borderRadius:"20px",backgroundColor:"text.secondary"}},ref:l},K===1&&A.map((X,Se)=>X.hidden?null:ee.default.createElement(Va,{control:D,rules:{required:!0},key:X.name,render:({field:Me})=>ee.default.createElement(u3,{"data-testid":`custom-variable--${X.name}`,value:Me.value||"",onChange:Me.onChange,TextareaProps:{minLine:4,placeholder:(X.hintI18nKey?r(X.hintI18nKey):X.hint)||`Enter ${X.name}`},onEnter:Lo,onClickSuggestion:async ge=>{await St(ge.actions)},liteContextMenuPath:Nt?S?.MaxAIPromptActionConfig?.path:void 0,footerLeftNode:oe}),name:`textVariables.${Se}.default_value`})),K>1&&ee.default.createElement(x,{sx:{height:"100%",width:"100%",overflow:"hidden",gap:"12px"}},ee.default.createElement(x,{sx:{flex:1,overflow:"auto",gap:"8px",flexWrap:"wrap",flexDirection:"row"}},A.map((X,Se)=>{let Me=(q==="lg"||q==="xl")&&A.length>1?"calc(50% - 8px)":"100%";return X.hidden?null:ee.default.createElement(Va,{control:D,rules:{required:!0},key:X.name,name:`textVariables.${Se}.default_value`,render:({field:ge})=>ee.default.createElement(Ct,{fullWidth:!0,"data-testid":`custom-variable--${X.name}`,size:"small",key:X.name,label:X.hint||"Label",value:ge.value||"",sx:{width:Me,mt:"8px"},InputProps:{sx:{fontSize:"16px",minHeight:"63px"}},inputProps:{style:{fontSize:"16px",textAlign:"left"}},FormHelperTextProps:{sx:{ml:0,fontSize:"12px"}},onChange:ve=>{ge.onChange(ve.target.value)},onKeyUp:ve=>{ve.stopPropagation()},onKeyDown:async ve=>{ve.key==="Enter"&&!ve.shiftKey&&!M.current?(ve.stopPropagation(),ve.preventDefault(),Lo()):ve.stopPropagation()},onCompositionStart:()=>{M.current=!0},onCompositionEnd:()=>{M.current=!1},onPaste:ve=>{ve.stopPropagation()},onFocus:ve=>{h(Se),g(Se)},onBlur:()=>{h(null)},InputLabelProps:{shrink:!0,sx:{fontSize:"16px"}},multiline:!0,placeholder:X.hint||`Enter ${X.name}`,minRows:2,maxRows:2})})})),ee.default.createElement(x,{direction:"row",alignItems:"center",justifyContent:"end",width:"100%"},de?null:ee.default.createElement(x,{sx:{flexDirection:"row",flex:1}},oe),Ie?ee.default.createElement(ps,{value:{isVoiceInput:de,setIsVoiceInput:se}},ee.default.createElement(Cp,{onMouseDown:async()=>{try{if(nt.current)return;Z.current&&clearTimeout(Z.current),v(!0),clearTimeout(lt.current),nt.current=!0,Le.current=await navigator.mediaDevices.getUserMedia({audio:!0}),nt.current=!1,Te(!0),window.addEventListener("mouseup",()=>{nt.current||(clearTimeout(lt.current),lt.current=setTimeout(()=>{v(!1)},200))},{once:!0})}catch{nt.current=!1,Z.current=setTimeout(()=>{v(!1)},3e3)}},onStartRecording:Ze,onStopRecording:dt,onSpeechToTextSuccess:X=>{pe.current!==null&&(j(`textVariables.${pe.current}.default_value`,X),pt(pe.current),C(!1))},onSpeechToTextFinally:()=>{At()}})):ee.default.createElement(ne,{title:r("package__features:chat__inputbox__button__send_to_ai__tooltip"),description:"\u23CE",tooltipProps:{sx:{minWidth:"unset",p:1}},variant:"contained","data-testid":"sidebar_actions__send_btn",sx:{width:32,height:32,minWidth:"unset",borderRadius:1,boxSizing:"border-box","&[disabled]":{color:"background.paper"},"&:hover":{color:X=>X.palette.mode==="dark"?"rgba(0, 0, 0, 0.87)":"rgba(255, 255, 255, 1)"}},disabled:F,onClick:Lo,styleType:"default"},ee.default.createElement(h3.default,{sx:{fontSize:"16px",color:"inherit !important"}})))))):null},g3=DL;var x3=()=>{let e=document.createElement("div");e.contentEditable="true",e.style.all="initial",e.style.position="absolute",e.style.top="-9999px",e.style.left="-9999px",e.style.width="1px",e.style.height="1px",e.style.overflow="hidden",document.body.appendChild(e),e.focus(),document.execCommand("paste",!1,"");let t=document.createElement("div");return e.childNodes.forEach(o=>{t.appendChild(o.cloneNode(!0))}),e.remove(),t},gi=e=>{let t=[];return e.forEach(o=>{document.querySelectorAll(o).forEach(n=>{n instanceof HTMLElement&&t.push(n)})}),t},Af=(e,t=!1)=>{if(e.focus(),!t)document.execCommand("selectAll",!1,"");else{let n=window.getSelection(),r=document.createRange();r.selectNodeContents(e),r.collapse(!1),n?.removeAllRanges(),n?.addRange(r)}document.execCommand("paste",!1,""),(e.lastElementChild||e).scrollIntoView({block:"center",inline:"center"})},_3={selectors:['div[id][contenteditable="true"]'],insertContent:async(e,t,o)=>{let n=_3.selectors,r=o||gi(n)[0];if(!r){let d=gi([".amn .ams.bkH",".amn .ams.bkI"]),f=d[d.length-1];f&&(f.click(),await uh(document.body,n[0],100,5e3),r=gi(n)[0])}if(!r)return;let i=document.createElement("div");i.className="F0iAze";let a=x3();a.className="Znr6db";let s=document.createElement("br");a.appendChild(s),i.appendChild(a),r.scrollIntoView({block:"center",inline:"center"});let l=!1,p=Array.from(r.childNodes);p.length===1&&p[0]instanceof HTMLElement&&(p=Array.from(p[0].childNodes)),p.forEach(d=>{if(d instanceof HTMLElement){let f=d;if((f.tagName==="HR"||f.matches(".gmail_quote")||f.querySelector(".gmail_quote"))&&(l=!0),l)return}d.remove()}),r.focus(),r.prepend(i);let u=document.createRange();u.selectNodeContents(a),u.collapse(!1);let c=window.getSelection();c?.removeAllRanges(),c?.addRange(u),(a.lastElementChild||a).scrollIntoView({block:"center",inline:"center"}),setTimeout(()=>{i.classList.remove("F0iAze")},1e3)}},Ef={selectors:['div[id^=editor] div[aria-multiline][spellcheck][contenteditable="true"]'],insertContent:async(e,t,o)=>{let n=Ef.selectors,r=o||gi(n)[0];if(!r){let m=gi(['button[role="menuitem"]:has(i[data-icon-name="ArrowReplyRegular"])','button[role="menuitem"]:has(i[data-icon-name="ArrowReplyAllRegular"])']),d=m[m.length-1];d&&(d.click(),await uh(document.body,n[0],100,5e3),r=gi(n)[0])}if(!r)return;let i=document.createElement("div"),a=x3();a.innerHTML=a.innerHTML.replace(/\n/g,"<br />");let s=document.createElement("br");a.appendChild(s),a.querySelectorAll("li > br:first-child").forEach(m=>{m.remove()}),i.appendChild(a);let l=!1;Array.from(r.children).forEach(m=>{(m.id.includes("RplyFwdMsg")||m.matches("#divRplyFwdMsg")||m.matches("#RplyFwdMsg")||m.querySelector("#divRplyFwdMsg")||m.querySelector("#RplyFwdMsg")||m.tagName==="HR")&&(l=!0),!l&&m.remove()}),r.focus(),r.prepend(i);let p=document.createRange();p.selectNodeContents(a),p.collapse(!1);let u=window.getSelection();u?.removeAllRanges(),u?.addRange(p),(a.lastElementChild||a).scrollIntoView({block:"center",inline:"center"})}},C3={selectors:["div[id][contenteditable]","div#contents ytd-commentbox:not([hidden]) div[id][contenteditable]"],needFindInstantReplyButtonIdToInput:!0,insertContent:async(e,t,o)=>{let n=C3.selectors,r=o||gi(n)[0];if(!r)return;let i=r.querySelector("a.yt-simple-endpoint[href]"),a=i?.innerHTML;Af(r),a&&(i.innerHTML=a)}},Kg=null,y3={selectors:['div.ql-editor[contenteditable="true"]','div.msg-form__contenteditable[contenteditable="true"]'],needFindInstantReplyButtonIdToInput:!0,insertContent:async(e,t,o)=>{let n=y3.selectors,r=o||gi(n)[0];if(!r)return;Kg&&clearTimeout(Kg);let a=r.querySelector("a.ql-mention[href]")?.cloneNode(!0)?.outerHTML;Af(r),a&&(Kg=setTimeout(()=>{let s=r.querySelector("p");s&&(s.innerHTML=a+" "+s.innerHTML)},50))}},b3={selectors:['div.ql-editor[contenteditable="true"]'],insertContent:async(e,t,o)=>{let n=b3.selectors,r=o||gi(n)[0];r&&Af(r)}};var I3={selectors:['[class^="channelTextArea"] [class^="textArea"] div[role="textbox"][contenteditable="true"]'],insertContent:async(e,t,o)=>{let n=I3.selectors,r=o||gi(n)[0];r&&Af(r)}};var S3={selectors:["textarea[id]"],needFindInstantReplyButtonIdToInput:!0,insertContent:async(e,t,o)=>{let n=S3.selectors,r=o||gi(n)[0];if(!r)return;r.focus(),r.select(),document.execCommand("paste",!1,""),r.setSelectionRange(r.value.length,r.value.length),r.closest("div#id.style-scope.ytcp-form-input-container")?.scrollIntoView()}},v3={"outlook.live.com":Ef,"outlook.office.com":Ef,"outlook.office365.com":Ef,"mail.google.com":_3,"youtube.com":C3,"studio.youtube.com":S3,"linkedin.com":y3,"app.slack.com":b3,"discord.com":I3};var qg=class e{constructor(){this.lastFocusInstantReplyInput=void 0}static getInstance(){return this.instance||(this.instance=new e),this.instance}setLastFocusInstantReplyInput(t){this.lastFocusInstantReplyInput=t}getLastFocusInstantReplyInput(){return this.lastFocusInstantReplyInput}},T3=qg;var no=I(w());var FL={};function ol(e,t){let o=t||FL,n=typeof o.includeImageAlt=="boolean"?o.includeImageAlt:!0,r=typeof o.includeHtml=="boolean"?o.includeHtml:!0;return w3(e,n,r)}function w3(e,t,o){if(HL(e)){if("value"in e)return e.type==="html"&&!o?"":e.value;if(t&&"alt"in e&&e.alt)return e.alt;if("children"in e)return M3(e.children,t,o)}return Array.isArray(e)?M3(e,t,o):""}function M3(e,t,o){let n=[],r=-1;for(;++r<e.length;)n[r]=w3(e[r],t,o);return n.join("")}function HL(e){return!!(e&&typeof e=="object")}function On(e,t,o,n){let r=e.length,i=0,a;if(t<0?t=-t>r?0:r+t:t=t>r?r:t,o=o>0?o:0,n.length<1e4)a=Array.from(n),a.unshift(t,o),e.splice(...a);else for(o&&e.splice(t,o);i<n.length;)a=n.slice(i,i+1e4),a.unshift(t,0),e.splice(...a),i+=1e4,t+=1e4}function Xn(e,t){return e.length>0?(On(e,e.length,0,t),e):t}var E3={}.hasOwnProperty;function A3(e){let t={},o=-1;for(;++o<e.length;)NL(t,e[o]);return t}function NL(e,t){let o;for(o in t){let r=(E3.call(e,o)?e[o]:void 0)||(e[o]={}),i=t[o],a;if(i)for(a in i){E3.call(r,a)||(r[a]=[]);let s=i[a];zL(r[a],Array.isArray(s)?s:s?[s]:[])}}}function zL(e,t){let o=-1,n=[];for(;++o<t.length;)(t[o].add==="after"?e:n).push(t[o]);On(e,0,0,n)}function Pf(e,t){let o=Number.parseInt(e,t);return o<9||o===11||o>13&&o<32||o>126&&o<160||o>55295&&o<57344||o>64975&&o<65008||(o&65535)===65535||(o&65535)===65534||o>1114111?"\uFFFD":String.fromCodePoint(o)}function da(e){return e.replace(/[\t\n\r ]+/g," ").replace(/^ | $/g,"").toLowerCase().toUpperCase()}var Ir=Cs(/[A-Za-z]/),Yn=Cs(/[\dA-Za-z]/),P3=Cs(/[#-'*+\--9=?A-Z^-~]/);function ou(e){return e!==null&&(e<32||e===127)}var nu=Cs(/\d/),k3=Cs(/[\dA-Fa-f]/),L3=Cs(/[!-/:-@[-`{-~]/);function me(e){return e!==null&&e<-2}function wo(e){return e!==null&&(e<0||e===32)}function ke(e){return e===-2||e===-1||e===32}var O3=Cs(/\p{P}|\p{S}/u),B3=Cs(/\s/);function Cs(e){return t;function t(o){return o!==null&&o>-1&&e.test(String.fromCharCode(o))}}function Oe(e,t,o,n){let r=n?n-1:Number.POSITIVE_INFINITY,i=0;return a;function a(l){return ke(l)?(e.enter(o),s(l)):t(l)}function s(l){return ke(l)&&i++<r?(e.consume(l),s):(e.exit(o),t(l))}}var D3={tokenize:VL};function VL(e){let t=e.attempt(this.parser.constructs.contentInitial,n,r),o;return t;function n(s){if(s===null){e.consume(s);return}return e.enter("lineEnding"),e.consume(s),e.exit("lineEnding"),Oe(e,t,"linePrefix")}function r(s){return e.enter("paragraph"),i(s)}function i(s){let l=e.enter("chunkText",{contentType:"text",previous:o});return o&&(o.next=l),o=l,a(s)}function a(s){if(s===null){e.exit("chunkText"),e.exit("paragraph"),e.consume(s);return}return me(s)?(e.consume(s),e.exit("chunkText"),i):(e.consume(s),a)}}var H3={tokenize:RL},F3={tokenize:UL};function RL(e){let t=this,o=[],n=0,r,i,a;return s;function s(C){if(n<o.length){let b=o[n];return t.containerState=b[1],e.attempt(b[0].continuation,l,p)(C)}return p(C)}function l(C){if(n++,t.containerState._closeFlow){t.containerState._closeFlow=void 0,r&&y();let b=t.events.length,v=b,S;for(;v--;)if(t.events[v][0]==="exit"&&t.events[v][1].type==="chunkFlow"){S=t.events[v][1].end;break}g(n);let P=b;for(;P<t.events.length;)t.events[P][1].end=Object.assign({},S),P++;return On(t.events,v+1,0,t.events.slice(b)),t.events.length=P,p(C)}return s(C)}function p(C){if(n===o.length){if(!r)return m(C);if(r.currentConstruct&&r.currentConstruct.concrete)return f(C);t.interrupt=!!(r.currentConstruct&&!r._gfmTableDynamicInterruptHack)}return t.containerState={},e.check(F3,u,c)(C)}function u(C){return r&&y(),g(n),m(C)}function c(C){return t.parser.lazy[t.now().line]=n!==o.length,a=t.now().offset,f(C)}function m(C){return t.containerState={},e.attempt(F3,d,f)(C)}function d(C){return n++,o.push([t.currentConstruct,t.containerState]),m(C)}function f(C){if(C===null){r&&y(),g(0),e.consume(C);return}return r=r||t.parser.flow(t.now()),e.enter("chunkFlow",{contentType:"flow",previous:i,_tokenizer:r}),h(C)}function h(C){if(C===null){_(e.exit("chunkFlow"),!0),g(0),e.consume(C);return}return me(C)?(e.consume(C),_(e.exit("chunkFlow")),n=0,t.interrupt=void 0,s):(e.consume(C),h)}function _(C,b){let v=t.sliceStream(C);if(b&&v.push(null),C.previous=i,i&&(i.next=C),i=C,r.defineSkip(C.start),r.write(v),t.parser.lazy[C.start.line]){let S=r.events.length;for(;S--;)if(r.events[S][1].start.offset<a&&(!r.events[S][1].end||r.events[S][1].end.offset>a))return;let P=t.events.length,k=P,L,H;for(;k--;)if(t.events[k][0]==="exit"&&t.events[k][1].type==="chunkFlow"){if(L){H=t.events[k][1].end;break}L=!0}for(g(n),S=P;S<t.events.length;)t.events[S][1].end=Object.assign({},H),S++;On(t.events,k+1,0,t.events.slice(P)),t.events.length=S}}function g(C){let b=o.length;for(;b-- >C;){let v=o[b];t.containerState=v[1],v[0].exit.call(t,e)}o.length=C}function y(){r.write([null]),i=void 0,r=void 0,t.containerState._closeFlow=void 0}}function UL(e,t,o){return Oe(e,e.attempt(this.parser.constructs.document,t,o),"linePrefix",this.parser.constructs.disable.null.includes("codeIndented")?void 0:4)}function $g(e){if(e===null||wo(e)||B3(e))return 1;if(O3(e))return 2}function Op(e,t,o){let n=[],r=-1;for(;++r<e.length;){let i=e[r].resolveAll;i&&!n.includes(i)&&(t=i(t,o),n.push(i))}return t}var ru={name:"attention",tokenize:GL,resolveAll:WL};function WL(e,t){let o=-1,n,r,i,a,s,l,p,u;for(;++o<e.length;)if(e[o][0]==="enter"&&e[o][1].type==="attentionSequence"&&e[o][1]._close){for(n=o;n--;)if(e[n][0]==="exit"&&e[n][1].type==="attentionSequence"&&e[n][1]._open&&t.sliceSerialize(e[n][1]).charCodeAt(0)===t.sliceSerialize(e[o][1]).charCodeAt(0)){if((e[n][1]._close||e[o][1]._open)&&(e[o][1].end.offset-e[o][1].start.offset)%3&&!((e[n][1].end.offset-e[n][1].start.offset+e[o][1].end.offset-e[o][1].start.offset)%3))continue;l=e[n][1].end.offset-e[n][1].start.offset>1&&e[o][1].end.offset-e[o][1].start.offset>1?2:1;let c=Object.assign({},e[n][1].end),m=Object.assign({},e[o][1].start);N3(c,-l),N3(m,l),a={type:l>1?"strongSequence":"emphasisSequence",start:c,end:Object.assign({},e[n][1].end)},s={type:l>1?"strongSequence":"emphasisSequence",start:Object.assign({},e[o][1].start),end:m},i={type:l>1?"strongText":"emphasisText",start:Object.assign({},e[n][1].end),end:Object.assign({},e[o][1].start)},r={type:l>1?"strong":"emphasis",start:Object.assign({},a.start),end:Object.assign({},s.end)},e[n][1].end=Object.assign({},a.start),e[o][1].start=Object.assign({},s.end),p=[],e[n][1].end.offset-e[n][1].start.offset&&(p=Xn(p,[["enter",e[n][1],t],["exit",e[n][1],t]])),p=Xn(p,[["enter",r,t],["enter",a,t],["exit",a,t],["enter",i,t]]),p=Xn(p,Op(t.parser.constructs.insideSpan.null,e.slice(n+1,o),t)),p=Xn(p,[["exit",i,t],["enter",s,t],["exit",s,t],["exit",r,t]]),e[o][1].end.offset-e[o][1].start.offset?(u=2,p=Xn(p,[["enter",e[o][1],t],["exit",e[o][1],t]])):u=0,On(e,n-1,o-n+3,p),o=n+p.length-u-2;break}}for(o=-1;++o<e.length;)e[o][1].type==="attentionSequence"&&(e[o][1].type="data");return e}function GL(e,t){let o=this.parser.constructs.attentionMarkers.null,n=this.previous,r=$g(n),i;return a;function a(l){return i=l,e.enter("attentionSequence"),s(l)}function s(l){if(l===i)return e.consume(l),s;let p=e.exit("attentionSequence"),u=$g(l),c=!u||u===2&&r||o.includes(l),m=!r||r===2&&u||o.includes(n);return p._open=!!(i===42?c:c&&(r||!m)),p._close=!!(i===42?m:m&&(u||!c)),t(l)}}function N3(e,t){e.column+=t,e.offset+=t,e._bufferIndex+=t}var Xg={name:"autolink",tokenize:jL};function jL(e,t,o){let n=0;return r;function r(d){return e.enter("autolink"),e.enter("autolinkMarker"),e.consume(d),e.exit("autolinkMarker"),e.enter("autolinkProtocol"),i}function i(d){return Ir(d)?(e.consume(d),a):d===64?o(d):p(d)}function a(d){return d===43||d===45||d===46||Yn(d)?(n=1,s(d)):p(d)}function s(d){return d===58?(e.consume(d),n=0,l):(d===43||d===45||d===46||Yn(d))&&n++<32?(e.consume(d),s):(n=0,p(d))}function l(d){return d===62?(e.exit("autolinkProtocol"),e.enter("autolinkMarker"),e.consume(d),e.exit("autolinkMarker"),e.exit("autolink"),t):d===null||d===32||d===60||ou(d)?o(d):(e.consume(d),l)}function p(d){return d===64?(e.consume(d),u):P3(d)?(e.consume(d),p):o(d)}function u(d){return Yn(d)?c(d):o(d)}function c(d){return d===46?(e.consume(d),n=0,u):d===62?(e.exit("autolinkProtocol").type="autolinkEmail",e.enter("autolinkMarker"),e.consume(d),e.exit("autolinkMarker"),e.exit("autolink"),t):m(d)}function m(d){if((d===45||Yn(d))&&n++<63){let f=d===45?m:c;return e.consume(d),f}return o(d)}}var ys={tokenize:KL,partial:!0};function KL(e,t,o){return n;function n(i){return ke(i)?Oe(e,r,"linePrefix")(i):r(i)}function r(i){return i===null||me(i)?t(i):o(i)}}var kf={name:"blockQuote",tokenize:qL,continuation:{tokenize:$L},exit:XL};function qL(e,t,o){let n=this;return r;function r(a){if(a===62){let s=n.containerState;return s.open||(e.enter("blockQuote",{_container:!0}),s.open=!0),e.enter("blockQuotePrefix"),e.enter("blockQuoteMarker"),e.consume(a),e.exit("blockQuoteMarker"),i}return o(a)}function i(a){return ke(a)?(e.enter("blockQuotePrefixWhitespace"),e.consume(a),e.exit("blockQuotePrefixWhitespace"),e.exit("blockQuotePrefix"),t):(e.exit("blockQuotePrefix"),t(a))}}function $L(e,t,o){let n=this;return r;function r(a){return ke(a)?Oe(e,i,"linePrefix",n.parser.constructs.disable.null.includes("codeIndented")?void 0:4)(a):i(a)}function i(a){return e.attempt(kf,t,o)(a)}}function XL(e){e.exit("blockQuote")}var Lf={name:"characterEscape",tokenize:YL};function YL(e,t,o){return n;function n(i){return e.enter("characterEscape"),e.enter("escapeMarker"),e.consume(i),e.exit("escapeMarker"),r}function r(i){return L3(i)?(e.enter("characterEscapeValue"),e.consume(i),e.exit("characterEscapeValue"),e.exit("characterEscape"),t):o(i)}}var Of={name:"characterReference",tokenize:ZL};function ZL(e,t,o){let n=this,r=0,i,a;return s;function s(c){return e.enter("characterReference"),e.enter("characterReferenceMarker"),e.consume(c),e.exit("characterReferenceMarker"),l}function l(c){return c===35?(e.enter("characterReferenceMarkerNumeric"),e.consume(c),e.exit("characterReferenceMarkerNumeric"),p):(e.enter("characterReferenceValue"),i=31,a=Yn,u(c))}function p(c){return c===88||c===120?(e.enter("characterReferenceMarkerHexadecimal"),e.consume(c),e.exit("characterReferenceMarkerHexadecimal"),e.enter("characterReferenceValue"),i=6,a=k3,u):(e.enter("characterReferenceValue"),i=7,a=nu,u(c))}function u(c){if(c===59&&r){let m=e.exit("characterReferenceValue");return a===Yn&&!Vl(n.sliceSerialize(m))?o(c):(e.enter("characterReferenceMarker"),e.consume(c),e.exit("characterReferenceMarker"),e.exit("characterReference"),t)}return a(c)&&r++<i?(e.consume(c),u):o(c)}}var z3={tokenize:JL,partial:!0},Bf={name:"codeFenced",tokenize:QL,concrete:!0};function QL(e,t,o){let n=this,r={tokenize:v,partial:!0},i=0,a=0,s;return l;function l(S){return p(S)}function p(S){let P=n.events[n.events.length-1];return i=P&&P[1].type==="linePrefix"?P[2].sliceSerialize(P[1],!0).length:0,s=S,e.enter("codeFenced"),e.enter("codeFencedFence"),e.enter("codeFencedFenceSequence"),u(S)}function u(S){return S===s?(a++,e.consume(S),u):a<3?o(S):(e.exit("codeFencedFenceSequence"),ke(S)?Oe(e,c,"whitespace")(S):c(S))}function c(S){return S===null||me(S)?(e.exit("codeFencedFence"),n.interrupt?t(S):e.check(z3,h,b)(S)):(e.enter("codeFencedFenceInfo"),e.enter("chunkString",{contentType:"string"}),m(S))}function m(S){return S===null||me(S)?(e.exit("chunkString"),e.exit("codeFencedFenceInfo"),c(S)):ke(S)?(e.exit("chunkString"),e.exit("codeFencedFenceInfo"),Oe(e,d,"whitespace")(S)):S===96&&S===s?o(S):(e.consume(S),m)}function d(S){return S===null||me(S)?c(S):(e.enter("codeFencedFenceMeta"),e.enter("chunkString",{contentType:"string"}),f(S))}function f(S){return S===null||me(S)?(e.exit("chunkString"),e.exit("codeFencedFenceMeta"),c(S)):S===96&&S===s?o(S):(e.consume(S),f)}function h(S){return e.attempt(r,b,_)(S)}function _(S){return e.enter("lineEnding"),e.consume(S),e.exit("lineEnding"),g}function g(S){return i>0&&ke(S)?Oe(e,y,"linePrefix",i+1)(S):y(S)}function y(S){return S===null||me(S)?e.check(z3,h,b)(S):(e.enter("codeFlowValue"),C(S))}function C(S){return S===null||me(S)?(e.exit("codeFlowValue"),y(S)):(e.consume(S),C)}function b(S){return e.exit("codeFenced"),t(S)}function v(S,P,k){let L=0;return H;function H(N){return S.enter("lineEnding"),S.consume(N),S.exit("lineEnding"),W}function W(N){return S.enter("codeFencedFence"),ke(N)?Oe(S,O,"linePrefix",n.parser.constructs.disable.null.includes("codeIndented")?void 0:4)(N):O(N)}function O(N){return N===s?(S.enter("codeFencedFenceSequence"),D(N)):k(N)}function D(N){return N===s?(L++,S.consume(N),D):L>=a?(S.exit("codeFencedFenceSequence"),ke(N)?Oe(S,V,"whitespace")(N):V(N)):k(N)}function V(N){return N===null||me(N)?(S.exit("codeFencedFence"),P(N)):k(N)}}}function JL(e,t,o){let n=this;return r;function r(a){return a===null?o(a):(e.enter("lineEnding"),e.consume(a),e.exit("lineEnding"),i)}function i(a){return n.parser.lazy[n.now().line]?o(a):t(a)}}var iu={name:"codeIndented",tokenize:tO},eO={tokenize:oO,partial:!0};function tO(e,t,o){let n=this;return r;function r(p){return e.enter("codeIndented"),Oe(e,i,"linePrefix",5)(p)}function i(p){let u=n.events[n.events.length-1];return u&&u[1].type==="linePrefix"&&u[2].sliceSerialize(u[1],!0).length>=4?a(p):o(p)}function a(p){return p===null?l(p):me(p)?e.attempt(eO,a,l)(p):(e.enter("codeFlowValue"),s(p))}function s(p){return p===null||me(p)?(e.exit("codeFlowValue"),a(p)):(e.consume(p),s)}function l(p){return e.exit("codeIndented"),t(p)}}function oO(e,t,o){let n=this;return r;function r(a){return n.parser.lazy[n.now().line]?o(a):me(a)?(e.enter("lineEnding"),e.consume(a),e.exit("lineEnding"),r):Oe(e,i,"linePrefix",5)(a)}function i(a){let s=n.events[n.events.length-1];return s&&s[1].type==="linePrefix"&&s[2].sliceSerialize(s[1],!0).length>=4?t(a):me(a)?r(a):o(a)}}var Yg={name:"codeText",tokenize:iO,resolve:nO,previous:rO};function nO(e){let t=e.length-4,o=3,n,r;if((e[o][1].type==="lineEnding"||e[o][1].type==="space")&&(e[t][1].type==="lineEnding"||e[t][1].type==="space")){for(n=o;++n<t;)if(e[n][1].type==="codeTextData"){e[o][1].type="codeTextPadding",e[t][1].type="codeTextPadding",o+=2,t-=2;break}}for(n=o-1,t++;++n<=t;)r===void 0?n!==t&&e[n][1].type!=="lineEnding"&&(r=n):(n===t||e[n][1].type==="lineEnding")&&(e[r][1].type="codeTextData",n!==r+2&&(e[r][1].end=e[n-1][1].end,e.splice(r+2,n-r-2),t-=n-r-2,n=r+2),r=void 0);return e}function rO(e){return e!==96||this.events[this.events.length-1][1].type==="characterEscape"}function iO(e,t,o){let n=this,r=0,i,a;return s;function s(m){return e.enter("codeText"),e.enter("codeTextSequence"),l(m)}function l(m){return m===96?(e.consume(m),r++,l):(e.exit("codeTextSequence"),p(m))}function p(m){return m===null?o(m):m===32?(e.enter("space"),e.consume(m),e.exit("space"),p):m===96?(a=e.enter("codeTextSequence"),i=0,c(m)):me(m)?(e.enter("lineEnding"),e.consume(m),e.exit("lineEnding"),p):(e.enter("codeTextData"),u(m))}function u(m){return m===null||m===32||m===96||me(m)?(e.exit("codeTextData"),p(m)):(e.consume(m),u)}function c(m){return m===96?(e.consume(m),i++,c):i===r?(e.exit("codeTextSequence"),e.exit("codeText"),t(m)):(a.type="codeTextData",u(m))}}var Df=class{constructor(t){this.left=t?[...t]:[],this.right=[]}get(t){if(t<0||t>=this.left.length+this.right.length)throw new RangeError("Cannot access index `"+t+"` in a splice buffer of size `"+(this.left.length+this.right.length)+"`");return t<this.left.length?this.left[t]:this.right[this.right.length-t+this.left.length-1]}get length(){return this.left.length+this.right.length}shift(){return this.setCursor(0),this.right.pop()}slice(t,o){let n=o??Number.POSITIVE_INFINITY;return n<this.left.length?this.left.slice(t,n):t>this.left.length?this.right.slice(this.right.length-n+this.left.length,this.right.length-t+this.left.length).reverse():this.left.slice(t).concat(this.right.slice(this.right.length-n+this.left.length).reverse())}splice(t,o,n){let r=o||0;this.setCursor(Math.trunc(t));let i=this.right.splice(this.right.length-r,Number.POSITIVE_INFINITY);return n&&au(this.left,n),i.reverse()}pop(){return this.setCursor(Number.POSITIVE_INFINITY),this.left.pop()}push(t){this.setCursor(Number.POSITIVE_INFINITY),this.left.push(t)}pushMany(t){this.setCursor(Number.POSITIVE_INFINITY),au(this.left,t)}unshift(t){this.setCursor(0),this.right.push(t)}unshiftMany(t){this.setCursor(0),au(this.right,t.reverse())}setCursor(t){if(!(t===this.left.length||t>this.left.length&&this.right.length===0||t<0&&this.left.length===0))if(t<this.left.length){let o=this.left.splice(t,Number.POSITIVE_INFINITY);au(this.right,o.reverse())}else{let o=this.right.splice(this.left.length+this.right.length-t,Number.POSITIVE_INFINITY);au(this.left,o.reverse())}}};function au(e,t){let o=0;if(t.length<1e4)e.push(...t);else for(;o<t.length;)e.push(...t.slice(o,o+1e4)),o+=1e4}function Ff(e){let t={},o=-1,n,r,i,a,s,l,p,u=new Df(e);for(;++o<u.length;){for(;o in t;)o=t[o];if(n=u.get(o),o&&n[1].type==="chunkFlow"&&u.get(o-1)[1].type==="listItemPrefix"&&(l=n[1]._tokenizer.events,i=0,i<l.length&&l[i][1].type==="lineEndingBlank"&&(i+=2),i<l.length&&l[i][1].type==="content"))for(;++i<l.length&&l[i][1].type!=="content";)l[i][1].type==="chunkText"&&(l[i][1]._isInFirstContentOfListItem=!0,i++);if(n[0]==="enter")n[1].contentType&&(Object.assign(t,aO(u,o)),o=t[o],p=!0);else if(n[1]._container){for(i=o,r=void 0;i--&&(a=u.get(i),a[1].type==="lineEnding"||a[1].type==="lineEndingBlank");)a[0]==="enter"&&(r&&(u.get(r)[1].type="lineEndingBlank"),a[1].type="lineEnding",r=i);r&&(n[1].end=Object.assign({},u.get(r)[1].start),s=u.slice(r,o),s.unshift(n),u.splice(r,o-r+1,s))}}return On(e,0,Number.POSITIVE_INFINITY,u.slice(0)),!p}function aO(e,t){let o=e.get(t)[1],n=e.get(t)[2],r=t-1,i=[],a=o._tokenizer||n.parser[o.contentType](o.start),s=a.events,l=[],p={},u,c,m=-1,d=o,f=0,h=0,_=[h];for(;d;){for(;e.get(++r)[1]!==d;);i.push(r),d._tokenizer||(u=n.sliceStream(d),d.next||u.push(null),c&&a.defineSkip(d.start),d._isInFirstContentOfListItem&&(a._gfmTasklistFirstContentOfListItem=!0),a.write(u),d._isInFirstContentOfListItem&&(a._gfmTasklistFirstContentOfListItem=void 0)),c=d,d=d.next}for(d=o;++m<s.length;)s[m][0]==="exit"&&s[m-1][0]==="enter"&&s[m][1].type===s[m-1][1].type&&s[m][1].start.line!==s[m][1].end.line&&(h=m+1,_.push(h),d._tokenizer=void 0,d.previous=void 0,d=d.next);for(a.events=[],d?(d._tokenizer=void 0,d.previous=void 0):_.pop(),m=_.length;m--;){let g=s.slice(_[m],_[m+1]),y=i.pop();l.push([y,y+g.length-1]),e.splice(y,2,g)}for(l.reverse(),m=-1;++m<l.length;)p[f+l[m][0]]=f+l[m][1],f+=l[m][1]-l[m][0]-1;return p}var Zg={tokenize:pO,resolve:lO},sO={tokenize:cO,partial:!0};function lO(e){return Ff(e),e}function pO(e,t){let o;return n;function n(s){return e.enter("content"),o=e.enter("chunkContent",{contentType:"content"}),r(s)}function r(s){return s===null?i(s):me(s)?e.check(sO,a,i)(s):(e.consume(s),r)}function i(s){return e.exit("chunkContent"),e.exit("content"),t(s)}function a(s){return e.consume(s),e.exit("chunkContent"),o.next=e.enter("chunkContent",{contentType:"content",previous:o}),o=o.next,r}}function cO(e,t,o){let n=this;return r;function r(a){return e.exit("chunkContent"),e.enter("lineEnding"),e.consume(a),e.exit("lineEnding"),Oe(e,i,"linePrefix")}function i(a){if(a===null||me(a))return o(a);let s=n.events[n.events.length-1];return!n.parser.constructs.disable.null.includes("codeIndented")&&s&&s[1].type==="linePrefix"&&s[2].sliceSerialize(s[1],!0).length>=4?t(a):e.interrupt(n.parser.constructs.flow,o,t)(a)}}function Hf(e,t,o,n,r,i,a,s,l){let p=l||Number.POSITIVE_INFINITY,u=0;return c;function c(g){return g===60?(e.enter(n),e.enter(r),e.enter(i),e.consume(g),e.exit(i),m):g===null||g===32||g===41||ou(g)?o(g):(e.enter(n),e.enter(a),e.enter(s),e.enter("chunkString",{contentType:"string"}),h(g))}function m(g){return g===62?(e.enter(i),e.consume(g),e.exit(i),e.exit(r),e.exit(n),t):(e.enter(s),e.enter("chunkString",{contentType:"string"}),d(g))}function d(g){return g===62?(e.exit("chunkString"),e.exit(s),m(g)):g===null||g===60||me(g)?o(g):(e.consume(g),g===92?f:d)}function f(g){return g===60||g===62||g===92?(e.consume(g),d):d(g)}function h(g){return!u&&(g===null||g===41||wo(g))?(e.exit("chunkString"),e.exit(s),e.exit(a),e.exit(n),t(g)):u<p&&g===40?(e.consume(g),u++,h):g===41?(e.consume(g),u--,h):g===null||g===32||g===40||ou(g)?o(g):(e.consume(g),g===92?_:h)}function _(g){return g===40||g===41||g===92?(e.consume(g),h):h(g)}}function Nf(e,t,o,n,r,i){let a=this,s=0,l;return p;function p(d){return e.enter(n),e.enter(r),e.consume(d),e.exit(r),e.enter(i),u}function u(d){return s>999||d===null||d===91||d===93&&!l||d===94&&!s&&"_hiddenFootnoteSupport"in a.parser.constructs?o(d):d===93?(e.exit(i),e.enter(r),e.consume(d),e.exit(r),e.exit(n),t):me(d)?(e.enter("lineEnding"),e.consume(d),e.exit("lineEnding"),u):(e.enter("chunkString",{contentType:"string"}),c(d))}function c(d){return d===null||d===91||d===93||me(d)||s++>999?(e.exit("chunkString"),u(d)):(e.consume(d),l||(l=!ke(d)),d===92?m:c)}function m(d){return d===91||d===92||d===93?(e.consume(d),s++,c):c(d)}}function zf(e,t,o,n,r,i){let a;return s;function s(m){return m===34||m===39||m===40?(e.enter(n),e.enter(r),e.consume(m),e.exit(r),a=m===40?41:m,l):o(m)}function l(m){return m===a?(e.enter(r),e.consume(m),e.exit(r),e.exit(n),t):(e.enter(i),p(m))}function p(m){return m===a?(e.exit(i),l(a)):m===null?o(m):me(m)?(e.enter("lineEnding"),e.consume(m),e.exit("lineEnding"),Oe(e,p,"linePrefix")):(e.enter("chunkString",{contentType:"string"}),u(m))}function u(m){return m===a||m===null||me(m)?(e.exit("chunkString"),p(m)):(e.consume(m),m===92?c:u)}function c(m){return m===a||m===92?(e.consume(m),u):u(m)}}function nl(e,t){let o;return n;function n(r){return me(r)?(e.enter("lineEnding"),e.consume(r),e.exit("lineEnding"),o=!0,n):ke(r)?Oe(e,n,o?"linePrefix":"lineSuffix")(r):t(r)}}var Qg={name:"definition",tokenize:mO},uO={tokenize:dO,partial:!0};function mO(e,t,o){let n=this,r;return i;function i(d){return e.enter("definition"),a(d)}function a(d){return Nf.call(n,e,s,o,"definitionLabel","definitionLabelMarker","definitionLabelString")(d)}function s(d){return r=da(n.sliceSerialize(n.events[n.events.length-1][1]).slice(1,-1)),d===58?(e.enter("definitionMarker"),e.consume(d),e.exit("definitionMarker"),l):o(d)}function l(d){return wo(d)?nl(e,p)(d):p(d)}function p(d){return Hf(e,u,o,"definitionDestination","definitionDestinationLiteral","definitionDestinationLiteralMarker","definitionDestinationRaw","definitionDestinationString")(d)}function u(d){return e.attempt(uO,c,c)(d)}function c(d){return ke(d)?Oe(e,m,"whitespace")(d):m(d)}function m(d){return d===null||me(d)?(e.exit("definition"),n.parser.defined.push(r),t(d)):o(d)}}function dO(e,t,o){return n;function n(s){return wo(s)?nl(e,r)(s):o(s)}function r(s){return zf(e,i,o,"definitionTitle","definitionTitleMarker","definitionTitleString")(s)}function i(s){return ke(s)?Oe(e,a,"whitespace")(s):a(s)}function a(s){return s===null||me(s)?t(s):o(s)}}var Jg={name:"hardBreakEscape",tokenize:fO};function fO(e,t,o){return n;function n(i){return e.enter("hardBreakEscape"),e.consume(i),r}function r(i){return me(i)?(e.exit("hardBreakEscape"),t(i)):o(i)}}var e0={name:"headingAtx",tokenize:gO,resolve:hO};function hO(e,t){let o=e.length-2,n=3,r,i;return e[n][1].type==="whitespace"&&(n+=2),o-2>n&&e[o][1].type==="whitespace"&&(o-=2),e[o][1].type==="atxHeadingSequence"&&(n===o-1||o-4>n&&e[o-2][1].type==="whitespace")&&(o-=n+1===o?2:4),o>n&&(r={type:"atxHeadingText",start:e[n][1].start,end:e[o][1].end},i={type:"chunkText",start:e[n][1].start,end:e[o][1].end,contentType:"text"},On(e,n,o-n+1,[["enter",r,t],["enter",i,t],["exit",i,t],["exit",r,t]])),e}function gO(e,t,o){let n=0;return r;function r(u){return e.enter("atxHeading"),i(u)}function i(u){return e.enter("atxHeadingSequence"),a(u)}function a(u){return u===35&&n++<6?(e.consume(u),a):u===null||wo(u)?(e.exit("atxHeadingSequence"),s(u)):o(u)}function s(u){return u===35?(e.enter("atxHeadingSequence"),l(u)):u===null||me(u)?(e.exit("atxHeading"),t(u)):ke(u)?Oe(e,s,"whitespace")(u):(e.enter("atxHeadingText"),p(u))}function l(u){return u===35?(e.consume(u),l):(e.exit("atxHeadingSequence"),s(u))}function p(u){return u===null||u===35||wo(u)?(e.exit("atxHeadingText"),s(u)):(e.consume(u),p)}}var V3=["address","article","aside","base","basefont","blockquote","body","caption","center","col","colgroup","dd","details","dialog","dir","div","dl","dt","fieldset","figcaption","figure","footer","form","frame","frameset","h1","h2","h3","h4","h5","h6","head","header","hr","html","iframe","legend","li","link","main","menu","menuitem","nav","noframes","ol","optgroup","option","p","param","search","section","summary","table","tbody","td","tfoot","th","thead","title","tr","track","ul"],t0=["pre","script","style","textarea"];var o0={name:"htmlFlow",tokenize:yO,resolveTo:CO,concrete:!0},xO={tokenize:IO,partial:!0},_O={tokenize:bO,partial:!0};function CO(e){let t=e.length;for(;t--&&!(e[t][0]==="enter"&&e[t][1].type==="htmlFlow"););return t>1&&e[t-2][1].type==="linePrefix"&&(e[t][1].start=e[t-2][1].start,e[t+1][1].start=e[t-2][1].start,e.splice(t-2,2)),e}function yO(e,t,o){let n=this,r,i,a,s,l;return p;function p(M){return u(M)}function u(M){return e.enter("htmlFlow"),e.enter("htmlFlowData"),e.consume(M),c}function c(M){return M===33?(e.consume(M),m):M===47?(e.consume(M),i=!0,h):M===63?(e.consume(M),r=3,n.interrupt?t:A):Ir(M)?(e.consume(M),a=String.fromCharCode(M),_):o(M)}function m(M){return M===45?(e.consume(M),r=2,d):M===91?(e.consume(M),r=5,s=0,f):Ir(M)?(e.consume(M),r=4,n.interrupt?t:A):o(M)}function d(M){return M===45?(e.consume(M),n.interrupt?t:A):o(M)}function f(M){let K="CDATA[";return M===K.charCodeAt(s++)?(e.consume(M),s===K.length?n.interrupt?t:O:f):o(M)}function h(M){return Ir(M)?(e.consume(M),a=String.fromCharCode(M),_):o(M)}function _(M){if(M===null||M===47||M===62||wo(M)){let K=M===47,F=a.toLowerCase();return!K&&!i&&t0.includes(F)?(r=1,n.interrupt?t(M):O(M)):V3.includes(a.toLowerCase())?(r=6,K?(e.consume(M),g):n.interrupt?t(M):O(M)):(r=7,n.interrupt&&!n.parser.lazy[n.now().line]?o(M):i?y(M):C(M))}return M===45||Yn(M)?(e.consume(M),a+=String.fromCharCode(M),_):o(M)}function g(M){return M===62?(e.consume(M),n.interrupt?t:O):o(M)}function y(M){return ke(M)?(e.consume(M),y):H(M)}function C(M){return M===47?(e.consume(M),H):M===58||M===95||Ir(M)?(e.consume(M),b):ke(M)?(e.consume(M),C):H(M)}function b(M){return M===45||M===46||M===58||M===95||Yn(M)?(e.consume(M),b):v(M)}function v(M){return M===61?(e.consume(M),S):ke(M)?(e.consume(M),v):C(M)}function S(M){return M===null||M===60||M===61||M===62||M===96?o(M):M===34||M===39?(e.consume(M),l=M,P):ke(M)?(e.consume(M),S):k(M)}function P(M){return M===l?(e.consume(M),l=null,L):M===null||me(M)?o(M):(e.consume(M),P)}function k(M){return M===null||M===34||M===39||M===47||M===60||M===61||M===62||M===96||wo(M)?v(M):(e.consume(M),k)}function L(M){return M===47||M===62||ke(M)?C(M):o(M)}function H(M){return M===62?(e.consume(M),W):o(M)}function W(M){return M===null||me(M)?O(M):ke(M)?(e.consume(M),W):o(M)}function O(M){return M===45&&r===2?(e.consume(M),z):M===60&&r===1?(e.consume(M),j):M===62&&r===4?(e.consume(M),Y):M===63&&r===3?(e.consume(M),A):M===93&&r===5?(e.consume(M),q):me(M)&&(r===6||r===7)?(e.exit("htmlFlowData"),e.check(xO,Q,D)(M)):M===null||me(M)?(e.exit("htmlFlowData"),D(M)):(e.consume(M),O)}function D(M){return e.check(_O,V,Q)(M)}function V(M){return e.enter("lineEnding"),e.consume(M),e.exit("lineEnding"),N}function N(M){return M===null||me(M)?D(M):(e.enter("htmlFlowData"),O(M))}function z(M){return M===45?(e.consume(M),A):O(M)}function j(M){return M===47?(e.consume(M),a="",G):O(M)}function G(M){if(M===62){let K=a.toLowerCase();return t0.includes(K)?(e.consume(M),Y):O(M)}return Ir(M)&&a.length<8?(e.consume(M),a+=String.fromCharCode(M),G):O(M)}function q(M){return M===93?(e.consume(M),A):O(M)}function A(M){return M===62?(e.consume(M),Y):M===45&&r===2?(e.consume(M),A):O(M)}function Y(M){return M===null||me(M)?(e.exit("htmlFlowData"),Q(M)):(e.consume(M),Y)}function Q(M){return e.exit("htmlFlow"),t(M)}}function bO(e,t,o){let n=this;return r;function r(a){return me(a)?(e.enter("lineEnding"),e.consume(a),e.exit("lineEnding"),i):o(a)}function i(a){return n.parser.lazy[n.now().line]?o(a):t(a)}}function IO(e,t,o){return n;function n(r){return e.enter("lineEnding"),e.consume(r),e.exit("lineEnding"),e.attempt(ys,t,o)}}var n0={name:"htmlText",tokenize:SO};function SO(e,t,o){let n=this,r,i,a;return s;function s(A){return e.enter("htmlText"),e.enter("htmlTextData"),e.consume(A),l}function l(A){return A===33?(e.consume(A),p):A===47?(e.consume(A),v):A===63?(e.consume(A),C):Ir(A)?(e.consume(A),k):o(A)}function p(A){return A===45?(e.consume(A),u):A===91?(e.consume(A),i=0,f):Ir(A)?(e.consume(A),y):o(A)}function u(A){return A===45?(e.consume(A),d):o(A)}function c(A){return A===null?o(A):A===45?(e.consume(A),m):me(A)?(a=c,j(A)):(e.consume(A),c)}function m(A){return A===45?(e.consume(A),d):c(A)}function d(A){return A===62?z(A):A===45?m(A):c(A)}function f(A){let Y="CDATA[";return A===Y.charCodeAt(i++)?(e.consume(A),i===Y.length?h:f):o(A)}function h(A){return A===null?o(A):A===93?(e.consume(A),_):me(A)?(a=h,j(A)):(e.consume(A),h)}function _(A){return A===93?(e.consume(A),g):h(A)}function g(A){return A===62?z(A):A===93?(e.consume(A),g):h(A)}function y(A){return A===null||A===62?z(A):me(A)?(a=y,j(A)):(e.consume(A),y)}function C(A){return A===null?o(A):A===63?(e.consume(A),b):me(A)?(a=C,j(A)):(e.consume(A),C)}function b(A){return A===62?z(A):C(A)}function v(A){return Ir(A)?(e.consume(A),S):o(A)}function S(A){return A===45||Yn(A)?(e.consume(A),S):P(A)}function P(A){return me(A)?(a=P,j(A)):ke(A)?(e.consume(A),P):z(A)}function k(A){return A===45||Yn(A)?(e.consume(A),k):A===47||A===62||wo(A)?L(A):o(A)}function L(A){return A===47?(e.consume(A),z):A===58||A===95||Ir(A)?(e.consume(A),H):me(A)?(a=L,j(A)):ke(A)?(e.consume(A),L):z(A)}function H(A){return A===45||A===46||A===58||A===95||Yn(A)?(e.consume(A),H):W(A)}function W(A){return A===61?(e.consume(A),O):me(A)?(a=W,j(A)):ke(A)?(e.consume(A),W):L(A)}function O(A){return A===null||A===60||A===61||A===62||A===96?o(A):A===34||A===39?(e.consume(A),r=A,D):me(A)?(a=O,j(A)):ke(A)?(e.consume(A),O):(e.consume(A),V)}function D(A){return A===r?(e.consume(A),r=void 0,N):A===null?o(A):me(A)?(a=D,j(A)):(e.consume(A),D)}function V(A){return A===null||A===34||A===39||A===60||A===61||A===96?o(A):A===47||A===62||wo(A)?L(A):(e.consume(A),V)}function N(A){return A===47||A===62||wo(A)?L(A):o(A)}function z(A){return A===62?(e.consume(A),e.exit("htmlTextData"),e.exit("htmlText"),t):o(A)}function j(A){return e.exit("htmlTextData"),e.enter("lineEnding"),e.consume(A),e.exit("lineEnding"),G}function G(A){return ke(A)?Oe(e,q,"linePrefix",n.parser.constructs.disable.null.includes("codeIndented")?void 0:4)(A):q(A)}function q(A){return e.enter("htmlTextData"),a(A)}}var rl={name:"labelEnd",tokenize:AO,resolveTo:EO,resolveAll:wO},vO={tokenize:PO},TO={tokenize:kO},MO={tokenize:LO};function wO(e){let t=-1;for(;++t<e.length;){let o=e[t][1];(o.type==="labelImage"||o.type==="labelLink"||o.type==="labelEnd")&&(e.splice(t+1,o.type==="labelImage"?4:2),o.type="data",t++)}return e}function EO(e,t){let o=e.length,n=0,r,i,a,s;for(;o--;)if(r=e[o][1],i){if(r.type==="link"||r.type==="labelLink"&&r._inactive)break;e[o][0]==="enter"&&r.type==="labelLink"&&(r._inactive=!0)}else if(a){if(e[o][0]==="enter"&&(r.type==="labelImage"||r.type==="labelLink")&&!r._balanced&&(i=o,r.type!=="labelLink")){n=2;break}}else r.type==="labelEnd"&&(a=o);let l={type:e[i][1].type==="labelLink"?"link":"image",start:Object.assign({},e[i][1].start),end:Object.assign({},e[e.length-1][1].end)},p={type:"label",start:Object.assign({},e[i][1].start),end:Object.assign({},e[a][1].end)},u={type:"labelText",start:Object.assign({},e[i+n+2][1].end),end:Object.assign({},e[a-2][1].start)};return s=[["enter",l,t],["enter",p,t]],s=Xn(s,e.slice(i+1,i+n+3)),s=Xn(s,[["enter",u,t]]),s=Xn(s,Op(t.parser.constructs.insideSpan.null,e.slice(i+n+4,a-3),t)),s=Xn(s,[["exit",u,t],e[a-2],e[a-1],["exit",p,t]]),s=Xn(s,e.slice(a+1)),s=Xn(s,[["exit",l,t]]),On(e,i,e.length,s),e}function AO(e,t,o){let n=this,r=n.events.length,i,a;for(;r--;)if((n.events[r][1].type==="labelImage"||n.events[r][1].type==="labelLink")&&!n.events[r][1]._balanced){i=n.events[r][1];break}return s;function s(m){return i?i._inactive?c(m):(a=n.parser.defined.includes(da(n.sliceSerialize({start:i.end,end:n.now()}))),e.enter("labelEnd"),e.enter("labelMarker"),e.consume(m),e.exit("labelMarker"),e.exit("labelEnd"),l):o(m)}function l(m){return m===40?e.attempt(vO,u,a?u:c)(m):m===91?e.attempt(TO,u,a?p:c)(m):a?u(m):c(m)}function p(m){return e.attempt(MO,u,c)(m)}function u(m){return t(m)}function c(m){return i._balanced=!0,o(m)}}function PO(e,t,o){return n;function n(c){return e.enter("resource"),e.enter("resourceMarker"),e.consume(c),e.exit("resourceMarker"),r}function r(c){return wo(c)?nl(e,i)(c):i(c)}function i(c){return c===41?u(c):Hf(e,a,s,"resourceDestination","resourceDestinationLiteral","resourceDestinationLiteralMarker","resourceDestinationRaw","resourceDestinationString",32)(c)}function a(c){return wo(c)?nl(e,l)(c):u(c)}function s(c){return o(c)}function l(c){return c===34||c===39||c===40?zf(e,p,o,"resourceTitle","resourceTitleMarker","resourceTitleString")(c):u(c)}function p(c){return wo(c)?nl(e,u)(c):u(c)}function u(c){return c===41?(e.enter("resourceMarker"),e.consume(c),e.exit("resourceMarker"),e.exit("resource"),t):o(c)}}function kO(e,t,o){let n=this;return r;function r(s){return Nf.call(n,e,i,a,"reference","referenceMarker","referenceString")(s)}function i(s){return n.parser.defined.includes(da(n.sliceSerialize(n.events[n.events.length-1][1]).slice(1,-1)))?t(s):o(s)}function a(s){return o(s)}}function LO(e,t,o){return n;function n(i){return e.enter("reference"),e.enter("referenceMarker"),e.consume(i),e.exit("referenceMarker"),r}function r(i){return i===93?(e.enter("referenceMarker"),e.consume(i),e.exit("referenceMarker"),e.exit("reference"),t):o(i)}}var r0={name:"labelStartImage",tokenize:OO,resolveAll:rl.resolveAll};function OO(e,t,o){let n=this;return r;function r(s){return e.enter("labelImage"),e.enter("labelImageMarker"),e.consume(s),e.exit("labelImageMarker"),i}function i(s){return s===91?(e.enter("labelMarker"),e.consume(s),e.exit("labelMarker"),e.exit("labelImage"),a):o(s)}function a(s){return s===94&&"_hiddenFootnoteSupport"in n.parser.constructs?o(s):t(s)}}var i0={name:"labelStartLink",tokenize:BO,resolveAll:rl.resolveAll};function BO(e,t,o){let n=this;return r;function r(a){return e.enter("labelLink"),e.enter("labelMarker"),e.consume(a),e.exit("labelMarker"),e.exit("labelLink"),i}function i(a){return a===94&&"_hiddenFootnoteSupport"in n.parser.constructs?o(a):t(a)}}var su={name:"lineEnding",tokenize:DO};function DO(e,t){return o;function o(n){return e.enter("lineEnding"),e.consume(n),e.exit("lineEnding"),Oe(e,t,"linePrefix")}}var il={name:"thematicBreak",tokenize:FO};function FO(e,t,o){let n=0,r;return i;function i(p){return e.enter("thematicBreak"),a(p)}function a(p){return r=p,s(p)}function s(p){return p===r?(e.enter("thematicBreakSequence"),l(p)):n>=3&&(p===null||me(p))?(e.exit("thematicBreak"),t(p)):o(p)}function l(p){return p===r?(e.consume(p),n++,l):(e.exit("thematicBreakSequence"),ke(p)?Oe(e,s,"whitespace")(p):s(p))}}var Bn={name:"list",tokenize:zO,continuation:{tokenize:VO},exit:UO},HO={tokenize:WO,partial:!0},NO={tokenize:RO,partial:!0};function zO(e,t,o){let n=this,r=n.events[n.events.length-1],i=r&&r[1].type==="linePrefix"?r[2].sliceSerialize(r[1],!0).length:0,a=0;return s;function s(d){let f=n.containerState.type||(d===42||d===43||d===45?"listUnordered":"listOrdered");if(f==="listUnordered"?!n.containerState.marker||d===n.containerState.marker:nu(d)){if(n.containerState.type||(n.containerState.type=f,e.enter(f,{_container:!0})),f==="listUnordered")return e.enter("listItemPrefix"),d===42||d===45?e.check(il,o,p)(d):p(d);if(!n.interrupt||d===49)return e.enter("listItemPrefix"),e.enter("listItemValue"),l(d)}return o(d)}function l(d){return nu(d)&&++a<10?(e.consume(d),l):(!n.interrupt||a<2)&&(n.containerState.marker?d===n.containerState.marker:d===41||d===46)?(e.exit("listItemValue"),p(d)):o(d)}function p(d){return e.enter("listItemMarker"),e.consume(d),e.exit("listItemMarker"),n.containerState.marker=n.containerState.marker||d,e.check(ys,n.interrupt?o:u,e.attempt(HO,m,c))}function u(d){return n.containerState.initialBlankLine=!0,i++,m(d)}function c(d){return ke(d)?(e.enter("listItemPrefixWhitespace"),e.consume(d),e.exit("listItemPrefixWhitespace"),m):o(d)}function m(d){return n.containerState.size=i+n.sliceSerialize(e.exit("listItemPrefix"),!0).length,t(d)}}function VO(e,t,o){let n=this;return n.containerState._closeFlow=void 0,e.check(ys,r,i);function r(s){return n.containerState.furtherBlankLines=n.containerState.furtherBlankLines||n.containerState.initialBlankLine,Oe(e,t,"listItemIndent",n.containerState.size+1)(s)}function i(s){return n.containerState.furtherBlankLines||!ke(s)?(n.containerState.furtherBlankLines=void 0,n.containerState.initialBlankLine=void 0,a(s)):(n.containerState.furtherBlankLines=void 0,n.containerState.initialBlankLine=void 0,e.attempt(NO,t,a)(s))}function a(s){return n.containerState._closeFlow=!0,n.interrupt=void 0,Oe(e,e.attempt(Bn,t,o),"linePrefix",n.parser.constructs.disable.null.includes("codeIndented")?void 0:4)(s)}}function RO(e,t,o){let n=this;return Oe(e,r,"listItemIndent",n.containerState.size+1);function r(i){let a=n.events[n.events.length-1];return a&&a[1].type==="listItemIndent"&&a[2].sliceSerialize(a[1],!0).length===n.containerState.size?t(i):o(i)}}function UO(e){e.exit(this.containerState.type)}function WO(e,t,o){let n=this;return Oe(e,r,"listItemPrefixWhitespace",n.parser.constructs.disable.null.includes("codeIndented")?void 0:5);function r(i){let a=n.events[n.events.length-1];return!ke(i)&&a&&a[1].type==="listItemPrefixWhitespace"?t(i):o(i)}}var Vf={name:"setextUnderline",tokenize:jO,resolveTo:GO};function GO(e,t){let o=e.length,n,r,i;for(;o--;)if(e[o][0]==="enter"){if(e[o][1].type==="content"){n=o;break}e[o][1].type==="paragraph"&&(r=o)}else e[o][1].type==="content"&&e.splice(o,1),!i&&e[o][1].type==="definition"&&(i=o);let a={type:"setextHeading",start:Object.assign({},e[r][1].start),end:Object.assign({},e[e.length-1][1].end)};return e[r][1].type="setextHeadingText",i?(e.splice(r,0,["enter",a,t]),e.splice(i+1,0,["exit",e[n][1],t]),e[n][1].end=Object.assign({},e[i][1].end)):e[n][1]=a,e.push(["exit",a,t]),e}function jO(e,t,o){let n=this,r;return i;function i(p){let u=n.events.length,c;for(;u--;)if(n.events[u][1].type!=="lineEnding"&&n.events[u][1].type!=="linePrefix"&&n.events[u][1].type!=="content"){c=n.events[u][1].type==="paragraph";break}return!n.parser.lazy[n.now().line]&&(n.interrupt||c)?(e.enter("setextHeadingLine"),r=p,a(p)):o(p)}function a(p){return e.enter("setextHeadingLineSequence"),s(p)}function s(p){return p===r?(e.consume(p),s):(e.exit("setextHeadingLineSequence"),ke(p)?Oe(e,l,"lineSuffix")(p):l(p))}function l(p){return p===null||me(p)?(e.exit("setextHeadingLine"),t(p)):o(p)}}var R3={tokenize:KO};function KO(e){let t=this,o=e.attempt(ys,n,e.attempt(this.parser.constructs.flowInitial,r,Oe(e,e.attempt(this.parser.constructs.flow,r,e.attempt(Zg,r)),"linePrefix")));return o;function n(i){if(i===null){e.consume(i);return}return e.enter("lineEndingBlank"),e.consume(i),e.exit("lineEndingBlank"),t.currentConstruct=void 0,o}function r(i){if(i===null){e.consume(i);return}return e.enter("lineEnding"),e.consume(i),e.exit("lineEnding"),t.currentConstruct=void 0,o}}var U3={resolveAll:K3()},W3=j3("string"),G3=j3("text");function j3(e){return{tokenize:t,resolveAll:K3(e==="text"?qO:void 0)};function t(o){let n=this,r=this.parser.constructs[e],i=o.attempt(r,a,s);return a;function a(u){return p(u)?i(u):s(u)}function s(u){if(u===null){o.consume(u);return}return o.enter("data"),o.consume(u),l}function l(u){return p(u)?(o.exit("data"),i(u)):(o.consume(u),l)}function p(u){if(u===null)return!0;let c=r[u],m=-1;if(c)for(;++m<c.length;){let d=c[m];if(!d.previous||d.previous.call(n,n.previous))return!0}return!1}}}function K3(e){return t;function t(o,n){let r=-1,i;for(;++r<=o.length;)i===void 0?o[r]&&o[r][1].type==="data"&&(i=r,r++):(!o[r]||o[r][1].type!=="data")&&(r!==i+2&&(o[i][1].end=o[r-1][1].end,o.splice(i+2,r-i-2),r=i+2),i=void 0);return e?e(o,n):o}}function qO(e,t){let o=0;for(;++o<=e.length;)if((o===e.length||e[o][1].type==="lineEnding")&&e[o-1][1].type==="data"){let n=e[o-1][1],r=t.sliceStream(n),i=r.length,a=-1,s=0,l;for(;i--;){let p=r[i];if(typeof p=="string"){for(a=p.length;p.charCodeAt(a-1)===32;)s++,a--;if(a)break;a=-1}else if(p===-2)l=!0,s++;else if(p!==-1){i++;break}}if(s){let p={type:o===e.length||l||s<2?"lineSuffix":"hardBreakTrailing",start:{line:n.end.line,column:n.end.column-s,offset:n.end.offset-s,_index:n.start._index+i,_bufferIndex:i?a:n.start._bufferIndex+a},end:Object.assign({},n.end)};n.end=Object.assign({},p.start),n.start.offset===n.end.offset?Object.assign(n,p):(e.splice(o,0,["enter",p,t],["exit",p,t]),o+=2)}o++}return e}function q3(e,t,o){let n=Object.assign(o?Object.assign({},o):{line:1,column:1,offset:0},{_index:0,_bufferIndex:-1}),r={},i=[],a=[],s=[],l=!0,p={consume:b,enter:v,exit:S,attempt:L(P),check:L(k),interrupt:L(k,{interrupt:!0})},u={previous:null,code:null,containerState:{},events:[],parser:e,sliceStream:h,sliceSerialize:f,now:_,defineSkip:g,write:d},c=t.tokenize.call(u,p),m;return t.resolveAll&&i.push(t),u;function d(D){return a=Xn(a,D),y(),a[a.length-1]!==null?[]:(H(t,0),u.events=Op(i,u.events,u),u.events)}function f(D,V){return XO(h(D),V)}function h(D){return $O(a,D)}function _(){let{line:D,column:V,offset:N,_index:z,_bufferIndex:j}=n;return{line:D,column:V,offset:N,_index:z,_bufferIndex:j}}function g(D){r[D.line]=D.column,O()}function y(){let D;for(;n._index<a.length;){let V=a[n._index];if(typeof V=="string")for(D=n._index,n._bufferIndex<0&&(n._bufferIndex=0);n._index===D&&n._bufferIndex<V.length;)C(V.charCodeAt(n._bufferIndex));else C(V)}}function C(D){l=void 0,m=D,c=c(D)}function b(D){me(D)?(n.line++,n.column=1,n.offset+=D===-3?2:1,O()):D!==-1&&(n.column++,n.offset++),n._bufferIndex<0?n._index++:(n._bufferIndex++,n._bufferIndex===a[n._index].length&&(n._bufferIndex=-1,n._index++)),u.previous=D,l=!0}function v(D,V){let N=V||{};return N.type=D,N.start=_(),u.events.push(["enter",N,u]),s.push(N),N}function S(D){let V=s.pop();return V.end=_(),u.events.push(["exit",V,u]),V}function P(D,V){H(D,V.from)}function k(D,V){V.restore()}function L(D,V){return N;function N(z,j,G){let q,A,Y,Q;return Array.isArray(z)?K(z):"tokenize"in z?K([z]):M(z);function M(te){return Te;function Te(Ie){let Nt=Ie!==null&&te[Ie],lt=Ie!==null&&te.null,Le=[...Array.isArray(Nt)?Nt:Nt?[Nt]:[],...Array.isArray(lt)?lt:lt?[lt]:[]];return K(Le)(Ie)}}function K(te){return q=te,A=0,te.length===0?G:F(te[A])}function F(te){return Te;function Te(Ie){return Q=W(),Y=te,te.partial||(u.currentConstruct=te),te.name&&u.parser.constructs.disable.null.includes(te.name)?ae(Ie):te.tokenize.call(V?Object.assign(Object.create(u),V):u,p,pe,ae)(Ie)}}function pe(te){return l=!0,D(Y,Q),j}function ae(te){return l=!0,Q.restore(),++A<q.length?F(q[A]):G}}}function H(D,V){D.resolveAll&&!i.includes(D)&&i.push(D),D.resolve&&On(u.events,V,u.events.length-V,D.resolve(u.events.slice(V),u)),D.resolveTo&&(u.events=D.resolveTo(u.events,u))}function W(){let D=_(),V=u.previous,N=u.currentConstruct,z=u.events.length,j=Array.from(s);return{restore:G,from:z};function G(){n=D,u.previous=V,u.currentConstruct=N,u.events.length=z,s=j,O()}}function O(){n.line in r&&n.column<2&&(n.column=r[n.line],n.offset+=r[n.line]-1)}}function $O(e,t){let o=t.start._index,n=t.start._bufferIndex,r=t.end._index,i=t.end._bufferIndex,a;if(o===r)a=[e[o].slice(n,i)];else{if(a=e.slice(o,r),n>-1){let s=a[0];typeof s=="string"?a[0]=s.slice(n):a.shift()}i>0&&a.push(e[r].slice(0,i))}return a}function XO(e,t){let o=-1,n=[],r;for(;++o<e.length;){let i=e[o],a;if(typeof i=="string")a=i;else switch(i){case-5:{a="\r";break}case-4:{a=`
`;break}case-3:{a=`\r
`;break}case-2:{a=t?" ":"	";break}case-1:{if(!t&&r)continue;a=" ";break}default:a=String.fromCharCode(i)}r=i===-2,n.push(a)}return n.join("")}var a0={};$M(a0,{attentionMarkers:()=>nB,contentInitial:()=>ZO,disable:()=>rB,document:()=>YO,flow:()=>JO,flowInitial:()=>QO,insideSpan:()=>oB,string:()=>eB,text:()=>tB});var YO={42:Bn,43:Bn,45:Bn,48:Bn,49:Bn,50:Bn,51:Bn,52:Bn,53:Bn,54:Bn,55:Bn,56:Bn,57:Bn,62:kf},ZO={91:Qg},QO={[-2]:iu,[-1]:iu,32:iu},JO={35:e0,42:il,45:[Vf,il],60:o0,61:Vf,95:il,96:Bf,126:Bf},eB={38:Of,92:Lf},tB={[-5]:su,[-4]:su,[-3]:su,33:r0,38:Of,42:ru,60:[Xg,n0],91:i0,92:[Jg,Lf],93:rl,95:ru,96:Yg},oB={null:[ru,U3]},nB={null:[42,95]},rB={null:[]};function s0(e){let o=A3([a0,...(e||{}).extensions||[]]),n={defined:[],lazy:{},constructs:o,content:r(D3),document:r(H3),flow:r(R3),string:r(W3),text:r(G3)};return n;function r(i){return a;function a(s){return q3(n,i,s)}}}function l0(e){for(;!Ff(e););return e}var $3=/[\0\t\n\r]/g;function p0(){let e=1,t="",o=!0,n;return r;function r(i,a,s){let l=[],p,u,c,m,d;for(i=t+(typeof i=="string"?i.toString():new TextDecoder(a||void 0).decode(i)),c=0,t="",o&&(i.charCodeAt(0)===65279&&c++,o=void 0);c<i.length;){if($3.lastIndex=c,p=$3.exec(i),m=p&&p.index!==void 0?p.index:i.length,d=i.charCodeAt(m),!p){t=i.slice(c);break}if(d===10&&c===m&&n)l.push(-3),n=void 0;else switch(n&&(l.push(-5),n=void 0),c<m&&(l.push(i.slice(c,m)),e+=m-c),d){case 0:{l.push(65533),e++;break}case 9:{for(u=Math.ceil(e/4)*4,l.push(-2);e++<u;)l.push(-1);break}case 10:{l.push(-4),e=1;break}default:n=!0,e=1}c=m+1}return s&&(n&&l.push(-5),t&&l.push(t),l.push(null)),l}}var iB=/\\([!-/:-@[-`{-~])|&(#(?:\d{1,7}|x[\da-f]{1,6})|[\da-z]{1,31});/gi;function Rf(e){return e.replace(iB,aB)}function aB(e,t,o){if(t)return t;if(o.charCodeAt(0)===35){let r=o.charCodeAt(1),i=r===120||r===88;return Pf(o.slice(i?2:1),i?16:10)}return Vl(o)||e}function bs(e){return!e||typeof e!="object"?"":"position"in e||"type"in e?X3(e.position):"start"in e||"end"in e?X3(e):"line"in e||"column"in e?c0(e):""}function c0(e){return Y3(e&&e.line)+":"+Y3(e&&e.column)}function X3(e){return c0(e&&e.start)+"-"+c0(e&&e.end)}function Y3(e){return e&&typeof e=="number"?e:1}var Q3={}.hasOwnProperty;function u0(e,t,o){return typeof t!="string"&&(o=t,t=void 0),sB(o)(l0(s0(o).document().write(p0()(e,t,!0))))}function sB(e){let t={transforms:[],canContainEols:["emphasis","fragment","heading","paragraph","strong"],enter:{autolink:i(Zt),autolinkProtocol:L,autolinkEmail:L,atxHeading:i(At),blockQuote:i(Ie),characterEscape:L,characterReference:L,codeFenced:i(Nt),codeFencedFenceInfo:a,codeFencedFenceMeta:a,codeIndented:i(Nt,a),codeText:i(lt,a),codeTextData:L,data:L,codeFlowValue:L,definition:i(Le),definitionDestinationString:a,definitionLabelString:a,definitionTitleString:a,emphasis:i(nt),hardBreakEscape:i(Ze),hardBreakTrailing:i(Ze),htmlFlow:i(dt,a),htmlFlowData:L,htmlText:i(dt,a),htmlTextData:L,image:i(It),label:a,link:i(Zt),listItem:i(Lo),listItemValue:m,listOrdered:i(pt,c),listUnordered:i(pt),paragraph:i(St),reference:M,referenceString:a,resourceDestinationString:a,resourceTitleString:a,setextHeading:i(At),strong:i($),thematicBreak:i(ie)},exit:{atxHeading:l(),atxHeadingSequence:v,autolink:l(),autolinkEmail:Te,autolinkProtocol:te,blockQuote:l(),characterEscapeValue:H,characterReferenceMarkerHexadecimal:F,characterReferenceMarkerNumeric:F,characterReferenceValue:pe,characterReference:ae,codeFenced:l(_),codeFencedFence:h,codeFencedFenceInfo:d,codeFencedFenceMeta:f,codeFlowValue:H,codeIndented:l(g),codeText:l(N),codeTextData:H,data:H,definition:l(),definitionDestinationString:b,definitionLabelString:y,definitionTitleString:C,emphasis:l(),hardBreakEscape:l(O),hardBreakTrailing:l(O),htmlFlow:l(D),htmlFlowData:H,htmlText:l(V),htmlTextData:H,image:l(j),label:q,labelText:G,lineEnding:W,link:l(z),listItem:l(),listOrdered:l(),listUnordered:l(),paragraph:l(),referenceString:K,resourceDestinationString:A,resourceTitleString:Y,resource:Q,setextHeading:l(k),setextHeadingLineSequence:P,setextHeadingText:S,strong:l(),thematicBreak:l()}};J3(t,(e||{}).mdastExtensions||[]);let o={};return n;function n(R){let Z={type:"root",children:[]},de={stack:[Z],tokenStack:[],config:t,enter:s,exit:p,buffer:a,resume:u,data:o},se=[],oe=-1;for(;++oe<R.length;)if(R[oe][1].type==="listOrdered"||R[oe][1].type==="listUnordered")if(R[oe][0]==="enter")se.push(oe);else{let Rt=se.pop();oe=r(R,Rt,oe)}for(oe=-1;++oe<R.length;){let Rt=t[R[oe][0]];Q3.call(Rt,R[oe][1].type)&&Rt[R[oe][1].type].call(Object.assign({sliceSerialize:R[oe][2].sliceSerialize},de),R[oe][1])}if(de.tokenStack.length>0){let Rt=de.tokenStack[de.tokenStack.length-1];(Rt[1]||Z3).call(de,void 0,Rt[0])}for(Z.position={start:Is(R.length>0?R[0][1].start:{line:1,column:1,offset:0}),end:Is(R.length>0?R[R.length-2][1].end:{line:1,column:1,offset:0})},oe=-1;++oe<t.transforms.length;)Z=t.transforms[oe](Z)||Z;return Z}function r(R,Z,de){let se=Z-1,oe=-1,Rt=!1,ue,X,Se,Me;for(;++se<=de;){let ge=R[se];switch(ge[1].type){case"listUnordered":case"listOrdered":case"blockQuote":{ge[0]==="enter"?oe++:oe--,Me=void 0;break}case"lineEndingBlank":{ge[0]==="enter"&&(ue&&!Me&&!oe&&!Se&&(Se=se),Me=void 0);break}case"linePrefix":case"listItemValue":case"listItemMarker":case"listItemPrefix":case"listItemPrefixWhitespace":break;default:Me=void 0}if(!oe&&ge[0]==="enter"&&ge[1].type==="listItemPrefix"||oe===-1&&ge[0]==="exit"&&(ge[1].type==="listUnordered"||ge[1].type==="listOrdered")){if(ue){let ve=se;for(X=void 0;ve--;){let yo=R[ve];if(yo[1].type==="lineEnding"||yo[1].type==="lineEndingBlank"){if(yo[0]==="exit")continue;X&&(R[X][1].type="lineEndingBlank",Rt=!0),yo[1].type="lineEnding",X=ve}else if(!(yo[1].type==="linePrefix"||yo[1].type==="blockQuotePrefix"||yo[1].type==="blockQuotePrefixWhitespace"||yo[1].type==="blockQuoteMarker"||yo[1].type==="listItemIndent"))break}Se&&(!X||Se<X)&&(ue._spread=!0),ue.end=Object.assign({},X?R[X][1].start:ge[1].end),R.splice(X||se,0,["exit",ue,ge[2]]),se++,de++}if(ge[1].type==="listItemPrefix"){let ve={type:"listItem",_spread:!1,start:Object.assign({},ge[1].start),end:void 0};ue=ve,R.splice(se,0,["enter",ve,ge[2]]),se++,de++,Se=void 0,Me=!0}}}return R[Z][1]._spread=Rt,de}function i(R,Z){return de;function de(se){s.call(this,R(se),se),Z&&Z.call(this,se)}}function a(){this.stack.push({type:"fragment",children:[]})}function s(R,Z,de){this.stack[this.stack.length-1].children.push(R),this.stack.push(R),this.tokenStack.push([Z,de]),R.position={start:Is(Z.start),end:void 0}}function l(R){return Z;function Z(de){R&&R.call(this,de),p.call(this,de)}}function p(R,Z){let de=this.stack.pop(),se=this.tokenStack.pop();if(se)se[0].type!==R.type&&(Z?Z.call(this,R,se[0]):(se[1]||Z3).call(this,R,se[0]));else throw new Error("Cannot close `"+R.type+"` ("+bs({start:R.start,end:R.end})+"): it\u2019s not open");de.position.end=Is(R.end)}function u(){return ol(this.stack.pop())}function c(){this.data.expectingFirstListItemValue=!0}function m(R){if(this.data.expectingFirstListItemValue){let Z=this.stack[this.stack.length-2];Z.start=Number.parseInt(this.sliceSerialize(R),10),this.data.expectingFirstListItemValue=void 0}}function d(){let R=this.resume(),Z=this.stack[this.stack.length-1];Z.lang=R}function f(){let R=this.resume(),Z=this.stack[this.stack.length-1];Z.meta=R}function h(){this.data.flowCodeInside||(this.buffer(),this.data.flowCodeInside=!0)}function _(){let R=this.resume(),Z=this.stack[this.stack.length-1];Z.value=R.replace(/^(\r?\n|\r)|(\r?\n|\r)$/g,""),this.data.flowCodeInside=void 0}function g(){let R=this.resume(),Z=this.stack[this.stack.length-1];Z.value=R.replace(/(\r?\n|\r)$/g,"")}function y(R){let Z=this.resume(),de=this.stack[this.stack.length-1];de.label=Z,de.identifier=da(this.sliceSerialize(R)).toLowerCase()}function C(){let R=this.resume(),Z=this.stack[this.stack.length-1];Z.title=R}function b(){let R=this.resume(),Z=this.stack[this.stack.length-1];Z.url=R}function v(R){let Z=this.stack[this.stack.length-1];if(!Z.depth){let de=this.sliceSerialize(R).length;Z.depth=de}}function S(){this.data.setextHeadingSlurpLineEnding=!0}function P(R){let Z=this.stack[this.stack.length-1];Z.depth=this.sliceSerialize(R).codePointAt(0)===61?1:2}function k(){this.data.setextHeadingSlurpLineEnding=void 0}function L(R){let de=this.stack[this.stack.length-1].children,se=de[de.length-1];(!se||se.type!=="text")&&(se=fe(),se.position={start:Is(R.start),end:void 0},de.push(se)),this.stack.push(se)}function H(R){let Z=this.stack.pop();Z.value+=this.sliceSerialize(R),Z.position.end=Is(R.end)}function W(R){let Z=this.stack[this.stack.length-1];if(this.data.atHardBreak){let de=Z.children[Z.children.length-1];de.position.end=Is(R.end),this.data.atHardBreak=void 0;return}!this.data.setextHeadingSlurpLineEnding&&t.canContainEols.includes(Z.type)&&(L.call(this,R),H.call(this,R))}function O(){this.data.atHardBreak=!0}function D(){let R=this.resume(),Z=this.stack[this.stack.length-1];Z.value=R}function V(){let R=this.resume(),Z=this.stack[this.stack.length-1];Z.value=R}function N(){let R=this.resume(),Z=this.stack[this.stack.length-1];Z.value=R}function z(){let R=this.stack[this.stack.length-1];if(this.data.inReference){let Z=this.data.referenceType||"shortcut";R.type+="Reference",R.referenceType=Z,delete R.url,delete R.title}else delete R.identifier,delete R.label;this.data.referenceType=void 0}function j(){let R=this.stack[this.stack.length-1];if(this.data.inReference){let Z=this.data.referenceType||"shortcut";R.type+="Reference",R.referenceType=Z,delete R.url,delete R.title}else delete R.identifier,delete R.label;this.data.referenceType=void 0}function G(R){let Z=this.sliceSerialize(R),de=this.stack[this.stack.length-2];de.label=Rf(Z),de.identifier=da(Z).toLowerCase()}function q(){let R=this.stack[this.stack.length-1],Z=this.resume(),de=this.stack[this.stack.length-1];if(this.data.inReference=!0,de.type==="link"){let se=R.children;de.children=se}else de.alt=Z}function A(){let R=this.resume(),Z=this.stack[this.stack.length-1];Z.url=R}function Y(){let R=this.resume(),Z=this.stack[this.stack.length-1];Z.title=R}function Q(){this.data.inReference=void 0}function M(){this.data.referenceType="collapsed"}function K(R){let Z=this.resume(),de=this.stack[this.stack.length-1];de.label=Z,de.identifier=da(this.sliceSerialize(R)).toLowerCase(),this.data.referenceType="full"}function F(R){this.data.characterReferenceType=R.type}function pe(R){let Z=this.sliceSerialize(R),de=this.data.characterReferenceType,se;de?(se=Pf(Z,de==="characterReferenceMarkerNumeric"?10:16),this.data.characterReferenceType=void 0):se=Vl(Z);let oe=this.stack[this.stack.length-1];oe.value+=se}function ae(R){let Z=this.stack.pop();Z.position.end=Is(R.end)}function te(R){H.call(this,R);let Z=this.stack[this.stack.length-1];Z.url=this.sliceSerialize(R)}function Te(R){H.call(this,R);let Z=this.stack[this.stack.length-1];Z.url="mailto:"+this.sliceSerialize(R)}function Ie(){return{type:"blockquote",children:[]}}function Nt(){return{type:"code",lang:null,meta:null,value:""}}function lt(){return{type:"inlineCode",value:""}}function Le(){return{type:"definition",identifier:"",label:null,title:null,url:""}}function nt(){return{type:"emphasis",children:[]}}function At(){return{type:"heading",depth:0,children:[]}}function Ze(){return{type:"break"}}function dt(){return{type:"html",value:""}}function It(){return{type:"image",title:null,url:"",alt:null}}function Zt(){return{type:"link",title:null,url:"",children:[]}}function pt(R){return{type:"list",ordered:R.type==="listOrdered",start:null,spread:R._spread,children:[]}}function Lo(R){return{type:"listItem",spread:R._spread,checked:null,children:[]}}function St(){return{type:"paragraph",children:[]}}function $(){return{type:"strong",children:[]}}function fe(){return{type:"text",value:""}}function ie(){return{type:"thematicBreak"}}}function Is(e){return{line:e.line,column:e.column,offset:e.offset}}function J3(e,t){let o=-1;for(;++o<t.length;){let n=t[o];Array.isArray(n)?J3(e,n):lB(e,n)}}function lB(e,t){let o;for(o in t)if(Q3.call(t,o))switch(o){case"canContainEols":{let n=t[o];n&&e[o].push(...n);break}case"transforms":{let n=t[o];n&&e[o].push(...n);break}case"enter":case"exit":{let n=t[o];n&&Object.assign(e[o],n);break}}}function Z3(e,t){throw e?new Error("Cannot close `"+e.type+"` ("+bs({start:e.start,end:e.end})+"): a different token (`"+t.type+"`, "+bs({start:t.start,end:t.end})+") is open"):new Error("Cannot close document, a token (`"+t.type+"`, "+bs({start:t.start,end:t.end})+") is still open")}function Uf(e){let t=this;t.parser=o;function o(n){return u0(n,{...t.data("settings"),...e,extensions:t.data("micromarkExtensions")||[],mdastExtensions:t.data("fromMarkdownExtensions")||[]})}}var e8={}.hasOwnProperty;function t8(e,t){let o=t||{};function n(r,...i){let a=n.invalid,s=n.handlers;if(r&&e8.call(r,e)){let l=String(r[e]);a=e8.call(s,l)?s[l]:n.unknown}if(a)return a.call(this,r,...i)}return n.handlers=o.handlers||{},n.invalid=o.invalid,n.unknown=o.unknown,n}var pB={}.hasOwnProperty;function m0(e,t){let o=-1,n;if(t.extensions)for(;++o<t.extensions.length;)m0(e,t.extensions[o]);for(n in t)if(pB.call(t,n))switch(n){case"extensions":break;case"unsafe":{o8(e[n],t[n]);break}case"join":{o8(e[n],t[n]);break}case"handlers":{cB(e[n],t[n]);break}default:e.options[n]=t[n]}return e}function o8(e,t){t&&e.push(...t)}function cB(e,t){t&&Object.assign(e,t)}function n8(e,t,o,n){let r=o.enter("blockquote"),i=o.createTracker(n);i.move("> "),i.shift(2);let a=o.indentLines(o.containerFlow(e,i.current()),uB);return r(),a}function uB(e,t,o){return">"+(o?"":" ")+e}function Wf(e,t){return r8(e,t.inConstruct,!0)&&!r8(e,t.notInConstruct,!1)}function r8(e,t,o){if(typeof t=="string"&&(t=[t]),!t||t.length===0)return o;let n=-1;for(;++n<t.length;)if(e.includes(t[n]))return!0;return!1}function d0(e,t,o,n){let r=-1;for(;++r<o.unsafe.length;)if(o.unsafe[r].character===`
`&&Wf(o.stack,o.unsafe[r]))return/[ \t]/.test(n.before)?"":" ";return`\\
`}function lu(e,t){return!!(t.options.fences===!1&&e.value&&!e.lang&&/[^ \r\n]/.test(e.value)&&!/^[\t ]*(?:[\r\n]|$)|(?:^|[\r\n])[\t ]*$/.test(e.value))}function i8(e){let t=e.options.fence||"`";if(t!=="`"&&t!=="~")throw new Error("Cannot serialize code with `"+t+"` for `options.fence`, expected `` ` `` or `~`");return t}function a8(e,t,o,n){let r=i8(o),i=e.value||"",a=r==="`"?"GraveAccent":"Tilde";if(lu(e,o)){let c=o.enter("codeIndented"),m=o.indentLines(i,mB);return c(),m}let s=o.createTracker(n),l=r.repeat(Math.max(FC(i,r)+1,3)),p=o.enter("codeFenced"),u=s.move(l);if(e.lang){let c=o.enter(`codeFencedLang${a}`);u+=s.move(o.safe(e.lang,{before:u,after:" ",encode:["`"],...s.current()})),c()}if(e.lang&&e.meta){let c=o.enter(`codeFencedMeta${a}`);u+=s.move(" "),u+=s.move(o.safe(e.meta,{before:u,after:`
`,encode:["`"],...s.current()})),c()}return u+=s.move(`
`),i&&(u+=s.move(i+`
`)),u+=s.move(l),p(),u}function mB(e,t,o){return(o?"":"    ")+e}function Bp(e){let t=e.options.quote||'"';if(t!=='"'&&t!=="'")throw new Error("Cannot serialize title with `"+t+"` for `options.quote`, expected `\"`, or `'`");return t}function s8(e,t,o,n){let r=Bp(o),i=r==='"'?"Quote":"Apostrophe",a=o.enter("definition"),s=o.enter("label"),l=o.createTracker(n),p=l.move("[");return p+=l.move(o.safe(o.associationId(e),{before:p,after:"]",...l.current()})),p+=l.move("]: "),s(),!e.url||/[\0- \u007F]/.test(e.url)?(s=o.enter("destinationLiteral"),p+=l.move("<"),p+=l.move(o.safe(e.url,{before:p,after:">",...l.current()})),p+=l.move(">")):(s=o.enter("destinationRaw"),p+=l.move(o.safe(e.url,{before:p,after:e.title?" ":`
`,...l.current()}))),s(),e.title&&(s=o.enter(`title${i}`),p+=l.move(" "+r),p+=l.move(o.safe(e.title,{before:p,after:r,...l.current()})),p+=l.move(r),s()),a(),p}function l8(e){let t=e.options.emphasis||"*";if(t!=="*"&&t!=="_")throw new Error("Cannot serialize emphasis with `"+t+"` for `options.emphasis`, expected `*`, or `_`");return t}f0.peek=dB;function f0(e,t,o,n){let r=l8(o),i=o.enter("emphasis"),a=o.createTracker(n),s=a.move(r);return s+=a.move(o.containerPhrasing(e,{before:s,after:r,...a.current()})),s+=a.move(r),i(),s}function dB(e,t,o){return o.options.emphasis||"*"}function Gf(e,t){let o=!1;return zC(e,function(n){if("value"in n&&/\r?\n|\r/.test(n.value)||n.type==="break")return o=!0,NC}),!!((!e.depth||e.depth<3)&&ol(e)&&(t.options.setext||o))}function p8(e,t,o,n){let r=Math.max(Math.min(6,e.depth||1),1),i=o.createTracker(n);if(Gf(e,o)){let u=o.enter("headingSetext"),c=o.enter("phrasing"),m=o.containerPhrasing(e,{...i.current(),before:`
`,after:`
`});return c(),u(),m+`
`+(r===1?"=":"-").repeat(m.length-(Math.max(m.lastIndexOf("\r"),m.lastIndexOf(`
`))+1))}let a="#".repeat(r),s=o.enter("headingAtx"),l=o.enter("phrasing");i.move(a+" ");let p=o.containerPhrasing(e,{before:"# ",after:`
`,...i.current()});return/^[\t ]/.test(p)&&(p="&#x"+p.charCodeAt(0).toString(16).toUpperCase()+";"+p.slice(1)),p=p?a+" "+p:a,o.options.closeAtx&&(p+=" "+a),l(),s(),p}h0.peek=fB;function h0(e){return e.value||""}function fB(){return"<"}g0.peek=hB;function g0(e,t,o,n){let r=Bp(o),i=r==='"'?"Quote":"Apostrophe",a=o.enter("image"),s=o.enter("label"),l=o.createTracker(n),p=l.move("![");return p+=l.move(o.safe(e.alt,{before:p,after:"]",...l.current()})),p+=l.move("]("),s(),!e.url&&e.title||/[\0- \u007F]/.test(e.url)?(s=o.enter("destinationLiteral"),p+=l.move("<"),p+=l.move(o.safe(e.url,{before:p,after:">",...l.current()})),p+=l.move(">")):(s=o.enter("destinationRaw"),p+=l.move(o.safe(e.url,{before:p,after:e.title?" ":")",...l.current()}))),s(),e.title&&(s=o.enter(`title${i}`),p+=l.move(" "+r),p+=l.move(o.safe(e.title,{before:p,after:r,...l.current()})),p+=l.move(r),s()),p+=l.move(")"),a(),p}function hB(){return"!"}x0.peek=gB;function x0(e,t,o,n){let r=e.referenceType,i=o.enter("imageReference"),a=o.enter("label"),s=o.createTracker(n),l=s.move("!["),p=o.safe(e.alt,{before:l,after:"]",...s.current()});l+=s.move(p+"]["),a();let u=o.stack;o.stack=[],a=o.enter("reference");let c=o.safe(o.associationId(e),{before:l,after:"]",...s.current()});return a(),o.stack=u,i(),r==="full"||!p||p!==c?l+=s.move(c+"]"):r==="shortcut"?l=l.slice(0,-1):l+=s.move("]"),l}function gB(){return"!"}_0.peek=xB;function _0(e,t,o){let n=e.value||"",r="`",i=-1;for(;new RegExp("(^|[^`])"+r+"([^`]|$)").test(n);)r+="`";for(/[^ \r\n]/.test(n)&&(/^[ \r\n]/.test(n)&&/[ \r\n]$/.test(n)||/^`|`$/.test(n))&&(n=" "+n+" ");++i<o.unsafe.length;){let a=o.unsafe[i],s=o.compilePattern(a),l;if(a.atBreak)for(;l=s.exec(n);){let p=l.index;n.charCodeAt(p)===10&&n.charCodeAt(p-1)===13&&p--,n=n.slice(0,p)+" "+n.slice(l.index+1)}}return r+n+r}function xB(){return"`"}function C0(e,t){let o=ol(e);return!!(!t.options.resourceLink&&e.url&&!e.title&&e.children&&e.children.length===1&&e.children[0].type==="text"&&(o===e.url||"mailto:"+o===e.url)&&/^[a-z][a-z+.-]+:/i.test(e.url)&&!/[\0- <>\u007F]/.test(e.url))}y0.peek=_B;function y0(e,t,o,n){let r=Bp(o),i=r==='"'?"Quote":"Apostrophe",a=o.createTracker(n),s,l;if(C0(e,o)){let u=o.stack;o.stack=[],s=o.enter("autolink");let c=a.move("<");return c+=a.move(o.containerPhrasing(e,{before:c,after:">",...a.current()})),c+=a.move(">"),s(),o.stack=u,c}s=o.enter("link"),l=o.enter("label");let p=a.move("[");return p+=a.move(o.containerPhrasing(e,{before:p,after:"](",...a.current()})),p+=a.move("]("),l(),!e.url&&e.title||/[\0- \u007F]/.test(e.url)?(l=o.enter("destinationLiteral"),p+=a.move("<"),p+=a.move(o.safe(e.url,{before:p,after:">",...a.current()})),p+=a.move(">")):(l=o.enter("destinationRaw"),p+=a.move(o.safe(e.url,{before:p,after:e.title?" ":")",...a.current()}))),l(),e.title&&(l=o.enter(`title${i}`),p+=a.move(" "+r),p+=a.move(o.safe(e.title,{before:p,after:r,...a.current()})),p+=a.move(r),l()),p+=a.move(")"),s(),p}function _B(e,t,o){return C0(e,o)?"<":"["}b0.peek=CB;function b0(e,t,o,n){let r=e.referenceType,i=o.enter("linkReference"),a=o.enter("label"),s=o.createTracker(n),l=s.move("["),p=o.containerPhrasing(e,{before:l,after:"]",...s.current()});l+=s.move(p+"]["),a();let u=o.stack;o.stack=[],a=o.enter("reference");let c=o.safe(o.associationId(e),{before:l,after:"]",...s.current()});return a(),o.stack=u,i(),r==="full"||!p||p!==c?l+=s.move(c+"]"):r==="shortcut"?l=l.slice(0,-1):l+=s.move("]"),l}function CB(){return"["}function Dp(e){let t=e.options.bullet||"*";if(t!=="*"&&t!=="+"&&t!=="-")throw new Error("Cannot serialize items with `"+t+"` for `options.bullet`, expected `*`, `+`, or `-`");return t}function c8(e){let t=Dp(e),o=e.options.bulletOther;if(!o)return t==="*"?"-":"*";if(o!=="*"&&o!=="+"&&o!=="-")throw new Error("Cannot serialize items with `"+o+"` for `options.bulletOther`, expected `*`, `+`, or `-`");if(o===t)throw new Error("Expected `bullet` (`"+t+"`) and `bulletOther` (`"+o+"`) to be different");return o}function u8(e){let t=e.options.bulletOrdered||".";if(t!=="."&&t!==")")throw new Error("Cannot serialize items with `"+t+"` for `options.bulletOrdered`, expected `.` or `)`");return t}function jf(e){let t=e.options.rule||"*";if(t!=="*"&&t!=="-"&&t!=="_")throw new Error("Cannot serialize rules with `"+t+"` for `options.rule`, expected `*`, `-`, or `_`");return t}function m8(e,t,o,n){let r=o.enter("list"),i=o.bulletCurrent,a=e.ordered?u8(o):Dp(o),s=e.ordered?a==="."?")":".":c8(o),l=t&&o.bulletLastUsed?a===o.bulletLastUsed:!1;if(!e.ordered){let u=e.children?e.children[0]:void 0;if((a==="*"||a==="-")&&u&&(!u.children||!u.children[0])&&o.stack[o.stack.length-1]==="list"&&o.stack[o.stack.length-2]==="listItem"&&o.stack[o.stack.length-3]==="list"&&o.stack[o.stack.length-4]==="listItem"&&o.indexStack[o.indexStack.length-1]===0&&o.indexStack[o.indexStack.length-2]===0&&o.indexStack[o.indexStack.length-3]===0&&(l=!0),jf(o)===a&&u){let c=-1;for(;++c<e.children.length;){let m=e.children[c];if(m&&m.type==="listItem"&&m.children&&m.children[0]&&m.children[0].type==="thematicBreak"){l=!0;break}}}}l&&(a=s),o.bulletCurrent=a;let p=o.containerFlow(e,n);return o.bulletLastUsed=a,o.bulletCurrent=i,r(),p}function d8(e){let t=e.options.listItemIndent||"one";if(t!=="tab"&&t!=="one"&&t!=="mixed")throw new Error("Cannot serialize items with `"+t+"` for `options.listItemIndent`, expected `tab`, `one`, or `mixed`");return t}function f8(e,t,o,n){let r=d8(o),i=o.bulletCurrent||Dp(o);t&&t.type==="list"&&t.ordered&&(i=(typeof t.start=="number"&&t.start>-1?t.start:1)+(o.options.incrementListMarker===!1?0:t.children.indexOf(e))+i);let a=i.length+1;(r==="tab"||r==="mixed"&&(t&&t.type==="list"&&t.spread||e.spread))&&(a=Math.ceil(a/4)*4);let s=o.createTracker(n);s.move(i+" ".repeat(a-i.length)),s.shift(a);let l=o.enter("listItem"),p=o.indentLines(o.containerFlow(e,s.current()),u);return l(),p;function u(c,m,d){return m?(d?"":" ".repeat(a))+c:(d?i:i+" ".repeat(a-i.length))+c}}function h8(e,t,o,n){let r=o.enter("paragraph"),i=o.enter("phrasing"),a=o.containerPhrasing(e,n);return i(),r(),a}var I0=HC(["break","delete","emphasis","footnote","footnoteReference","image","imageReference","inlineCode","inlineMath","link","linkReference","mdxJsxTextElement","mdxTextExpression","strong","text","textDirective"]);function g8(e,t,o,n){return(e.children.some(function(a){return I0(a)})?o.containerPhrasing:o.containerFlow).call(o,e,n)}function x8(e){let t=e.options.strong||"*";if(t!=="*"&&t!=="_")throw new Error("Cannot serialize strong with `"+t+"` for `options.strong`, expected `*`, or `_`");return t}S0.peek=yB;function S0(e,t,o,n){let r=x8(o),i=o.enter("strong"),a=o.createTracker(n),s=a.move(r+r);return s+=a.move(o.containerPhrasing(e,{before:s,after:r,...a.current()})),s+=a.move(r+r),i(),s}function yB(e,t,o){return o.options.strong||"*"}function _8(e,t,o,n){return o.safe(e.value,n)}function C8(e){let t=e.options.ruleRepetition||3;if(t<3)throw new Error("Cannot serialize rules with repetition `"+t+"` for `options.ruleRepetition`, expected `3` or more");return t}function y8(e,t,o){let n=(jf(o)+(o.options.ruleSpaces?" ":"")).repeat(C8(o));return o.options.ruleSpaces?n.slice(0,-1):n}var b8={blockquote:n8,break:d0,code:a8,definition:s8,emphasis:f0,hardBreak:d0,heading:p8,html:h0,image:g0,imageReference:x0,inlineCode:_0,link:y0,linkReference:b0,list:m8,listItem:f8,paragraph:h8,root:g8,strong:S0,text:_8,thematicBreak:y8};var I8=[bB];function bB(e,t,o,n){if(t.type==="code"&&lu(t,n)&&(e.type==="list"||e.type===t.type&&lu(e,n)))return!1;if("spread"in o&&typeof o.spread=="boolean")return e.type==="paragraph"&&(e.type===t.type||t.type==="definition"||t.type==="heading"&&Gf(t,n))?void 0:o.spread?1:0}var al=["autolink","destinationLiteral","destinationRaw","reference","titleQuote","titleApostrophe"],S8=[{character:"	",after:"[\\r\\n]",inConstruct:"phrasing"},{character:"	",before:"[\\r\\n]",inConstruct:"phrasing"},{character:"	",inConstruct:["codeFencedLangGraveAccent","codeFencedLangTilde"]},{character:"\r",inConstruct:["codeFencedLangGraveAccent","codeFencedLangTilde","codeFencedMetaGraveAccent","codeFencedMetaTilde","destinationLiteral","headingAtx"]},{character:`
`,inConstruct:["codeFencedLangGraveAccent","codeFencedLangTilde","codeFencedMetaGraveAccent","codeFencedMetaTilde","destinationLiteral","headingAtx"]},{character:" ",after:"[\\r\\n]",inConstruct:"phrasing"},{character:" ",before:"[\\r\\n]",inConstruct:"phrasing"},{character:" ",inConstruct:["codeFencedLangGraveAccent","codeFencedLangTilde"]},{character:"!",after:"\\[",inConstruct:"phrasing",notInConstruct:al},{character:'"',inConstruct:"titleQuote"},{atBreak:!0,character:"#"},{character:"#",inConstruct:"headingAtx",after:`(?:[\r
]|$)`},{character:"&",after:"[#A-Za-z]",inConstruct:"phrasing"},{character:"'",inConstruct:"titleApostrophe"},{character:"(",inConstruct:"destinationRaw"},{before:"\\]",character:"(",inConstruct:"phrasing",notInConstruct:al},{atBreak:!0,before:"\\d+",character:")"},{character:")",inConstruct:"destinationRaw"},{atBreak:!0,character:"*",after:`(?:[ 	\r
*])`},{character:"*",inConstruct:"phrasing",notInConstruct:al},{atBreak:!0,character:"+",after:`(?:[ 	\r
])`},{atBreak:!0,character:"-",after:`(?:[ 	\r
-])`},{atBreak:!0,before:"\\d+",character:".",after:`(?:[ 	\r
]|$)`},{atBreak:!0,character:"<",after:"[!/?A-Za-z]"},{character:"<",after:"[!/?A-Za-z]",inConstruct:"phrasing",notInConstruct:al},{character:"<",inConstruct:"destinationLiteral"},{atBreak:!0,character:"="},{atBreak:!0,character:">"},{character:">",inConstruct:"destinationLiteral"},{atBreak:!0,character:"["},{character:"[",inConstruct:"phrasing",notInConstruct:al},{character:"[",inConstruct:["label","reference"]},{character:"\\",after:"[\\r\\n]",inConstruct:"phrasing"},{character:"]",inConstruct:["label","reference"]},{atBreak:!0,character:"_"},{character:"_",inConstruct:"phrasing",notInConstruct:al},{atBreak:!0,character:"`"},{character:"`",inConstruct:["codeFencedLangGraveAccent","codeFencedMetaGraveAccent"]},{character:"`",inConstruct:"phrasing",notInConstruct:al},{atBreak:!0,character:"~"}];function v8(e){return e.label||!e.identifier?e.label||"":Rf(e.identifier)}function T8(e){if(!e._compiled){let t=(e.atBreak?"[\\r\\n][\\t ]*":"")+(e.before?"(?:"+e.before+")":"");e._compiled=new RegExp((t?"("+t+")":"")+(/[|\\{}()[\]^$+*?.-]/.test(e.character)?"\\":"")+e.character+(e.after?"(?:"+e.after+")":""),"g")}return e._compiled}function M8(e,t,o){let n=t.indexStack,r=e.children||[],i=[],a=-1,s=o.before;n.push(-1);let l=t.createTracker(o);for(;++a<r.length;){let p=r[a],u;if(n[n.length-1]=a,a+1<r.length){let c=t.handle.handlers[r[a+1].type];c&&c.peek&&(c=c.peek),u=c?c(r[a+1],e,t,{before:"",after:"",...l.current()}).charAt(0):""}else u=o.after;i.length>0&&(s==="\r"||s===`
`)&&p.type==="html"&&(i[i.length-1]=i[i.length-1].replace(/(\r?\n|\r)$/," "),s=" ",l=t.createTracker(o),l.move(i.join(""))),i.push(l.move(t.handle(p,e,t,{...l.current(),before:s,after:u}))),s=i[i.length-1].slice(-1)}return n.pop(),i.join("")}function w8(e,t,o){let n=t.indexStack,r=e.children||[],i=t.createTracker(o),a=[],s=-1;for(n.push(-1);++s<r.length;){let l=r[s];n[n.length-1]=s,a.push(i.move(t.handle(l,e,t,{before:`
`,after:`
`,...i.current()}))),l.type!=="list"&&(t.bulletLastUsed=void 0),s<r.length-1&&a.push(i.move(IB(l,r[s+1],e,t)))}return n.pop(),a.join("")}function IB(e,t,o,n){let r=n.join.length;for(;r--;){let i=n.join[r](e,t,o,n);if(i===!0||i===1)break;if(typeof i=="number")return`
`.repeat(1+i);if(i===!1)return`

<!---->

`}return`

`}var SB=/\r?\n|\r/g;function E8(e,t){let o=[],n=0,r=0,i;for(;i=SB.exec(e);)a(e.slice(n,i.index)),o.push(i[0]),n=i.index+i[0].length,r++;return a(e.slice(n)),o.join("");function a(s){o.push(t(s,r,!s))}}function P8(e,t,o){let n=(o.before||"")+(t||"")+(o.after||""),r=[],i=[],a={},s=-1;for(;++s<e.unsafe.length;){let u=e.unsafe[s];if(!Wf(e.stack,u))continue;let c=e.compilePattern(u),m;for(;m=c.exec(n);){let d="before"in u||!!u.atBreak,f="after"in u,h=m.index+(d?m[1].length:0);r.includes(h)?(a[h].before&&!d&&(a[h].before=!1),a[h].after&&!f&&(a[h].after=!1)):(r.push(h),a[h]={before:d,after:f})}}r.sort(vB);let l=o.before?o.before.length:0,p=n.length-(o.after?o.after.length:0);for(s=-1;++s<r.length;){let u=r[s];u<l||u>=p||u+1<p&&r[s+1]===u+1&&a[u].after&&!a[u+1].before&&!a[u+1].after||r[s-1]===u-1&&a[u].before&&!a[u-1].before&&!a[u-1].after||(l!==u&&i.push(A8(n.slice(l,u),"\\")),l=u,/[!-/:-@[-`{-~]/.test(n.charAt(u))&&(!o.encode||!o.encode.includes(n.charAt(u)))?i.push("\\"):(i.push("&#x"+n.charCodeAt(u).toString(16).toUpperCase()+";"),l++))}return i.push(A8(n.slice(l,p),o.after)),i.join("")}function vB(e,t){return e-t}function A8(e,t){let o=/\\(?=[!-/:-@[-`{-~])/g,n=[],r=[],i=e+t,a=-1,s=0,l;for(;l=o.exec(i);)n.push(l.index);for(;++a<n.length;)s!==n[a]&&r.push(e.slice(s,n[a])),r.push("\\"),s=n[a];return r.push(e.slice(s)),r.join("")}function k8(e){let t=e||{},o=t.now||{},n=t.lineShift||0,r=o.line||1,i=o.column||1;return{move:l,current:a,shift:s};function a(){return{now:{line:r,column:i},lineShift:n}}function s(p){n+=p}function l(p){let u=p||"",c=u.split(/\r?\n|\r/g),m=c[c.length-1];return r+=c.length-1,i=c.length===1?i+m.length:1+m.length+n,u}}function v0(e,t={}){let o={enter:r,indentLines:E8,associationId:v8,containerPhrasing:EB,containerFlow:AB,createTracker:k8,compilePattern:T8,safe:PB,stack:[],unsafe:[...S8],join:[...I8],handlers:{...b8},options:{},indexStack:[],handle:void 0};m0(o,t),o.options.tightDefinitions&&o.join.push(wB),o.handle=t8("type",{invalid:TB,unknown:MB,handlers:o.handlers});let n=o.handle(e,void 0,o,{before:`
`,after:`
`,now:{line:1,column:1},lineShift:0});return n&&n.charCodeAt(n.length-1)!==10&&n.charCodeAt(n.length-1)!==13&&(n+=`
`),n;function r(i){return o.stack.push(i),a;function a(){o.stack.pop()}}}function TB(e){throw new Error("Cannot handle value `"+e+"`, expected node")}function MB(e){let t=e;throw new Error("Cannot handle unknown node `"+t.type+"`")}function wB(e,t){if(e.type==="definition"&&e.type===t.type)return 0}function EB(e,t){return M8(e,this,t)}function AB(e,t){return w8(e,this,t)}function PB(e,t){return P8(this,e,t)}function Kf(e){let t=this;t.compiler=o;function o(n){return v0(n,{...t.data("settings"),...e,extensions:t.data("toMarkdownExtensions")||[]})}}var $f=I(aw(),1);var an=class extends Error{constructor(t,o,n){super(),typeof o=="string"&&(n=o,o=void 0);let r="",i={},a=!1;if(o&&("line"in o&&"column"in o?i={place:o}:"start"in o&&"end"in o?i={place:o}:"type"in o?i={ancestors:[o],place:o.position}:i={...o}),typeof t=="string"?r=t:!i.cause&&t&&(a=!0,r=t.message,i.cause=t),!i.ruleId&&!i.source&&typeof n=="string"){let l=n.indexOf(":");l===-1?i.ruleId=n:(i.source=n.slice(0,l),i.ruleId=n.slice(l+1))}if(!i.place&&i.ancestors&&i.ancestors){let l=i.ancestors[i.ancestors.length-1];l&&(i.place=l.position)}let s=i.place&&"start"in i.place?i.place.start:i.place;this.ancestors=i.ancestors||void 0,this.cause=i.cause||void 0,this.column=s?s.column:void 0,this.fatal=void 0,this.file,this.message=r,this.line=s?s.line:void 0,this.name=bs(i.place)||"1:1",this.place=i.place||void 0,this.reason=this.message,this.ruleId=i.ruleId||void 0,this.source=i.source||void 0,this.stack=a&&i.cause&&typeof i.cause.stack=="string"?i.cause.stack:"",this.actual,this.expected,this.note,this.url}};an.prototype.file="";an.prototype.name="";an.prototype.reason="";an.prototype.message="";an.prototype.stack="";an.prototype.column=void 0;an.prototype.line=void 0;an.prototype.ancestors=void 0;an.prototype.cause=void 0;an.prototype.fatal=void 0;an.prototype.place=void 0;an.prototype.ruleId=void 0;an.prototype.source=void 0;var xi={basename:kB,dirname:LB,extname:OB,join:BB,sep:"/"};function kB(e,t){if(t!==void 0&&typeof t!="string")throw new TypeError('"ext" argument must be a string');pu(e);let o=0,n=-1,r=e.length,i;if(t===void 0||t.length===0||t.length>e.length){for(;r--;)if(e.codePointAt(r)===47){if(i){o=r+1;break}}else n<0&&(i=!0,n=r+1);return n<0?"":e.slice(o,n)}if(t===e)return"";let a=-1,s=t.length-1;for(;r--;)if(e.codePointAt(r)===47){if(i){o=r+1;break}}else a<0&&(i=!0,a=r+1),s>-1&&(e.codePointAt(r)===t.codePointAt(s--)?s<0&&(n=r):(s=-1,n=a));return o===n?n=a:n<0&&(n=e.length),e.slice(o,n)}function LB(e){if(pu(e),e.length===0)return".";let t=-1,o=e.length,n;for(;--o;)if(e.codePointAt(o)===47){if(n){t=o;break}}else n||(n=!0);return t<0?e.codePointAt(0)===47?"/":".":t===1&&e.codePointAt(0)===47?"//":e.slice(0,t)}function OB(e){pu(e);let t=e.length,o=-1,n=0,r=-1,i=0,a;for(;t--;){let s=e.codePointAt(t);if(s===47){if(a){n=t+1;break}continue}o<0&&(a=!0,o=t+1),s===46?r<0?r=t:i!==1&&(i=1):r>-1&&(i=-1)}return r<0||o<0||i===0||i===1&&r===o-1&&r===n+1?"":e.slice(r,o)}function BB(...e){let t=-1,o;for(;++t<e.length;)pu(e[t]),e[t]&&(o=o===void 0?e[t]:o+"/"+e[t]);return o===void 0?".":DB(o)}function DB(e){pu(e);let t=e.codePointAt(0)===47,o=FB(e,!t);return o.length===0&&!t&&(o="."),o.length>0&&e.codePointAt(e.length-1)===47&&(o+="/"),t?"/"+o:o}function FB(e,t){let o="",n=0,r=-1,i=0,a=-1,s,l;for(;++a<=e.length;){if(a<e.length)s=e.codePointAt(a);else{if(s===47)break;s=47}if(s===47){if(!(r===a-1||i===1))if(r!==a-1&&i===2){if(o.length<2||n!==2||o.codePointAt(o.length-1)!==46||o.codePointAt(o.length-2)!==46){if(o.length>2){if(l=o.lastIndexOf("/"),l!==o.length-1){l<0?(o="",n=0):(o=o.slice(0,l),n=o.length-1-o.lastIndexOf("/")),r=a,i=0;continue}}else if(o.length>0){o="",n=0,r=a,i=0;continue}}t&&(o=o.length>0?o+"/..":"..",n=2)}else o.length>0?o+="/"+e.slice(r+1,a):o=e.slice(r+1,a),n=a-r-1;r=a,i=0}else s===46&&i>-1?i++:i=-1}return o}function pu(e){if(typeof e!="string")throw new TypeError("Path must be a string. Received "+JSON.stringify(e))}var L8={cwd:HB};function HB(){return"/"}function Fp(e){return!!(e!==null&&typeof e=="object"&&"href"in e&&e.href&&"protocol"in e&&e.protocol&&e.auth===void 0)}function O8(e){if(typeof e=="string")e=new URL(e);else if(!Fp(e)){let t=new TypeError('The "path" argument must be of type string or an instance of URL. Received `'+e+"`");throw t.code="ERR_INVALID_ARG_TYPE",t}if(e.protocol!=="file:"){let t=new TypeError("The URL must be of scheme file");throw t.code="ERR_INVALID_URL_SCHEME",t}return NB(e)}function NB(e){if(e.hostname!==""){let n=new TypeError('File URL host must be "localhost" or empty on darwin');throw n.code="ERR_INVALID_FILE_URL_HOST",n}let t=e.pathname,o=-1;for(;++o<t.length;)if(t.codePointAt(o)===37&&t.codePointAt(o+1)===50){let n=t.codePointAt(o+2);if(n===70||n===102){let r=new TypeError("File URL path must not include encoded / characters");throw r.code="ERR_INVALID_FILE_URL_PATH",r}}return decodeURIComponent(t)}var T0=["history","path","basename","stem","extname","dirname"],cu=class{constructor(t){let o;t?Fp(t)?o={path:t}:typeof t=="string"||zB(t)?o={value:t}:o=t:o={},this.cwd="cwd"in o?"":L8.cwd(),this.data={},this.history=[],this.messages=[],this.value,this.map,this.result,this.stored;let n=-1;for(;++n<T0.length;){let i=T0[n];i in o&&o[i]!==void 0&&o[i]!==null&&(this[i]=i==="history"?[...o[i]]:o[i])}let r;for(r in o)T0.includes(r)||(this[r]=o[r])}get basename(){return typeof this.path=="string"?xi.basename(this.path):void 0}set basename(t){w0(t,"basename"),M0(t,"basename"),this.path=xi.join(this.dirname||"",t)}get dirname(){return typeof this.path=="string"?xi.dirname(this.path):void 0}set dirname(t){B8(this.basename,"dirname"),this.path=xi.join(t||"",this.basename)}get extname(){return typeof this.path=="string"?xi.extname(this.path):void 0}set extname(t){if(M0(t,"extname"),B8(this.dirname,"extname"),t){if(t.codePointAt(0)!==46)throw new Error("`extname` must start with `.`");if(t.includes(".",1))throw new Error("`extname` cannot contain multiple dots")}this.path=xi.join(this.dirname,this.stem+(t||""))}get path(){return this.history[this.history.length-1]}set path(t){Fp(t)&&(t=O8(t)),w0(t,"path"),this.path!==t&&this.history.push(t)}get stem(){return typeof this.path=="string"?xi.basename(this.path,this.extname):void 0}set stem(t){w0(t,"stem"),M0(t,"stem"),this.path=xi.join(this.dirname||"",t+(this.extname||""))}fail(t,o,n){let r=this.message(t,o,n);throw r.fatal=!0,r}info(t,o,n){let r=this.message(t,o,n);return r.fatal=void 0,r}message(t,o,n){let r=new an(t,o,n);return this.path&&(r.name=this.path+":"+r.name,r.file=this.path),r.fatal=!1,this.messages.push(r),r}toString(t){return this.value===void 0?"":typeof this.value=="string"?this.value:new TextDecoder(t||void 0).decode(this.value)}};function M0(e,t){if(e&&e.includes(xi.sep))throw new Error("`"+t+"` cannot be a path: did not expect `"+xi.sep+"`")}function w0(e,t){if(!e)throw new Error("`"+t+"` cannot be empty")}function B8(e,t){if(!e)throw new Error("Setting `"+t+"` requires `path` to be set too")}function zB(e){return!!(e&&typeof e=="object"&&"byteLength"in e&&"byteOffset"in e)}var D8=function(e){let n=this.constructor.prototype,r=n[e],i=function(){return r.apply(i,arguments)};return Object.setPrototypeOf(i,n),i};var VB={}.hasOwnProperty,k0=class e extends D8{constructor(){super("copy"),this.Compiler=void 0,this.Parser=void 0,this.attachers=[],this.compiler=void 0,this.freezeIndex=-1,this.frozen=void 0,this.namespace={},this.parser=void 0,this.transformers=DC()}copy(){let t=new e,o=-1;for(;++o<this.attachers.length;){let n=this.attachers[o];t.use(...n)}return t.data((0,$f.default)(!0,{},this.namespace)),t}data(t,o){return typeof t=="string"?arguments.length===2?(P0("data",this.frozen),this.namespace[t]=o,this):VB.call(this.namespace,t)&&this.namespace[t]||void 0:t?(P0("data",this.frozen),this.namespace=t,this):this.namespace}freeze(){if(this.frozen)return this;let t=this;for(;++this.freezeIndex<this.attachers.length;){let[o,...n]=this.attachers[this.freezeIndex];if(n[0]===!1)continue;n[0]===!0&&(n[0]=void 0);let r=o.call(t,...n);typeof r=="function"&&this.transformers.use(r)}return this.frozen=!0,this.freezeIndex=Number.POSITIVE_INFINITY,this}parse(t){this.freeze();let o=qf(t),n=this.parser||this.Parser;return E0("parse",n),n(String(o),o)}process(t,o){let n=this;return this.freeze(),E0("process",this.parser||this.Parser),A0("process",this.compiler||this.Compiler),o?r(void 0,o):new Promise(r);function r(i,a){let s=qf(t),l=n.parse(s);n.run(l,s,function(u,c,m){if(u||!c||!m)return p(u);let d=c,f=n.stringify(d,m);UB(f)?m.value=f:m.result=f,p(u,m)});function p(u,c){u||!c?a(u):i?i(c):o(void 0,c)}}}processSync(t){let o=!1,n;return this.freeze(),E0("processSync",this.parser||this.Parser),A0("processSync",this.compiler||this.Compiler),this.process(t,r),H8("processSync","process",o),n;function r(i,a){o=!0,Th(i),n=a}}run(t,o,n){F8(t),this.freeze();let r=this.transformers;return!n&&typeof o=="function"&&(n=o,o=void 0),n?i(void 0,n):new Promise(i);function i(a,s){let l=qf(o);r.run(t,l,p);function p(u,c,m){let d=c||t;u?s(u):a?a(d):n(void 0,d,m)}}}runSync(t,o){let n=!1,r;return this.run(t,o,i),H8("runSync","run",n),r;function i(a,s){Th(a),r=s,n=!0}}stringify(t,o){this.freeze();let n=qf(o),r=this.compiler||this.Compiler;return A0("stringify",r),F8(t),r(t,n)}use(t,...o){let n=this.attachers,r=this.namespace;if(P0("use",this.frozen),t!=null)if(typeof t=="function")l(t,o);else if(typeof t=="object")Array.isArray(t)?s(t):a(t);else throw new TypeError("Expected usable value, not `"+t+"`");return this;function i(p){if(typeof p=="function")l(p,[]);else if(typeof p=="object")if(Array.isArray(p)){let[u,...c]=p;l(u,c)}else a(p);else throw new TypeError("Expected usable value, not `"+p+"`")}function a(p){if(!("plugins"in p)&&!("settings"in p))throw new Error("Expected usable value but received an empty preset, which is probably a mistake: presets typically come with `plugins` and sometimes with `settings`, but this has neither");s(p.plugins),p.settings&&(r.settings=(0,$f.default)(!0,r.settings,p.settings))}function s(p){let u=-1;if(p!=null)if(Array.isArray(p))for(;++u<p.length;){let c=p[u];i(c)}else throw new TypeError("Expected a list of plugins, not `"+p+"`")}function l(p,u){let c=-1,m=-1;for(;++c<n.length;)if(n[c][0]===p){m=c;break}if(m===-1)n.push([p,...u]);else if(u.length>0){let[d,...f]=u,h=n[m][1];Fm(h)&&Fm(d)&&(d=(0,$f.default)(!0,h,d)),n[m]=[p,d,...f]}}}},L0=new k0().freeze();function E0(e,t){if(typeof t!="function")throw new TypeError("Cannot `"+e+"` without `parser`")}function A0(e,t){if(typeof t!="function")throw new TypeError("Cannot `"+e+"` without `compiler`")}function P0(e,t){if(t)throw new Error("Cannot call `"+e+"` on a frozen processor.\nCreate a new processor first, by calling it: use `processor()` instead of `processor`.")}function F8(e){if(!Fm(e)||typeof e.type!="string")throw new TypeError("Expected node, got `"+e+"`")}function H8(e,t,o){if(!o)throw new Error("`"+e+"` finished async. Use `"+t+"` instead")}function qf(e){return RB(e)?e:new cu(e)}function RB(e){return!!(e&&typeof e=="object"&&"message"in e&&"messages"in e)}function UB(e){return typeof e=="string"||WB(e)}function WB(e){return!!(e&&typeof e=="object"&&"byteLength"in e&&"byteOffset"in e)}var Xf=L0().use(Uf).use(Kf).freeze();var GB={blockquote:Ss,break:$B,code:_i,definition:_i,delete:Ss,emphasis:Ss,footnoteReference:_i,footnoteDefinition:_i,heading:qB,html:_i,image:z8,imageReference:z8,inlineCode:V8,list:Ss,listItem:Ss,link:Ss,linkReference:Ss,strong:Ss,table:_i,tableCell:_i,text:V8,thematicBreak:_i,toml:_i,yaml:_i},jB={},N8=[];function Hp(e){let t={...GB},o=e||jB,n=o.keep||N8,r=o.remove||N8,i=-1;for(;++i<r.length;){let p=r[i];typeof p=="string"?t[p]=_i:t[p[0]]=p[1]}let a={};if(n.length===0)a=t;else{let p;for(p in t)n.includes(p)||(a[p]=t[p]);for(i=-1;++i<n.length;)if(p=n[i],!Object.hasOwn(t,p))throw new Error("Unknown node type `"+p+"` in `keep`, use a replace tuple with a handle instead: `remove: [['"+p+"', handle]]`")}return function(p){return s(p)};function s(p){let u=p.type,c=p;if(Object.hasOwn(a,u)){let m=a[u];m&&(c=m(c)||void 0)}return c=Array.isArray(c)?l(c):c,c&&"children"in c&&(c.children=l(c.children)),c}function l(p){let u=-1,c=[];for(;++u<p.length;){let m=s(p[u]);Array.isArray(m)?c.push(...l(m)):m&&c.push(m)}return KB(c)}}function KB(e){let t=-1,o=[],n;for(;++t<e.length;){let r=e[t];n&&r.type===n.type&&"value"in r&&"value"in n?n.value+=r.value:(o.push(r),n=r)}return o}function z8(e){let t="title"in e?e.title:"",o=e.alt||t||"";return o?{type:"text",value:o}:void 0}function V8(e){return{type:"text",value:e.value}}function qB(e){return{type:"paragraph",children:e.children}}function Ss(e){return e.children}function $B(){return{type:"text",value:`
`}}function _i(){}var R8=async(e,t,o)=>{if(o){let n=Al('.markdown-body[data-testid="chat-ai-message--markdown"]',t);if(!n)return R8(e,t,!1);Bm(e,n,[])}else{let n=hc(e,!1,[]),r=await Xf().use(Hp).process(n);await navigator.clipboard.writeText(r.toString())}},XB=()=>{let{AIMessage:e}=Xe(),{t}=E(),{chatHubLoading:o}=ot(),{pageUrl:n}=vf(),[r,i]=(0,no.useState)(!1),a=(0,no.useMemo)(()=>{let u=Qp();return v3[u]||null},[n]),s=(0,no.useRef)(!1),l=$y.getInstance(),p=async(u,c)=>{let m=u.currentTarget,d=null;if(a?.needFindInstantReplyButtonIdToInput&&!s.current){let h=l.getLastActiveInput();h&&(Pl(h)?d=h:l.deleteLastActiveInput()),s.current=!0}let f=d||T3.getInstance().getLastFocusInstantReplyInput();a&&m&&(f&&(Pl(f)||(f=void 0)),await R8(e,m,c),await a.insertContent(e,c,f)),wf()};return(0,no.useEffect)(()=>{if(a){let u=()=>{if(a.selectors.length){let m=!1;for(let d of a.selectors){let f=document.querySelector(d);if(f&&Pl(f)){m=!0;break}}i(m)}};u();let c=setInterval(u,1e3);return()=>{clearInterval(c)}}},[a]),!a||!r?null:no.default.createElement(no.default.Fragment,null,no.default.createElement(ct,{disabled:o,sx:{p:0},onClick:u=>{p(u,!0)},"data-testid":"maxai-client--ai-message--next-action--insert-result-to-input-with-format-item"},no.default.createElement(x,{width:"100%"},no.default.createElement(x,{direction:"row",alignItems:"center",width:"100%",sx:{px:1},gap:1},no.default.createElement(U,{icon:"InsertBelow",sx:{flexShrink:0,fontSize:"20px",color:"text.secondary"}}),no.default.createElement(hi,{TooltipProps:{disableInteractive:!0},width:0,flex:1,lineClamp:1,fontSize:"16px",whiteSpace:"normal",color:"text.primary",fontWeight:400,sx:{height:"40px",lineHeight:"40px"}},t("package__features:chat__chat_with_any_content__next_actions__insert_content_with_format__title"))),no.default.createElement(ft,null))),no.default.createElement(ct,{disabled:o,sx:{p:0},onClick:u=>{p(u,!1)},"data-testid":"maxai-client--ai-message--next-action--insert-result-to-input-without-format-item"},no.default.createElement(x,{width:"100%"},no.default.createElement(x,{direction:"row",alignItems:"center",width:"100%",sx:{px:1},gap:1},no.default.createElement(U,{icon:"ArrowInsert",sx:{flexShrink:0,fontSize:"20px",color:"text.secondary"}}),no.default.createElement(hi,{TooltipProps:{disableInteractive:!0},width:0,flex:1,lineClamp:1,fontSize:"16px",whiteSpace:"normal",color:"text.primary",fontWeight:400,sx:{height:"40px",lineHeight:"40px"}},t("package__features:chat__chat_with_any_content__next_actions__insert_content_without_format__title"))),no.default.createElement(ft,null))))},U8=XB;var Kr=I(w()),YB=e=>{let{nextActions:t}=e,{chatHubLoading:o}=ot(),{askAIWithShortcutsV2:n}=Ne(),{AIMessage:r}=Xe(),i=(0,Kr.useMemo)(()=>bC(r),[r]),a=async s=>{let l=Gs(s);if(l.actions){let p=[],u=Rr(r,!1);u=u.replace(wl,""),p.push({type:"SET_VARIABLE_MAP",parameters:{VariableMap:{[Be.PRESET_VARIABLE__SELECTED_TEXT.name]:u}}}),p.push({type:"SET_VARIABLE",parameters:{Variable:{key:um,value:"sidebar_related_rewrite"}}}),p.push(...l.actions),await n(p,{disabledMaxAIDocumentIds:!0,keepLoadingAfterExecution:!0})}};return Kr.default.createElement(Ma,{in:!0,timeout:150},Kr.default.createElement(x,{sx:{mt:"0!important"}},t.length>0&&!i&&Kr.default.createElement(U8,null),t.map((s,l)=>{let p=l===t.length-1;if(!s.input?.prompt_action)return null;let u=s.input.prompt_action;return Kr.default.createElement(ct,{key:u.prompt_id,disabled:o,sx:{p:0},onClick:async()=>{await a(u)},id:"maxai-client--ai-message--next-action--use-prompt-action-item","data-testid":`maxai-client--ai-message--next-action--use-prompt-action-item-${l}`},Kr.default.createElement(x,{width:"100%"},Kr.default.createElement(x,{direction:"row",alignItems:"center",width:"100%",sx:{px:1},gap:1},u.prompt_icon&&Kr.default.createElement(U,{icon:u.prompt_icon,sx:{flexShrink:0,fontSize:"20px",color:"text.secondary"}}),Kr.default.createElement(hi,{TooltipProps:{disableInteractive:!0},width:0,flex:1,lineClamp:1,fontSize:"16px",whiteSpace:"normal",color:"text.primary",fontWeight:400,sx:{height:"40px",lineHeight:"40px"}},Qa(u.prompt_id,u.prompt_title))),!p&&Kr.default.createElement(ft,null)))})))},W8=YB;var Sr=I(w());var Yf=new Map,G8=(e,t)=>{window.dispatchEvent(new CustomEvent(e,{detail:{...t,appVersion:Q1,runTimeEnv:Yp}}))},j8=(e,t)=>{if(Yf.get(t))return;let o=n=>{let{appVersion:r,runTimeEnv:i}=n.detail||{};r===Q1&&i===Yp&&t(n)};Yf.set(t,o),window.addEventListener(e,o)},K8=(e,t)=>{let o=Yf.get(t);o&&(Yf.delete(t),window.removeEventListener(e,o))};var q8=I(ow());var ji=I(w()),ZB=({order:e,title:t,disabled:o,onClick:n})=>ji.default.createElement(ct,{disabled:o,sx:{p:0},onClick:n,"data-testid":`maxai-client--ai-message--next-action--related-question-item-${e}`},ji.default.createElement(x,{width:"100%"},ji.default.createElement(ft,null),ji.default.createElement(x,{direction:"row",alignItems:"center",width:"100%",sx:{px:1},gap:1},ji.default.createElement(hi,{TooltipProps:{disableInteractive:!0},lineClamp:1,fontSize:"16px",whiteSpace:"normal",color:"text.primary",fontWeight:400,sx:{height:"40px",lineHeight:"40px"}},t),ji.default.createElement(q8.default,{sx:{ml:"auto",mr:0,fontSize:"24px",color:"text.primary"}})))),QB=e=>{let{nextActions:t}=e,{chatHubLoading:o}=ot();return Array.isArray(t)?ji.default.createElement(Ma,{in:!0,timeout:150},ji.default.createElement(x,{className:"chat-ai-message--related-questions-container"},t.map((n,r)=>n.input?.content?ji.default.createElement(ZB,{order:r+1,title:n.input.content,key:n.input.content,disabled:o,onClick:async()=>{ta.send("SetVariablesModalClose",null),await C2(),G8("MAXAI_CLIENT__CHAT_INPUT__SEND_MESSAGE",{value:n.input.content})}}):null))):null},$8=QB;var JB=e=>{let{nextActions:t,nextActionsStatus:o}=e,{t:n}=E(),{variant:r}=_e(),{isLoading:i}=Xe(),{relatedQuestions:a,usePromptActionPrompts:s}=(0,Sr.useMemo)(()=>{let l=[],p=[];return t.forEach(u=>{switch(u.type){case"UsePromptAction":{p.push(u);break}case"FollowUpQuery":{l.push(u);break}case"FocusedSearch":}}),{usePromptActionPrompts:p,relatedQuestions:l}},[t]);return!i&&t.length===0||r==="share"?null:Sr.default.createElement(Sr.default.Fragment,null,Sr.default.createElement(ft,{sx:{mt:"32px!important"}}),o&&o!=="complete"&&Sr.default.createElement(x,{direction:"row",alignItems:"center",spacing:1},Sr.default.createElement(B,{sx:{display:"inline-block",width:"12px",height:"12px",margin:"0 0 0 4px !important",borderRadius:"50%",backgroundColor:l=>l.palette.mode==="dark"?"#fff":"#000"}})),o==="complete"&&a.length>0&&Sr.default.createElement(Sr.default.Fragment,null,Sr.default.createElement(Gi,{title:{title:n("package__features:chat__chat_with_any_content__next_actions__related__title"),titleIcon:"Stacks"}})),a.length>0&&Sr.default.createElement($8,{nextActions:a}),Sr.default.createElement(W8,{nextActions:s}))},X8=JB;var Y8=I(ir());var fa=I(w()),eD=e=>{let{message:t}=e,{metadata:o}=Xe(),{variant:n}=_e(),{isPayingUser:r}=Tt(),{showPricingHooksPopup:i}=Fl(),{updateMessage:a}=Di(),{paywallClickDebounce:s}=Wa(),l=o.embeddedPaywall,p=async c=>{if(!l)return;s({conversationId:t.conversationId,paywallType:"response",paywallReason:"ProChat",buttonType:"upgrade",targetElement:c?.currentTarget});let m=await Zs.sendUserAction(l.cta_action_name);m?.paywall&&i(t.conversationId,m.paywall)},u=()=>{if(!l)return;let c=Jo([{},t,{originalMessage:{metadata:{embeddedPaywall:{status:"hidden"}}}}]);a(t.conversationId,c),Zs.sendUserAction(l.close_action_name)};return n==="share"||r||!l||l.status==="hidden"?null:fa.default.createElement(x,{spacing:1,direction:"row",alignItems:"center",sx:{border:"1px solid",borderColor:"border.main",borderRadius:1,px:1.5,py:"10px"}},fa.default.createElement(Ha,{sx:{color:"text.primary",fontSize:"20px"}}),fa.default.createElement(x,{flex:1,spacing:.5},fa.default.createElement(T,{fontSize:"14px",fontWeight:500,color:"text.primary"},l.title),fa.default.createElement(T,{fontSize:"14px",color:"text.secondary"},l.message)),fa.default.createElement(ce,{variant:"contained",onClick:p,sx:{borderRadius:"9999px",px:"12px"}},l.cta_button_title),fa.default.createElement(ne,{onClick:u,sx:{width:36,height:36}},fa.default.createElement(Y8.default,{sx:{fontSize:20}})))},Zf=eD;var Jf=I(w());var qr=I(w()),tD=e=>{let{contentType:t="text"}=e;return t==="image"?qr.default.createElement(x,{mt:1,width:"60%",minWidth:sc-16-16},qr.default.createElement(x,{width:"100%",sx:{position:"relative",paddingBottom:"100%",bgcolor:"rgba(249, 249, 249)",borderRadius:"8px",alignItems:"center",justifyContent:"center"}},qr.default.createElement(B,{sx:{position:"absolute",top:0,left:0,width:"100%",height:"100%"}}),qr.default.createElement(r2,{sx:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%,-50%)",width:"54px",height:"54px",color:"#5f5f5f"}}))):qr.default.createElement(x,{mt:1},qr.default.createElement(vo,{animation:"wave",height:10}),qr.default.createElement(vo,{animation:"wave",height:10}),qr.default.createElement(vo,{animation:"wave",height:10}),qr.default.createElement(vo,{animation:"wave",height:10}),qr.default.createElement(vo,{animation:"wave",height:10}),qr.default.createElement(vo,{animation:"wave",height:10}))},Z8=tD;var ro=I(w());var J8=I(Pm()),e9=I(Q8());var uu=I(w()),iD=e=>{let{collapsed:t,disabled:o,onClick:n,children:r}=e,i=typeof t=="boolean"&&!o;return uu.default.createElement(x,{direction:"row",onClick:i?n:void 0,sx:{width:"max-content",alignItems:"center",color:a=>a.palette.mode==="dark"?"rgba(255, 255, 255, 0.7)":"rgba(0, 0, 0, 0.7)","&:hover":i?{cursor:"pointer",color:a=>a.palette.mode==="dark"?"rgba(255, 255, 255, 0.8)":"rgba(0, 0, 0, 0.6)"}:void 0}},uu.default.createElement(T,{fontSize:16,fontWeight:400},r||""),i?t?uu.default.createElement(J8.default,{sx:{fontSize:20,color:"inhert"}}):uu.default.createElement(e9.default,{sx:{fontSize:20,color:"inhert"}}):null)},Np=iD;var aD=e=>{let{message:t}=e,{t:o}=E(),{isDarkMode:n}=lr(),{metadata:r,content:i}=Xe(),[a,s]=(0,ro.useState)(!0),[l,p]=(0,ro.useState)(1),u=(0,ro.useMemo)(()=>en(void 0,r.AIModel),[r.AIModel]),c=(0,ro.useMemo)(()=>{let m=r?.AIModel,d=r?.processingText,f=r?.thinkingText,h=r?.copilot,_=gC(t);return f?_?"reasoningText":"reasonedText":_?h?"skeleton":d?"processingText":m?fC(m)&&u?.disableStreaming?"countdown":"understandingText":"point":"empty"},[r,i.contentType,u]);return(0,ro.useEffect)(()=>{if(c==="reasoningText"&&s(!1),c==="reasonedText"&&s(!0),c==="countdown"){p(1);let m=setInterval(()=>{p(d=>d+1)},1e3);return()=>clearInterval(m)}},[c]),c==="empty"?null:ro.default.createElement(x,{spacing:1},c==="skeleton"&&ro.default.createElement(Z8,{contentType:i.contentType}),c==="processingText"&&ro.default.createElement(Np,null,t.originalMessage?.metadata?.processingText||""),c==="countdown"&&ro.default.createElement(Np,{collapsed:a,onClick:()=>s(!a),disabled:!r.thinkingText},o("package__features:chat__ai_message__think_for_x_seconds",{COUNTDOWN:l})),c==="understandingText"&&ro.default.createElement(Np,{collapsed:a,onClick:()=>s(!a),disabled:!r.thinkingText},o("package__features:chat__ai_message__understanding_text")),c==="reasoningText"&&ro.default.createElement(Np,{collapsed:a,onClick:()=>s(!a),disabled:!r.thinkingText},o("package__features:chat__ai_message__reasoning_text")),c==="reasonedText"&&ro.default.createElement(Np,{collapsed:a,onClick:()=>s(!a),disabled:!r.thinkingText},o("package__features:chat__ai_message__reasoned_text",{AI_MODEL:u?.title||r.AIModel||""})),r?.thinkingText&&!a&&ro.default.createElement(B,{className:`markdown-body ${n?"markdown-body-dark":""}`,sx:{borderLeft:"2px solid",borderColor:"border.main",pl:1}},ro.default.createElement(B,{sx:{fontSize:14,color:m=>m.palette.mode==="dark"?"rgba(255,255,255,0.6)":"rgba(0,0,0,0.6)","& a":{color:"inherit!important",fontSize:14,textDecoration:"none!important",pointerEvents:"none"}}},ro.default.createElement(ro.Suspense,{fallback:ro.default.createElement(Wn,{loading:!0})},ro.default.createElement(Ya,{message:t,enableTextToStreaming:r.AIModel==="deepseek-r1"},r.thinkingText)))))},t9=aD;var n9=I(w());var o9=I(w()),sD=e=>{let{loading:t,loadingVariant:o="dots",children:n,sx:r,...i}=e;return o9.default.createElement(T,{sx:t?o==="dots"?{position:"relative","&::after":{content:'""',animation:"dots 1.5s infinite"},"@keyframes dots":{"0%":{content:'"."'},"25%":{content:'".."'},"50%":{content:'"..."'},"75%":{content:'".."'},"100%":{content:'"."'}},...r}:{position:"relative",background:a=>a.palette.mode==="dark"?`linear-gradient(
                  to left,
                  rgba(255, 255, 255, 0.38),
                  rgba(255, 255, 255, 0.87) 80%,
                  rgba(255, 255, 255, 0.38)
                )`:`linear-gradient(
                  to left,
                  rgba(0, 0, 0, 0.38),
                  rgba(0, 0, 0, 0.87) 80%,
                  rgba(0, 0, 0, 0.38)
                )`,backgroundClip:"text",WebkitBackgroundClip:"text",color:"transparent",backgroundSize:"200% 100%",animation:"gradientMove 1.8s linear infinite",...r,"@keyframes gradientMove":{"100%":{backgroundPosition:"-400%"}}}:r,...i},n?.replace("...",""))},vr=sD;var lD=e=>{let{t}=E(),{metadata:o,processingStep:n}=Xe();return n==="RESPONDING"||n==="RESPONDED"?null:n9.default.createElement(vr,{fontSize:16,color:"text.tertiary",loading:!0,loadingVariant:"gradient"},o.processingText||t("package__features:chat__ai_message__understanding_text"))},r9=lD;var Ye=I(w());var i9=I(Am()),a9=I(Pm());var sn=I(w()),pD=rr(Dx)(({theme:e})=>({position:"relative",borderRadius:e.shape.borderRadius,"&::before":{display:"none"},[`&.${Ns.expanded}`]:{margin:0}})),cD=rr(Nx)(()=>({color:"text.secondary",minHeight:"auto",padding:0,[`&.${Ns.expanded}`]:{minHeight:"auto",padding:0},[`& .${Ns.content}`]:{margin:0,padding:"4px 0"},[`& .${Ns.expandIconWrapper}`]:{alignSelf:"flex-start",height:"32px",alignItems:"center"},[`& .${Ns.content}.${Ns.expanded}`]:{margin:0},"&:hover":{cursor:"pointer",opacity:.8}})),uD=rr(Fx)({padding:0}),mD=e=>{let{size:t}=e;return sn.default.createElement(B,{position:"relative",width:t,height:t,zIndex:1},sn.default.createElement(B,{position:"absolute",width:t,height:t,sx:{bgcolor:o=>o.palette.mode==="light"?"rgb(235,235,235)":"rgb(185,185,185)",borderRadius:"50%",animation:"anim 1.0s infinite ease-in-out","@keyframes anim":{"0%,100%":{transform:"scale(1.1)"},"50%":{transform:"scale(0.9)"}}}}),sn.default.createElement(B,{position:"absolute",width:t/2,height:t/2,sx:{left:"50%",top:"50%",transform:"translate(-50%, -50%)",bgcolor:"text.primary",borderRadius:"50%"}}))},dD=e=>{let{title:t,icon:o,loading:n,customize:r,extraNode:i,titleSx:a,iconSx:s,headerSx:l,contentSx:p,children:u,hideExpandIcon:c,...m}=e,d=o;d||(d=sn.default.createElement(B,{display:"flex",justifyContent:"center",alignItems:"center",width:20,height:"1.5em"},n?sn.default.createElement(mD,{size:16}):sn.default.createElement(i9.default,{sx:{fontSize:16,color:"text.tertiary"}})));let f=()=>r?u:u?sn.default.createElement(sn.default.Fragment,null,sn.default.createElement(B,{sx:{position:"absolute",left:"9.5px",top:"22px",bottom:"4px",width:"1px",bgcolor:"text.tertiary"}}),sn.default.createElement(x,{gap:.5,pl:"28px",pb:.5,sx:{alignItems:"flex-start",...p}},u)):null;return sn.default.createElement(pD,{variant:"outlined",...m},sn.default.createElement(cD,{expandIcon:!c&&sn.default.createElement(a9.default,{sx:{fontSize:"24px"}}),sx:{minHeight:"32px!important"}},sn.default.createElement(x,{flex:1,direction:"row",alignItems:"center",justifyContent:"space-between",sx:l},sn.default.createElement(Gi,{title:{title:t,titleIcon:d},fontSx:{fontSize:16,color:"text.secondary",flex:1,...a},iconSx:{...s},sx:{alignItems:"flex-start"}}),sn.default.createElement(x,{direction:"row",alignItems:"center"},i))),sn.default.createElement(uD,null,f()))},Ki=dD;var je=I(w());var s9={padding:"6px 8px",borderRadius:"8px",height:"32px",display:"flex",alignItems:"center",border:"1px solid",boxSizing:"border-box",cursor:"pointer",borderColor:e=>e.palette.mode==="dark"?"rgba(255, 255, 255, 0.12)":"rgba(0, 0, 0, 0.08)","&:hover":{background:e=>e.palette.mode==="dark"?"rgba(255, 255, 255, 0.16)":"rgba(0, 0, 0, 0.08)"}},l9=e=>{let{i18nKey:t,options:o}=e,{t:n}=E();return n(t,o)},fD=(0,je.memo)(e=>{let{results:t,expanded:o,animation:n,defaultShowCount:r=3}=e,[i,a]=(0,je.useState)(!1),s=i?t:t.slice(0,r),l=fh(n);(0,je.useEffect)(()=>{if(o===!1){if(!l.current){a(!1);return}let c=setTimeout(()=>{a(!1)},500);return()=>{clearTimeout(c)}}},[o]);let p=async c=>{LC()?await ja.previewWebpage(c.url,{title:c.title}):window.open(c.url)},u=c=>{let{children:m,...d}=c;return je.default.createElement(Tn,{variant:"outlined",sx:s9,...d},m)};return je.default.createElement(x,{gap:1,direction:"row",alignItems:"center",flexWrap:"wrap"},s.map((c,m)=>je.default.createElement(u,{key:`${c.from||""}-${m}`},je.default.createElement(Rl,{citation:{content:"",search_result_index:1,source:{doc_id:"",type:"search_results",engine:"",title:c.title,from:c.from||"",body:c.body,url:c.url,searchQuery:""}}},je.default.createElement(x,{sx:{cursor:"pointer",flexDirection:"row",alignItems:"center",gap:.5,maxWidth:200},onClick:()=>p(c)},je.default.createElement(B,{width:20,height:20,borderRadius:"50%",overflow:"hidden",flexShrink:0},je.default.createElement("img",{src:ea(c.url),style:{width:"100%",height:"100%",objectFit:"contain"},alt:c.from||""})),je.default.createElement(T,{fontSize:14,color:"text.secondary",noWrap:!0},c.from||""))))),t.length>r&&!i&&je.default.createElement(u,{onClick:()=>a(!0)},je.default.createElement(x,{height:"100%",direction:"row",alignItems:"center",spacing:.5},je.default.createElement(T,{fontSize:14,color:"text.secondary",noWrap:!0},`+ ${t.length-r} `,je.default.createElement(l9,{i18nKey:"package__common:more"})))))}),hD=(0,je.memo)(e=>{let{keywords:t,expanded:o,animation:n,defaultShowCount:r=1}=e,[i,a]=(0,je.useState)(!1),s=i?t:t.slice(0,r),l=fh(n);(0,je.useEffect)(()=>{if(o===!1){if(!l.current){a(!1);return}let c=setTimeout(()=>{a(!1)},500);return()=>{clearTimeout(c)}}},[o]);let p=c=>{let{children:m,...d}=c;return je.default.createElement(Tn,{variant:"outlined",sx:{...s9,maxWidth:"calc(50% - 8px)",cursor:"auto","&:hover":{}},...d},m)},u={whiteSpace:"normal",fontSize:14,wordBreak:"break-all",color:c=>c.palette.mode==="dark"?"rgba(255, 255, 255, 0.7)":"rgba(0, 0, 0, 0.6)"};return je.default.createElement(x,{gap:1,direction:"row",alignItems:"center",flexWrap:"wrap",sx:{flex:"1!important",width:"100%"}},s?.map(c=>je.default.createElement(p,{key:c},je.default.createElement(hi,{TooltipProps:{disableInteractive:!0},lineClamp:1,sx:u},c))),t.length>r&&!i&&je.default.createElement(p,{onClick:()=>a(!0)},je.default.createElement(T,{sx:{...u,cursor:"pointer"}},`+ ${t.length-1} `,je.default.createElement(l9,{i18nKey:"package__common:more"}))))}),gD=e=>{let{searchPlan:t,loading:o,expanded:n,animation:r,...i}=e,{t:a}=E();return je.default.createElement(Ki,{title:je.default.createElement(vr,{loading:!1},t.topic),sx:{border:"none"},loading:o,expanded:n,...i},je.default.createElement(vr,{fontSize:14,color:"text.tertiary",loading:o&&t.status==="searching",loadingVariant:"gradient"},a("package__features:chat__ai_message__searching_text")),t.keywords&&t.keywords.length&&je.default.createElement(hD,{expanded:n,animation:r,keywords:t.keywords}),t.status==="reading"||t.results?je.default.createElement(je.default.Fragment,null,je.default.createElement(vr,{fontSize:14,color:"text.tertiary",loading:o&&t.status==="reading",loadingVariant:"gradient"},a("package__features:chat__ai_message__reading_text")),t.results&&t.results.length>0&&je.default.createElement(fD,{expanded:n,animation:r,results:t.results})):null)},p9=gD;var xD=e=>{let{message:t}=e,{t:o}=E(),{isDarkMode:n}=lr(),{metadata:r,processingStep:i}=Xe(),[a,s]=(0,Ye.useState)(!0),[l,p]=(0,Ye.useState)(!1),[u,c]=(0,Ye.useState)({}),[m,d]=(0,Ye.useState)(!1),[f,h]=(0,Ye.useState)(!1),{chatHubLoading:_}=ot(),g=Ke({expanded:l}),y=(0,Ye.useMemo)(()=>en(void 0,r.AIModel),[r.AIModel]),C=r.searchPlans||[],b=r.preprocessingTrackers||[],v=r.thinkingText,S=Math.max(C.length-1,0),P=i==="UNDERSTANDING",k=C.length||i==="SEARCHING",L=b.length>0||i==="ANALYZING",H=typeof v=="string"||i==="REASONING",W=(0,Ye.useCallback)(()=>{g.current.expanded||(s(!1),clearTimeout(g.current.timeout),g.current.timeout=setTimeout(()=>{s(!0)},100))},[]);(0,Ye.useEffect)(()=>(i==="UNDERSTANDING"&&(W(),p(!0)),i==="SEARCHING"&&(W(),p(!0),c({[S]:!0})),i==="ANALYZING"&&(W(),p(!0),c({}),d(!0)),i==="REASONING"&&(W(),p(!0),c({}),d(!1),h(!0)),i==="RESPONDING"&&p(!1),()=>{clearTimeout(g.current.timeout)}),[i]),(0,Ye.useEffect)(()=>{k&&c({[S]:!0})},[k,S]);let O=()=>C.length?C.map((N,z)=>{let j=i==="SEARCHING"&&z===C.length-1,G=!!u[z];return Ye.default.createElement(p9,{key:z,searchPlan:N,expanded:G,animation:a,loading:j,slotProps:{transition:a&&!_?{}:{timeout:0}},onChange:(q,A)=>c(Y=>({...Y,[z]:A}))})}):null,D=()=>b.length?b.map((N,z)=>{let j=i=="ANALYZING"&&z===b.length-1,G=N.status.replace("...","");return Ye.default.createElement(vr,{key:z,fontSize:14,color:j?"text.primary":"text.tertiary",loading:j,loadingVariant:"gradient",noWrap:!0},G)}):null,V=()=>v?Ye.default.createElement(B,{className:`markdown-body ${n?"markdown-body-dark":""}`},Ye.default.createElement(B,{sx:{fontSize:14,color:i==="REASONING"?"text.primary":"text.tertiary","& a":{color:"inherit!important",fontSize:14,textDecoration:"none!important",pointerEvents:"none"}}},Ye.default.createElement(Ye.Suspense,{fallback:Ye.default.createElement(Wn,{loading:!0})},Ye.default.createElement(Ya,{message:t,enableTextToStreaming:r.AIModel==="deepseek-r1"},v)))):null;return Ye.default.createElement(Ki,{title:"Pro chat",icon:Ye.default.createElement(Ha,{sx:{color:"text.primary"}}),sx:{px:1,py:.5},titleSx:{color:"text.primary",fontWeight:500},slotProps:{transition:_?{timeout:0}:{}},expanded:l,customize:!0,onChange:()=>{let N=!l;p(N),W(),N&&(c({}),d(!1),h(!1),H?h(!0):L?d(!0):k&&c({[S]:!0}))},extraNode:Ye.default.createElement(Ye.default.Fragment,null,Ye.default.createElement(Do,{size:16,model:r.AIModel||""}),Ye.default.createElement(T,{sx:{mx:.5,fontSize:12,color:N=>N.palette.mode==="dark"?"rgba(255, 255, 255, 0.87)":"rgba(0, 0, 0, 0.87)"}},en(void 0,r.AIModel)?.title))},Ye.default.createElement(x,null,P&&Ye.default.createElement(Ki,{title:Ye.default.createElement(vr,{loading:!0,loadingVariant:"gradient"},o("package__features:chat__ai_message__understanding_text")),expanded:!0,loading:!0,slotProps:{transition:a&&!_?{}:{timeout:0}},sx:{border:"none"},headerSx:{py:0}}),k&&O(),L&&Ye.default.createElement(Ki,{title:Ye.default.createElement(vr,{loading:!1},i==="ANALYZING"?o("package__features:chat__ai_message__analyzing_text"):o("package__features:chat__ai_message__analyzed_text")),expanded:m,loading:i==="ANALYZING",onChange:()=>d(!m),slotProps:{transition:a&&!_?{}:{timeout:0}},sx:{border:"none"},headerSx:{py:0}},D()),H?Ye.default.createElement(Ki,{title:Ye.default.createElement(vr,{loading:!1},i==="REASONING"?o("package__features:chat__ai_message__reasoning_text"):o("package__features:chat__ai_message__reasoned_text",{AI_MODEL:y?.title||r.AIModel||""})),expanded:f,loading:i==="REASONING",onChange:()=>h(!f),slotProps:{transition:a&&!_?{}:{timeout:0}},sx:{border:"none"},headerSx:{py:0}},V()):null))},c9=xD;var _D=e=>{let{metadata:t}=Xe();return t.chatMode==="pro_chat"?Jf.default.createElement(c9,{...e}):t.chatMode==="free_chat"?Jf.default.createElement(r9,{...e}):t.thinkingText||!t.isComplete?Jf.default.createElement(t9,{...e}):null},O0=_D;var Zn=I(w());var CD=()=>{let[e,t]=(0,Zn.useState)(!0),{metadata:o}=Xe(),{chatHubLoading:n}=ot(),r=(0,Zn.useMemo)(()=>o.copilot?.steps.some(i=>i.status==="loading"),[o.copilot]);return(0,Zn.useEffect)(()=>{r||t(!1)},[r]),Zn.default.createElement(Ki,{title:"AI art",icon:Zn.default.createElement(Ha,{sx:{color:"text.primary"}}),sx:{px:1,py:.5},titleSx:{color:"text.primary",fontWeight:500},expanded:e,customize:!0,onChange:()=>{t(!e)},slotProps:{transition:n?{timeout:0}:{}},extraNode:o.AIModel&&Zn.default.createElement(Zn.default.Fragment,null,Zn.default.createElement(Do,{size:16,model:o.AIModel||""}),Zn.default.createElement(T,{sx:{mx:.5,fontSize:12,color:i=>i.palette.mode==="dark"?"rgba(255, 255, 255, 0.87)":"rgba(0, 0, 0, 0.87)"}},en(void 0,o.AIModel)?.title))},o.copilot?.steps.map(i=>Zn.default.createElement(Ki,{title:Zn.default.createElement(vr,{loading:i.status!=="complete"},i.title),loading:r,sx:{border:"none"},hideExpandIcon:!0})))},u9=CD;var d9=I(m9());var fo=I(w()),SD=fo.default.memo(({knowledgeSources:e})=>{let[t,o]=(0,fo.useState)(!1),n=()=>{o(!t)},{t:r}=E();return fo.default.createElement(Tn,{variant:"outlined",sx:{borderRadius:"8px",padding:"12px",width:"100%",overflow:"hidden",position:"relative",border:"0px",bgcolor:i=>i.palette.mode==="dark"?"rgba(59, 61, 62, 1)":"rgba(244, 244, 244, 1)"}},fo.default.createElement(B,{display:"flex",alignItems:"center",mb:2},fo.default.createElement("img",{src:`https://t2.gstatic.com/faviconV2?client=SOCIAL&type=FAVICON&fallback_opts=TYPE,SIZE,URL&url=http://${e.title}.com&size=64`,alt:"Logo",style:{width:40,height:40,borderRadius:"8px",marginRight:"8px"}}),fo.default.createElement(B,{flex:1},fo.default.createElement(x,{direction:"row",justifyContent:"space-between",sx:{}},fo.default.createElement(T,{sx:{fontSize:16,fontWeight:600,lineHeight:"150%"},component:"div"},e.title),fo.default.createElement(ce,{onClick:n,sx:{color:"text.primary",height:"25px",borderRadius:"13px",bgcolor:i=>i.palette.mode==="dark"?"rgba(255, 255, 255, 0.16)":"rgba(0, 0, 0, 0.08)"}},fo.default.createElement(d9.default,{sx:{fontSize:"16px",transition:"all 0.2s",transform:t?"rotate(0deg)":"rotate(180deg)",marginRight:"3px",marginLeft:"-3px"}}),r(t?"package__features:chat__ai_message__knowledge__hide":"package__features:chat__ai_message__knowledge__show_all"))),fo.default.createElement(T,{variant:"body2",color:"textSecondary"},e.titleDescription))),fo.default.createElement(ft,null),fo.default.createElement(B,{sx:{marginTop:"8px",maxHeight:t?"1000px":"140px",overflow:"hidden"}},e?.knowledgePanelList&&e?.knowledgePanelList.map(i=>fo.default.createElement(B,{className:"knowledge-source-item",key:i.title,mx:1,my:1,sx:{display:"flex",alignItems:"flex-start"}},fo.default.createElement(T,{variant:"body2",sx:{fontWeight:"600",fontSize:"14px",width:"130px",minWidth:"130px",maxWidth:"130px",lineHeight:1.6}},i.title),fo.default.createElement(B,{flex:1},i.content&&i.content.map((a,s)=>fo.default.createElement(fo.default.Fragment,{key:s},a.type==="a"?fo.default.createElement(wi,{target:"_blank",href:a.href,sx:{display:"inline",fontSize:"14px",color:l=>l.palette.mode==="dark"?"rgba(255, 255, 255, 0.7)":"rgba(0, 0, 0, 0.6)",textDecorationColor:l=>l.palette.mode==="dark"?"rgba(255, 255, 255, 0.7)":"rgba(0, 0, 0, 0.6)"}},a.text):fo.default.createElement(T,{sx:{display:"inline",fontSize:"14px",color:l=>l.palette.mode==="dark"?"rgba(255, 255, 255, 0.7)":"rgba(0, 0, 0, 0.6)"}},a.text))))))))}),f9=SD;var g9=I(tw());var $r=I(w());var Tr=I(w()),vD=e=>{let{message:t,images:o,loading:n,handleUpdateMessageOnImageError:r}=e,[i,a]=(0,Tr.useState)([]),[s,l]=(0,Tr.useState)(),p=S_(i,300,[]);(0,Tr.useEffect)(()=>{if(n||p.length===0)return;let c=setTimeout(()=>{let m=De(t),d=m.originalMessage?.metadata?.searchResults;if(!d)return;let f=!1;d.forEach(h=>{h.images=h.images?.filter(_=>p.includes(_.src)?(f=!0,!1):!0)}),f&&r(m)},400);return()=>{clearTimeout(c)}},[n,p]);let u=(0,Tr.useMemo)(()=>a_(o.filter(c=>!i.includes(c.src)),"src"),[i,o]);return Tr.default.createElement(Tr.default.Fragment,null,u.map(c=>Tr.default.createElement(B,{component:"div",key:c.src,sx:{img:{border:m=>m.palette.mode==="dark"?"1px solid  rgba(255, 255, 255, 0.16)":"1px solid rgba(0, 0, 0, 0.08)"}}},Tr.default.createElement(Vr,{width:64,height:64,imgStyle:{borderRadius:"8px",cursor:"pointer",objectFit:"cover",display:"block",overflow:"hidden"},onImageClick:()=>{l(c.src)},src:c.src,alt:c.alt||"",onError:()=>{a(m=>[...new Set([...m,c.src])])}}))),Tr.default.createElement(Li,{images:u.map(c=>({src:c.src,alt:c.alt})),selectedImage:s,setSelectedImage:l}))},h9=vD;var TD=e=>{let{loading:t,message:o,images:n,videos:r,knowledgePanels:i}=e,{openVideoPopup:a}=aC(),{updateMessage:s}=Di();return $r.default.createElement($r.default.Fragment,null,(n.length>0||r.length>0)&&$r.default.createElement(x,{className:"media_sources",spacing:1},n.length>0&&$r.default.createElement(x,{spacing:1,direction:"row",className:"image_sources",sx:{overflowX:"scroll","&::-webkit-scrollbar":{display:"none",width:0,background:"transparent"}}},$r.default.createElement(h9,{key:o?.conversationId,message:o,loading:t,images:n,handleUpdateMessageOnImageError:l=>{l.conversationId&&s(l.conversationId,l)}})),r.length>0&&$r.default.createElement(x,{spacing:1,direction:"row",className:"image_sources",sx:{overflowX:"scroll","&::-webkit-scrollbar":{display:"none",width:0,background:"transparent"}}},r.map(l=>$r.default.createElement(x,{sx:{position:"relative",cursor:"pointer",img:{border:p=>p.palette.mode==="dark"?"1px solid rgba(255, 255, 255, 0.16)":"1px solid rgba(0, 0, 0, 0.08)"}},className:"videoItem",key:l.src,onClick:()=>{a(l.src,"",!0)}},$r.default.createElement(Vr,{width:114,height:64,imgStyle:{borderRadius:"8px",cursor:"pointer",objectFit:"cover",display:"block",overflow:"hidden"},src:l.imgSrc||l.poster||"",alt:""}),$r.default.createElement(B,{sx:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",height:16,width:16,color:"white",p:2,borderRadius:"50%",lineHeight:0,bgcolor:"#00000080",backdropFilter:"blur(4px)"}},$r.default.createElement(g9.default,{sx:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",fontSize:16}})))))),i.length>0&&$r.default.createElement(f9,{knowledgeSources:i[0]}))},x9=TD;var ur=I(w());var _9=I(Xm()),C9=I(dc());var gn=I(w()),MD=e=>{let{contextMenuList:t=[],onSelectActions:o,onClose:n,placement:r,query:i,onChange:a,platformFeatureCover:s}=e,{t:l}=E(),p=(0,gn.useRef)(null),{contextMenuPath:u}=uo(),c=(0,gn.useRef)(null),m=()=>{c.current?.querySelector("input")?.focus()},d=()=>{m()},f=g=>{m(),g&&g.actions&&u&&(o?.(g),n?.())},[h,_]=(0,gn.useState)(null);return gn.default.createElement(x,{ref:_,direction:r?.startsWith("top")?"column-reverse":"column",height:"100%",sx:{bgcolor:"background.default",border:"1px solid",borderColor:"border.main",borderRadius:1,boxShadow:"rgba(15, 15, 15, 0.05) 0px 0px 0px 1px, rgba(15, 15, 15, 0.1) 0px 3px 6px, rgba(15, 15, 15, 0.2) 0px 9px 24px"}},gn.default.createElement(wa,{mouseEvent:"onClick",onClickAway:()=>{n?.()}},gn.default.createElement(Ct,{placeholder:l("package__features:context_menu__use_prompt_button__input__placeholder"),value:i,onChange:g=>a(g.target.value),"aria-autocomplete":"none",ref:c,"data-testid":"context-menu-use-prompt--textfield",autoFocus:!0,sx:{bgcolor:"background.paper",borderRadius:1,padding:.5,"& input":{p:0,height:"39px",borderRadius:1,fontSize:"16px"}},onKeyDownCapture:g=>{p.current?.proxyKeyboardEvent(g.nativeEvent)&&(g.preventDefault(),g.stopPropagation()),g.key==="Escape"&&(n?.(),g.preventDefault(),g.stopPropagation());let y=p.current?.getSelectedItem();g.key==="Enter"&&y&&(f(y),n?.(),g.preventDefault(),g.stopPropagation())},onKeyDown:g=>{g.stopPropagation()},onKeyUp:g=>{g.stopPropagation()},InputProps:{startAdornment:gn.default.createElement(zn,{position:"start"},gn.default.createElement(C9.default,{sx:{fontSize:"24px"}})),endAdornment:i?gn.default.createElement(zn,{position:"end"},gn.default.createElement(Ve,{onClick:()=>a(""),sx:{p:.5,mr:-.5},edge:"end"},gn.default.createElement(_9.default,{sx:{fontSize:"18px"}}))):null},inputProps:{autoComplete:"off"}})),h&&gn.default.createElement(of,{platformFeatureCover:s,ref:p,menuList:t,menuWidth:300,menuMaxHeight:`${h.clientHeight-50}px`,defaultPlacement:r,defaultFallbackPlacements:[],onClickGroup:d,referenceElement:gn.default.createElement(B,{position:"relative",left:0,top:r?.startsWith("top")?"3px":"-3px"}),root:h,open:!0,onClickItem:f,zIndex:1e4,noOptionFallback:gn.default.createElement(T,{width:"100%",p:1,textAlign:"left",color:g=>g.palette.text.secondary,fontSize:"14px"},l("package__features:context_menu__button__use__prompt_no_options")),sx:{boxShadow:"none",border:"none",width:298}}))},y9=MD;var wD=e=>{let{className:t,sx:o,disabled:n,message:r,open:i,onOpenChange:a,platformFeatureCover:s,menuPlacement:l,menuFallbackPlacements:p,tooltipPlacement:u,label:c}=e,m="max-ai__actions__button--use-prompt",[d,f]=(0,ur.useState)(null),{t:h}=E(),{contextMenuPath:_}=uo(),{askAIWithShortcutsV2:g}=Ne(),{context:y,placement:C,floatingStyles:b,refs:v}=Ga({open:i,strategy:"fixed",onOpenChange(N){a(N)},placement:l||"bottom-start",middleware:[Ru(8),Wu({fallbackPlacements:p||["top-start","top-end","bottom-end"]}),Uu(),zx({apply({availableHeight:N,elements:z}){z.floating.style.maxHeight=`${N}px`}})],whileElementsMounted:Sl}),S=Mm(y),P=Em(y),{getReferenceProps:k,getFloatingProps:L}=Nl([S,P]),[H,W]=(0,ur.useState)(""),{liteContextMenuActionsItems:O}=Hi(H,{enabledVisibilitySettings:!0,enabledFavorite:!0,selectionInputAble:!0}),D=async N=>{let z=N.actions,j="";r&&(typeof r=="string"?j=r:typeof r=="function"?j=r():(j=Rr(r,!1),j=j.replace(wl,"")));let G=[{type:"SET_VARIABLE",parameters:{Variable:{key:"SELECTED_TEXT",value:j,label:"Selected text",isBuiltIn:!0,overwrite:!0}}},{type:"SET_VARIABLE",parameters:{Variable:{key:"VARIABLE_MODAL_KEY",value:"Sidebar",overwrite:!0,isBuiltIn:!0}}}];s&&G.push({type:"SET_VARIABLE",parameters:{Variable:{key:um,value:s}}}),await g(De(z),{beforeActions:G,disabledMaxAIDocumentIds:!0,keepLoadingAfterExecution:!0,isClearInput:!0})},V=(0,ur.useMemo)(()=>O.flatMap(N=>{if(N.type==="group"){let z=`context_menu__prompt__${N.prompt_id}`,j=`package__features:${z}`,G=h(j),q=Or?G==="package__features:"+z:G===z;return(!G||G===N.prompt_id||q||z===j)&&(G=N.prompt_title),[G+"__CONTEXT_MENU_LABEL_SLOT_PLACEHOLDER__"+N.prompt_id,...N.children??[]]}return[N]}),[O,h]);return ur.default.createElement(ur.default.Fragment,null,ur.default.createElement(ne,{tooltipProps:{placement:u||"top"},title:h("package__features:context_menu__button__use__prompt"),sx:{p:"6px",...o},"data-testid":m,className:t,onClick:N=>{f(d?null:N.currentTarget)},disabled:n,buttonRefBind:v.setReference,...k()},ur.default.createElement(U,{sx:{fontSize:"20px"},icon:"Rewrite"}),c),i&&ur.default.createElement(B,{ref:v.setFloating,style:b,...L(),sx:{width:300,height:400,zIndex:9999}},ur.default.createElement(y9,{platformFeatureCover:s,placement:C,onSelectActions:D,onClose:()=>{W(""),a(!1)},query:H,onChange:N=>W(N),contextMenuList:V})))},ED=function(e){return ur.default.createElement(as,{defaultContextMenuPath:"/rewrite"},ur.default.createElement(wD,{...e}))},t1=ED;var Qn=I(w());var I9=I(b9()),mu=I(w()),AD=e=>{let{message:t,...o}=e,{t:n}=E(),[r,i]=(0,mu.useState)(!1),a=MC(t),s=async()=>{i(!0),await Promise.all(a.map(async l=>{let p=l.uploadedUrl;if(!p)return;let u=TC(p);if(u){let c=u.endsWith(".webp")?u.replace(".webp",".png"):u;p=(await v2.fetchDocument(c)).data?.s3?.doc_url||p}try{let c=await J2(ar.fetch(p,{method:"GET",parse:"blob",headers:{"Content-Type":"image/png"}}),2e4,{success:!1}),m=!1;if(c.success&&c?.data?.contentType)try{let d=t.text;xr(t)&&(d=t.originalMessage?.metadata?.title?.title||""),(0,I9.saveAs)(g2(c.data.base64,"image/png"),`${d}.png`),m=!0}catch{}if(!m){let d=document.createElement("a");d.href=p,d.download="download",d.click(),d.remove()}}catch{}})).then().catch().finally(()=>{i(!1)})};return a.length===0?null:mu.default.createElement(ne,{title:n("package__features:chat__ai_message__download_image"),onClick:s,disabled:r,...o,sx:{p:"6px",borderRadius:"4px",...o.sx}},mu.default.createElement(U,{icon:r?"Loading":"FileDownload",sx:{fontSize:"20px"}}))},S9=AD;var du=I(w()),PD=e=>{let{message:t,...o}=e,{t:n}=E(),[r,i]=(0,du.useState)(!1),a=async s=>{let l=Al(".maxai-ai-message__image__content__box img",s.currentTarget);if(l?.src){i(!0);try{let p=new Image;await new Promise(u=>{let c=async m=>{if(m){let d=new ClipboardItem({"image/png":m});navigator.clipboard.write([d]).then(function(){u(!0)}).catch(function(f){u(!1)})}else u(!1)};try{let m=new URL(l.src);p.src=m.href+"&#",p.crossOrigin="anonymous",p.onload=()=>{let d=document.createElement("canvas");d.width=p.naturalWidth,d.height=p.naturalHeight;let f=d.getContext("2d");f&&(f.drawImage(p,0,0),d.toBlob(c))},p.onerror=async()=>{let d=await kl.proxyFetch(l.src,{method:"GET",parse:"blob",blobContentType:"image/png"});if(d?.data){let f=d.data;await c(f)}else u(!1)}}catch{u(!1)}})}catch{}finally{i(!1)}}};return du.default.createElement(ne,{title:n("package__common:copy_image"),disabled:r,onClick:a,...o,sx:{p:"6px",...o.sx}},du.default.createElement(U,{icon:r?"Loading":"Copy",sx:{fontSize:"20px"}}))},v9=PD;var $o=I(w()),T9=[E2,P2,A2,nc],kD=(e,t)=>t==="free_chat"?T9:T9.filter(o=>o.value!==e),LD=e=>{let{message:t}=e,{isLastMessage:o}=Xe(),n=t.conversationId||"",r=re(c=>c.conversationType),i=qa(n),[a,s]=(0,$o.useState)(!1),l=t.originalMessage?.metadata?.AIModel||"",p=t.originalMessage?.metadata?.chatMode,u=(0,$o.useMemo)(()=>r!=="Chat"||!o||!a?null:{suggestions:kD(l,p)},[t.messageId,r,o,l,p,a]);return(0,$o.useEffect)(()=>{i&&n?Ws(n).then(c=>{c.lastRunActions.length>0?s(!0):s(!1)}):s(!1)},[i,n]),!u||l===nm.value?null:$o.default.createElement(OD,{conversationId:n,conversationType:r,suggestionAIModels:u.suggestions})},OD=e=>{let{conversationId:t,conversationType:o,suggestionAIModels:n}=e,{t:r}=E(),{switchConversationModel:i}=qe(),a=xe(t),s=n[n.length-1],l=Fo.use.setChatAIModelAndProvider(),{isPayingUser:p}=Tt(),{chatMode:u,updateChatMode:c}=us(),[m,d]=(0,$o.useState)(!1),f=async _=>{try{if(!t||!_)return;if(u!=="pro_chat")if(p)await c("pro_chat");else{d(!0);return}let{lastRunActionsParams:g,lastRunActions:y}=await Ws(t);l({AIProvider:_.AIProvider,AIModel:_.value}),await i(o,_.AIProvider,_.value);let{setShortcuts:C,runShortcuts:b}=qm(t);C(y),await b(g)}catch{}finally{}},h=(0,$o.useMemo)(()=>n.map(_=>({value:_.value,label:_.title,icon:$o.default.createElement(Do,{model:_.value})})),[n]);return h.length===0?null:$o.default.createElement($o.default.Fragment,null,$o.default.createElement(ne,{disabled:a,placement:"top-start",options:h,testid:"maxai--chat-message--compare-answers",sx:{p:"6px"},OptionsCardProps:{sx:{width:"240px"},title:r("package__features:chat__chat_message_tools__compare_answers__title")},onSelectOption:_=>{let g=n.find(y=>y.value===_);g&&f(g)},defaultOptionValue:s.value,autoClosePopoverOnSelectDefaultOption:!0},$o.default.createElement(Do,{model:s.value})),$o.default.createElement(Lt,{trigger:m,placement:"top-start",anchorElementSelectors:'[data-testid="maxai--chat-pro-chat-switch"]',onClose:()=>{d(!1)},ctaButtonText:r("package__features:onboarding__onboarding_popover__cta_button__try_it"),onCTAButtonClick:async()=>{await c("pro_chat")}},$o.default.createElement(x,{spacing:.5},$o.default.createElement(T,{fontSize:20,lineHeight:1.4,color:"text.primary",fontWeight:700,textAlign:"left"},"Pro chat"),$o.default.createElement(T,{fontSize:14,lineHeight:1.4,color:"text.primary",fontWeight:400,textAlign:"left"},r("package__features:onboarding__onboarding_popover__pro_chat__compare_models__description",{NAME:"Pro chat"})))))},M9=LD;var ze=I(w()),BD=e=>`${nr}/share?id=${e}`,DD=()=>{let{t:e}=E(),{conversation:t,updateConversation:o,getConversation:n}=Bi(),r=t?.share?.id,[i,a]=(0,ze.useState)(!1),[s,l]=(0,ze.useState)(!1),p=t?.share?.enable===!0,u=(0,ze.useRef)(null),[c,m]=(0,ze.useState)(!1),d=(0,ze.useMemo)(()=>[{testid:"maxai--conversation--share-button--download",value:"download",icon:ze.default.createElement(U,{icon:"FileDownload"}),label:e("package__features:chat__ai_message__tools__download_this_chat")},{testid:"maxai--conversation--share-button--share",value:"share",icon:ze.default.createElement(U,{icon:p?"IosShare":"Lock"}),label:e("package__features:chat__ai_message__tools__share_this_chat")}],[e,p]),f=(g=e("package__features:chat__navbar__conversation_share__share_panel__error_tip"))=>{oo.error(g,{anchorOrigin:{vertical:"top",horizontal:"center"}})},h=async()=>{if(!t?.id)return;let g="";if(r)m(!0),p||await _(!0),g=r;else try{if(!g){l(!0);let C=await n(t.id);if(!C){f();return}await un.getService().checkUpdate(t.id),await Ur.getService().checkUpdate(t.id);let b=(await un.getService().shareConversation(C.id,!0))?.share;b?.id&&b.enable&&(g=b.id,await o(C.id,{share:{enable:!0,id:b.id}}))}}catch{f()}finally{m(!0),l(!1)}let y=BD(g);navigator.clipboard.writeText(y)},_=async g=>{if(t?.id)try{a(!0);let y=(await un.getService().shareConversation(t.id,g))?.share;y?.id?await o(t.id,{share:{enable:y.enable,id:y.id}}):f()}catch{f()}finally{a(!1)}};return ze.default.createElement(ze.default.Fragment,null,ze.default.createElement(ne,{placement:"top-start",buttonRefBind:g=>{u.current=g},loading:s,defaultOptionValue:"share",options:d,onSelectOption:async g=>{g==="download"&&await IC(t),g==="share"&&await h()},testid:"maxai--conversation--share-button",sx:{width:"max-content",height:32,p:"6px",gap:"4px"},OptionsCardProps:{sx:{width:"max-content",minWidth:200}}},ze.default.createElement(U,{icon:p?"IosShare":"Lock"}),ze.default.createElement(T,{noWrap:!0,fontSize:"14px",lineHeight:"21px",fontWeight:500,component:"div"},e("package__features:chat__navbar__conversation_share__share_button__title"))),ze.default.createElement($u,{open:c,anchorEl:u.current,onClose:()=>{m(!1)},anchorOrigin:{vertical:"top",horizontal:"left"},transformOrigin:{vertical:"bottom",horizontal:"left"},slotProps:{paper:{elevation:0,sx:{overflow:"unset",background:"transparent"}}}},ze.default.createElement(x,{sx:{borderBottom:"8px solid transparent"}},ze.default.createElement(vn,{sx:{py:1,px:2,width:"320px",boxSizing:"border-box",display:"flex",flexDirection:"column",gap:1,border:"1px solid",borderColor:"border.main",boxShadow:"0px 4px 6px -2px rgba(16, 24, 40, 0.03);0px 12px 16px -4px rgba(16, 24, 40, 0.08);"}},ze.default.createElement(T,{fontSize:16,fontWeight:500},e("package__features:chat__navbar__conversation_share__share_panel__title")),ze.default.createElement(x,{sx:{"& > button":{border:"1px solid",width:"100%",p:1,borderColor:"border.main",borderRadius:"0 0 8px 8px",alignItems:"center",justifyContent:"start","&:not(:last-child)":{borderBottom:"none",borderRadius:"8px 8px 0 0"}}}},ze.default.createElement(ce,{"data-testid":"maxai--conversation--share-private-button",disabled:i,onClick:async()=>{await _(!1)}},ze.default.createElement(x,{width:"100%"},ze.default.createElement(x,{direction:"row",alignItems:"center",gap:1},i?ze.default.createElement(Jt,{size:16}):ze.default.createElement(U,{icon:"Lock",sx:{fontSize:"16px"}}),ze.default.createElement(T,{textAlign:"left",fontSize:"14px",color:"text.primary"},e("package__features:chat__navbar__conversation_share__share_panel__private_button__title")),!p&&ze.default.createElement(U,{icon:"GreenCircleCheck",sx:{ml:"auto",mr:0,fontSize:"20px"}})),ze.default.createElement(T,{textAlign:"left",fontSize:"12px",color:"text.secondary"},e("package__features:chat__navbar__conversation_share__share_panel__private_button__description")))),ze.default.createElement(ce,{disabled:i,onClick:async()=>{await _(!0)}},ze.default.createElement(x,{width:"100%"},ze.default.createElement(x,{direction:"row",alignItems:"center",gap:1},i?ze.default.createElement(Jt,{size:16}):ze.default.createElement(U,{icon:"Share",sx:{fontSize:"16px"}}),ze.default.createElement(T,{textAlign:"left",fontSize:"14px",color:"text.primary"},e("package__features:chat__navbar__conversation_share__share_panel__public_button__title")),p&&ze.default.createElement(U,{icon:"GreenCircleCheck",sx:{ml:"auto",mr:0,fontSize:"20px"}})),ze.default.createElement(T,{textAlign:"left",fontSize:"12px",color:"text.secondary"},e("package__features:chat__navbar__conversation_share__share_panel__public_button__description"))))),p&&ze.default.createElement(x,{direction:"row",alignItems:"center",gap:1},ze.default.createElement(U,{icon:"GreenCircleCheck",sx:{fontSize:"16px"}}),ze.default.createElement(T,{textAlign:"left",fontSize:"12px",color:"#379837"},e("package__features:chat__navbar__conversation_share__share_panel__copied_tip")))))))},w9=DD;var F0=async e=>{let t=e,o=Array.from(e.matchAll(/\[maxai-embed\]\(([^)]+)\)/g)),n=Array.from(new Set(o.map(r=>r[1])));return await Promise.all(n.map(async r=>{let{data:i}=await tm(()=>ja.downloadDocument(r)),a=i?.data;return a?(t=t.replaceAll(`[maxai-embed](${r})`,""),a):null})),t};var Mr=I(w());var FD=e=>{let{message:t,onCopy:o}=e,{t:n}=E(),r=re(f=>f.chatDocuments),i=(0,Mr.useRef)(null),[a,s]=(0,Mr.useState)(""),l=async f=>{let h=i.current;if(!h)return;let _=Al('.markdown-body[data-testid="chat-ai-message--markdown"]',h);_&&(Bm(t,_,r),m(f))},p=async f=>{let h=hc(t,!0,r),_=await F0(h),g=await Xf().use(Hp).process(_);navigator.clipboard.writeText(g.toString().trim()),m(f)},u=async f=>{let h=hc(t,!0,r),_=(await F0(h)).trim();navigator.clipboard.writeText(_),m(f)},c=(0,Mr.useRef)(),m=f=>{clearTimeout(c.current),o?.(),s(f),c.current=setTimeout(()=>{s("")},1e3)},d=(0,Mr.useMemo)(()=>[{value:"copy_with_formatting",testid:"ai-message-tools__copy-with-formatting",icon:Mr.default.createElement(U,{icon:a==="copy_with_formatting"?"Check":"CopyWithFormatting",sx:{fontSize:"20px"}}),title:n(a==="copy_with_formatting"?"package__common:copied":"package__common:copy_to_clipboard"),label:n("package__common:copy_with_formatting"),ButtonProps:{tooltipProps:{placement:"left"}}},{value:"copy_without_formatting",testid:"ai-message-tools__copy-without-formatting",icon:Mr.default.createElement(U,{icon:a==="copy_without_formatting"?"Check":"CopyWithoutFormatting",sx:{fontSize:"20px"}}),title:n(a==="copy_without_formatting"?"package__common:copied":"package__common:copy_to_clipboard"),label:n("package__common:copy_without_formatting"),ButtonProps:{tooltipProps:{placement:"left"}}},{value:"copy_as_plain_text",testid:"ai-message-tools__copy-as-plain-text",icon:Mr.default.createElement(U,{icon:a==="copy_as_plain_text"?"Check":"CopyTextOnly",sx:{fontSize:"20px"}}),title:n(a==="copy_as_plain_text"?"package__common:copied":"package__common:copy_to_clipboard"),label:n("package__common:copy"),ButtonProps:{tooltipProps:{placement:"left"}}}],[n,a]);return Mr.default.createElement(ne,{placement:"top-start",defaultOptionValue:"copy_as_plain_text",testid:"ai-message-tools__hover-to-copy",options:d,buttonRefBind:f=>{i.current=f},disabledOnSelectOptionAutoClosePopup:!0,onClick:()=>{u("copy_as_plain_text")},onSelectOption:f=>{f==="copy_with_formatting"&&l("copy_with_formatting"),f==="copy_without_formatting"&&p("copy_without_formatting"),f==="copy_as_plain_text"&&u("copy_as_plain_text")},sx:{p:"6px"},OptionsCardProps:{sx:{width:"max-content",minWidth:"240px"}}},Mr.default.createElement(U,{icon:"CopyTextOnly",sx:{fontSize:"20px"}}))},E9=FD;var HD=e=>{let{message:t,...o}=e,{AIMessage:n}=kI(),{renderTools:r}=n||{},{conversationId:i,variant:a}=_e(),s=xe(i),l=t.originalMessage?.metadata?.AIModel||"",p=t.originalMessage?.content?.contentType||"text",u=Qn.default.useRef(null),c=t.originalMessage?.metadata?.navMetadata?.key==="transcript"||t.originalMessage?.metadata?.videoTranscripts?.length||t.originalMessage?.metadata?.videoTimestamped?.length,m=a==="normal"&&p==="text"&&!c&&l!==nm.value,{setUsePromptOpen:d,usePromptOpen:f,isLastMessage:h}=(0,Qn.useContext)(bf),_={shareConversationButton:h&&Qn.default.createElement(w9,null),imageCopyButton:p==="image"&&Qn.default.createElement(v9,{message:t}),textCopyButton:p==="text"&&Qn.default.createElement(E9,{message:t}),attachmentsDownloadButton:t&&Qn.default.createElement(S9,{message:t}),usePromptButton:m&&Qn.default.createElement(t1,{disabled:s,message:t,open:f,onOpenChange:d,iconButton:!0,className:"max-ai__actions__button--use-max-ai",platformFeatureCover:"sidebar_response_rewrite",menuPlacement:"bottom-start",menuFallbackPlacements:["top-start"],tooltipPlacement:"top",sx:{color:y=>y.palette.mode==="dark"?"rgba(255, 255, 255, 0.7)":"rgba(0, 0, 0, 0.6)"}}),regenerateButton:a==="normal"&&Qn.default.createElement(m3,{message:t}),modelSuggestions:a==="normal"&&Qn.default.createElement(M9,{message:t}),divider:Qn.default.createElement(ft,{sx:{minWidth:"1px",maxWidth:"1px",minHeight:"14px",maxHeight:"14px"},orientation:"vertical"})},g=r?r(_,t,{isLastMessage:h}):Qn.default.createElement(Qn.default.Fragment,null,_.shareConversationButton,_.imageCopyButton,_.textCopyButton,_.attachmentsDownloadButton,_.usePromptButton,_.regenerateButton,_.modelSuggestions);return Qn.default.createElement(x,{direction:"row",alignItems:"center",spacing:1,ref:u,...o,sx:{position:"relative",marginTop:"8px!important",...o.sx}},g)},A9=HD;var P9=I(Pm());var Ae=I(w());function ND(e){return typeof e=="string"?e.split(","):Array.isArray(e)&&typeof e[0]=="string"?e:[]}var fu={px:1,borderRadius:"8px",height:"25px",display:"flex",alignItems:"center",border:"0px",bgcolor:e=>e.palette.mode==="dark"?"rgba(59, 61, 62, 1)":"rgba(244, 244, 244, 1)"},zD=({copilotType:e,copilot:t,messageIsComplete:o})=>{let n=t.steps.findIndex(c=>c.status==="loading"),[r,i]=(0,Ae.useState)(),a=(()=>{let c=n===-1?t.steps:t.steps.slice(0,n+1);return e==="art"&&(c=c.map(m=>m.title==="Optimizing art prompt"||m.title==="Generating art"?{...m,value:void 0}:m)),c})(),s=(0,Ae.useMemo)(()=>a.some(c=>c.status==="loading"),[a]),l=typeof r>"u"?s:r,p=c=>c?m=>m.palette.mode==="dark"?"#fff":"#000":m=>m.palette.mode==="dark"?"rgba(255, 255, 255, 0.5)":"rgba(0, 0, 0, 0.38)",u=(c,m)=>!(a.length-1!==m&&c.status==="complete");return Ae.default.createElement(x,{direction:"column",spacing:1,sx:{border:c=>c.palette.mode==="dark"?"1px solid rgba(255, 255, 255, 0.16)":"1px solid rgba(0, 0, 0, 0.08)",padding:"8px 10px",borderRadius:"8px"}},t.title&&Ae.default.createElement(x,{direction:"row",justifyContent:"space-between",sx:{userSelect:"none","&:hover":{cursor:"pointer"}},onClick:()=>i(!l)},Ae.default.createElement(Gi,{title:t.title}),Ae.default.createElement(P9.default,{sx:{transform:l?"rotate(180deg)":"rotate(0deg)",fontSize:"24px",transition:"all 0.2s"}})),l&&Ae.default.createElement(Ae.default.Fragment,null,Ae.default.createElement(ft,{sx:{borderColor:c=>c.palette.mode==="dark"?"rgba(255, 255, 255, 0.16)":"rgba(0, 0, 0, 0.08)"}}),a.map((c,m)=>Ae.default.createElement(x,{spacing:.5,key:c.title},Ae.default.createElement(x,{spacing:1,direction:"row",alignItems:"center"},Ae.default.createElement(x,{alignItems:"center",justifyContent:"center",width:16,height:16},!o&&c.status==="loading"?Ae.default.createElement(Jt,{size:16,sx:{color:p(!0)}}):Ae.default.createElement(U,{sx:{color:p(!1),fontSize:20},icon:"CheckCircle"})),Ae.default.createElement(T,{fontSize:14,fontWeight:500,color:p(!o&&c.status==="loading"),noWrap:!0,sx:{p:0,pl:"6px"}},c.title)),(c.value||!u(c,m))&&Ae.default.createElement(x,{direction:"row"},Ae.default.createElement(B,{sx:{minHeight:"14px",marginLeft:"7px",width:"2px",borderRadius:"2px",bgcolor:d=>u(c,m)?"transparent":d.palette.mode==="dark"?"rgba(255, 255, 255, 0.16)":"rgba(0, 0, 0, 0.08)"}}),c.value&&Ae.default.createElement(x,{spacing:1,direction:"row",alignItems:"center",sx:{flex:"1!important"}},Ae.default.createElement(x,{alignItems:"center",justifyContent:"center",width:16,height:16}),(c.valueType==="text"||c.valueType===void 0)&&Ae.default.createElement(Tn,{variant:"outlined",sx:fu},Ae.default.createElement(he,{title:String(c.value)},Ae.default.createElement(T,{fontSize:14,color:"text.primary",noWrap:!0,maxWidth:256},String(c.value)))),c.valueType==="tags"&&Ae.default.createElement(x,{gap:1,direction:"row",alignItems:"center",flexWrap:"wrap",sx:{flex:"1!important"}},ND(c.value).map((d,f)=>Ae.default.createElement(Tn,{key:d+f,variant:"outlined",sx:fu},Ae.default.createElement(he,{title:d},Ae.default.createElement(T,{noWrap:!0,maxWidth:160,fontSize:14,color:h=>h.palette.mode==="dark"?"rgba(255, 255, 255, 0.7)":"rgba(0, 0, 0, 0.6)"},d))))),c.valueType==="source"&&Ae.default.createElement(VD,{sources:c.value})))))))},VD=({sources:e})=>{let{t}=E(),[o,n]=(0,Ae.useState)(!1),r=(0,Ae.useMemo)(()=>o?e:e.slice(0,3),[o]);return Ae.default.createElement(x,{gap:1,direction:"row",alignItems:"center",flexWrap:"wrap",width:0,sx:{flex:"1!important"}},r.map((i,a)=>Ae.default.createElement(Tn,{key:`${i.title}-${a}`,variant:"outlined",sx:{...fu,"&:hover":{background:s=>s.palette.mode==="dark"?"rgba(255, 255, 255, 0.16)":"rgba(0, 0, 0, 0.08)"}}},Ae.default.createElement(Rl,{citation:{content:"",search_result_index:1,source:{doc_id:"",type:"search_results",engine:"",...i}}},Ae.default.createElement(wi,{href:i.url,target:"_blank",underline:"none",maxWidth:200},Ae.default.createElement(x,{direction:"row",alignItems:"center",spacing:.5},Ae.default.createElement(B,{width:16,height:16,borderRadius:"50%",overflow:"hidden",flexShrink:0},Ae.default.createElement("img",{src:i.favicon||ea(i.url),alt:i?.from,width:"100%",height:"100%"})),Ae.default.createElement(T,{fontSize:12,color:"text.secondary",noWrap:!0},i?.from)))))),e.length>3&&!o&&Ae.default.createElement(Tn,{variant:"outlined",sx:{...fu,"&:hover":{background:i=>i.palette.mode==="dark"?"rgba(255, 255, 255, 0.16)":"rgba(0, 0, 0, 0.08)",cursor:"pointer"}},onClick:()=>n(!0)},Ae.default.createElement(x,{height:"100%",direction:"row",alignItems:"center",spacing:.5},Ae.default.createElement(T,{fontSize:12,color:"text.secondary",noWrap:!0},`+ ${e.length-3} ${t("package__features:chat__ai_message__sources__more")}`))),e.length>3&&o&&Ae.default.createElement(Tn,{variant:"outlined",sx:{...fu,"&:hover":{background:i=>i.palette.mode==="dark"?"rgba(255, 255, 255, 0.16)":"rgba(0, 0, 0, 0.08)",cursor:"pointer"}},onClick:()=>n(!1)},Ae.default.createElement(x,{height:"100%",direction:"row",alignItems:"center",spacing:.5,color:"text.secondary"},Ae.default.createElement(T,{fontSize:12,color:"text.secondary",noWrap:!0},t("package__features:chat__ai_message__sources__hide")))))},k9=zD;var Qe=I(w());var L9=I(ir());var eo=I(w()),o1=(e=1)=>({overflow:"hidden",display:"-webkit-box","-webkit-box-orient":"vertical","-webkit-line-clamp":String(e)}),RD=({searchResult:e,searchResultIndex:t,key:o})=>eo.default.createElement(Tn,{key:o,sx:{marginBottom:"16px",borderRadius:"8px",border:"1px solid",backgroundColor:"initial",boxShadow:"initial",borderColor:n=>n.palette.mode==="dark"?"rgba(255, 255, 255, 0.16)":"rgba(0, 0, 0, 0.08)","&:hover":{cursor:"pointer",bgcolor:n=>n.palette.mode==="dark"?"rgba(255, 255, 255, 0.08)":"rgba(0, 0, 0, 0.04)"}}},eo.default.createElement(Gx,null,eo.default.createElement(wi,{href:e.url,target:"_blank",underline:"none"},eo.default.createElement(x,{sx:{gap:"6px",p:"16px"}},eo.default.createElement(x,{direction:"row",alignItems:"center",justifyContent:"space-between",sx:{gap:"16px"}},eo.default.createElement(T,{sx:{fontSize:"16px",fontWeight:"500",lineHeight:"24px",height:"24px",color:"text.primary",...o1()}},e.title)),eo.default.createElement(x,{sx:{flexDirection:"row",alignItems:"center",gap:"4px"}},eo.default.createElement(B,{component:"img",src:ea(e.redirectedUrl||e.url),alt:e.from,sx:{width:"16px",height:"16px",borderRadius:"50%",objectFit:"cover",objectPosition:"center",border:"1px solid",borderColor:n=>n.palette.mode==="dark"?"rgba(255, 255, 255, 0.16)":"rgba(0, 0, 0, 0.08)"}}),eo.default.createElement(T,{sx:{fontSize:"12px",fontWeight:"500",lineHeight:"18px",color:"text.secondary",...o1()}},e.from),eo.default.createElement(T,{sx:{fontSize:"12px",fontWeight:"500",lineHeight:"18px",color:"text.secondary"}},"\xB7 ",t+1)),eo.default.createElement(T,{sx:{fontSize:"14px",fontWeight:"400",lineHeight:"21px",color:"text.secondary",...o1(4)}},e.body))))),UD=({open:e,onClose:t,searchResults:o,metadataTitle:n})=>{let r=(0,eo.useMemo)(()=>!Ta(),[]),{t:i}=E();return eo.default.createElement(Pa,{anchor:r?"right":"bottom",disableScrollLock:!0,disableEnforceFocus:!0,open:e,onClose:t,sx:{zIndex:1502,position:r?"fixed":"absolute",[`& .${Aa.paper}`]:{position:"absolute",borderRadius:r?"16px 0 0 16px":"16px 16px 0 0",minHeight:"80vh",maxHeight:r?"100vh":"80vh",bgcolor:"background.paper",backgroundImage:"unset"}},slotProps:{backdrop:{sx:{position:"absolute"}}}},eo.default.createElement(x,{sx:{maxWidth:r?"520px":"100%",height:"100%",overflow:"hidden",borderRadius:"16px, 16px, 0px, 0px"}},eo.default.createElement(x,{sx:{p:"16px",position:"relative"}},eo.default.createElement(T,{sx:{fontSize:"24px",fontWeight:"700",lineHeight:"34px"}},`${o.length} ${i("package__features:chat__ai_message__sources__modal__title")}`),eo.default.createElement(T,{sx:{fontSize:"16px",fontWeight:"400",lineHeight:"24px",color:"text.secondary",...o1()}},n?.title),eo.default.createElement(Ve,{onClick:t,sx:{position:"absolute",top:"12px",right:"12px"}},eo.default.createElement(L9.default,{sx:{fontSize:24}}))),eo.default.createElement(ft,null),eo.default.createElement(B,{sx:{flex:1,height:"0px",p:"16px",pd:0,overflowY:"auto"}},o.map((a,s)=>eo.default.createElement(RD,{key:s,searchResult:a,searchResultIndex:s})))))},O9=UD;var WD=e=>{let t=Ra(),{searchResults:o,loading:n}=e,[r,i]=(0,Qe.useState)(!1),a=(0,Qe.useMemo)(()=>t==="xs"||t==="sm"?6:t==="md"?4:t==="lg"||t==="xl"?3:6,[t]),s=(0,Qe.useMemo)(()=>12/a,[a]),l=(0,Qe.useMemo)(()=>o.length>s?o.slice(0,s-1):o,[r,o]),p=(0,Qe.useMemo)(()=>o.length>s?o.slice(s-1).map(c=>ea(c.redirectedUrl||c.url)).filter(Boolean):[],[r,o,s]),{t:u}=E();return Qe.default.createElement(Qe.default.Fragment,null,Qe.default.createElement(ii,{container:!0,spacing:1,sx:{ml:"-8px!important"}},n?Array(6).fill("").map((c,m)=>Qe.default.createElement(ii,{item:!0,xs:a,key:m},Qe.default.createElement(vo,{variant:"rounded",width:"100%",height:60}))):Qe.default.createElement(Qe.default.Fragment,null,l.map((c,m)=>Qe.default.createElement(ii,{item:!0,xs:a,key:m,className:"sourceGrid"},Qe.default.createElement(Rl,{citation:{content:"",search_result_index:1,source:{doc_id:"",type:"search_results",...c,from:c?.from||"",engine:c?.engine||"",searchQuery:c?.searchQuery||""}}},Qe.default.createElement(Tn,{variant:"outlined",sx:{backgroundColor:d=>d.palette.mode==="dark"?"rgba(59, 61, 62, 1)":"rgba(244, 244, 244, 1)",borderRadius:"8px",border:"0px","&:hover":{background:d=>d.palette.mode==="dark"?"rgba(255, 255, 255, 0.16)":"rgba(0, 0, 0, 0.08)"}}},Qe.default.createElement(wi,{href:c.url,target:"_blank",underline:"none"},Qe.default.createElement(x,{p:1,spacing:.5,className:"test"},Qe.default.createElement(T,{fontSize:14,color:"text.primary",noWrap:!0,sx:{p:0}},c.title),Qe.default.createElement(x,{direction:"row",alignItems:"center",spacing:.5},Qe.default.createElement(B,{width:16,height:16,borderRadius:"50%",overflow:"hidden",flexShrink:0},Qe.default.createElement("img",{src:ea(c.url),alt:c?.from,width:"100%",height:"100%"})),Qe.default.createElement(T,{fontSize:12,color:"text.secondary",noWrap:!0},c?.from),Qe.default.createElement(T,{fontSize:12,color:"text.secondary",flexShrink:0},"\xB7 ",m+1)))))))),o.length>s&&Qe.default.createElement(ii,{item:!0,xs:a,onClick:()=>{i(!0)}},Qe.default.createElement(Tn,{variant:"outlined",sx:{backgroundColor:c=>c.palette.mode==="dark"?"rgba(59, 61, 62, 1)":"rgba(244, 244, 244, 1)",borderRadius:"8px",border:"0px","&:hover":{cursor:"pointer",background:c=>c.palette.mode==="dark"?"rgba(255, 255, 255, 0.16)":"rgba(0, 0, 0, 0.08)"}}},Qe.default.createElement(x,{p:1,spacing:1},Qe.default.createElement(x,{direction:"row",spacing:1},p.map((c,m)=>Qe.default.createElement(B,{key:m+(c||""),width:16,height:16,borderRadius:"50%",overflow:"hidden",flexShrink:0},Qe.default.createElement("img",{src:c,width:"100%",height:"100%"})))),Qe.default.createElement(x,{direction:"row",alignItems:"center",spacing:.5},Qe.default.createElement(T,{fontSize:12,color:"text.secondary",flexShrink:0},u("package__features:chat__ai_message__sources__view")," ",p.length," ",u("package__features:chat__ai_message__sources__more")))))))),Qe.default.createElement(O9,{open:r,onClose:()=>i(!1),searchResults:o,metadataTitle:e.metadataTitle}))},B9=WD;var GD={whiteSpace:"pre-wrap",width:"100%",boxSizing:"border-box",wordBreak:"break-word",color:"text.primary"},jD=e=>{let{message:t,order:o,loading:n=!1,hasError:r}=e,{t:i}=E(),{content:a,metadata:s,isAutoHideTools:l,isLoading:p}=Xe(),[u,c]=We.default.useState(!1);(0,We.useEffect)(()=>{if(a.status==="complete"){let S=setTimeout(()=>{c(!0)},Ny);return()=>clearTimeout(S)}else c(!1)},[a.status]);let m=s.shareType!=="art"&&a.status==="complete"?u:a.status===void 0?!p:!1,d=(a.status==="complete"?u:!0)&&!r&&s?.nextActions,{copilotComplete:f,searchImages:h,searchVideos:_,knowledgePanels:g}=(0,We.useMemo)(()=>{let S=s.copilot?s.copilot.steps.every(H=>H.status==="complete"):!0,P=[],k=[],L=[];return s.searchResults?.forEach(H=>{H.images&&P.push(...H.images),H.videos&&k.push(...H.videos),H.knowledgePanel&&L.push(H.knowledgePanel)}),{copilotComplete:S,searchImages:P,searchVideos:k,knowledgePanels:L}},[s]),y=s.includeHistory===!1,C=s.isTriggeredContentReview===!0,[b,v]=(0,We.useState)(!1);return We.default.createElement(B,{component:"div",className:"chat-message chat-message--AI",sx:{[`& .${yf}`]:{opacity:l&&!b?0:1},"&:hover":{[`& .${yf}`]:{opacity:1}}},onMouseEnter:()=>{v(!0)},onMouseLeave:()=>{v(!1)}},y&&!C&&o!==1&&We.default.createElement(Sf,{message:t}),We.default.createElement(x,{className:"chat-message--text",sx:GD},We.default.createElement(x,{spacing:3},We.default.createElement(Zf,{message:t}),!r&&s.title&&s.shareType!=="art"&&We.default.createElement(Gi,{title:s.title,fontSx:{fontWeight:"700",fontSize:"24px",color:"text.primary",whiteSpace:s.shareType==="search"?"":"nowrap",textOverflow:"ellipsis",overflow:"hidden"}}),!r&&s.copilot&&(s.shareType==="art"?We.default.createElement(u9,null):We.default.createElement(k9,{copilotType:s.shareType,copilot:s.copilot,messageIsComplete:!!s.isComplete})),!r&&f&&s.searchResults&&s.searchResults.length>0&&We.default.createElement(x,{spacing:1,marginBottom:"8px !important"},We.default.createElement(x,{direction:"row",alignItems:"center",spacing:1},We.default.createElement(Vs,{icon:"CaptivePortal",sx:{fontSize:"18px"}}),We.default.createElement(T,{fontSize:"18px"},"Sources")),We.default.createElement(B9,{metadataTitle:s.title,searchResults:s.searchResults,loading:!1})),f&&a.title?.title!=="noneShowContent"&&We.default.createElement(x,{spacing:2},s.chatMode?We.default.createElement(We.default.Fragment,null,We.default.createElement(O0,{message:t,loading:n}),We.default.createElement(Vg,{message:t}),We.default.createElement(Ug,{message:t,hasError:r})):We.default.createElement(We.default.Fragment,null,We.default.createElement(Vg,{message:t}),We.default.createElement(O0,{message:t,loading:n}),!r&&(h.length>0||_.length>0||g.length>0)&&We.default.createElement(x9,{message:t,images:h,videos:_,knowledgePanels:g,loading:n}),We.default.createElement(Ug,{message:t,hasError:r}))),!p||m?We.default.createElement(A9,{className:yf,message:t}):We.default.createElement(B,{height:"16px"}),s.nextActions&&d&&We.default.createElement(X8,{nextActions:s.nextActions,nextActionsStatus:s.nextActionsStatus}))),C&&s.isComplete&&o!==1&&We.default.createElement(ft,{sx:{mt:2}},We.default.createElement(T,{color:"text.secondary",fontSize:"12px"},i("package__features:chat__ai_message__context_triggered_content_review"))))},D9=jD;var KD=e=>H0.default.createElement(If,{...e},H0.default.createElement(D9,{...e})),F9=wp(KD);var Ft=I(w());var hu=I(w());var sl=I(w()),qD=e=>{let{message:t}=e,{t:o}=E(),n=t.conversationId||"",r=qa(n),i=t?.messageId===r,a=xe(n),{regenerate:s}=Ne(),[l,p]=(0,sl.useState)(!1);return(0,sl.useEffect)(()=>{i&&Ws(n).then(({lastRunActions:c})=>{p(c.length>0)})},[i]),i&&l?sl.default.createElement(ne,{placement:"top",disabled:a,title:o("package__features:chat__ai_message__tools__regenerate_button"),onClick:()=>s(n),testid:"sidebar_actions__regenerate",sx:{p:"6px"}},sl.default.createElement(U,{sx:{fontSize:"20px"},icon:"Regenerate"})):null},H9=qD;var $D=e=>{let{message:t}=e,{conversationId:o,variant:n}=_e(),r=tn(o),i=Ei(r),a=t.meta?.systemMessageType||t.extra?.systemMessageType||"normal",s=t.meta?.status||t.extra?.status||"success",l=(0,hu.useMemo)(()=>t.type==="system"&&s==="error"&&i?.messageId===t.messageId?!0:s!=="success"&&a==="normal"&&i?.messageId===t.messageId&&t.parentMessageId,[t.type,t.parentMessageId,t.messageId,i?.messageId,s,a]);return hu.default.createElement(x,{direction:"row",alignItems:"center",flexWrap:"wrap",gap:1,className:"chat-system--message-tools"},n==="chatHub"||!l?null:hu.default.createElement(H9,{message:t}))},N0=$D;var XD=Ft.default.lazy(()=>import("./U4SUH7W4.js")),YD=e=>{let{message:t,loading:o,sx:n}=e,{isDarkMode:r}=lr(),i=co(),a=t?.extra?.systemMessageType==="needUpgrade"||t?.meta?.systemMessageType==="needUpgrade",s=t.meta.chatMode,l=t.meta.paywallData,p=t.meta?.AIModel||t.originalMessage?.metadata?.AIModel,u=(0,Ft.useMemo)(()=>Rr(t,!1),[t]),c=(0,Ft.useMemo)(()=>a?{width:"100%",whiteSpace:"pre-wrap",wordBreak:"break-word",gap:1,"& > div[data-permission-scene-type]":{mb:1}}:{whiteSpace:"pre-wrap",width:"100%",wordBreak:"break-word",borderRadius:"8px",bgcolor:"background.paper"},[a]),m=(0,Ft.useMemo)(()=>i?.id==="USE_CHAT_GPT_AI_ROOT_Context_Menu_Portal",[i]),d=()=>p?s==="free_chat"?Ft.default.createElement(ma,null):Ft.default.createElement(Ap,{AIProvider:en(void 0,p,{fallback:!1,checkValid:!0})?.AIProvider,AIModel:p}):Ft.default.createElement(ma,null);return Ft.default.createElement(x,{className:"chat-message chat-message--text",gap:1,sx:{boxSizing:"border-box",...c,...n}},a&&l?Ft.default.createElement(Ft.default.Fragment,null,m?null:d(),Ft.default.createElement(zy,{paywallData:l}),Ft.default.createElement(N0,{message:t,loading:o})):Ft.default.createElement(Ft.default.Fragment,null,d(),Ft.default.createElement(Vu,{severity:t?.meta?.status||"info",sx:{p:1,[`& .${zu.message}`]:{p:0,width:"100%"},"& > div:first-of-type":{display:"none"},"& .markdown-body":{"& > p:first-of-type":{mt:0}}},icon:Ft.default.createElement(Ft.default.Fragment,null)},Ft.default.createElement(B,null,Ft.default.createElement(x,{direction:"row",alignItems:"flex-start",spacing:1.5},Ft.default.createElement("div",{className:`markdown-body ${r?"markdown-body-dark":""}`},Ft.default.createElement(Ft.Suspense,{fallback:Ft.default.createElement(Wn,{sx:{my:0},loading:!0})},Ft.default.createElement(XD,{message:t},u)))))),Ft.default.createElement(N0,{message:t,loading:o})))},n1=wp(YD);var Xr=I(w());var ZD=({message:e})=>{let[t,o]=(0,Xr.useState)(!1),{getState:n}=W_(),r=(0,Xr.useMemo)(()=>n().conversationType==="Art",[n]),i=e?.meta?.messageChatDocuments||[];if(i.length===0)return null;let[a,s]=(0,Xr.useState)(),l=3,p=i.length-l;return Xr.default.createElement(x,{width:"100%",direction:"column",gap:1},Xr.default.createElement(Li,{hideMenu:!0,images:i.map(u=>({src:u.link||"",alt:u.title})),selectedImage:a,setSelectedImage:s}),Xr.default.createElement(x,{direction:"row",gap:1,width:"100%",justifyContent:"flex-end",flexWrap:"wrap"},(t?i:i.slice(0,l)).map(u=>Xr.default.createElement(QD,{key:u.id||u.maxAIDocumentId,chatDocument:u,propOnClick:r?()=>{s(u.link||"")}:void 0})),!t&&p>0&&Xr.default.createElement(Xa,{text:`+${p} more`,onClick:()=>o(!0)})))},QD=e=>{let{chatDocument:t,propOnClick:o}=e,n=t.maxAIDocumentId?Sy(t.maxAIDocumentId):!0;return Xr.default.createElement(Xl,{onClick:o,disabled:n,chatDocument:t})},N9=ZD;var z9=(e,t)=>{let o=e.indexOf(t);if(o===-1)return"";let n=e.indexOf(`
`,o);return n===-1?"":e.substring(o,n).replace(t,"").trim()},JD=e=>{e.length;let t=e.find(i=>i.name===Be.PRESET_VARIABLE__CURRENT_WEBSITE_DOMAIN.name)?.default_value||"",o=[],n=e.find(i=>i.name===Be.PRESET_VARIABLE__INSTANT_REPLY__WEBSITE_TYPE.name)?.default_value,r=e.find(i=>i.name===Be.PRESET_VARIABLE__INSTANT_REPLY__TARGET_CONTEXT.name)?.default_value||e.find(i=>i.name===Be.PRESET_VARIABLE__INSTANT_REPLY__FULL_CONTEXT.name)?.default_value||"";if(n&&r)switch(n){case"EMAIL":{let i=z9(r,"**Subject:**");i?o.push(`Email content of "${i}".`):o.push(`Email content of "${r}"`);break}case"SOCIAL_MEDIA":{let i=r.indexOf("**Comment:**");if(i!==-1){let a=r.slice(i).replace("**Comment:**","").trim();o.push(a)}else if(t.includes("youtube.com")){let a=z9(r,"**Post title:**");a&&o.push(`Video content of "${a}".`)}else{let a=r.indexOf("**Post caption/description:**");if(a!==-1){let s=r.slice(a).replace("**Post caption/description:**","").trim();o.push(s)}}break}case"CHAT_APP_WEBSITE":{let i=r.indexOf("**Content:**");if(i!==-1){let a=r.slice(i).replace("**Content:**","").replace(`
+`,`
`).trim();o.push(a)}break}case"UNKNOWN":default:}return o.join(`
`)};function gu(e=[],t=[]){let o,n=e.find(r=>r.key==="Selected text"||r.key==="Draft"||r.key.endsWith("draft"));return n&&(o=n.value),o||(o=JD(t)),{text:o,userVariables:e.filter(r=>r.key!=="Draft"&&r.key!=="Selected text"&&!r.key.endsWith("draft"))}}var ho=I(w());var eF=rr(({className:e,...t})=>ho.default.createElement(Hr,{...t,classes:{popper:e}}))(({theme:e})=>({[`& > .${Vn.tooltip}`]:{background:e.palette.mode==="dark"?"#2C2C2C":"#ffffff",color:"rgba(0, 0, 0, 0.87)",fontSize:12,boxShadow:"0px 12px 16px -4px rgba(0, 0, 0, 0.08), 0px 4px 6px -2px rgba(0, 0, 0, 0.03)",maxWidth:"none",borderRadius:e.spacing(1),border:`1px solid ${e.palette.border.main}`,backgroundClip:"padding-box"},[`& .${Vn.arrow}`]:{color:e.palette.mode==="dark"?"#2C2C2C":"#ffffff","&::before":{border:`1px solid ${e.palette.border.main}`,background:e.palette.mode==="dark"?"#2C2C2C":"#ffffff",backgroundClip:"padding-box"}}})),tF=(0,ho.forwardRef)(function({variable:t,sx:o,container:n,children:r,virtualRect:i,popperSx:a,suffix:s,anchorElSx:l,descriptionEl:p},u){let[c,m]=(0,ho.useState)(!1),d=(0,ho.useRef)(null);(0,ho.useImperativeHandle)(u,()=>({close:()=>m(!1)}));let f=t.key==="Selected Text"||t.key==="Draft"?"Context":t.key,h={container:n,className:"maxai-variable-tooltip",sx:{zIndex:2147483619,...a},transition:!0};return i&&(h.anchorEl={getBoundingClientRect(){return i}}),ho.default.createElement(wa,{onClickAway:_=>{c&&_.target instanceof HTMLElement&&(d.current?.contains(_.target)||d.current===_.target)||m(!1)}},ho.default.createElement(x,{direction:"row",width:"100%",sx:o},ho.default.createElement(eF,{open:c,PopperProps:h,title:ho.default.createElement(x,{direction:"column",maxHeight:"min(500px, 40vh)",overflow:"hidden",height:"max-content"},ho.default.createElement(x,{direction:"row",width:"100%",gap:1.25,p:1.25,ref:d,boxSizing:"border-box",flexGrow:1,overflow:"hidden"},ho.default.createElement(B,{width:"2px",minWidth:"2px",bgcolor:_=>_.palette.mode==="dark"?"rgba(255, 255, 255, 0.12)":"rgba(0, 0, 0, 0.12)"}),ho.default.createElement(x,{direction:"column",flexGrow:1,overflow:"hidden"},ho.default.createElement(x,{direction:"row",gap:1.25,alignItems:"center",maxWidth:"100%"},ho.default.createElement(T,{fontSize:"14px",overflow:"hidden",textOverflow:"ellipsis",noWrap:!0,color:_=>_.palette.mode==="dark"?"rgba(255, 255, 255, 0.50)":"rgba(0, 0, 0, 0.38)"},f),ho.default.createElement(Gn,{sx:{padding:"5px",fontSize:"20px",borderRadius:"4px",color:"text.secondary"},defaultIconSx:{fontSize:"15px"},PopperProps:{placement:"top",container:n},copyText:t.value})),p,ho.default.createElement(T,{width:"100%",whiteSpace:"pre-wrap",color:"text.primary",textAlign:"left",lineHeight:"24px",fontSize:"16px",flexGrow:1,overflow:"auto"},t.value))),s),placement:"top",arrow:!0,disableFocusListener:!0,disableHoverListener:!0,disableTouchListener:!0},ho.default.createElement(B,{onClick:()=>{m(!c)},sx:l},typeof r=="function"?r({variable:t,open:c}):r))))}),zp=tF;var j9=I(z0());var Ht=I(w()),R0=I(w());var xu=I(w());var iF=/(\.py|\.ipynb|\.js|\.jsx|\.html|\.css|\.java|\.cs|\.php|\.c|\.cpp|\.cxx|\.h|\.hpp|\.rs|\.R|\.Rmd|\.swift|\.go|\.rb|\.kt|\.kts|\.ts|\.tsx|\.m|\.scala|\.rs|\.dart|\.lua|\.pl|\.pm|\.t|\.sh|\.bash|\.zsh|\.csv|\.log|\.ini|\.config|\.json|\.yaml|\.yml|\.toml|\.lua|\.sql|\.bat|\.md|\.coffee|\.tex|\.latex)/,aF=({filetype:e,filename:t,sx:o})=>(e=e.toLowerCase(),e.endsWith("pdf")?xu.default.createElement(l2,{sx:o}):t.endsWith(".txt")?xu.default.createElement(p2,{sx:o}):iF.test(t)?xu.default.createElement(s2,{sx:o}):xu.default.createElement(c2,{sx:o})),V9=aF;var R9=I(lw());var xt=I(w()),sF={borderRadius:e=>e.spacing(1),border:e=>`1px solid ${e.palette.border.main}`,background:e=>e.palette.background.default,display:"flex",flexDirection:"row",position:"relative",p:1.25,gap:1.5,height:"62px",boxSizing:"border-box",width:"282px",minWidth:"282px",overflow:"hidden"},lF={height:"40px",width:"40px",fontSize:"40px",cursor:"pointer"},U9={fontWeight:500,textOverflow:"ellipsis",whiteSpace:"nowrap",overflow:"hidden",fontSize:"14px"},pF={...U9,color:e=>e.palette.mode==="dark"?"rgba(255, 255, 255, 0.38)":"rgba(0, 0, 0, 0.38)"},Vp=228,V0=200,cF=({message:e})=>{let[t,o]=(0,xt.useState)(void 0),[n,r,i]=(0,xt.useMemo)(()=>{let m=(e.meta?.attachments||[]).filter(h=>h.uploadStatus==="success"),d=m.filter(h=>h.icon==="image"),f=m.filter(h=>h.icon!=="image");return[d,f.map(h=>({...h,attachmentExtractedContent:CC(h,e)})),m]},[e,e.meta?.attachments]),[a,s]=(0,xt.useState)({width:`${Vp}px`,height:`${Vp/1.5}px`}),l=(0,xt.useMemo)(()=>n.length===1?a:n.length>3?{width:"64px",height:"64px"}:{width:"112px",height:"112px"},[n]),p=m=>{if(n.length!==1)return;let{naturalWidth:d,naturalHeight:f}=m,h=d/f;if(h>=1&&h<=1.5){let _=`${Vp/1.5}px`,g=`${Vp}px`;s({width:g,height:_})}else if(h>1.5){let _=`${Vp/2}px`,g=`${Vp}px`;s({width:g,height:_})}else if(h<1&&h>=.75){let _=`${V0}px`;s({width:"228px",height:_})}else{let _=`${V0}px`,g=`${V0*.75}px`;s({width:g,height:_})}},u=(0,xt.useMemo)(()=>n.map(m=>({src:m.uploadedUrl||m.base64Data||m.blobUrl||"",alt:m.fileName})),[n]),c=(0,xt.useRef)(null);if(i.length!==0)return xt.default.createElement(x,{width:"100%",direction:"column",gap:1},n.length>0&&xt.default.createElement(x,{gap:1,direction:"row",justifyContent:"flex-end",overflow:"auto",width:"100%"},n.map(m=>xt.default.createElement(Vr,{key:m.id,width:l.width,height:l.height,alt:m.fileName,onLoaded:p,SkeletonSx:{borderRadius:d=>d.spacing(1),width:l.width,height:l.height,overflow:"hidden"},src:m.uploadedUrl||m.base64Data||m.blobUrl||"",imageSx:{borderRadius:d=>d.spacing(1),width:l.width,height:l.height,overflow:"hidden",objectFit:"cover",cursor:"pointer",border:d=>`1px solid ${d.palette.mode==="dark"?"rgba(255, 255, 255, 0.08)":"rgba(0,0,0,0.08)"}`},onImageClick:()=>{o(m.uploadedUrl||m.base64Data||m.blobUrl||"")}}))),xt.default.createElement(Li,{images:u,selectedImage:t,setSelectedImage:o}),r.length>0&&xt.default.createElement(x,{direction:"column",gap:1,width:"100%",alignItems:"flex-end",ref:c},r.map(m=>xt.default.createElement(uF,{key:m.id,file:m,getFilesContainer:()=>c.current}))))},uF=(0,xt.memo)(function({file:t,container:o,getFilesContainer:n}){let{t:r}=E(),i=(0,xt.useRef)(null),[a,s]=(0,xt.useState)(null),[l,p]=(0,xt.useState)(360);return xt.default.createElement(B,{ref:i,onClick:()=>{let u=n?.()??null;if(i.current&&u){let c=u.getBoundingClientRect(),m=i.current.getBoundingClientRect(),d=m.left+20,f=c.left+c.width/2,h=Math.max(f,d);p(h===f?Math.min(c.width-40,600):Math.max((m.right-m.left-20)*2,140)),s(new DOMRect(h,m.top,1,m.height))}}},xt.default.createElement(zp,{variable:{key:t.fileName,value:t.attachmentExtractedContent},anchorElSx:sF,virtualRect:a,sx:{width:"fit-content",cursor:"pointer"},container:o,popperSx:{width:l},descriptionEl:xt.default.createElement(x,{direction:"column"},xt.default.createElement(T,{textAlign:"left",fontSize:"14px",color:"text.secondary",noWrap:!0,flexShrink:0},`${S2(t.fileSize||0)} \u2022 ${t.fileType}`),xt.default.createElement(T,{textAlign:"left",fontSize:"12px",color:"text.secondary",noWrap:!0,flexShrink:0,display:"flex",alignItems:"center",gap:1},xt.default.createElement(R9.default,{sx:{fontSize:"12px",color:"inherit"}}),r("package__features:chat__user_message__contexts__file__preview__tips")))},xt.default.createElement(V9,{filename:t.fileName,filetype:t.fileType,sx:lF}),xt.default.createElement(x,{direction:"column",overflow:"hidden",flexGrow:1},xt.default.createElement(T,{sx:U9},t.fileName),xt.default.createElement(T,{sx:pF},t.fileType.toUpperCase()))))}),W9=cF;var vs=I(w()),mF=({iconSx:e,message:t,formatMessageContent:o,...n})=>{let{t:r}=E(),{inputMediator:i}=_e(),a=co(),{askAIWithShortcutsV2:s}=Ne(),{chatHubLoading:l}=ot(),p=t.meta?.MaxAIPromptActionConfig?.prompt_id,u=(0,vs.useMemo)(()=>t.meta?.MaxAIPromptActionConfig===void 0,[t.meta?.MaxAIPromptActionConfig]),c=(0,vs.useMemo)(()=>t.meta?.MaxAIPromptActionConfig&&Gs(t.meta?.MaxAIPromptActionConfig),[t.meta?.MaxAIPromptActionConfig]),m=(0,vs.useMemo)(()=>["AI_RESPONSE_LANGUAGE",Be.PRESET_VARIABLE__INTERFACE_LANGUAGE.name,Be.PRESET_VARIABLE__SYSTEM_CURRENT_DATE.name,Be.PRESET_VARIABLE__REFINE_DRAFT__FOLLOW_UP_INSTRUCTION.name,Be.PRESET_VARIABLE__INSTANT_REPLY__WEBSITE_TYPE.name,Be.PRESET_VARIABLE__INSTANT_REPLY__DRAFT_CONTEXT.name,Be.PRESET_VARIABLE__INSTANT_REPLY__TARGET_CONTEXT.name,Be.PRESET_VARIABLE__INSTANT_REPLY__FULL_CONTEXT.name,Be.PRESET_VARIABLE__INSTANT_REPLY__SOCIAL_MEDIA__POST_DRAFT.name,Be.PRESET_VARIABLE__INSTANT_REPLY__EMAIL__DRAFT.name,Be.PRESET_VARIABLE__INSTANT_REPLY__CHAT_APP__MESSAGE_DRAFT.name,Be.PRESET_VARIABLE__CURRENT_WEBSITE_DOMAIN.name,Be.PRESET_VARIABLE__CURRENT_WEBPAGE_URL.name,Be.PRESET_VARIABLE__AI_RESPONSE_WRITING_STYLE.name,Be.PRESET_VARIABLE__AI_RESPONSE_TONE.name,Be.OUTPUT_PRESET_VARIABLE__CHAT_COMPLETE.name],[]),d=(0,vs.useMemo)(()=>{if(t.meta?.disableEditQuestion)return!1;if(u)return!0;let h=c?.origin?.variables;return h&&h?.some(g=>g.name==="KEY_POINTS")?!0:p&&V_.includes(p)?!1:!!h?.filter(g=>g.name&&!m.includes(g.name))?.length},[u,c?.origin?.variables,m,t.meta?.disableEditQuestion,p]),f=async()=>{if(u){wf(),i.updateInputValue(o);let h=i.ref;h&&(h.focus(),h.setSelectionRange(h.value.length,h.value.length));return}else if(c){let h=c.actions;if(h.length>0){let _=c?.origin?.variables;if(_){let y=_.reduce((C,b)=>(C&&!m.includes(b.name)?C[b.name]={key:b.name,value:b.default_value,overwrite:!0,isBuiltIn:!0,label:b.label||b.hint||b.name}:C&&p==="47070ec6-8700-43fd-a519-20fe3841df38"&&(b.name==="MAXAI__INSTANT_REPLY__TARGET_CONTEXT"||b.name==="MAXAI__INSTANT_REPLY__FULL_CONTEXT"||b.name==="MAXAI__INSTANT_REPLY__LAST_CONTEXT")&&(C[b.name]={key:b.name,value:b.default_value,overwrite:!0,isBuiltIn:!0,label:b.label||b.hint||b.name}),C??{}),{});h.unshift({type:"SET_VARIABLE_MAP",parameters:{VariableMap:y}})}let g=h.find(y=>y.type==="SET_VARIABLES_MODAL");if(g){if(g.parameters.SetVariablesModalConfig={...g.parameters.SetVariablesModalConfig,disableAutoExecuteWhenAllVariableHaveValue:!0},p==="47070ec6-8700-43fd-a519-20fe3841df38"){let b=ly[0].parameters.SetVariablesModalConfig;b&&(g.parameters.SetVariablesModalConfig={...g.parameters.SetVariablesModalConfig,...b})}let y=g.parameters?.MaxAIPromptActionConfig?.variables.find(b=>b.name==="SELECTED_TEXT"),C="8c0c38d4-1dfe-498e-8229-05e758b2dc03"===p;y&&(y.hidden=!1,C&&(y.hidden=!0))}await s(h,{isClearInput:!0,isFocusInput:!0}),dF(a)}}};return d?vs.default.createElement(Vm,{title:r("package__features:chat__user_message__action__edit"),...n,onClick:f,sx:{mr:.5,p:"6px",borderRadius:1,color:"text.secondary",...n.sx},disabled:l},vs.default.createElement(U,{icon:"DefaultIcon",sx:{fontSize:"20px",...e}})):null},G9=mF;function dF(e){if(e){let t=e.querySelector('*[data-testid="maxai--chat-box--chat-input--main"] textarea');if(t&&t?.focus){t.focus(),t.setSelectionRange(t.value.length,t.value.length);return}let o=e.querySelector("*[data-testid^=custom-variable--] textarea");if(o&&o?.focus){o.focus(),o.setSelectionRange(o.value.length,o.value.length);return}}}var wr=I(w()),fF=["www.linkedin.com"],hF=({variable:e,container:t,getMessageContainer:o,zIndex:n})=>{let r=(0,wr.useRef)(null),[i,a]=(0,wr.useState)(null),[s,l]=(0,wr.useState)(360);return wr.default.createElement(x,{direction:"row",width:"100%",gap:"4px",sx:{"& .maxai-user-message-variable-copy-icon":{transition:"opacity 0.2s ease-in-out",opacity:0},"&:hover .maxai-user-message-variable-copy-icon":{opacity:1}}},wr.default.createElement(B,null,wr.default.createElement(Gn,{tooltipPlacement:"top",tabIndex:-1,sx:{padding:"6px",fontSize:"20px",borderRadius:"8px",color:"text.secondary"},defaultIconSx:{},className:"maxai-user-message-variable-copy-icon",PopperProps:{container:t,sx:{zIndex:n}},copyText:e.value,onCopy:()=>{fF.includes(window.location.host)&&Yp.includes("extension")&&setTimeout(()=>{kl.hideSidebar()},1)}})),wr.default.createElement(zp,{variable:e,container:t,sx:{flexGrow:1,overflow:"hidden"},virtualRect:i,popperSx:{width:s,boxSizing:"border-box",zIndex:n},anchorElSx:{width:"100%"}},wr.default.createElement(x,{direction:"column",gap:1,ref:r,sx:{width:"100%",p:1,borderRadius:p=>p.spacing(.5),background:p=>p.palette.mode==="dark"?"rgba(255, 255, 255, 0.04)":"rgba(0, 0, 0, 0.04)",boxSizing:"border-box"},onClick:()=>{let p=o?.()??null;if(r.current&&p){let u=p.getBoundingClientRect(),c=r.current.getBoundingClientRect(),m=c.left+20,d=u.left+u.width/2,f=Math.max(d,m);if(f===d){let h=Math.min(u.width-40,600);l(h)}else l(Math.max((c.right-c.left-20)*2,140));a(new DOMRect(f,c.top,1,c.height))}}},wr.default.createElement(T,{color:p=>p.palette.mode==="dark"?"rgba(255, 255, 255, 0.38)":"rgba(0, 0, 0, 0.38)",fontSize:"14px"},e.key),wr.default.createElement(T,{whiteSpace:"nowrap",textOverflow:"ellipsis",overflow:"hidden",fontSize:"14px",color:"text.primary"},e.value))))},i1=hF;var a1="maxai-client--user-message--action-icon--visible-on-hover",gF={whiteSpace:"pre-wrap",wordBreak:"break-word",p:e=>e.spacing(1.5),bgcolor:e=>e.palette.secondary.main,borderRadius:e=>e.spacing(1),color:"text.primary",maxWidth:"100%",width:"auto",flexWrap:"wrap",overflow:"hidden"},xF={width:"auto",maxWidth:"100%",flexDirection:"row",justifyContent:"flex-end",gap:"2px",[`& .${a1}`]:{width:"32px",height:"32px",transition:"opacity 0.2s ease-in-out",opacity:0},[`&:hover .${a1}`]:{opacity:1}},_F=e=>{let{message:t,order:o,container:n}=e,{t:r}=E(),{inputMediator:i}=_e(),a=t.meta?.MaxAIPromptActionConfig===void 0,s=(0,R0.useMemo)(()=>!t.meta?.includeHistory&&o!==1,[t,o]),{quote:l,userVariables:p,formatMessageContent:u}=(0,R0.useMemo)(()=>{let y=Rr(t,!1),C=[],b=gu(t.meta?.contexts,t.meta?.MaxAIPromptActionConfig?.variables),v=b?.text??"";return v||t.meta?.MaxAIPromptActionConfig?.variables?.find(S=>S.name==="SELECTED_TEXT")&&(v=" "),b?.userVariables.forEach(S=>{S.key===Be.PRESET_VARIABLE__COMPOSE_KEY_POINTS.hint||S.key===Be.PRESET_VARIABLE__REPLY_KEY_POINTS.hint||S.key===Be.PRESET_VARIABLE__REFINE_DRAFT__FOLLOW_UP_INSTRUCTION.hint?y=S.value:C.push(S)}),{formatMessageContent:y,userVariables:C,quote:v}},[t]),[c,m]=(0,Ht.useState)(null),[d,f]=(0,Ht.useState)(360),h=(0,Ht.useRef)(null),_=(0,Ht.useRef)(null),g=()=>{i.updateInputValue(u);let y=i.ref;y&&(y.focus(),y.setSelectionRange(y.value.length,y.value.length))};return Ht.default.createElement(x,{className:"chat-message chat-message--user",direction:"column",gap:1,ref:h,width:"100%"},s&&Ht.default.createElement(Sf,{message:t}),!!l&&Ht.default.createElement(Ht.default.Fragment,null,Ht.default.createElement(B,{sx:{display:"flex",flexDirection:"row",justifyContent:"flex-end",width:"100%"}},Ht.default.createElement(zp,{variable:{key:"Quote",value:l},sx:{maxWidth:"100%",width:"auto"},virtualRect:c,popperSx:{width:d,boxSizing:"border-box"},container:n},Ht.default.createElement(x,{gap:1,direction:"row",color:y=>y.palette.mode==="dark"?"rgba(255, 255, 255, 0.38)":"rgba(0, 0, 0, 0.38)",width:"100%",ref:_,onClick:()=>{if(_.current&&h.current){let y=h.current.getBoundingClientRect(),C=_.current.getBoundingClientRect(),b=C.left+40,v=y.left+y.width/2,S=Math.max(v,b);if(S===v){let P=Math.min(y.width-40,600);f(P)}else f(Math.min(Math.max((C.width-20)*2,140),y.width-40,600));m(new DOMRect(S,C.top,1,C.height))}}},Ht.default.createElement(j9.default,{sx:{fontSize:"18px"}}),Ht.default.createElement(RC,{maxLine:2,fontSize:"14px",flex:1},l))))),Ht.default.createElement(N9,{message:t}),Ht.default.createElement(W9,{message:t}),Ht.default.createElement(x,{direction:"row",justifyContent:"flex-end",width:"100%",paddingLeft:y=>y.spacing(6)},Ht.default.createElement(x,{sx:xF},Ht.default.createElement(B,null,Ht.default.createElement(G9,{message:t,formatMessageContent:u,tabIndex:-1,className:a1,PopperProps:{disablePortal:!0}})),Ht.default.createElement(B,null,Ht.default.createElement(Gn,{tabIndex:-1,sx:{mr:.5,p:"6px",borderRadius:1,color:"text.secondary"},className:a1,PopperProps:{disablePortal:!0},copyText:u})),Ht.default.createElement(B,{className:"chat-message--text",sx:gF,onClick:y=>{if(y.detail===3){let C=y.target;if(C){let b=C.innerText;navigator.clipboard.writeText(b),y.preventDefault();let v=document.createRange();v.selectNodeContents(C);let S=window.getSelection();S&&(S.removeAllRanges(),S.addRange(v))}}}},Ht.default.createElement(T,{fontSize:"16px"},u),Ht.default.createElement(x,{width:"100%",direction:"column",gap:1},p.map((y,C)=>Ht.default.createElement(i1,{variable:y,key:`${y.key}-${C}`,getMessageContainer:()=>h.current,container:n})))))))},K9=wp(_F);var $9=I(ir()),X9=I(q9());var jt=I(w()),IF=({message:e,sx:t})=>{let[o,n]=(0,jt.useState)(!1),[r,i]=(0,jt.useState)(new Set),[a,s]=(0,jt.useState)(""),l=(0,jt.useMemo)(()=>JSON.stringify(e,null,2),[e]);return jt.default.createElement(jt.default.Fragment,null,jt.default.createElement(B,{position:"absolute",top:16,right:16,zIndex:1,sx:t},jt.default.createElement(Hr,{open:o,title:jt.default.createElement(x,null,e&&jt.default.createElement(x,{sx:{gap:1,flexDirection:"row"}},jt.default.createElement(Gu,{size:"small",sx:{width:"auto",flex:1,color:"#fff"},options:Object.keys(e),onChange:(p,u)=>{s(u??"")},renderInput:p=>jt.default.createElement(Ct,{...p,variant:"outlined"})}),jt.default.createElement(ce,{size:"small",variant:"contained",onClick:()=>{a&&i(p=>{let u=new Set(p);return u.add(a),u})}},"\u6DFB\u52A0\u76D1\u89C6\u5B57\u6BB5")),jt.default.createElement(x,{sx:{flexDirection:"row",gap:1,justifyContent:"space-between",alignItems:"center"}},jt.default.createElement(Gn,{copyText:l,sx:{color:"#fff"}}),jt.default.createElement(Ve,{onClick:()=>n(!1)},jt.default.createElement($9.default,{sx:{color:"#fff"}}))),jt.default.createElement("pre",{style:{fontSize:"12px",overflowY:"auto"}},l))},jt.default.createElement(Ve,{onClick:()=>n(p=>!p),sx:{fontSize:24}},jt.default.createElement(X9.default,null)))),r?.size>0&&jt.default.createElement(B,{sx:{borderRadius:1,border:"1px solid #ccc",p:1,background:"#f0f0f0"}},Array.from(r)?.map(p=>jt.default.createElement("div",{key:p},p,":"," ",JSON.stringify(p.split(".").reduce((u,c)=>u?.[c],e))))))},SF=e=>Fu?jt.default.createElement(IF,{...e}):null,l1=SF;var vF=e=>{let{message:t,sx:o,order:n,loading:r,onChangeHeight:i,...a}=e,s=(0,Er.useRef)(null),l=(0,Er.useRef)(0);return vy(t),(0,Er.useEffect)(()=>{if(s.current){let p=s.current,u=()=>{if(!p)return;let m=p.offsetHeight;m&&m!==l.current&&Math.abs(m-l.current)>10&&(l.current=m,i?.(m,t.messageId))},c=new ResizeObserver(()=>{u()});return c.observe(p),()=>{c.disconnect()}}},[i]),Er.default.createElement(B,{"data-message-id":t.messageId,"data-scroll-position":t.type==="system"?"bottom":"top",ref:s,sx:{padding:p=>`${p.spacing(2.25)} ${p.spacing(1.5)}`,position:"relative",boxSizing:"border-box",maxWidth:"var(--max-width)",width:"100%",mx:"auto",color:"text.primary",userSelect:"text","& .chat-message--text":{textAlign:"left",fontSize:"16px",lineHeight:1.4,fontWeight:400},...o},...a},Er.default.createElement(l1,{message:t}),ki(t)&&Er.default.createElement(n1,{message:t}),xr(t)&&Er.default.createElement(F9,{order:n,loading:r??!1,message:t}),hC(t)&&Er.default.createElement(K9,{order:n,message:t}))},Y9=(0,Er.memo)(vF);var Z9=I(w()),TF=e=>{let{conversationId:t}=e,o=Wl(t);return Z9.default.createElement(l1,{message:o,sx:{left:0,right:"inherit"}})},Q9=TF;var Ue=I(w());var J9=I(sw());var p1=I(w()),MF=e=>{let{onClick:t,container:o}=e,{t:n}=E();return p1.default.createElement(Ve,{onClick:()=>t(),sx:{position:"absolute",bottom:"16px",left:"50%",transform:"translateX(-50%)",bgcolor:"background.paper",padding:0,border:"1px solid",width:"32px",height:"32px",borderColor:r=>r.palette.mode==="dark"?"rgb(64,64,64)":"rgb(234,234,234)",boxShadow:"0px 12px 16px -4px rgba(0, 0, 0, 0.08), 0px 4px 6px -2px rgba(0, 0, 0, 0.03)","&:hover":{bgcolor:r=>r.palette.mode==="dark"?"rgb(64,64,64)":"rgb(234,234,234)"}}},p1.default.createElement(he,{PopperProps:{container:o},title:n("package__features:chat__message_list__scroll_to_bottom__title"),placement:"top"},p1.default.createElement(J9.default,{sx:{boxSizing:"border-box",padding:"8px",fontSize:"32px"}})))},c1=MF;var wF="message-list-scroll-container",U0=4*24+2*18,ev=e=>{let t=e.scrollTop,o=e.scrollHeight,n=e.clientHeight;return Math.abs(n+t-o)>10},EF=(e,t,o,n)=>{if(!e)return;let r=e.querySelectorAll("[data-message-id]"),i=Array.from(r).findIndex(s=>s.getAttribute("data-message-id")===t),a=r[i];if(a){let s=a.getAttribute("data-scroll-position")||"bottom";e.scrollTo(0,s==="bottom"?e?.scrollHeight:a.offsetTop-U0),o?.()}n?.()},AF=e=>{let{conversationId:t}=_e(),{conversationId:o=t,sx:n,emptyNode:r,children:i}=e,a=ny(o),s=qa(o),l=(0,Ue.useRef)(null),[p,u]=(0,Ue.useState)(0),c=(0,Ue.useRef)(li(EF,50,{leading:!1,trailing:!0})),m=(0,Ue.useRef)(null),d=(0,Ue.useRef)(null),{messages:f,isLoading:h,isFetchingNextPage:_,hasNextPage:g,fetchNextPage:y,lastMessageId:C,previousPageLastMessageId:b}=ty(o),[v,S]=(0,Ue.useState)(!1),P=(0,Ue.useRef)(!1);(0,Ue.useEffect)(()=>{P.current=!1},[o]);let[k,L]=(0,Ue.useState)(!1);(0,Ue.useLayoutEffect)(()=>{L(!1)},[o]);let H=h||!k,W=(0,Ue.useRef)(!1),O=(0,Ue.useCallback)(()=>{_||!g||W.current||(W.current=!0,y().then().catch())},[_,g,y]),D=Ke(O),V=()=>{let M=l.current;M&&(M.scrollTo(0,M.scrollHeight),S(!1))},N=(0,Ue.useCallback)(()=>{if(!m.current){L(!0);return}let M=l.current;if(M&&S(ev(M)),d.current===m.current){L(!0);return}let K=m.current;c.current(l.current,m.current,()=>{d.current=K,P.current=!0,W.current&&(W.current=!1)},()=>{setTimeout(()=>{L(!0)},100)})},[]);(0,Ue.useEffect)(()=>{let M=l.current;if(!M)return;let K=te=>{if(S(ev(M)),te.deltaY<0){M.scrollTop<=M.offsetHeight/10&&D.current();return}},F=new ResizeObserver(()=>{let te=M.clientHeight;u(te)});F.observe(M);let pe=li(K,100),ae=Rn(K,300);return M.addEventListener("wheel",pe),M.addEventListener("wheel",ae),M.addEventListener("scroll",pe),M.addEventListener("scroll",ae),()=>{M.removeEventListener("wheel",pe),M.removeEventListener("wheel",ae),M.removeEventListener("scroll",pe),M.removeEventListener("scroll",ae),F.disconnect()}},[l.current,o]);let z=(0,Ue.useRef)(null);fm(()=>{z.current=m.current}),(0,Ue.useEffect)(()=>{z.current&&(Ei(f)?.messageId!==z.current&&V(),z.current=null)},[f]),(0,Ue.useEffect)(()=>{let M=a?.messageId||"";M&&C!==M?m.current=M:C&&C!==m.current&&(m.current=C)},[a?.messageId,C]),(0,Ue.useEffect)(()=>{b&&W.current&&(m.current=b)},[b]),(0,Ue.useEffect)(()=>{d.current=null},[o]);let j=(0,Ue.useRef)({}),G=(0,Ue.useMemo)(()=>{a&&(j.current[o]=a);let M=De(f),K=j.current[o],F=K?.messageId;if(!F)return{writingMessageId:"",currentMessages:M};let pe=f.findIndex(ae=>ae.messageId===F);if(pe>-1){let ae=!1;if(a&&a.updated_at&&M[pe].updated_at){if(new Date(a.updated_at).getTime()<new Date(M[pe].updated_at).getTime())return{writingMessageId:F,currentMessages:M};ae=!0}return!a&&!ae?(delete j.current[o],{writingMessageId:"",currentMessages:M}):(M[pe]=Jo([M[pe],a]),{writingMessageId:F,currentMessages:M})}else if(K){let ae=Ei(f);ae&&ki(ae)?delete j.current[o]:M=[...f,K]}return{writingMessageId:F,currentMessages:M}},[o,a,f]),q=(0,Ue.useMemo)(()=>!(h||_||g||G.currentMessages.length||G.writingMessageId||s),[h,_,g,G.currentMessages.length,G.writingMessageId,s]),A=Ei(f)?.type,Y=(0,Ue.useMemo)(()=>({flex:1,height:"0",overflowY:"auto",display:q?"none":"block","&:focus":{outline:"none"},"& .maxai__message-item":{"&:last-of-type":{minHeight:A==="system"?"unset":p===0?`calc(100vh - ${U0+200}px)`:`calc(${p}px - ${U0}px)`}},...n}),[p,A,n,q]),Q=Ue.default.createElement(x,{"data-testid":"maxai--chat-panel--message-list",key:o,sx:{height:0,flex:1,width:"100%",position:"relative",display:q?"none":"flex","& *":{boxSizing:"border-box"},...n}},Ue.default.createElement(Q9,{conversationId:o}),q&&r,H&&Ue.default.createElement("div",{style:{position:"absolute",top:0,left:0,right:0,bottom:0,zIndex:2}},Ue.default.createElement(Wn,{loading:!0,sx:{backgroundColor:"background.default"}})),Ue.default.createElement(B,{ref:l,id:wF,tabIndex:-1,sx:Y},_&&Ue.default.createElement(x,{width:"100%",alignItems:"center",justifyContent:"center",sx:{my:"16px"}},Ue.default.createElement(Jt,{size:16,sx:{m:"0 auto"}})),G.currentMessages.map((M,K)=>Ue.default.createElement(Y9,{key:`${M.messageId}_${K}`,className:`maxai__message-item maxai__message-item--${M.type}`,"data-testid":`maxai__message-item-${K+1}`,message:M,order:K+1,onChangeHeight:N,loading:G.writingMessageId===M.messageId}))),v&&!q&&Ue.default.createElement(c1,{onClick:()=>V()}));return i?i({isShowHomeView:q,isLoading:h,isFetchingNextPage:_,hasNextPage:g,messages:G.currentMessages,listNode:Q}):Q},Rp=AF;var Vt=I(w());var Ps=I(w());var av=I(Mi());var Wo=I(w());var nv=I(ir());var Dn=I(w());var mr=I(w());var tv=I(w()),u1=[{betaFeature:"appearance_v2",optionTitle:"package__features:beta_features__modal__option__appearance_v2__title",betaFeatureCardTitle:"package__features:beta_features__modal__feature_card__appearance_v2__title",betaFeatureCardImages:[nh("/images/beta-features/appearance/1.png")],betaFeatureCardDescription:"package__features:beta_features__modal__feature_card__appearance_v2__description",onButtonText:"package__features:beta_features__modal__feature_card__appearance_v2__on",offButtonText:"package__features:beta_features__modal__feature_card__appearance_v2__off"},{betaFeature:"enabled_artifacts",optionTitle:"package__features:beta_features__modal__option__artifacts__title",betaFeatureCardTitle:"package__features:beta_features__modal__feature_card__artifacts__title",betaFeatureCardImages:[nh("/images/beta-features/artifacts/1.png")],betaFeatureCardDescription:"package__features:beta_features__modal__feature_card__artifacts__description",onButtonText:"package__features:beta_features__modal__feature_card__common__on",offButtonText:"package__features:beta_features__modal__feature_card__common__off"}],Ts=(0,tv.createContext)({mode:"full",selectedBetaFeature:u1[0].betaFeature,betaFeatureOptions:u1,openBetaFeature:()=>{},handleSelectBetaFeature:()=>{},closeBetaFeature:()=>{},open:!1});var PF=e=>{let{betaFeature:t,onChange:o}=e,{t:n}=E(),{selectedBetaFeature:r,betaFeatureOptions:i}=(0,mr.useContext)(Ts),a=i.find(s=>s.betaFeature===r);return!a||a.betaFeature!==t?null:mr.default.createElement(x,{gap:1.5,width:"100%"},a.betaFeatureCardImages[0]&&mr.default.createElement("img",{alt:n(a.betaFeatureCardTitle),width:"100%",src:a.betaFeatureCardImages[0]}),mr.default.createElement(x,{gap:1},mr.default.createElement(x,{direction:"row",alignItems:"center",gap:1},mr.default.createElement(T,{width:0,flex:1,noWrap:!0,fontSize:"16px",fontWeight:"400",color:"text.primary",textAlign:"left"},n(a.betaFeatureCardTitle)),mr.default.createElement(x,{onClick:async()=>{let s=!a?.enabled;a?.setEnabled?.(s),o?.(s)},direction:"row",alignItems:"center",gap:.5,sx:{flexShrink:0,py:.5,px:1,cursor:"pointer"}},mr.default.createElement(T,{fontSize:"14px",fontWeight:"400",color:"text.primary"},n(a.offButtonText)),mr.default.createElement(x,{alignItems:"center",justifyContent:"center",p:"2px"},mr.default.createElement(Rm,{checked:a.enabled,height:16})),mr.default.createElement(T,{fontSize:"14px",fontWeight:"400",color:"text.primary"},n(a.onButtonText)))),mr.default.createElement(T,{fontSize:"14px",fontWeight:"400",color:"text.secondary"},n(a.betaFeatureCardDescription))))},W0=PF;var Up=I(w());var kF=()=>{let{t:e}=E(),{selectedBetaFeature:t,betaFeatureOptions:o,handleSelectBetaFeature:n}=(0,Up.useContext)(Ts);return Up.default.createElement(Ku,{sx:{width:"100%"}},o.map(r=>Up.default.createElement(qu,{sx:{p:"8px 12px"},key:r.betaFeature,selected:t===r.betaFeature,onClick:()=>n(r.betaFeature)},Up.default.createElement(T,{fontSize:"14px",fontWeight:500,color:"text.primary"},e(r.optionTitle)))))},ov=kF;var LF=()=>{let{t:e}=E(),{mode:t,open:o,closeBetaFeature:n}=(0,Dn.useContext)(Ts),{appSettings:r,setAppSettings:i}=sr(),a=co(),{betaSettings:s,updateBetaSettings:l}=En();return Dn.default.createElement(Ti,{container:a,open:o,onClose:p=>{p.stopPropagation(),n()},sx:{position:t==="full"?"fixed":"absolute"},slotProps:{root:{onClick:p=>{p.stopPropagation()}},backdrop:{sx:{position:t==="full"?"fixed":"absolute"}}}},Dn.default.createElement(ju,{sx:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",borderRadius:1,bgcolor:p=>p.palette.mode==="dark"?"#3d3d3d":"#fff",maxWidth:"768px!important",width:t==="full"?"100%":"448px",p:"0!important"}},Dn.default.createElement(x,null,Dn.default.createElement(x,{direction:"row",alignItems:"center",justifyContent:"space-between",sx:{p:"8px 16px",borderBottom:"1px solid",borderColor:"border.main",boxSizing:"border-box"}},Dn.default.createElement(T,{fontSize:"16px",fontWeight:600,lineHeight:"20px",color:"text.primary"},e("package__features:beta_features__modal__title")),Dn.default.createElement(Ve,{"aria-label":"close",sx:{width:30,height:30},onClick:()=>{n()}},Dn.default.createElement(nv.default,{sx:{width:20,height:20}}))),Dn.default.createElement(x,{sx:{flexDirection:t==="lite"?"column":"row"}},Dn.default.createElement(x,{sx:{p:"12px 16px",width:t==="lite"?"100%":"208px",boxSizing:"border-box"}},Dn.default.createElement(ov,null)),Dn.default.createElement(x,{sx:{p:"12px 16px",width:t==="lite"?"100%":"0",flex:1,boxSizing:"border-box"}},Dn.default.createElement(W0,{betaFeature:"enabled_artifacts",onChange:async()=>{await i({userSettings:{features:{artifacts:{enabled:!r.userSettings?.features?.artifacts?.enabled}}}})}}),Dn.default.createElement(W0,{betaFeature:"appearance_v2",onChange:async()=>{await l({appearance_v2_enabled:!s?.appearance_v2_enabled})}}))))))},rv=LF;var iv=e=>{let{sx:t}=e;return Wo.default.createElement(av.default,{sx:{...t}},Wo.default.createElement("svg",{width:"18",height:"18",viewBox:"0 0 18 18",fill:"none",xmlns:"http://www.w3.org/2000/svg"},Wo.default.createElement("g",null,Wo.default.createElement("path",{d:"M3.74989 15.75C3.11239 15.75 2.65927 15.4656 2.39052 14.8969C2.12177 14.3281 2.18739 13.8 2.58739 13.3125L6.74989 8.25V3.75H5.99989C5.78739 3.75 5.60927 3.67813 5.46552 3.53437C5.32177 3.39062 5.24989 3.2125 5.24989 3C5.24989 2.7875 5.32177 2.60938 5.46552 2.46562C5.60927 2.32187 5.78739 2.25 5.99989 2.25H11.9999C12.2124 2.25 12.3905 2.32187 12.5343 2.46562C12.678 2.60938 12.7499 2.7875 12.7499 3C12.7499 3.2125 12.678 3.39062 12.5343 3.53437C12.3905 3.67813 12.2124 3.75 11.9999 3.75H11.2499V8.25L15.4124 13.3125C15.8124 13.8 15.878 14.3281 15.6093 14.8969C15.3405 15.4656 14.8874 15.75 14.2499 15.75H3.74989ZM5.24989 13.5H12.7499L10.1999 10.5H7.79989L5.24989 13.5ZM3.74989 14.25H14.2499L9.74989 8.775V3.75H8.24989V8.775L3.74989 14.25Z",fill:"currentColor"}))))},OF=e=>{let{mode:t,buttonSize:o="small",sx:n,tooltipProps:r,...i}=e,{t:a}=E(),{userSettings:s}=sr(),{betaSettings:l}=En(),{loaded:p,features:u}=ZC(),[c,m]=(0,Wo.useState)(!1),[d,f]=(0,Wo.useState)(void 0),h=(0,Wo.useMemo)(()=>t||(Ta()?"lite":"full"),[t]),_=(0,Wo.useMemo)(()=>De(u1).map(S=>(S.enabled=!1,S.hasBetaFeatureAccess=!1,p&&u[S.betaFeature]&&S.betaFeature==="enabled_artifacts"&&(S.enabled=s?.features?.artifacts?.enabled,S.hasBetaFeatureAccess=!0),S)).filter(S=>S.hasBetaFeatureAccess),[u,p,s,l?.appearance_v2_enabled]),g=_.find(S=>S.enabled),y=S=>{let P=_.find(L=>L.hasBetaFeatureAccess),k=S||P?.betaFeature;k&&(f(k),m(!0))},v={mode:h,open:c,selectedBetaFeature:d,handleSelectBetaFeature:S=>{f(S)},betaFeatureOptions:_,openBetaFeature:y,closeBetaFeature:()=>{f(void 0),m(!1)}};return _.find(S=>S.hasBetaFeatureAccess)?Wo.default.createElement(Ts.Provider,{value:v},o==="small"?Wo.default.createElement(zs,{"data-testid":"maxai--chat--beta-features-button",title:a("package__features:beta_features__toggle_button__title"),tooltipProps:{disableInteractive:!0,...r},color:"primary",sx:{position:"relative",...n},onClick:()=>{y()},...i},Wo.default.createElement(B,{component:"svg",sx:{position:"absolute",opacity:g?1:0,top:"4px",right:"4px",width:"6px",height:"6px",borderRadius:"50%",bgcolor:"currentColor",color:"inherit"}}),Wo.default.createElement(iv,{sx:{fontSize:"20px"}})):Wo.default.createElement(zs,{"data-testid":"maxai--chat--beta-features-button",onClick:()=>{y()},color:"primary",sx:{position:"relative",width:"100%",justifyContent:"flex-start",padding:"8px 10px",height:"unset",gap:"12px",display:"flex",alignItems:"center","& > :not(div)":{flexShrink:0}},...i},Wo.default.createElement(B,{component:"svg",sx:{position:"absolute",opacity:g?1:0,top:"4px",left:"28px",width:"6px",height:"6px",borderRadius:"50%",bgcolor:"currentColor",color:"inherit"}}),Wo.default.createElement(iv,{sx:{fontSize:"20px"}}),Wo.default.createElement(T,{component:"div",flex:1,width:0,fontSize:"14px",color:"inherit",fontWeight:400,textAlign:"left"},a("package__features:beta_features__toggle_button__title"))),Wo.default.createElement(rv,null)):null},sv=OF;var G0=I(Mi()),Xo=I(w()),BF=e=>Xo.default.createElement(G0.default,{...e},Xo.default.createElement("svg",{width:"20",height:"20",viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg"},Xo.default.createElement("mask",{id:"mask0_240_14735",style:{maskType:"alpha"},maskUnits:"userSpaceOnUse",x:"0",y:"0",width:"20",height:"20"},Xo.default.createElement("rect",{width:"20",height:"20",fill:"#D9D9D9"})),Xo.default.createElement("g",{mask:"url(#mask0_240_14735)"},Xo.default.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M2.95161 15.5565C3.24536 15.8502 3.59849 15.9971 4.01099 15.9971H16.011C16.4235 15.9971 16.7766 15.8502 17.0704 15.5565C17.3641 15.2627 17.511 14.9096 17.511 14.4971V5.5C17.511 5.0875 17.3641 4.73438 17.0704 4.44063C16.7766 4.14688 16.4235 4 16.011 4H4.01099C3.59849 4 3.24536 4.14688 2.95161 4.44063C2.65786 4.73438 2.51099 5.0875 2.51099 5.5V14.4971C2.51099 14.9096 2.65786 15.2627 2.95161 15.5565ZM16.011 14.4971H4.01099V7.75001H16.011V14.4971ZM4.01172 5.90688C4.01172 5.58379 4.27364 5.32188 4.59672 5.32188C4.91981 5.32188 5.18172 5.58379 5.18172 5.90688C5.18172 6.22997 4.91981 6.49188 4.59672 6.49188C4.27364 6.49188 4.01172 6.22997 4.01172 5.90688ZM5.62256 5.90688C5.62256 5.58379 5.88448 5.32188 6.20756 5.32188C6.53065 5.32188 6.79257 5.58379 6.79257 5.90688C6.79257 6.22997 6.53065 6.49188 6.20756 6.49188C5.88448 6.49188 5.62256 6.22997 5.62256 5.90688ZM7.23323 5.90688C7.23323 5.58379 7.49514 5.32188 7.81823 5.32188C8.14132 5.32188 8.40323 5.58379 8.40323 5.90688C8.40323 6.22997 8.14132 6.49188 7.81823 6.49188C7.49514 6.49188 7.23323 6.22997 7.23323 5.90688Z",fill:"currentColor"})))),DF=e=>Xo.default.createElement(G0.default,{...e},Xo.default.createElement("svg",{width:"21",height:"21",viewBox:"0 0 21 21",fill:"none",xmlns:"http://www.w3.org/2000/svg"},Xo.default.createElement("mask",{id:"mask0_248_17101",style:{maskType:"alpha"},maskUnits:"userSpaceOnUse",x:"0",y:"0",width:"21",height:"21"},Xo.default.createElement("rect",{x:"0.75",y:"0.5",width:"20",height:"20",fill:"#D9D9D9"})),Xo.default.createElement("g",{mask:"url(#mask0_248_17101)"},Xo.default.createElement("path",{d:"M7.02758 14.223H12.2387V12.7341H7.02758V14.223ZM7.02758 11.2452H14.472V9.75634H7.02758V11.2452ZM7.02758 8.26745H14.472V6.77856H7.02758V8.26745ZM5.53869 17.2008C5.12925 17.2008 4.77874 17.055 4.48717 16.7634C4.19559 16.4718 4.0498 16.1213 4.0498 15.7119V5.28967C4.0498 4.88023 4.19559 4.52972 4.48717 4.23814C4.77874 3.94657 5.12925 3.80078 5.53869 3.80078H15.9609C16.3704 3.80078 16.7209 3.94657 17.0124 4.23814C17.304 4.52972 17.4498 4.88023 17.4498 5.28967V15.7119C17.4498 16.1213 17.304 16.4718 17.0124 16.7634C16.7209 17.055 16.3704 17.2008 15.9609 17.2008H5.53869ZM5.53869 15.7119H15.9609V5.28967H5.53869V15.7119Z",fill:"currentColor"})))),FF=e=>{let{sx:t}=e,{t:o}=E(),{conversationId:n,currentDocument:r,setCurrentDocument:i}=re(m=>({conversationId:m.conversationIds[0],currentDocument:m.currentDocument,setCurrentDocument:m.setCurrentDocument})),{updateConversation:a}=qe(),{inputMediator:s}=_e();if(!r)return null;let l=()=>{let m=!r.selected;i(d=>d?{...d,selected:m}:null),a(n,{meta:{chatSources:{enableCurrent:m}}},{syncToRemote:!1,isPartialUpdate:!0,updateUpdatedAt:!1}),s.focus()},p=r.maxAIDocumentType,u=o("package__features:chat__current_document_button__file__tooltip"),c=Xo.default.createElement(Hm,{chatDocument:r});return p&&p.startsWith("page_content")&&!p.includes("pdf")&&(u=o("package__features:chat__current_document_button__webpage__tooltip")),r.selected||(lo?c=Xo.default.createElement(BF,null):c=Xo.default.createElement(DF,null)),Xo.default.createElement(he,{title:u,disableInteractive:!0},Xo.default.createElement(B,null,Xo.default.createElement(Xa,{text:o("package__features:home_view__chat_with_any_content__chat__chat_document_selector__chip__current__title"),icon:c,mode:"normal",selected:r.selected,onClick:l,iconSx:{"& > img":{width:"20px",height:"20px",padding:"1px"}},sx:{userSelect:"none",...r.selected?{borderColor:"transparent",bgcolor:"active.main",color:"active.contrastText","&:hover":{bgcolor:"active.hover",color:"active.hoverText"}}:{},...t},...e})))},lv=FF;var pv=I(Mi()),Ms=I(w()),HF=e=>Ms.default.createElement(pv.default,{...e},Ms.default.createElement("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},Ms.default.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M3 10.4278C3 6.87783 5.87783 4 9.42782 4C12.9778 4 15.8556 6.87783 15.8556 10.4278C15.8556 11.8691 15.3813 13.1996 14.5801 14.2717L18.729 18.4206C19.0903 18.7819 19.0903 19.3677 18.729 19.729C18.3677 20.0903 17.7819 20.0903 17.4206 19.729L13.2718 15.5801C12.1997 16.3812 10.8691 16.8556 9.42782 16.8556C5.87783 16.8556 3 13.9778 3 10.4278ZM9.42782 5.85034C6.89975 5.85034 4.85034 7.89975 4.85034 10.4278C4.85034 12.9559 6.89975 15.0053 9.42782 15.0053C11.9559 15.0053 14.0053 12.9559 14.0053 10.4278C14.0053 7.89975 11.9559 5.85034 9.42782 5.85034Z",fill:"currentColor"}))),NF=e=>{let{sx:t,...o}=e,{t:n}=E(),{check:r}=gc(),{conversationId:i,enableSearch:a,setEnableSearch:s}=re(c=>({conversationId:c.conversationIds[0],enableSearch:c.enableSearch,setEnableSearch:c.setEnableSearch})),{updateConversation:l}=qe(),{inputMediator:p}=_e(),u=()=>{let c=!a;c&&!r(!0)||(s(c),l(i,{meta:{chatSources:{enableSearch:c}}},{syncToRemote:!1,isPartialUpdate:!0,updateUpdatedAt:!1}),p.focus())};return Ms.default.createElement(he,{title:n("package__features:chat__enable_search_button__web__tooltip"),disableInteractive:!0},Ms.default.createElement(B,null,Ms.default.createElement(Xa,{text:n("package__features:home_view__chat_with_any_content__chat__chat_document_selector__chip__search__title"),icon:Ms.default.createElement(HF,{sx:{mx:"-2px"}}),mode:"normal",selected:a,onClick:u,sx:{userSelect:"none",...a?{borderColor:"transparent",bgcolor:"active.main",color:"active.contrastText","&:hover":{bgcolor:"active.hover",color:"active.hoverText"}}:{},...t},...o})))},cv=NF;var uv=I(w());var zF=()=>{let e="feedback",{userInfo:t,subscriptionType:o}=Tt(),{syncSurveyStatus:n}=Ll(!1),r=vt(u_),i=vt(m_),a=(0,uv.useMemo)(()=>!(!i||t===null||o!=="yearly"&&o!=="oneTimePayment"||r[e]),[t,o,i,e,r]);return Ol(n),{loaded:i,canShowSurvey:a}},mv=zF;var dv=I(Mi());var Ar=I(w()),VF=({sx:e})=>{let t="feedback",o=`${nr}/survey/feedback/`,{isLogin:n}=Mn(),{t:r}=E(),{canShowSurvey:i}=mv(),{syncSurveyStatus:a}=Ll(!1),[s,l]=(0,Ar.useState)(!1),p=()=>{l(!0),window.open(o),c_("survey_card_clicked",{survey_type:t})};return Ol(()=>{s&&(a(void 0,!0),l(!1))}),!n||!i?null:Ar.default.createElement(Ar.default.Fragment,null,Ar.default.createElement(he,{placement:"top",title:r("package__features:chat__chat_input__feedback_button__description"),disableInteractive:!0},Ar.default.createElement("div",null,Ar.default.createElement(si,{"data-testid":"maxai--chat--feedback-button",sx:{borderRadius:1,p:"6px",bgcolor:u=>u.palette.mode==="dark"?"rgba(178, 115, 255, 0.16)":"rgba(118, 1, 211, 0.08)","&:hover":{bgcolor:u=>u.palette.mode==="dark"?"rgba(178, 115, 255, 0.24)":"rgba(118, 1, 211, 0.12)"},...e},onClick:p},Ar.default.createElement(RF,{sx:{fontSize:20}}),Ar.default.createElement(T,{ml:.5,my:0,fontSize:12,fontWeight:400,lineHeight:1.5,color:"text.primary",sx:{userSelect:"none",opacity:1}},r("package__features:chat__chat_input__feedback_button"))))))},fv=VF,RF=({sx:e})=>Ar.default.createElement(dv.default,{viewBox:"0 0 20 20",sx:e},Ar.default.createElement("svg",{width:"20",height:"20",viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg"},Ar.default.createElement("path",{d:"M4.8127 6.80792H15.1877M4.8127 10.0007H15.1877M4.46686 14.0898V16.9173L8.15621 14.0898H16.5724C17.5269 14.0898 18.3002 13.3151 18.3002 12.3606V4.81315C18.3002 3.85865 17.5255 3.08398 16.571 3.08398H3.42936C2.47486 3.08398 1.7002 3.85865 1.7002 4.81315V12.3606C1.7002 13.3151 2.47486 14.0898 3.42936 14.0898H4.46686Z",stroke:"currentColor",strokeOpacity:"0.87",strokeWidth:"1.60645"})));var hv=I(w()),UF=({open:e,onClose:t,onConfirm:o})=>{let{t:n}=E();return hv.default.createElement(rs,{open:e,title:n("package__features:context_menu__lite_editor__modal__delete_all__title"),description:n("package__features:context_menu__lite_editor__modal__delete_all__description"),confirmButtonText:n("package__features:context_menu__lite_editor__modal__delete_all__button__delete"),onConfirm:o,onClose:t})},gv=UF;var Mv=I(ir()),wv=I(dc());var st=I(w());var io=I(w()),Iv=I(w());var xv=I(pw());var m1=I(w()),WF=({onClick:e,sx:t,item:o,...n})=>{let{t:r}=E();return m1.default.createElement(B,{className:"maxai_project_node__group__add_sources",onMouseDown:i=>{i.stopPropagation()},onMouseUp:i=>{i.stopPropagation()},onClick:i=>{i.stopPropagation()}},m1.default.createElement(ne,{title:r("package__features:chat__inputbox__my_own_tools__modal__add_prompt_inside__tooltip"),placement:"top",tooltipProps:{disableInteractive:!0,enterNextDelay:50,placement:"top-end"},sx:t,onClick:i=>{i.stopPropagation(),e?.(i),i.currentTarget&&i.currentTarget.blur()},...n},m1.default.createElement(xv.default,{sx:{fontSize:20}})))},_v=WF;var Yr=I(w());var ha=I(w()),GF=({isFolder:e,onClickEdit:t,onClickRename:o,onClickDelete:n,onCloseMenuList:r})=>{let{t:i}=E(),[a,s]=(0,ha.useState)(!1),l=(0,ha.useMemo)(()=>{let p=[];return e?p.push({value:"rename",icon:ha.default.createElement(U,{icon:"DefaultIcon"}),label:i("package__common:rename"),divider:!0}):p.push({value:"edit",icon:ha.default.createElement(U,{icon:"DefaultIcon"}),label:i("package__common:edit"),divider:!0,ButtonProps:{loading:a}}),p.push({value:"delete",icon:ha.default.createElement(U,{icon:"Delete",sx:{color:"rgba(255, 14, 39, 1)!important"}}),label:i("package__common:delete"),labelSx:{color:"rgba(255, 14, 39, 1)!important"}}),p},[e,a,i]);return ha.default.createElement(Da,{placement:"bottom-end",offset:{top:0,right:0,bottom:0,left:0},options:l,sx:{width:"248px",gap:"4px"},onSelectOption:async p=>{if(p==="edit"){s(!0);try{await t?.()}catch{}finally{s(!1),r()}}else p==="rename"?(o?.(),r()):p==="delete"&&(n?.(),r())}})},Cv=GF;var jF=e=>{let{itemId:t,onClickEdit:o,onClickDelete:n,onClickRename:r,onOpenChanged:i,closeTooltip:a,sx:s,title:l,isFolder:p,tooltipProps:u,containerSx:c}=e,[m,d]=(0,Yr.useState)(null),f=(0,Yr.useRef)(null),h=!!m,_=vt(dy(t??"")),g=()=>{d(null),i?.(!1),setTimeout(()=>{a?.()},500)},y=(0,Yr.useMemo)(()=>_||h?null:{opacity:0,pointerEvents:"none",position:"absolute"},[h,_]);return Yr.default.createElement(B,{className:"maxai_project_node__tree_more_actions",onMouseDown:C=>{C.stopPropagation()},onMouseUp:C=>{C.stopPropagation()},onClick:C=>{C.stopPropagation()},sx:{...y,...c}},Yr.default.createElement(ne,{ref:f,title:l,tooltipProps:{disableInteractive:!0,disableFocusListener:!0,arrow:!0,placement:"top-end",...u},sx:s,onClick:C=>{C.stopPropagation(),d(C.currentTarget),i?.(!0)}},Yr.default.createElement(U,{icon:"More",size:20})),Yr.default.createElement(Fr,{disableScrollLock:!0,anchorOrigin:{vertical:"bottom",horizontal:"right"},transformOrigin:{vertical:"top",horizontal:"right"},anchorEl:m,open:h,onClose:g,slotProps:{paper:{elevation:0,sx:{overflow:"unset",background:"transparent"}}}},Yr.default.createElement(Cv,{isFolder:p,onClickEdit:o,onClickDelete:n,onClickRename:r,onCloseMenuList:g})))},yv=jF;var Sv=e=>ai(e,["type","name"],["asc","asc"]),vv=(e,t,o,n=new Map)=>{let r=e.map(i=>{let a={id:i.prompt_id,name:i.prompt_title,type:i.type==="group"?"group":"item",parentId:t?.id||null,metadata:i};return a.type==="group"&&o.add(a.id),i.children&&i.children.length>0&&vv(i.children,a,o,n),n.set(i.prompt_id,a),a});return t&&(t.children=Sv(r)),{parentDataItem:t,treeDataFlatMap:n}},bv=e=>{oo.error(e||"",{autoHideDuration:3e3})},KF=e=>{let{liteContextMenuActionsItems:t,rootLiteContextMenu:o,disabledTooltip:n,sx:r,onClose:i}=e,{t:a}=E(),{createNewPrompt:s,editPrompt:l,openDeletePromptConfirm:p}=An(),{editGroup:u,openDeleteGroupConfirm:c}=ci(),{refetch:m}=nn(),{askAIWithShortcutsV2:d}=Ne(),f=(0,io.useRef)(null),[h,_]=(0,io.useState)(null);(0,io.useEffect)(()=>{},[t]);let[g,y]=(0,io.useState)(null),C=(0,io.useRef)(new Map),{treeViewData:b,openedGroups:v}=(0,Iv.useMemo)(()=>{let O=new Set,{parentDataItem:D,treeDataFlatMap:V}=vv(t,{id:o.prompt_id,name:a("package__features:chat__inputbox__my_own_tools__modal__title"),type:"group",parentId:null,metadata:o},O,C.current);return y(D),C.current.set(o.prompt_id,D),{treeViewData:D,openedGroups:O}},[t,o]),S=(0,io.useCallback)(O=>({...O.id===h&&{backgroundColor:D=>D.palette.mode==="dark"?"rgba(255, 255, 255, 0.08)":"rgba(0, 0, 0, 0.04)"},"&:hover":{".maxai_project_node__tree_more_actions":{opacity:1,pointerEvents:"auto",position:"static"},".maxai_project_node__group__add_sources":{opacity:1,pointerEvents:"auto",position:"static"}},pr:"4px",pl:"16px",height:"44px"}),[h]),P=(0,io.useCallback)((O,D)=>O.type==="group"?io.default.createElement(By,{size:20,isExpand:D}):io.default.createElement(U,{sx:{color:"text.secondary",flexShrink:0},icon:O.metadata.prompt_icon?O.metadata.prompt_icon==="Empty"?"Shuriken":O.metadata.prompt_icon:"Shuriken",size:20}),[]),k=(0,io.useCallback)((O,D)=>{let V="actions"in O.metadata?O.metadata.origin:O.metadata;return io.default.createElement(x,{alignItems:"center",direction:"row",gap:"2px"},io.default.createElement(yv,{isFolder:O.type==="group",title:O.type==="group"?a("package__features:chat__inputbox__my_own_tools__modal__group_more_actions_button__tooltip"):a("package__features:chat__inputbox__my_own_tools__modal__prompt_more_actions_button__tooltip"),tooltipProps:{open:n?!1:void 0,disabled:n,enterNextDelay:50},itemId:O.id,onClickEdit:async()=>{V&&await l(V)},onClickDelete:()=>{V&&(O.type==="group"?c(V):p(V))},onClickRename:()=>{V&&u(V)},closeTooltip:D,onOpenChanged:N=>{_(N?O.id:null)}}),O.type==="group"&&io.default.createElement(_v,{item:O,onClick:()=>{f.current?.toggleGroup(O.id,!0),s({parent_prompt_id:O.id,prompt_icon:"Shuriken"})}}))},[a,n,l,c,p,u,s]),L=(0,io.useCallback)((O,D)=>{let V=C.current.get(O);if(!V)return;let N=V.parentId||"";y(z=>{if(!z)return null;let j=C.current.get(N);j&&(j.children=j.children?.filter(q=>q.id!==O));let G=C.current.get(D);return G&&(V.parentId=D,G.children=G.children||[],G.children.push(V),G.children=Sv(G.children)),z})},[]),H=(0,io.useCallback)((O,D)=>{let V=O[0],N=D.id,z=C.current.get(V);z&&(L(V,N),on.moveContextMenuNode(V,"",N,0).then(j=>{j.data?.status==="OK"?bv(a("package__features:chat__inputbox__my_own_tools__modal__action__move_success",{FILE_NAME:z.name,FOLDER_NAME:D.name})):bv(j.data?.msg||""),m()}).catch(j=>{m()}))},[L,m,a]),W=(0,io.useCallback)(async O=>{O.type==="item"&&await Fe({emitEvent:!0})&&O.metadata.actions&&(i?.(),await d(O.metadata.actions,{isClearInput:!0,isFocusInput:!0}))},[d,i]);return(0,io.useEffect)(()=>{},[g]),g&&io.default.createElement(Oy,{ref:f,disabledGroupDrag:!0,rootItem:g,defaultOpenedGroups:v,slotItemRight:k,slotTitleLeft:P,onItemMove:H,onItemClick:W,hideCheckbox:!0,itemSx:S,groupChildrenContainerSx:{pl:"8px"},edgeDropZoneWidth:8})},Tv=KF;var qF=({sx:e,onClose:t})=>{let{t:o}=E(),n=(0,st.useRef)(null);(0,st.useEffect)(()=>{if(n.current){let _=setTimeout(()=>{n.current?.focus()},500);return()=>clearTimeout(_)}},[]);let[r,i]=(0,st.useState)(""),{liteContextMenuActionsItems:a,rootLiteContextMenu:s}=Hi(r,{contextMenuPath:"/my_own_tools",enabledFavorite:!1}),{createNewPrompt:l}=An(),{createNewGroup:p}=ci(),[u,c]=(0,st.useState)(!1),{refetch:m}=nn(),d=()=>{c(!0)},f=()=>{c(!1)},h=async()=>{let _=await on.deleteContextMenuNodes(a.map(g=>g.prompt_id));return _&&_.success&&_.data?.data?oo.error(o("package__features:chat__inputbox__my_own_tools__modal__all_prompts__delete_success")):oo.error(o("package__features:chat__inputbox__my_own_tools__modal__delete_error")),await m("onConfirmDeleteAllPrompt"),!0};return st.default.createElement(x,{sx:{height:"100%",overflow:"hidden",...e},tabIndex:-1},st.default.createElement(x,{direction:"row",alignItems:"center",sx:{p:2,gap:1,borderBottom:"1px solid",borderColor:"border.main"}},st.default.createElement(Ct,{fullWidth:!0,inputRef:n,placeholder:o("package__features:chat__inputbox__my_own_tools__modal__search_placeholder"),inputProps:{autocomplete:"off"},sx:{[`&  .${vl.input}`]:{boxSizing:"border-box",height:"32px",p:0,pl:1,fontSize:"16px",lineHeight:"1.5",fontWeight:400},[`& > .${vl.root} > fieldset`]:{borderColor:"transparent !important"}},onChange:_=>{i(_.target.value)}}),st.default.createElement(Ve,{onClick:t,sx:{p:"6px"}},st.default.createElement(Mv.default,{sx:{color:"text.secondary"}}))),!r&&st.default.createElement(x,{p:1,pb:0},st.default.createElement(ce,{onClick:()=>l({prompt_icon:"Shuriken"}),sx:{justifyContent:"flex-start",gap:2,px:2,py:1.5}},st.default.createElement(a2,{sx:{fontSize:20,color:"text.primary"}}),st.default.createElement(T,{fontSize:14,lineHeight:1.4,color:"text.primary",fontWeight:500,textAlign:"left"},o("package__features:chat__inputbox__my_own_tools__modal__new_prompt")))),!r&&st.default.createElement(x,{p:1,py:"6px",pr:1.5,direction:"row",alignItems:"center"},st.default.createElement(T,{fontSize:12,lineHeight:1.5,color:"text.secondary",fontWeight:500,textAlign:"left",p:1,flex:1},o("package__features:chat__inputbox__my_own_tools__modal__title")),st.default.createElement(x,{direction:"row",gap:"2px",alignItems:"center"},st.default.createElement(ne,{optionsMenuTriggerMode:"click",title:o("package__features:chat__inputbox__my_own_tools__modal__root_more_actions_button__tooltip"),placement:"bottom-end",tooltipProps:{disableInteractive:!0,disableFocusListener:!0,arrow:!0,placement:"top-end"},sx:e,OptionsCardProps:{sx:{width:"248px"}},onClick:_=>{_.stopPropagation()},onSelectOption:_=>{_==="delete"&&d()},options:[{value:"delete",icon:st.default.createElement(U,{icon:"Delete",sx:{color:a.length===0?"text.disabled":"rgba(255, 14, 39, 1)!important"}}),label:o("package__features:context_menu__lite_editor__modal__delete_all_prompts__button__delete"),labelSx:{color:a.length===0?"text.disabled":"rgba(255, 14, 39, 1)!important"},disabled:a.length===0}]},st.default.createElement(U,{icon:"More",size:20})),st.default.createElement(gv,{open:u,onClose:f,onConfirm:h}),st.default.createElement(ne,{title:o("package__features:chat__inputbox__my_own_tools__modal__new_folder_button__tooltip"),tooltipProps:{disableInteractive:!0,disableFocusListener:!0,arrow:!0,placement:"top-end"},sx:e,onClick:_=>{_.stopPropagation(),p({prompt_title:o("package__features:project__add_sources__modal__create_folder_modal__input_default_value")})}},st.default.createElement(i2,{sx:{fontSize:20}})))),a.length===0&&(r?st.default.createElement(x,{sx:{flexDirection:"row",justifyContent:"flex-start",gap:2,px:2,py:1.5}},st.default.createElement(wv.default,{sx:{color:_=>_.palette.mode==="dark"?"rgba(255, 255, 255, 0.3)":"rgba(0, 0, 0, 0.38)"}}),st.default.createElement(T,{sx:{fontSize:14,lineHeight:1.5,fontWeight:400,textAlign:"left",color:_=>_.palette.mode==="dark"?"rgba(255, 255, 255, 0.3)":"rgba(0, 0, 0, 0.38)"}},o("package__features:chat__inputbox__my_own_tools__modal__search_no_data"))):st.default.createElement(x,{sx:{height:"50px",justifyContent:"center",alignItems:"center"}},st.default.createElement(T,{sx:{fontSize:14,lineHeight:1.5,fontWeight:400,textAlign:"left",color:_=>_.palette.mode==="dark"?"rgba(255, 255, 255, 0.3)":"rgba(0, 0, 0, 0.38)"}},o("package__features:chat__inputbox__my_own_tools__modal__no_data")))),st.default.createElement(x,{sx:{flex:1,height:"0",overflow:"auto",paddingBottom:"16px"}},s&&st.default.createElement(Tv,{liteContextMenuActionsItems:a,rootLiteContextMenu:s,onClose:t})))},Ev=qF;var d1=I(w()),$F=({open:e,onClose:t})=>(Om((o,n)=>{o==="SyncContextMenuConversationInSidebar"&&e&&t?.()}),d1.default.createElement(Pa,{open:e,onClose:t,anchor:"bottom",sx:{zIndex:1502,position:"absolute",[`& .${Aa.paper}`]:{position:"absolute",borderTopRightRadius:16,borderTopLeftRadius:16,height:"90vh",bgcolor:"background.paper"}},disableEnforceFocus:!0,slotProps:{backdrop:{sx:{position:"absolute"}}}},d1.default.createElement(vn,{tabIndex:-1,onKeyDown:o=>{e&&o.key==="Escape"&&t?.()},elevation:0,sx:{boxSizing:"border-box",width:"100%",height:"100%",borderRadius:0}},e&&d1.default.createElement(Ev,{onClose:t})))),Av=$F;var f1=I(w()),XF=e=>{let[t,o]=(0,f1.useState)(!1),{inputMediator:n}=_e(),{chatHubLoading:r}=ot();return f1.default.createElement(t1,{disabled:r,open:t,onOpenChange:o,className:"max-ai__actions__button--use-max-ai",message:()=>n.getInputValue(),platformFeatureCover:"sidebar_input_rewrite",...e})},h1=XF;var Go=I(w()),YF=()=>{let{t:e}=E(),{inputMediator:t}=_e(),{selectedType:o,changeMyOwnToolsType:n,resetMyOwnToolsType:r}=Un(),{chatHubLoading:i}=ot(),[a,s]=(0,Go.useState)(!1),[l,p]=(0,Go.useState)(!1),u={SUGGESTED:"PromptMyOwnTools",MY_OWN_TOOLS:"PromptMyOwnTools",REWRITE:"Rewrite"},{changeContextMenuPath:c,changeMode:m}=uo(),{rewriteDisabled:d}=My(),{conversationId:f}=Bi(),h=tn(f),_=(0,Go.useRef)(),g=(0,Go.useMemo)(()=>a?!0:o!=="SUGGESTED",[a,o]),y=(0,Go.useMemo)(()=>[{value:"MY_OWN_TOOLS",testid:"maxai--chat-my-own-tools-button--my-own-tools",label:e("package__features:chat__inputbox__button__my_own_tools__menu__my_own_tools"),icon:Go.default.createElement(U,{icon:"PromptMyOwnTools"})},{value:"REWRITE",testid:"maxai--chat-my-own-tools-button--rewrite",label:e("package__features:chat__inputbox__button__my_own_tools__menu__rewrite"),title:d?e("package__features:home_view__chat_with_any_content__tab__rewrite__disabled_title"):null,disabled:d,ButtonProps:{key:`REWRITE-${d}`,tooltipProps:{placement:"right",disabled:!1}},icon:Go.default.createElement(U,{icon:"Rewrite"})}],[e,d]),C=(0,Go.useMemo)(()=>y.find(L=>a?L.value==="REWRITE":L.value===o),[a,o,y]),b=L=>{let H=L;o===H?r():n(H),t.updateInputValue(""),t.focus()},v=()=>{p(!0);let L=_h("MY_OWN_TOOLS");L&&c(L)},S=()=>{p(!1),c(null)};(0,Go.useEffect)(()=>{let L=_h(o);c(L||null),m("list")},[o]);let P=(0,Go.useRef)(!1),{refetch:k}=nn("/my_own_tools");return Go.default.createElement(B,{ref:_,position:"relative"},Go.default.createElement(zs,{disabled:i,testid:"maxai--chat-my-own-tools-button",defaultOptionValue:"MY_OWN_TOOLS",options:g?void 0:y,title:g?e(a?"package__features:chat__inputbox__button__my_own_tools__menu__rewrite":"package__features:chat__inputbox__button__my_own_tools__menu__my_own_tools"):null,tooltipProps:{disableInteractive:!0},placement:h.length===0?"bottom-end":"top-end",onClick:async()=>{if(g)r();else{if(!await Fe({emitEvent:!0}))return;v()}},onSelectOption:async L=>{if(L==="REWRITE")s(!0);else if(L==="MY_OWN_TOOLS"){if(!await Fe({emitEvent:!0}))return;v(),P.current||(P.current=!0,k("FirstClickMyToolsButton"))}else b(L)},OptionsCardProps:{sx:{width:"144px",marginLeft:"-12px"}},sx:{height:"32px",lineHeight:1.5,...g?{padding:"0 6px",gap:"6px",fontSize:"14px",bgcolor:"active.main",color:"active.contrastText","&:hover":{bgcolor:"active.hover",color:"active.hoverText"}}:{}}},Go.default.createElement(U,{icon:a?u.REWRITE:u[o]||u.SUGGESTED,sx:{...g?{color:"inherit !important"}:{}}})),Go.default.createElement(Av,{open:l,onClose:S}),Go.default.createElement(h1,{sx:{position:"absolute",top:0,left:0,opacity:0,zIndex:-1},open:a,onOpenChange:s,menuPlacement:"bottom-end",menuFallbackPlacements:["top-end"],tooltipPlacement:"top"}))},Pv=YF;var _u=I(w()),QF=()=>({chatScreenshots:re(t=>t.chatScreenshots)}),j0=()=>{let{uploadDocument:e}=WC(),{getChatHubState:t,setChatScreenshots:o}=re(s=>({getChatHubState:s.getChatHubState,setChatScreenshots:s.setChatScreenshots})),n=(0,_u.useCallback)(s=>{o(l=>{let p=[...l];return s.forEach(u=>{let c=p.findIndex(m=>m.id===m.id);c<0?p.push({...u}):p[c]={...p[c],...u}}),p})},[]),r=(0,_u.useCallback)(s=>{o(l=>l.filter(p=>!s.includes(p.id)))},[]),i=(0,_u.useCallback)(async s=>{if(!s.length)return;let{supportedFiles:l}=await kC(s,{maxCount:T2});if(!l.length)return;let p=await lc.isLogin(),u={},c=l.map(m=>{let d=Bo();u[d]=m.file;let f={id:d,title:m.file.name||"Chat file",status:"uploading",selected:!0,maxAIDocumentType:m.documentType,createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()};return p||(f.status="pending",f.preUploadMetadata={previewIcon:URL.createObjectURL(m.file)}),f});n(c),await Promise.all(c.map(async m=>{let{data:d,reason:f}=await ja.analyzeToDocument(u[m.id]);if(!d)return r([m.id]),oo.error(f,{autoHideDuration:3e3}),null;if(m.maxAIDocumentId=d.doc_id,m.maxAIDocumentType=d.doc_type,n([m]),!p&&!await Fe())return r([m.id]),null;let h=await e(d);t().chatScreenshots.find(g=>g.id===m.id)&&(h.success&&h.data?n([{...m,link:h.data.s3?.doc_url,status:"success",updatedAt:new Date().toISOString()}]):(r([m.id]),oo.error(h.message,{autoHideDuration:3e3})))}))},[]),a=(0,_u.useCallback)(()=>{o(()=>[])},[]);return{addOrUpdateChatScreenshots:n,removeChatScreenshots:r,uploadChatScreenshotFiles:i,removeAllChatScreenshots:a}},kv=()=>{let e=QF(),t=j0();return{...e,...t}};XM();YM();var ga=I(w()),Lv=I(ec()),JF=e=>{let{rootContainer:t,customElementName:o,children:n,style:r,checkVisibility:i=!0,onSetContainer:a}=e,[s,l]=(0,ga.useState)(null),p=(0,ga.useRef)(null);return(0,ga.useEffect)(()=>{if(t&&!s){if(i&&!Pl(t))return;let u="customElements"in window,c=document.createElement(u?o:"div");r&&(c.style.cssText=r),t.insertBefore(c,t.firstChild);let m=c.attachShadow({mode:"open"}),d=document.createElement("style"),f=document.createElement("div");m.appendChild(d),m.appendChild(f);let h=String(o).toLowerCase().replace(/_/g,"-");p.current=kx({key:`${h}-emotion-cache`,prepend:!0,container:d}),l(_=>(_&&_.getRootNode()?.host?.remove(),f))}else s&&!t&&l(null);return()=>{}},[t,s,o,i,r]),(0,ga.useEffect)(()=>{a&&s&&a(s)},[s,a]),!s||!p.current?null:(0,Lv.createPortal)(ga.default.createElement(Lx,{value:p.current},n),s)},Ov=JF;var Dv=I(uw());var Fn=I(w());var g1=I(w()),ll=I(w()),eH=e=>{let{onChange:t}=e,[o,n]=(0,ll.useState)(!1),r=(0,ll.useRef)([0,0]),[i,a]=(0,ll.useState)([0,0,0,0]),s=c=>{r.current=[c.clientX,c.clientY],n(!0)},l=c=>{if(o){let[m,d]=r.current,[f,h]=[c.clientX,c.clientY],[_,g,y,C]=[Math.min(m,f),Math.min(d,h),Math.abs(m-f),Math.abs(d-h)];a([_,g,y,C])}},p=async c=>{n(!1);let m=await e.getScreenshot();if(m){let d=document.createElement("canvas"),f=d.getContext("2d"),h=new Image;h.src=m,h.onload=()=>{let _=window.innerWidth,g=h.naturalWidth/_,[y,C,b,v]=i.map(P=>P*g);d.width=b,d.height=v,f?.drawImage(h,y,C,b,v,0,0,b,v);let S=d.toDataURL("image/png");d.toBlob(async P=>{if(P)t?.({image:S,rect:i,imageFile:new File([P],"screenshot.png",{type:"image/png"})});else{let k=await h2(S,"screenshot.png");t?.({image:S,rect:i,imageFile:k})}})}}},u=(0,ll.useMemo)(()=>{let[,,c,m]=[0,0,window.innerWidth,window.innerHeight],[d=0,f=0,h=0,_=0]=i;return[[0,0,h+d,f],[d+h,0,c-d-h,f+_],[0,f,d,m-f],[d,f+_,c-d,m-f-_]]},[i]);return g1.default.createElement(B,{onMouseDown:s,onMouseMove:l,onMouseUp:p,position:"fixed",sx:{width:"100vw",height:"100vh",top:0,left:0,zIndex:2147483647,cursor:"crosshair"}},g1.default.createElement(B,{sx:{position:"absolute",top:`${i[1]}px`,left:`${i[0]}px`,width:`${i[2]}px`,height:`${i[3]}px`,outline:"3px dashed",outlineColor:"#9065B0"}}),u.map((c,m)=>g1.default.createElement(B,{key:c.join(","),sx:{position:"absolute",top:c[1],left:c[0],width:c[2],height:c[3],backgroundColor:"rgba(0,0,0,0.3)"}})))},Bv=eH;var tH=e=>{let{getScreenshot:t,disabled:o,tooltip:n,sx:r}=e,i=Fn.default.useRef(null),{t:a}=E(),[s,l]=(0,Fn.useState)(null),{uploadChatScreenshotFiles:p}=j0(),{chatHubLoading:u}=ot(),{isUnavailableUploadSource:c}=Un(),m=o??(u||c);(0,Fn.useEffect)(()=>{function h(_){if(_.key==="Escape"){s?.remove(),l(null),e.onCropEnd?.();return}}return s&&window.addEventListener("keydown",h,!0),()=>{window.removeEventListener("keydown",h,!0)}},[s]);let d=(0,Fn.useMemo)(()=>n||(c?a("package__features:chat__inputbox__button__ai_screenshot__rewrite_disabled_tooltip"):m?"":a("package__features:chat__inputbox__button__ai_screenshot__tooltip")),[n,a,c,m]);return Fn.default.createElement(Fn.default.Fragment,null,Fn.default.createElement(he,{placement:"top",title:d,disableInteractive:!0},Fn.default.createElement(B,null,Fn.default.createElement(ne,{buttonRefBind:h=>i.current=h,disabled:m,"data-testid":"maxai-take-screenshot",tooltipProps:{disableInteractive:!0},onClick:async()=>{if(!await Fe({emitEvent:!0})||!Q2("7.4.1"))return;e.onCropStart?.();let h=document.createElement("div");h.style.width="100vw",h.style.height="100vh",h.style.position="fixed",h.style.zIndex="2147483647",document.body.appendChild(h),l(h)},sx:r},Fn.default.createElement(Dv.default,{sx:{transform:"rotate(-90deg)",fontSize:"20px"}})))),s&&!m&&Fn.default.createElement(Ov,{customElementName:"max-ai-screenshot",rootContainer:s},Fn.default.createElement(Bv,{getScreenshot:t||(()=>kl.getCurrentTabScreenshot()),onChange:async({imageFile:h})=>{if(s?.remove(),l(null),e.onCropEnd?.(),e.onFile){e.onFile(h);return}await p([h])}})))},Fv=tH;var Hv=I(Mi());var go=I(w());var oH=()=>go.default.createElement(Hv.default,null,go.default.createElement("svg",{width:"20",height:"20",viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg"},go.default.createElement("path",{d:"M10.7698 4.27077C10.7698 3.84616 10.4256 3.50195 10.001 3.50195C9.57637 3.50195 9.23216 3.84616 9.23216 4.27077V9.23314H4.26979C3.84519 9.23314 3.50098 9.57735 3.50098 10.002C3.50098 10.4266 3.84519 10.7708 4.26979 10.7708H9.23216V15.7331C9.23216 16.1577 9.57637 16.502 10.001 16.502C10.4256 16.502 10.7698 16.1577 10.7698 15.7331V10.7708H15.7322C16.1568 10.7708 16.501 10.4266 16.501 10.002C16.501 9.57735 16.1568 9.23314 15.7322 9.23314H10.7698V4.27077Z",fill:"currentColor"}))),nH=e=>{let{sx:t,...o}=e,{t:n}=E(),r=re(_=>_.chatDocuments),[i,a]=(0,go.useState)(null),[s,l]=Br(YC),{inputMediator:p}=_e(),{openSelectDocumentModal:u}=Dy(),c=r.filter(_=>_.link!==window.location.href&&_.id!==om&&_.selected),m=async()=>{u(!0),p.focus()},d=(0,go.useRef)(null);if((0,go.useEffect)(()=>(s?d.current=window.setTimeout(()=>{l(!1)},5e3):d.current&&window.clearTimeout(d.current),()=>{d.current&&window.clearTimeout(d.current)}),[s]),!c.length)return go.default.createElement(ne,{"data-testid":"maxai--chat-document-selector--button",title:n("package__features:home_view__chat_with_any_content__chat__chat_document_selector__button_title"),tooltipProps:{disableInteractive:!0},onClick:m,onMouseEnter:()=>{l(!1)},sx:{border:"1px solid",borderColor:"border.main",width:32,height:32,color:_=>_.palette.mode==="dark"?"#ffffff":"rgba(0, 0, 0, 0.87)",...t},...o,buttonRefBind:a},go.default.createElement(oH,null));let f=3,h=c.length;return go.default.createElement(go.default.Fragment,null,go.default.createElement(he,{title:n("package__features:chat__select_document_button__edit__tooltip"),disableInteractive:!0},go.default.createElement(x,{onMouseEnter:()=>{l(!1)}},go.default.createElement(Xa,{toRef:a,dataTestId:"maxai--chat-document-selector--button",mode:"normal",selected:!0,onClick:m,sx:{userSelect:"none",borderColor:"transparent",bgcolor:"active.main",color:"active.contrastText","&:hover":{bgcolor:"active.hover",color:"active.hoverText"},...t},...o},c.slice(0,f).map((_,g)=>go.default.createElement(x,{key:_.id,justifyContent:"center",alignItems:"center",sx:{width:20,height:20,border:"1px solid",borderRadius:12,ml:g>0?"-10px":0,bgcolor:y=>y.palette.mode==="light"?"rgba(182, 218, 239, 1)":"rgba(65, 108, 155, 1)",borderColor:y=>y.palette.mode==="light"?"rgba(213, 239, 255, 1)":"rgba(42, 74, 109, 1)","& > svg":{width:"12px",height:"12px",fontSize:"12px"},"& > img":{width:"12px",height:"12px"}}},go.default.createElement(VC,{documentType:_.maxAIDocumentType,file:{name:_.title},link:_.link,size:14}))),go.default.createElement(T,{ml:"-2px",fontSize:"13px",color:"inherit"},h===1?n("package__features:chat__select_sources__sources_singular__title",{COUNT:h}):n("package__features:chat__select_sources__sources_plural__title",{COUNT:h}))))),go.default.createElement(he,{open:s,title:n("package__features:chat__select_sources_error__maximum__text",{MAX_COUNT:U2}),placement:"top",arrow:!0,PopperProps:{anchorEl:i},sx:{maxWidth:240}},go.default.createElement(B,null)))},Nv=nH;var xa=I(w()),rH=({sx:e})=>{let{loaded:t,subscriptionType:o}=Tt(),{isLogin:n}=Mn(),{t:r}=E(),{getPlansInfoByType:i}=vm(),{showPricingUpgradeContentPopup:a}=iC(),s=i(Z2),l=!1,p=rC(),u=m=>{a("proactive_modal")},c=(0,xa.useMemo)(()=>(o==="monthly"||o==="quarterly")&&s.discount_title?r("package__features:pricing__save_to",{NUM:s.discount_title}):r("package__common:upgrade"),[r,o,s.discount_title]);return!t||!n||o==="yearly"||o==="oneTimePayment"?null:xa.default.createElement(xa.default.Fragment,null,xa.default.createElement(he,{title:p,disableInteractive:!0},xa.default.createElement(si,{"data-testid":"maxai--chat--upgrade-plan-button",variant:"contained",sx:{borderRadius:"9999px",p:"6px 12px 6px 8px",...e},loading:l,onClick:u},xa.default.createElement(Ju,{sx:{fontSize:20,color:"inherit"}}),xa.default.createElement(T,{ml:.5,my:0,fontSize:14,lineHeight:"20px",color:"text.primary",sx:{userSelect:"none",opacity:l?0:1,color:"inherit"}},c))))},zv=rH;var Vv=I(Xm());var Jn=I(w());var iH={position:"relative",width:56,height:56,flex:"0 0 56px",borderRadius:1,border:"1px solid",borderColor:"border.secondary",bgcolor:"background.default","& > .chat-screenshot-list-cancel-icon":{transition:"opacity 0.1s ease-in-out",position:"absolute",top:0,right:0,transform:"translate3d(50%, -50%, 0)",fontSize:"16px",zIndex:10,overflow:"visible",cursor:"pointer",color:"text.primary"}},aH=e=>{let{sx:t}=e,{artReferenceImages:o,removeArtReferenceImages:n,clearArtReferenceImages:r}=xy(),{AIModel:i}=Fo.use.art();(0,Jn.useEffect)(()=>{i!=="gpt-image-1"&&r()},[i]);let[a,s]=(0,Jn.useState)(),l=(0,Jn.useMemo)(()=>o.map(p=>({src:p.link||"",alt:p.title})),[o]);return i!=="gpt-image-1"||!o.length?null:Jn.default.createElement(B,{width:"100%",position:"relative",sx:t},Jn.default.createElement(Li,{hideMenu:!0,images:l,selectedImage:a,setSelectedImage:s}),Jn.default.createElement(x,{direction:"row",tabIndex:-1,mt:"-10px",pt:"10px",pr:"10px",sx:{gap:1,overflowX:"auto",boxSizing:"border-box",overflowY:"hidden",outline:"0px"}},o.map((p,u)=>{if(p.maxAIDocumentType==="image"){let c=p.preUploadMetadata?.previewIcon||p.link||"";return Jn.default.createElement(B,{key:p.id,sx:iH},Jn.default.createElement(Vr,{width:"100%",height:"100%",alt:p.title,src:c,SkeletonSx:{borderRadius:1},imageSx:{borderRadius:1,objectFit:"cover",cursor:"pointer"},onImageClick:()=>{s(p.link||"")}}),Jn.default.createElement(Vv.default,{className:"chat-screenshot-list-cancel-icon",onClick:()=>n([p.id])}),p.status==="uploading"&&Jn.default.createElement(B,{sx:{position:"absolute",zIndex:1,top:0,left:0,display:"flex",justifyContent:"center",alignItems:"center",height:"100%",width:"100%",bgcolor:"transparent",backdropFilter:"blur(2px)"}},Jn.default.createElement(Jt,{size:30,thickness:4})))}return null})))},Rv=aH;var Kt=I(w());var Uv=I(ir());var Ci=I(w()),sH=[{value:"prompt",testId:"input--big-text-paste-selector--prompt",labelI18nKey:"package__features:chat__big_text_paste__options__prompt"},{value:"source",testId:"input--big-text-paste-selector--source",labelI18nKey:"package__features:chat__big_text_paste__options__source"}],lH=e=>{let{text:t="",onConfirm:o,onClose:n,sx:r,...i}=e,{t:a}=E(),s=re(h=>h.conversationType),{createNewPrompt:l}=An(),{changeMyOwnToolsType:p}=Un(),{setTemplate:u}=Fi(),{handleUploadFiles:c}=hy(),m=o??(h=>{if(h==="prompt")p("MY_OWN_TOOLS"),l(),u(kt(s).getInputValue()+t);else if(h==="source"){let _=new File([t],Jp().t("package__features:home_view__chat_with_any_content__chat__chat_document_selector__chip__pasted__title",{fileName:`text ${mC()}.txt`}),{type:"text/plain"});c([_])}}),d=()=>{n?.({},"closeClick")},f=h=>{m?.(h),n?.({},"confirmClick")};return Ci.default.createElement(Ti,{onClose:n,sx:{position:"absolute",...r},slotProps:{backdrop:{sx:{position:"absolute"}}},...i},Ci.default.createElement(B,{sx:{outline:"none",position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",minWidth:"min(448px, calc(100% - 32px))",maxWidth:"min(calc(1168px - 32px), calc(100% - 32px))",maxHeight:"calc(100% - 32px)",overflow:"auto",backgroundColor:"background.paper",boxSizing:"border-box",borderRadius:"16px",width:"448px",padding:"24px"}},Ci.default.createElement(x,{sx:{flexDirection:"row",justifyContent:"center",alignItems:"center",position:"relative",height:"24px"}},Ci.default.createElement(Qu,{sx:{color:"text.primary"}}),Ci.default.createElement(Ve,{sx:{position:"absolute",right:0,top:0,width:"24px",height:"24px"},onClick:d},Ci.default.createElement(Uv.default,{sx:{color:"text.secondary"}}))),t&&Ci.default.createElement(B,{sx:{boxSizing:"border-box",padding:"12px",border:h=>`1px solid ${h.palette.border.main}`,borderRadius:"8px",marginTop:"16px"}},Ci.default.createElement(T,{sx:{width:"100%",overflow:"hidden",textOverflow:"ellipsis",display:"-webkit-box",WebkitLineClamp:3,WebkitBoxOrient:"vertical",fontWeight:400,fontSize:"16px",lineHeight:"150%",color:"text.tertiary"}},t)),Ci.default.createElement(x,{sx:{gap:1,marginTop:"24px"}},sH.map(h=>Ci.default.createElement(ce,{variant:"contained",onClick:()=>f(h.value),"data-testid":h.testId,sx:{padding:"10px 16px",lineHeight:"20px"}},a(h.labelI18nKey))))))},Wv=lH;var pH=e=>{let{headerNode:t,headerLeftNode:o,headerRightNode:n,footerNode:r,footerLeftNode:i,footerRightNode:a,minLine:s=3,error:l,textareaProps:p,sx:u,defaultValue:c,sendButtonProps:m}=e,{t:d}=E(),{conversationId:f,conversationType:h}=re(Q=>({conversationId:Q.conversationIds[0],conversationType:Q.conversationType})),{askAIQuestionV2:_,askAIQuestion:g}=Ne(),{getConversationLoading:y}=qe(),{betaSettings:C}=En(),b=ql(),{loading:v}=$a(),{pastedBigText:S,setPastedBigText:P,handlePasteEvent:k,handleAIArtInputPasteEvent:L}=Iy(),{AIModel:H}=Fo.use.art(),W=(0,Kt.useMemo)(()=>{if(h==="Summary")switch(t_()){case"PAGE_SUMMARY":return d("package__features:chat__input__summary_page__placeholder");case"YOUTUBE_VIDEO_SUMMARY":return d("package__features:chat__input__summary_video__placeholder");case"DEFAULT_EMAIL_SUMMARY":return d("package__features:chat__input__summary_email__placeholder");case"PDF_CRX_SUMMARY":return d("package__features:chat__input__summary_pdf__placeholder");default:return d("package__features:chat__input__summary_page__placeholder")}return d(h==="Search"?"package__features:chat__input__search__placeholder":h==="Art"?"package__features:chat__input__art__placeholder":"package__features:chat__input__chat__placeholder")},[h,d]),O=b.getInputValue();(0,Kt.useEffect)(()=>{let Q=M=>{let K=M.detail?.value;K&&(C?.appearance_v2_enabled||h==="Art"?_({type:"user",text:K,meta:{includeHistory:!0}}):g({type:"user",text:K,meta:{includeHistory:!0}}))};return j8("MAXAI_CLIENT__CHAT_INPUT__SEND_MESSAGE",Q),()=>{K8("MAXAI_CLIENT__CHAT_INPUT__SEND_MESSAGE",Q)}},[_,g]);let D=async()=>{if(!b.isComposing){if(!await Fe({emitEvent:!0})){b.focus();return}v||await y(f)||O&&(C?.appearance_v2_enabled||h==="Art"?_({type:"user",text:O,meta:{includeHistory:!0}}):g({type:"user",text:O,meta:{includeHistory:!0}}))}};(0,Kt.useEffect)(()=>{if(b.ref){let Q=b.getInputValue();b.focus(),b.ref?.setSelectionRange(Q.length,Q.length)}},[f,b]),(0,Kt.useEffect)(()=>{c&&b.updateInputValue(c)},[c]);let[V,N]=(0,Kt.useState)(!1),[z,j]=(0,Kt.useState)(!1),G=Kt.default.createElement(Kt.default.Fragment,null,V?null:a,Kt.default.createElement(ps,{value:{isVoiceInput:V,setIsVoiceInput:N}},Kt.default.createElement(yp,{voiceButtonProps:{onStartRecording:()=>{j(!0)},onStopRecording:Q=>{Q!=="done"&&j(!1)},onSpeechToTextFinally:()=>{j(!1)}},...m}))),{disabled:q,...A}=p||{},Y=q||z;return Kt.default.createElement(Kt.default.Fragment,null,Kt.default.createElement(x,{direction:"column",width:"100%",borderRadius:1,border:"1px solid",borderColor:`${l?"rgb(239, 83, 80)":"border.main"}`,boxShadow:"0px 1px 2px 0px rgba(0, 0, 0, 0.05)",boxSizing:"border-box",sx:{"& > *":{order:1},...u}},t,Kt.default.createElement(B,{"data-testid":"maxai--chat-box--chat-input--main",sx:{p:"10px"}},o||n?Kt.default.createElement(B,{"data-testid":"maxai--chat-box--chat-input--main-header",display:"flex",alignItems:"center",justifyContent:"space-between"},Kt.default.createElement(x,{direction:"row",spacing:.5,flex:1,mb:1,sx:{"&:empty":{display:"none"}}},o),Kt.default.createElement(x,{direction:"row",spacing:.5,mb:1,sx:{"&:empty":{display:"none"}}},n)):null,Kt.default.createElement(bp,{ref:Q=>b.bindRef(Q),"data-testid":"chat-input-textarea","data-disabled-button-clicked":!0,value:O,placeholder:W,minLine:s,onChangeText:Q=>b.updateInputValue(Q),onPaste:Q=>{b.emit("onPaste",Q),h==="Art"?H==="gpt-image-1"&&L(Q):k(Q)},onEnter:D,onCompositionStart:()=>b.setIsComposing(!0),onCompositionEnd:()=>b.setIsComposing(!1),stopPropagation:!0,disabled:Y,...A}),i||G?Kt.default.createElement(B,{display:"flex",alignItems:"center",justifyContent:"space-between",mt:1},!V&&Kt.default.createElement(x,{direction:"row",spacing:.5},i),Kt.default.createElement(x,{direction:"row",spacing:1,flex:1,justifyContent:"flex-end",overflow:"hidden"},G)):null),r),Kt.default.createElement(Wv,{open:!!S,text:S,onClose:()=>P("")}))},Gv=pH;var jv=I(Xm());var yi=I(w()),cH={position:"relative",width:56,height:56,borderRadius:1,border:"1px solid",borderColor:"border.secondary",bgcolor:"background.default","& > .chat-screenshot-list-cancel-icon":{opacity:1,transition:"opacity 0.1s ease-in-out",position:"absolute",top:0,right:0,transform:"translate3d(50%, -50%, 0)",fontSize:"16px",zIndex:10,overflow:"visible",cursor:"pointer",color:"text.primary"}},uH=e=>{let{sx:t}=e,{t:o}=E(),{chatScreenshots:n,removeChatScreenshots:r,removeAllChatScreenshots:i}=kv();return(0,yi.useEffect)(()=>{if(n.length>0){let a=()=>{i()};return Ah.addListener("MAXAI_PROJECT_UPLOAD_SUCCESS",a),()=>{Ah.removeListener("MAXAI_PROJECT_UPLOAD_SUCCESS",a)}}},[n.length]),n.length?yi.default.createElement(B,{className:"maxai-chat-screenshot-list-view",width:"100%",position:"relative",sx:t},yi.default.createElement(x,{direction:"row",tabIndex:-1,mt:"-10px",pt:"10px",pr:"10px",sx:{gap:1,overflowX:"auto",boxSizing:"border-box",overflowY:"hidden",scrollbarColor:"auto","&::-webkit-scrollbar":{height:0,width:0,background:"transparent",display:"none"},"&::-webkit-scrollbar-thumb":{background:"transparent"}}},n.map((a,s)=>{if(a.maxAIDocumentType==="image"){let l=a.preUploadMetadata?.previewIcon||a.link||"";return yi.default.createElement(B,{key:a.id,sx:cH},yi.default.createElement(Vr,{width:"100%",height:"100%",alt:a.title,src:l,SkeletonSx:{borderRadius:1},imageSx:{borderRadius:1,objectFit:"cover",cursor:"pointer"},onImageClick:()=>{a.maxAIDocumentId&&ja.previewDocument(a.maxAIDocumentId,{documentType:a.maxAIDocumentType,title:a.title,url:a.link})}}),yi.default.createElement(he,{disableInteractive:!0,title:o("package__features:chat__select_document_button__remove__tooltip")},yi.default.createElement(jv.default,{className:"chat-screenshot-list-cancel-icon",onClick:()=>r([a.id])})),a.status==="uploading"&&yi.default.createElement(B,{sx:{position:"absolute",zIndex:1,top:0,left:0,display:"flex",justifyContent:"center",alignItems:"center",height:"100%",width:"100%",bgcolor:"transparent",backdropFilter:"blur(2px)"}},yi.default.createElement(Jt,{size:30,thickness:4})))}return null}))):null},Kv=uH;var qv=I(ir());var pl=I(w()),mH=e=>{let{sx:t}=e,{selectionContent:o,setSelectionContent:n}=re(r=>({selectionContent:r.selectionContent,setSelectionContent:r.setSelectionContent}));return o?pl.default.createElement(x,{width:"100%",border:"1px solid",borderColor:"border.main",borderRadius:1,p:"10px",sx:t},pl.default.createElement(x,{direction:"row",justifyContent:"space-between",gap:1},pl.default.createElement(T,{fontSize:"14px",color:"text.secondary"},"Text from your selection"),pl.default.createElement(ne,{sx:{width:20,height:20,borderRadius:.5},onClick:()=>n(null)},pl.default.createElement(qv.default,{sx:{fontSize:"16px!important"}}))),pl.default.createElement(T,{fontSize:"14px",color:"text.tertiary",sx:{display:"-webkit-box",WebkitBoxOrient:"vertical",WebkitLineClamp:2,overflow:"hidden",textOverflow:"ellipsis"}},o.selectedText)):null},$v=mH;var Xv=I(rw());var xn=I(w()),x1=[{title:"package__features:home_view__chat_with_any_content__chat__chat_document_selector__add_sources__file__title",icon:xn.default.createElement(na,{sx:{fontSize:"20px"},icon:"File"}),addContextType:"files",testid:"maxai--chat-document-selector--modal--preset-button--files"},{title:"package__features:home_view__chat_with_any_content__chat__chat_document_selector__add_sources__text__title",icon:xn.default.createElement(na,{sx:{fontSize:"20px"},icon:"Text"}),addContextType:"text",testid:"maxai--chat-document-selector--modal--preset-button--text"},{title:"package__features:home_view__chat_with_any_content__chat__chat_document_selector__choose_sources__urls__title",icon:xn.default.createElement(na,{sx:{fontSize:"20px"},icon:"URLs"}),addContextType:"urls",testid:"maxai--chat-document-selector--modal--preset-button--urls"}],Yv=[{chatDocumentId:om,title:"package__features:home_view__chat_with_any_content__chat__chat_document_selector__chip__search__title",icon:xn.default.createElement(na,{sx:{fontSize:"20px"},icon:"Search"}),addContextType:"search",testid:"maxai--chat-document-selector--modal--preset-button--search"}],dH=e=>{let{t}=E(),{chatDocuments:o}=jl(),{dataList:n,activeIndex:r,onSelect:i,showEnterIcon:a=!1}=e;return xn.default.createElement(Dr,{sx:{p:0,overflowY:"auto",position:"relative",width:"100%",gap:"2px"}},n.map((s,l)=>{let p=r===l,u=o.find(d=>d.id===s.chatDocumentId),c=u?.selected,m=location.href===u?.link?[t("package__features:home_view__chat_with_any_content__chat__chat_document_selector__chip__current__title")]:[];return xn.default.createElement(ct,{disabled:s.disabled,key:l,selected:p,onClick:()=>i&&i(s,l,n),sx:{p:"1px 0",width:"calc(100% - 12px)",left:"6px",borderRadius:"6px",minHeight:"unset"},"data-testid":s.testid||`maxai--chat-document-selector--modal--existing-document-button--${u?.maxAIDocumentType||"chat_file"}`},xn.default.createElement(he,{zIndex:2147483621,title:s.tooltip||"",placement:"left",PopperProps:{modifiers:[{name:"flip",enabled:!0,options:{fallbackPlacements:["top","right"]}}],sx:{[`&.${Vn.popper}[data-popper-placement*="left"] > .${Vn.tooltip}`]:{mr:"20px"}}}},xn.default.createElement(x,{direction:"row",sx:{alignItems:"center",p:1,borderRadius:"8px",gap:"12px",position:"relative",width:"100%","& > button:last-of-type":{display:"none"},"&:hover":{"& > button:last-of-type":{display:"block"}}}},c&&xn.default.createElement(B,{sx:{position:"absolute",width:"3px",height:"100%",left:"-6px",top:0,backgroundColor:"primary.main"}}),xn.default.createElement(tc,{sx:{width:"20x",height:"20px",minWidth:"20px!important",flexShrink:0}},u?xn.default.createElement(Hm,{size:20,chatDocument:u}):s.icon),xn.default.createElement(x,{direction:"row",gap:"4px",width:0,flex:1},xn.default.createElement(T,{width:0,flex:1,noWrap:!0,sx:{textAlign:"left",fontSize:"14px",color:"text.primary"}},t(s.title)," ",s.disabled?" (TODO)":""),xn.default.createElement(x,{direction:"row",gap:"4px",alignItems:"center",component:"div",flexShrink:0},m.map(d=>xn.default.createElement(ky,{key:d,sx:{color:"text.secondary"},label:d})))),p&&a&&xn.default.createElement(Xv.default,{sx:{flexShrink:0,fontSize:"16px",color:"text.secondary"}}),s.suffix)))}))},Zv=dH;var cl=I(w()),fH=e=>{let{onAddContextClick:t,disabled:o}=e,{t:n}=E(),{selectedChatDocuments:r,toggleSelectedChatDocument:i,setChatDocuments:a}=jm(),{chatHubLoading:s}=ot(),l=(0,cl.useMemo)(()=>ai(r,["createdAt"],["desc"]).sort((u,c)=>u.link===window.location.href?-1:c.link===window.location.href?1:0),[r]),p=u=>{u.status==="uploading"?a(c=>c.filter(m=>m.id!==u.id)):i(u.id)};return l.length>0?cl.default.createElement(cl.default.Fragment,null,l.map(u=>cl.default.createElement(Xl,{disabled:s,dataTestId:"maxai--chat-document-selector--selected-document-button",key:u.id,onClose:()=>{p(u)},showClose:!0,chatDocument:u}))):cl.default.createElement(T,{fontSize:"14px",sx:{color:o?"action.disabled":"text.secondary",userSelect:"none"},onClick:t},n("package__features:home_view__chat_with_any_content__chat__chat_document_selector__add_sources__title"))},Qv=fH;var Zr=I(w()),hH=rr(Vx)(({theme:e})=>({fontFamily:e.typography.fontFamily,width:"100%",display:"block",padding:"16px",boxSizing:"border-box",fontSize:"16px",backgroundColor:"transparent",border:"none",outline:"none",resize:"none",lineHeight:"1.5",color:e.palette.text.primary,scrollbarColor:e.palette.mode==="dark"?"rgba(255, 255, 255, 0.6) transparent":"rgba(0, 0, 0, 0.6) transparent"})),Jv=(0,Zr.forwardRef)(({minHeight:e,maxHeight:t,style:o,...n},r)=>{let i=(0,Zr.useRef)(null),[a,s]=(0,Zr.useState)(null);(0,Zr.useEffect)(()=>{if(i.current){let u=window.getComputedStyle(i.current),c=parseInt(u.lineHeight,10)||parseInt(u.height,10),m=parseInt(u.paddingTop,10),d=parseInt(u.paddingBottom,10);s({lineHeight:c,paddingY:m+d})}},[]);let{minRows:l,maxRows:p}=(0,Zr.useMemo)(()=>{if(!a||!e)return{minRows:void 0,maxRows:void 0};let{lineHeight:u,paddingY:c}=a,m=Math.max(Math.ceil((e-c)/u),1),d=t?Math.max(Math.ceil((t-c)/u),m):void 0;return{minRows:m,maxRows:d}},[a,e,t]);return Zr.default.createElement(hH,{ref:u=>{typeof r=="function"?r(u):r&&(r.current=u),i.current=u},minRows:l,maxRows:p,style:o,...n})});Jv.displayName="MaxAITextareaAutosize";var e7=Jv;var Pr=I(w()),gH=e=>{let{t}=E(),o=Pr.default.useRef(null),[n,r]=(0,Pr.useState)(""),{show:i,BackdropTransparent:a,onClose:s,onConfirm:l,onBack:p}=e,u=f=>{r(""),s(f)};(0,Pr.useEffect)(()=>{i&&(setTimeout(()=>{o.current?.focus()},0),setTimeout(()=>{o.current?.focus()},100))},[i]);let c=(0,Pr.useCallback)(f=>{r(f.target.value)},[]),m=(0,Pr.useCallback)(()=>{l?.(n),u()},[l,n,u]),d=(0,Pr.useCallback)(f=>{f.key!=="Escape"&&f.stopPropagation()},[]);return Pr.default.createElement(Wr,{confirmBtnTextId:"maxai--project--paste-text-modal--confirm-button",show:i,BackdropTransparent:a,onClose:u,title:t("package__features:home_view__chat_with_any_content__chat__chat_document_selector__paste_text__title"),confirmBtnDisabled:n.trim()==="",onConfirm:m,onBack:p},Pr.default.createElement(x,{sx:{borderTop:"1px solid",borderBottom:"1px solid",borderColor:"border.main"}},Pr.default.createElement(e7,{ref:o,value:n,onChange:c,onKeyDown:d,placeholder:t("package__features:home_view__chat_with_any_content__chat__chat_document_selector__paste_text__placeholder"),minHeight:269,maxHeight:511})))},t7=gH;var Eo=I(w()),xH={INVALID_URL:"package__features:home_view__chat_with_any_content__chat__chat_document_selector__paste_url__error__invalid_url",EXISTS_URL:"package__features:home_view__chat_with_any_content__chat__chat_document_selector__paste_url__error__exists_url",TOO_MUCH_URL:"package__features:home_view__chat_with_any_content__chat__chat_document_selector__paste_url__error__too_much_url"},o7=()=>({INVALID_URL:!1,EXISTS_URL:!1,TOO_MUCH_URL:!1}),_H=e=>{let{t}=E(),{show:o,BackdropTransparent:n,onClose:r,onChange:i,onBack:a}=e,[s,l]=(0,Eo.useState)(""),[p,u]=(0,Eo.useState)(o7),{chatDocuments:c}=jl(),[m,d]=(0,Eo.useState)([]),f=(0,Eo.useRef)(null),h=(0,Eo.useRef)(!1),_=(0,Eo.useMemo)(()=>{let b=Object.keys(p).find(v=>p[v]);return b?t(xH[b]):""},[p,t]),g=(0,Eo.useMemo)(()=>m.length===0||_!=="",[m,_]),y=b=>{let v=c.map(k=>k.link).concat(m.map(k=>k.link)),S=b.map(k=>k.startsWith("http")?k:`https://${k}`).filter(k=>!v.includes(k));if(S.length===0){u(k=>({...k,EXISTS_URL:!0}));return}u(k=>({...k,EXISTS_URL:!1}));let P=S.map(k=>({id:Bo(),status:"idle",title:k,link:k,maxAIDocumentType:"page_content__webpage"}));d(k=>k.concat(P))};return(0,Eo.useEffect)(()=>{o&&(setTimeout(()=>{f.current?.focus()},0),setTimeout(()=>{f.current?.focus()},100))},[o]),(0,Eo.useEffect)(()=>{m.length>M2?u(b=>({...b,TOO_MUCH_URL:!0})):u(b=>({...b,TOO_MUCH_URL:!1}))},[m]),Eo.default.createElement(Wr,{confirmBtnTextId:"maxai--project--paste-url-modal--confirm-button",show:o,BackdropTransparent:n,onClose:b=>{l(""),d([]),r(b),u(o7)},title:t("package__features:home_view__chat_with_any_content__chat__chat_document_selector__paste_url__modal__title"),confirmBtnText:t("package__features:home_view__chat_with_any_content__chat__chat_document_selector__modal__done__title"),cancelBtnText:t("package__features:home_view__chat_with_any_content__chat__chat_document_selector__modal__cancel__title"),confirmBtnDisabled:g,onConfirm:()=>(i?.(m.map(b=>b.link)),!0),onBack:a},Eo.default.createElement(x,{sx:{padding:"24px",gap:"8px",maxHeight:"264px",boxSizing:"border-box",borderTop:"1px solid",borderBottom:"1px solid",borderColor:"border.main"}},m.length>0&&Eo.default.createElement(x,{direction:"row",gap:"8px",flexWrap:"wrap"},m.map(b=>Eo.default.createElement(Xl,{showClose:!0,key:b.id,onClose:()=>{d(v=>v.filter(S=>S.id!==b.id))},chatDocument:b}))),Eo.default.createElement(B,{component:"textarea",ref:f,value:s,onCompositionStart:b=>{h.current=!0},onCompositionEnd:b=>{h.current=!1,l(b.currentTarget.value)},onKeyDown:b=>{if(b.key!=="Escape"&&b.stopPropagation(),b.key==="Enter"||b.code==="Space"){if(h.current)return;let v=s.trim();Zp(v)&&(y([v]),u(S=>({...S,INVALID_URL:!1})),l(""),b.preventDefault())}},onChange:b=>{l(b.target.value)},onPaste:b=>{let P=b.clipboardData.getData("text").trim().split(`
`).filter(k=>Zp(k));P.length>0?(y(P),u(k=>({...k,INVALID_URL:!1}))):u(k=>({...k,INVALID_URL:!0})),l(""),b.preventDefault()},placeholder:t("package__features:home_view__chat_with_any_content__chat__chat_document_selector__paste_url__placeholder"),sx:{fontFamily:b=>b.typography.fontFamily,display:"block",width:"100%",height:"232px",padding:"0",fontSize:"16px",boxSizing:"border-box",border:"none",outline:"none",backgroundColor:"transparent",resize:"none",color:"text.primary",lineHeight:"1.5",scrollbarColor:b=>b.palette.mode==="dark"?"rgba(255, 255, 255, 0.6) transparent":"rgba(0, 0, 0, 0.6) transparent"}})),_&&Eo.default.createElement(x,{sx:{gap:"4px",padding:"16px"}},Eo.default.createElement(Ly,{errorText:_})))},n7=_H;var K0=I(w()),CH=e=>{let{chatDocuments:t}=jl(),o=(0,K0.useMemo)(()=>{let n=De(Yv);return ai(t,["createdAt"],["asc"]).forEach(i=>{if(i.hidden)return;let a={title:i.title,tooltip:i.title,addContextType:"document",link:i.link,chatDocumentId:i.id};a.link===window.location.href?n.unshift(a):n.push(a)}),n},[t]);return(0,K0.useMemo)(()=>{if(!e)return{showTitle:!0,chatDocumentsMenuList:o,filteredMenuList:x1,matchCount:x1.length};let n=x1.filter(i=>i.title.toLowerCase().includes(e.toLowerCase()));if(n.length)return{showTitle:!1,chatDocumentsMenuList:[],filteredMenuList:n,matchCount:n.length};let r=o.filter(i=>i.title.toLowerCase().includes(e.toLowerCase()));return{showTitle:!1,chatDocumentsMenuList:[],filteredMenuList:r,matchCount:r.length}},[e,o])},r7=CH;var s7=I(Mi());var Ce=I(w());var to=I(w()),i7=I(ir());var yH=[{value:"prompt",testId:"input--big-text-paste-selector--prompt",labelI18nKey:"package__features:chat__big_text_paste__options__prompt"},{value:"source",testId:"input--big-text-paste-selector--source",labelI18nKey:"package__features:chat__big_text_paste__options__source"}],bH=(0,to.forwardRef)((e,t)=>{let{t:o}=E(),[n,r]=(0,to.useState)(!1),[i,a]=(0,to.useState)(""),s=(0,to.useRef)(),l=(0,to.useCallback)(()=>{r(!1),s.current?.resolve(!1)},[]),p=(0,to.useCallback)(c=>{r(!1),s.current?.resolve(c)},[]),u=(0,to.useCallback)(async c=>(r(!0),a(c),new Promise((m,d)=>{s.current={resolve:m,reject:d}})),[]);return(0,to.useImperativeHandle)(t,()=>({confirmSelect:u})),to.default.createElement(Ti,{open:n,onClose:l,sx:{position:"absolute"},slotProps:{backdrop:{sx:{position:"absolute"}}}},to.default.createElement(B,{sx:{outline:"none",position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",minWidth:"min(448px, calc(100% - 32px))",maxWidth:"min(calc(1168px - 32px), calc(100% - 32px))",maxHeight:"calc(100% - 32px)",overflow:"auto",backgroundColor:"background.paper",boxSizing:"border-box",borderRadius:"16px",width:"448px",padding:"24px"}},to.default.createElement(x,{sx:{flexDirection:"row",justifyContent:"center",alignItems:"center",position:"relative",height:"24px"}},to.default.createElement(Qu,{sx:{color:"text.primary"}}),to.default.createElement(Ve,{sx:{position:"absolute",right:0,top:0,width:"24px",height:"24px"},onClick:l},to.default.createElement(i7.default,{sx:{color:"text.secondary"}}))),i&&to.default.createElement(B,{sx:{boxSizing:"border-box",padding:"12px",border:c=>`1px solid ${c.palette.border.main}`,borderRadius:"8px",marginTop:"16px"}},to.default.createElement(T,{sx:{width:"100%",overflow:"hidden",textOverflow:"ellipsis",display:"-webkit-box",WebkitLineClamp:3,WebkitBoxOrient:"vertical",fontWeight:400,fontSize:"16px",lineHeight:"150%",color:"text.tertiary"}},i)),to.default.createElement(x,{sx:{gap:1,marginTop:"24px"}},yH.map(c=>to.default.createElement(ce,{variant:"contained",onClick:()=>p(c.value),"data-testid":c.testId,sx:{padding:"10px 16px",lineHeight:"20px"}},o(c.labelI18nKey))))))}),a7=bH;var IH=e=>{let{t}=E(),{hideFileList:o=!1}=e,n=Ce.default.useRef(null),r=(0,Ce.useRef)(null),{createNewPrompt:i}=An(),{setTemplate:a}=Fi(),[s,l]=(0,Ce.useState)(!1),[p,u]=(0,Ce.useState)(!1),[c,m]=(0,Ce.useState)(!1),[d,f]=(0,Ce.useState)(0),[h,_]=(0,Ce.useState)(""),g=re(F=>F.conversationType),{chatHubLoading:y}=ot(),{chatDocuments:C,toggleSelectedChatDocument:b,handleUploadFilesToChatDocuments:v,handleUploadLinksToChatDocuments:S,toggleMaxAISearchFeature:P}=jm(),k=(0,Ce.useMemo)(()=>C.map(F=>F.link),[C]),L=(0,Ce.useRef)(k);(0,Ce.useEffect)(()=>{L.current=k},[k]);let{isUnavailableUploadSource:H,changeMyOwnToolsType:W}=Un(),O=(0,Ce.useMemo)(()=>y||H,[H,y]),{showTitle:D,chatDocumentsMenuList:V,filteredMenuList:N,matchCount:z}=r7(h),j=(0,Ce.useCallback)(F=>{let pe=F.key==="ArrowUp",ae=F.key==="ArrowDown",te=0,Te=z-1;return z&&(pe||ae)?(F.preventDefault(),F.stopPropagation(),f(Ie=>pe?Ie-1<0?Te:Ie-1:Ie+1>Te?te:Ie+1),!0):!1},[z]),G=(0,Ce.useRef)(j);(0,Ce.useEffect)(()=>{G.current=j},[z]);let q=(0,Ce.useRef)(s);(0,Ce.useEffect)(()=>{f(0),q.current=s},[N,s]),(0,Ce.useEffect)(()=>{let F=kt(g).ref;if(F&&!1){let te=Ie=>{if(Ie.key==="@"){l(!0);return}if(Ie.key==="Escape"){l(!1);return}q.current&&G.current(Ie)},Te=Ie=>{let Nt=Ie.key==="ArrowUp",lt=Ie.key==="ArrowDown";if((Nt||lt)&&q.current&&z>0)return;let Le=F.selectionStart,nt=F.value;if(Le){let At=nt.slice(0,Le),Ze=[],dt=At.indexOf("@");for(;dt!==-1;)Ze.push(dt),dt=At.indexOf("@",dt+1);let It=Ze.reverse().find(Zt=>Zt<Le);if(It!==void 0){let Zt=At.slice(It+1);l(!0),_(Zt);return}}_(""),l(!1)};return F.addEventListener("keydown",te,{capture:!0}),F.addEventListener("keyup",Te,{capture:!0}),()=>{F.removeEventListener("keydown",te,{capture:!0}),F.removeEventListener("keyup",Te,{capture:!0})}}let ae=async te=>{if(O)return;let Te=te.clipboardData?.getData("text").trim();if(Te){if(Te.length>=8e3){if(te.preventDefault(),te.stopPropagation(),!await Fe({emitEvent:!0}))return;let Ie=kt(g);switch(await r.current?.confirmSelect(Te)){case"prompt":{W("MY_OWN_TOOLS"),i(),a(Ie.getInputValue()+Te);return}break;case"source":{te.preventDefault(),te.stopPropagation();let Nt=new File([Te],t("package__features:home_view__chat_with_any_content__chat__chat_document_selector__chip__pasted__title",{fileName:"text.txt"}),{type:"text/plain"});await v([Nt]);return}default:break}}if(Zp(Te,!0)&&!L.current.includes(Te)){te.preventDefault(),te.stopPropagation(),await S([Te]);return}}};return kt(g).addListener("onPaste",ae),()=>{kt(g).removeListener("onPaste",ae)}},[g,O]);let A=()=>{if(O)return;l(!s);let F=kt(g).ref;F&&F.focus()},Y=async()=>{let F=await x2({accept:w2});F.length>0&&(await v(F),l(!1))},Q=async()=>{u(!0)},M=async()=>{m(!0)},K=async F=>{if(await Fe({emitEvent:!0}))switch(F){case"file":await Y();break;case"text":await Q();break;case"url":await M();break}};return Ce.default.createElement(B,{sx:{position:"relative"}},Ce.default.createElement(x,{direction:"row",alignItems:"center",gap:"8px",flexWrap:"wrap"},Ce.default.createElement(he,{placement:"top",title:H?t("package__features:home_view__chat_with_any_content__chat__chat_document_selector__button__unavailable__tooltip"):void 0,disableInteractive:!0},Ce.default.createElement(x,null,Ce.default.createElement(ne,{disabled:O,"data-testid":"maxai--chat-document-selector--button",title:t("package__features:home_view__chat_with_any_content__chat__chat_document_selector__button_title"),onClick:A,buttonRefBind:F=>{n.current=F},sx:{color:F=>F.palette.mode==="dark"?"#ffffff":"rgba(0, 0, 0, 0.87)"},tooltipProps:{disableInteractive:!0}},Ce.default.createElement(s7.default,null,Ce.default.createElement("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},Ce.default.createElement("path",{d:"M13.1002 3.8002C13.1002 3.19268 12.6077 2.7002 12.0002 2.7002C11.3927 2.7002 10.9002 3.19268 10.9002 3.8002V10.9002H3.8002C3.19268 10.9002 2.7002 11.3927 2.7002 12.0002C2.7002 12.6077 3.19268 13.1002 3.8002 13.1002H10.9002V20.2002C10.9002 20.8077 11.3927 21.3002 12.0002 21.3002C12.6077 21.3002 13.1002 20.8077 13.1002 20.2002V13.1002H20.2002C20.8077 13.1002 21.3002 12.6077 21.3002 12.0002C21.3002 11.3927 20.8077 10.9002 20.2002 10.9002H13.1002V3.8002Z",fill:"currentColor"})))))),!o&&Ce.default.createElement(Qv,{disabled:O,onAddContextClick:A})),Ce.default.createElement(zl,{placement:"bottom-start",fallbackPlacements:["top-start"],disableScrollLock:!0,onClose:()=>{l(!1)},open:s&&z>0,anchorEl:n.current,PaperProps:{sx:{border:"none"}}},Ce.default.createElement(x,{"data-testid":"maxai--chat-document-selector--card",sx:{borderRadius:1,maxWidth:"360px",minWidth:"240px",width:"fit-content",maxHeight:"264px",boxSizing:"border-box",border:"1px solid",borderColor:"border.main",py:"4px",bgcolor:F=>F.palette.mode==="dark"?"rgba(61, 61, 61, 1)":"#fff",alignItems:"center",justifyContent:"center","& > div":{boxSizing:"border-box",width:"100%"}}},Ce.default.createElement(x,{sx:{flexShrink:0}},D&&Ce.default.createElement(T,{px:"8px",textAlign:"left",fontSize:"12px",lineHeight:"32px",height:"32px",color:"text.secondary",flexShrink:0,noWrap:!0},t("package__features:home_view__chat_with_any_content__chat__chat_document_selector__add_sources__title")),Ce.default.createElement(x,{direction:"row",alignItems:"center",px:1},Ce.default.createElement(ne,{sx:{height:"36px"},onClick:()=>K("url")},Ce.default.createElement(na,{icon:"URLs"}),Ce.default.createElement("span",null,t("package__features:home_view__chat_with_any_content__chat__chat_document_selector__add_sources__url__title"))),Ce.default.createElement(ne,{sx:{height:"36px"},onClick:()=>K("text")},Ce.default.createElement(na,{icon:"Text"}),Ce.default.createElement("span",null,t("package__features:home_view__chat_with_any_content__chat__chat_document_selector__add_sources__text__title"))),Ce.default.createElement(ne,{sx:{height:"36px"},onClick:()=>K("file")},Ce.default.createElement(na,{icon:"File"}),Ce.default.createElement("span",null,t("package__features:home_view__chat_with_any_content__chat__chat_document_selector__add_sources__file__title"))))),Ce.default.createElement(ft,{sx:{my:"4px",width:"100%",flexShrink:0}}),V.length>0&&Ce.default.createElement(x,{width:"100%",sx:{flex:1,height:0}},Ce.default.createElement(T,{sx:{flexShrink:0},textAlign:"left",fontSize:"12px",lineHeight:"32px",height:"32px",color:"text.secondary",flexShrink:0,noWrap:!0,px:"8px"},t("package__features:home_view__chat_with_any_content__chat__chat_document_selector__choose_sources__title")),Ce.default.createElement(Zv,{onSelect:F=>{if(F.addContextType==="search"){P();return}F.chatDocumentId&&b(F.chatDocumentId)},dataList:V})))),Ce.default.createElement(t7,{show:p,onClose:()=>{u(!1)},onConfirm:async F=>{let pe=new File([F],t("package__features:home_view__chat_with_any_content__chat__chat_document_selector__chip__pasted__title",{fileName:"text.txt"}),{type:"text/plain"});await v([pe])}}),Ce.default.createElement(n7,{show:c,onClose:()=>{m(!1)},onChange:async F=>{await S(F)}}),Ce.default.createElement(a7,{ref:r}))},l7=IH;var SH=e=>{let{enableState:t,disableState:o,children:n}=e,{isEnable:r,isDisable:i}=re(a=>({isEnable:t?t(a):!0,isDisable:o?o(a):!1}));return typeof n=="function"?n({isEnable:r,isDisable:i}):!r||i?null:n},Cu=SH;var ut=I(w());var ul=I(w());var f7=I(p7()),h7=I(c7()),g7=I(u7()),x7=I(m7()),_7=I(d7());var dr=I(w()),zH=(e,t=24)=>{try{let[o,n]=e.split(":").map(Number),r=!1;n>o&&(e=`${n}:${o}`,r=!0);let i={"1:1":dr.default.createElement(_7.default,{sx:{fontSize:t,transform:r?"rotate(90deg)":"none"}}),"3:2":dr.default.createElement(f7.default,{sx:{fontSize:t,transform:r?"rotate(90deg)":"none"}}),"5:4":dr.default.createElement(h7.default,{sx:{fontSize:t,transform:r?"rotate(90deg)":"none"}}),"7:5":dr.default.createElement(g7.default,{sx:{fontSize:t,transform:r?"rotate(90deg)":"none"}}),"16:9":dr.default.createElement(x7.default,{sx:{fontSize:t,transform:r?"rotate(90deg)":"none"}})};return i[e]||i["1:1"]}catch{return null}},VH=()=>{let{t:e}=E(),{localSettings:t,setLocalSettings:o}=yt(),n=t.thirdProviderSettings?.MAXAI_DALLE,[r,i]=(0,dr.useState)(!1),a=Tl.aspectRatios.map(s=>({label:s.label(e),value:s.value,origin:s}))||[];return dr.default.createElement(ka,{"data-testid":"maxai-chat--advanced--settings--art--aspect-ratio"},dr.default.createElement(La,{sx:{fontSize:16,color:"text.primary"}},e("package__features:art__text_to_image__advanced__aspect_ratio__title")),dr.default.createElement(Ba,{sx:{fontSize:"16px",[`& .${Oa.icon}`]:{fontSize:24}},MenuProps:{elevation:1,anchorOrigin:{vertical:"top",horizontal:"left"},transformOrigin:{vertical:"bottom",horizontal:"left"}},size:"small",open:r,onClose:()=>i(!1),onOpen:()=>i(!0),label:e("package__features:art__text_to_image__advanced__aspect_ratio__title"),value:n?.aspectRatio||"1:1",onChange:async(s,l)=>{let p=a.find(u=>u.value===s.target.value);p&&o({thirdProviderSettings:{MAXAI_DALLE:{generateCount:n?.generateCount||1,contentType:n?.contentType||"image",aspectRatio:p.value,resolution:p.origin.resolution||[1024,1024]}}})}},a.map((s,l)=>dr.default.createElement(ct,{key:l,"data-value":s.value,value:s.value},dr.default.createElement(x,{direction:"row",alignItems:"center",spacing:1},zH(s.value),dr.default.createElement(T,{component:"span",fontSize:14,color:"text.primary",textAlign:"left",noWrap:!0},s.label,` (${s.value})`))))))},C7=VH;var qi=I(w()),RH=()=>{let{t:e}=E(),{localSettings:t,setLocalSettings:o}=yt(),n=t.thirdProviderSettings?.MAXAI_DALLE,[r,i]=(0,qi.useState)(!1),a=Tl.contentTypes.map(s=>({label:s.label(e),value:s.value,origin:s}))||[];return qi.default.createElement(ka,{"data-testid":"maxai-chat--advanced--settings--art--content-type"},qi.default.createElement(La,{sx:{fontSize:16,color:"text.primary"}},e("package__features:art__text_to_image__advanced__content_type__title")),qi.default.createElement(Ba,{sx:{fontSize:"16px",[`& .${Oa.icon}`]:{fontSize:24}},MenuProps:{elevation:1,anchorOrigin:{vertical:"top",horizontal:"left"},transformOrigin:{vertical:"bottom",horizontal:"left"}},size:"small",open:r,onClose:()=>i(!1),onOpen:()=>i(!0),label:e("package__features:art__text_to_image__advanced__content_type__title"),value:n?.contentType||"vivid",onChange:(s,l)=>{l.props.disabled||o({thirdProviderSettings:{MAXAI_DALLE:{generateCount:n?.generateCount||1,aspectRatio:n?.aspectRatio||"1:1",resolution:n?.resolution||[1024,1024],contentType:s.target.value}}})}},a.map((s,l)=>qi.default.createElement(ct,{key:l,"data-value":s.value,value:s.value},qi.default.createElement(x,{direction:"row",alignItems:"center",spacing:1},s.origin?.exampleImage?qi.default.createElement("img",{width:24,height:24,alt:`${s.value} example`,src:s.origin?.exampleImage}):null,qi.default.createElement(T,{component:"span",fontSize:14,color:"text.primary",textAlign:"left",noWrap:!0},s.label))))))},y7=RH;var UH=()=>{let{t:e}=E();return ul.default.createElement(x,{spacing:1},ul.default.createElement(x,{direction:"row",mb:1},ul.default.createElement(T,{fontSize:"16px",fontWeight:600,color:"text.primary"},e("package__features:chat__art__text_to_image__advanced__title"))),ul.default.createElement(x,{spacing:2},ul.default.createElement(C7,null),ul.default.createElement(y7,null)))},b7=UH;var ml=I(w());var ws=I(w()),WH=[{value:"sogou",label:"Sogou Search"},{value:"brave",label:"Brave Search"},{value:"yandex",label:"Yandex Search"},{value:"naver",label:"Naver Search"},{value:"bing",label:"Bing Search"},{value:"yahoo",label:"Yahoo Search"},{value:"baidu",label:"Baidu Search"},{value:"google",label:"Google Search"}],GH=e=>{let{t}=E(),{localSettings:o,setLocalSettings:n}=yt(),[r,i]=(0,ws.useState)(!1);return ws.default.createElement(ka,null,ws.default.createElement(La,{sx:{fontSize:16,color:"text.primary"}},t("package__features:chat__app__search_advanced__search_engine__title")),ws.default.createElement(Ba,{sx:{fontSize:"16px",[`& .${Oa.icon}`]:{fontSize:24}},MenuProps:{elevation:1,anchorOrigin:{vertical:"top",horizontal:"left"},transformOrigin:{vertical:"bottom",horizontal:"left"}},"data-testid":"chat-search--engine-selector",size:"small",open:r,onClose:()=>i(!1),onOpen:()=>i(!0),label:t("package__features:chat__app__search_advanced__search_engine__title"),value:o.sidebarSettings?.search?.searchEngine||"google",onChange:(a,s)=>{s.props.disabled||n({sidebarSettings:{search:{searchEngine:a.target.value}}})},...e},WH.map((a,s)=>ws.default.createElement(ct,{key:s,"data-value":a.value,value:a.value},ws.default.createElement(T,{component:"span",fontSize:14,color:"text.primary",textAlign:"left",noWrap:!0},a.label)))))},I7=GH;var Es=I(w()),jH=Array.from({length:10},(e,t)=>t+1).map(e=>({value:e,label:`${e} result${e===1?"":"s"}`})),KH=()=>{let{t:e}=E(),{localSettings:t,setLocalSettings:o}=yt(),[n,r]=(0,Es.useState)(!1);return Es.default.createElement(ka,null,Es.default.createElement(La,{sx:{fontSize:16,color:"text.primary"}},e("package__features:chat__app__search_advanced__search_results__title")),Es.default.createElement(Ba,{sx:{fontSize:"16px",[`& .${Oa.icon}`]:{fontSize:24}},MenuProps:{elevation:1,anchorOrigin:{vertical:"top",horizontal:"left"},transformOrigin:{vertical:"bottom",horizontal:"left"}},"data-testid":"chat-search--results-count-selector",size:"small",open:n,onClose:()=>r(!1),onOpen:()=>r(!0),label:e("package__features:chat__app__search_advanced__search_results__title"),value:t.sidebarSettings?.search?.maxResultsCount||6,onChange:(i,a)=>{a.props.disabled||o({sidebarSettings:{search:{maxResultsCount:hm(i.target.value)?i.target.value:6}}})}},jH.map((i,a)=>Es.default.createElement(ct,{key:a,"data-value":i.value,value:i.value},Es.default.createElement(T,{component:"span",fontSize:14,color:"text.primary",textAlign:"left",noWrap:!0},i.label)))))},S7=KH;var qH=()=>{let{t:e}=E();return ml.default.createElement(x,{spacing:1},ml.default.createElement(x,{direction:"row",mb:1},ml.default.createElement(T,{fontSize:"16px",fontWeight:600,color:"text.primary"},e("package__features:chat__app__search_advanced__title"))),ml.default.createElement(x,{spacing:2},ml.default.createElement(I7,null),ml.default.createElement(S7,null)))},v7=qH;var _n=I(w()),$H=e=>{let{conversationType:t,conversationId:o}=Oi(),{conversationType:n=t,children:r,...i}=e,{t:a}=E(),s=xe(o),[l,p]=(0,_n.useState)(null),u=f=>{p(f.currentTarget)},c=()=>{p(null)},m=!!l,d=(0,_n.useRef)(null);return["Search","Art"].includes(n)?_n.default.createElement(_n.default.Fragment,null,_n.default.createElement(zs,{title:a("package__features:chat__inputbox__button__advanced_options__tooltip"),id:"MaxAIAIAdvanced","data-button-clicked-name":"maxai-advanced-button","aria-owns":m?"mouse-over-popover":void 0,"aria-haspopup":"true",disabled:s,onClick:u,...i,sx:{position:"relative",...i.sx},testid:`maxai-chat--advanced--settings-button--${n.toLowerCase()}`},_n.default.createElement(U,{icon:"Tune",sx:{color:"text.primary",fontSize:"20px"}})),_n.default.createElement($u,{open:m,anchorEl:l,id:"mouse-over-popover",elevation:2,anchorOrigin:{vertical:"bottom",horizontal:"right"},transformOrigin:{vertical:"bottom",horizontal:"right"},onClose:c,disableScrollLock:!0},_n.default.createElement(B,{ref:d,sx:{borderRadius:1,border:"1px solid #EBEBEB",boxShadow:"0px 4px 8px 0px rgba(0, 0, 0, 0.16)",width:402,display:"flex",alignItems:"stretch",justifyContent:"center",flexDirection:"row"}},_n.default.createElement(x,{spacing:1,p:1,width:"100%"},n==="Search"&&_n.default.createElement(v7,null),n==="Art"&&_n.default.createElement(b7,null),r,_n.default.createElement(x,{sx:{minHeight:"28px"},width:"100%",spacing:1,alignItems:"center",direction:"row",justifyContent:"end",flexDirection:"row"},_n.default.createElement(Ve,{onClick:f=>{f.stopPropagation(),c()}},_n.default.createElement(U,{icon:"Close",sx:{fontSize:"24px"}}))))))):null},T7=$H;var Qr=I(w());var XH=e=>{let{anchorElementSelectors:t='[data-testid="maxai-chat-history-button"]',placement:o=lo?"bottom-start":"left-end",...n}=e,{t:r}=E(),[i,a]=Qr.default.useState(!1),[s,l]=Qr.default.useState(!0),p=re(f=>f.conversationIds),u=tn(p[0]),c=xe(p[0]),m=(0,Qr.useCallback)(async()=>{let f=await Ge.getOnboardingDataByKey(Wc),h=await un.cachedChatConversationService.getCacheConversationsByType("Chat");f&&u.length<=0&&c===!1&&h.length>0&&setTimeout(()=>{a(!0)},1e3)},[u,c]),{extensionTourOnBoardingOpened:d}=pr();return(0,Qr.useEffect)(()=>{d&&Ge.getOnboardingDataByKey(wg).then(f=>l(!!f))},[d]),(0,Qr.useEffect)(()=>{s||m()},[s,m]),s?null:Qr.default.createElement(Lt,{placement:o,trigger:i,anchorElementSelectors:t,keepPollingCheckAnchorEl:!0,onShow:()=>{Ge.setOnboardingData(wg,!0)},CtaButtonProps:{"data-button-clicked-name":"Onboarding > Chat history > Got it"},...n},Qr.default.createElement(x,{spacing:.5},Qr.default.createElement(T,{fontSize:20,lineHeight:1.4,color:"text.primary",fontWeight:700,textAlign:"left"},r("package__features:onboarding__onboarding_popover__chat_history__title")),Qr.default.createElement(T,{fontSize:14,lineHeight:1.4,color:"text.primary",fontWeight:400,textAlign:"left"},r("package__features:onboarding__onboarding_popover__chat_history__description"))))},M7=XH;var $t=I(w());var v1=I(w());var Wp=I(w());var qt=I(w());var q0=I(w()),YH=e=>{let{open:t,displaysText:o,onDelete:n,...r}=e,{t:i}=E(),a=i("package__features:chat__conversation_item__delete_chat__dialog__title");return q0.default.createElement(Wr,{show:t,onClose:s=>{r.onClose?.({},s)},title:a,onConfirm:()=>n?.(),confirmBtnText:i("package__common:delete"),wrapSx:{width:"448px"},confirmBtnSx:{backgroundColor:"rgba(237, 80, 80, 1)",color:"rgba(255, 255, 255, 1)","&:hover":{backgroundColor:"rgba(237, 99, 99, 1)",color:"rgba(255, 255, 255, 1)"}}},q0.default.createElement(T,{fontSize:"16px",color:"text.primary",px:"24px"},i("package__features:chat__conversation_item__delete_chat__description")))},S1=YH;var xo=I(w()),ZH=e=>{let{conversation:t,displaysText:o,disabled:n,onClose:r,onClickRename:i,onClickDelete:a,sx:s}=e,{deleteConversation:l}=qe(),{t:p}=E(),[u,c]=(0,xo.useState)(null),m=!!u,[d,f]=(0,xo.useState)(!1),h=g=>{g.preventDefault(),g.stopPropagation(),c(null),r?.()},_=async()=>{a?a():await l(t.id)&&f(!1)};return xo.default.createElement(xo.default.Fragment,null,xo.default.createElement(he,{placement:"top",title:p("package__common:more")},xo.default.createElement(B,{sx:s},xo.default.createElement(Ve,{disabled:n,onClick:g=>{g.preventDefault(),g.stopPropagation(),c(g.currentTarget)},sx:{p:.5},"data-testid":"chat-conversation--more-actions-button"},xo.default.createElement(U,{icon:"More",size:16})))),xo.default.createElement(Fr,{anchorEl:u,id:`${t.id}_MORE_ACTIONS_MENU`,open:m,onClose:h,onClick:h,slotProps:{paper:{elevation:0,sx:{overflow:"visible",filter:"drop-shadow(0px 2px 8px rgba(0,0,0,0.32))",mt:1}}},anchorOrigin:{vertical:"bottom",horizontal:"left"},transformOrigin:{vertical:"top",horizontal:"right"}},xo.default.createElement(ct,{"data-testid":"chat-conversation--rename-chat-button",onClick:g=>{i?.(),h(g)}},xo.default.createElement(tc,null,xo.default.createElement(U,{icon:"DefaultIcon",size:16})),xo.default.createElement(oc,{sx:{fontSize:"14px",color:"text.primary"}},xo.default.createElement(T,{sx:{fontSize:"14px",color:"text.primary"},component:"span"},p("package__common:rename")))),xo.default.createElement(ct,{"data-testid":"chat-conversation--delete-chat-button",onClick:g=>{f(!0),h(g)},sx:{color:"#f44336"}},xo.default.createElement(tc,null,xo.default.createElement(U,{icon:"Delete",size:16,sx:{color:"#f44336"}})),xo.default.createElement(oc,{sx:{fontSize:"14px"}},xo.default.createElement(T,{sx:{fontSize:"14px"},component:"span"},p("package__features:chat__conversation_item__delete_chat__button__title"))))),xo.default.createElement(S1,{displaysText:o,open:d,onClose:g=>{g?.stopPropagation?.(),f(!1)},onDelete:()=>_()}))},w7=ZH;var dl=I(w()),QH=e=>{let{keyword:t,sx:o,children:n}=e,r=(0,dl.useRef)(null),i=(0,dl.useMemo)(()=>{if(!t||!n)return[];let a=[],s=new RegExp(t,"gi"),l=0,p=s.exec(n);for(;p!==null;){let m=n.slice(l,p.index);m&&a.push({match:!1,content:m}),a.push({match:!0,content:t}),l=p.index+t.length,p=s.exec(n)}let u=n.slice(l,n.length);u&&a.push({match:!1,content:u});let c=a[0];if(!c.match&&a.length>1&&c.content.length>15){let f=c.content.length-15;a.some(_=>(_!==c&&(f+=_.content.length),f>15))&&(c.content=`...${c.content.slice(-4)}`)}return a},[t,n]);return dl.default.createElement(T,{ref:r,color:"text.primary",fontSize:"14px",lineHeight:"24px",noWrap:!0,width:0,flex:1,textAlign:"left",sx:o},i.length?i.map(a=>dl.default.createElement("span",{style:a.match?{background:"rgba(215, 164, 253, 0.4)"}:void 0},a.content)):n)},E7=QH;var JH=e=>{let{conversation:t,keyword:o,selected:n,onClick:r,sx:i,style:a,icon:s,label:l,order:p}=e,[u,c]=(0,qt.useState)(!1),{editingNameRef:m,editing:d,setEditing:f,updateConversationName:h}=Kl(),{displaysText:_,displaysTime:g}=Km({...t,name:m.current||t.name}),y=(0,qt.useMemo)(()=>{let v=t.meta?.AIProvider||"USE_CHAT_GPT_PLUS",S=t.meta?.AIModel||"";return en(v,S)?.title||S},[]),C=()=>{if(s)return s;let v=t.last_msg||t.match_message;if(v?.originalMessage?.metadata?.chatMode==="free_chat"||v?.meta?.chatMode==="free_chat")return qt.default.createElement(Nr,{sx:{fontSize:22}});let S=v?.originalMessage?.metadata?.AIModel||v?.meta?.AIModel;return S?qt.default.createElement(Do,{size:24,provider:t.meta.AIProvider,model:S}):qt.default.createElement(Nr,{sx:{fontSize:22}})},b=()=>l||qt.default.createElement(qt.default.Fragment,null,qt.default.createElement(Ux,{sx:{flexShrink:0,width:"unset",fontSize:"12px",padding:"0!important",height:"16px!important","& > span":{padding:"0 6px"}},label:t.type==="ContextMenu"?"Rewrite":t.type,size:"small"}),qt.default.createElement(T,{noWrap:!0,flex:1,textAlign:"left",width:0,color:"text.secondary",fontSize:"12px",lineHeight:"16px"},y));return qt.default.createElement(x,{id:`conversation-item-${t.id}`,"data-testid":p?`conversation-item-${p}`:"conversation-item",spacing:1,style:a,sx:i},qt.default.createElement(x,{direction:"row",alignItems:"center",px:"12px",py:"8px",onMouseOver:()=>{c(!0)},onMouseOut:()=>{c(!1)},onClick:()=>r?.(t),sx:{cursor:"pointer",borderRadius:"6px",userSelect:"none",...n||d?{bgcolor:v=>v.palette.mode==="dark"?"#383838":"#F0F0F0"}:{"&:hover":{bgcolor:v=>v.palette.mode==="dark"?"rgba(255, 255, 255, .1)":"rgba(0, 0, 0, 0.04)"}},"&:hover .conversation-list-row-more-action-button":{opacity:1}},spacing:2},qt.default.createElement(x,{width:"24px",height:"24px",alignItems:"center",justifyContent:"center"},C()),qt.default.createElement(x,{width:0,flex:1},qt.default.createElement(x,{direction:"row",alignItems:"center",justifyContent:"space-between",gap:1},qt.default.createElement(x,{direction:"row",gap:1,alignItems:"center",flex:1,width:0},b()),qt.default.createElement(T,{flexShrink:0,color:"text.secondary",fontSize:"12px",lineHeight:"16px"},g)),qt.default.createElement(x,{position:"relative",direction:"row",alignItems:"center"},d?qt.default.createElement(wa,{mouseEvent:"onMouseDown",onClickAway:()=>h(t)},qt.default.createElement(Ct,{onClick:v=>{v.stopPropagation()},"data-testid":"maxai--conversation--rename-chat--input",size:"small",ref:v=>{v&&setTimeout(()=>{v.querySelector("input")?.focus()},0)},defaultValue:t.name,onChange:v=>{v.stopPropagation(),m.current=v.target.value.trim()},onKeyDownCapture:v=>{v.stopPropagation(),v.key==="Enter"&&h(t)},onPaste:v=>{v.stopPropagation()},sx:{width:"100%",mt:"1.5px",mb:"-5.625px","& input":{p:"2px 2px 2px 4px",fontSize:"14px"}}})):qt.default.createElement(E7,{keyword:o},_),qt.default.createElement(w7,{conversation:t,displaysText:_,onClose:()=>c(!1),onClickRename:()=>f(!0),sx:n||u?null:{position:"absolute",right:0,opacity:0}})))))},A7=(0,qt.memo)(JH,zm);var Ao=I(w());var k7=I(w());function eN(e){var t=e.lastRenderedStartIndex,o=e.lastRenderedStopIndex,n=e.startIndex,r=e.stopIndex;return!(n>o||r<t)}function tN(e){for(var t=e.isItemLoaded,o=e.itemCount,n=e.minimumBatchSize,r=e.startIndex,i=e.stopIndex,a=[],s=null,l=null,p=r;p<=i;p++){var u=t(p);u?l!==null&&(a.push(s,l),s=l=null):(l=p,s===null&&(s=p))}if(l!==null){for(var c=Math.min(Math.max(l,s+n-1),o-1),m=l+1;m<=c&&!t(m);m++)l=m;a.push(s,l)}if(a.length)for(;a[1]-a[0]+1<n&&a[0]>0;){var d=a[0]-1;if(!t(d))a[0]=d;else break}return a}var oN=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")},nN=function(){function e(t,o){for(var n=0;n<o.length;n++){var r=o[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(t,o,n){return o&&e(t.prototype,o),n&&e(t,n),t}}(),rN=function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)},P7=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t&&(typeof t=="object"||typeof t=="function")?t:e},iN=function(e){rN(t,e);function t(){var o,n,r,i;oN(this,t);for(var a=arguments.length,s=Array(a),l=0;l<a;l++)s[l]=arguments[l];return i=(n=(r=P7(this,(o=t.__proto__||Object.getPrototypeOf(t)).call.apply(o,[this].concat(s))),r),r._lastRenderedStartIndex=-1,r._lastRenderedStopIndex=-1,r._memoizedUnloadedRanges=[],r._onItemsRendered=function(p){var u=p.visibleStartIndex,c=p.visibleStopIndex;r._lastRenderedStartIndex=u,r._lastRenderedStopIndex=c,r._ensureRowsLoaded(u,c)},r._setRef=function(p){r._listRef=p},n),P7(r,i)}return nN(t,[{key:"resetloadMoreItemsCache",value:function(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;this._memoizedUnloadedRanges=[],n&&this._ensureRowsLoaded(this._lastRenderedStartIndex,this._lastRenderedStopIndex)}},{key:"componentDidMount",value:function(){}},{key:"render",value:function(){var n=this.props.children;return n({onItemsRendered:this._onItemsRendered,ref:this._setRef})}},{key:"_ensureRowsLoaded",value:function(n,r){var i=this.props,a=i.isItemLoaded,s=i.itemCount,l=i.minimumBatchSize,p=l===void 0?10:l,u=i.threshold,c=u===void 0?15:u,m=tN({isItemLoaded:a,itemCount:s,minimumBatchSize:p,startIndex:Math.max(0,n-c),stopIndex:Math.min(s-1,r+c)});(this._memoizedUnloadedRanges.length!==m.length||this._memoizedUnloadedRanges.some(function(d,f){return m[f]!==d}))&&(this._memoizedUnloadedRanges=m,this._loadUnloadedRanges(m))}},{key:"_loadUnloadedRanges",value:function(n){for(var r=this,i=this.props.loadMoreItems||this.props.loadMoreRows,a=function(p){var u=n[p],c=n[p+1],m=i(u,c);m?.then(function(){if(eN({lastRenderedStartIndex:r._lastRenderedStartIndex,lastRenderedStopIndex:r._lastRenderedStopIndex,startIndex:u,stopIndex:c})){if(r._listRef==null)return;typeof r._listRef.resetAfterIndex=="function"?r._listRef.resetAfterIndex(u,!0):(typeof r._listRef._getItemStyleCache=="function"&&r._listRef._getItemStyleCache(-1),r._listRef.forceUpdate())}})},s=0;s<n.length;s+=2)a(s)}}]),t}(k7.PureComponent),L7=iN;var $0=class e extends Xu{constructor(){super(...arguments);this.inputEl=null}static getInstance(){return e.instance||(e.instance=new e),e.instance}getInputEl(){return this.inputEl}setInputEl(o){this.inputEl=o}},As=$0;var er=I(w());var aN=({onRefetch:e,onClose:t})=>{let{t:o}=E(),n=(0,er.useRef)(null),r=(0,er.useRef)(null),[i,a]=(0,er.useState)(!1),{editing:s,editingNameRef:l,setEditing:p,updateConversationName:u}=Kl(),{control:c,handleSubmit:m,reset:d,watch:f,formState:{errors:h}}=Bl({mode:"onChange",defaultValues:{name:""}}),_=f("name",""),g=(0,er.useCallback)(()=>{p(!1),t?.()},[t,p]),y=(0,er.useCallback)(async({name:b})=>{a(!0),await tm(async()=>{r.current&&(l.current=b,await u(r.current,!0),await e())}),a(!1),p(!1)},[l,e,p,u]),C=(0,er.useMemo)(()=>As.getInstance(),[]);return gm(C,{showRenameModal:b=>{r.current=b,p(!0),d({name:b.name||SC(b).displaysText}),requestAnimationFrame(()=>{n.current?.focus(),n.current?.select()})}}),er.default.createElement(Wr,{isFixed:!0,loading:i,show:s,onClose:g,title:o("package__features:chat__history_view__rename__dialog__title"),wrapSx:{width:"460px"},footerVariant:"horizontal",confirmBtnDisabled:!_?.trim()||!!h.name,onConfirm:m(y)},er.default.createElement(B,{component:"form",onSubmit:m(y),sx:{padding:"0 24px",gap:"8px"}},er.default.createElement(Va,{disabled:i,name:"name",rules:{validate:b=>!!b?.trim(),maxLength:{value:ac,message:o("package__features:chat__history_view__rename__dialog__name_too_long",{MAX_LENGTH:ac})}},control:c,render:({field:b,fieldState:{error:v}})=>er.default.createElement(Ct,{fullWidth:!0,"data-testid":"chat--history-view--rename-input",inputRef:n,error:!!v?.message,helperText:v?.message,sx:{[`& .${Kx.root}`]:{fontSize:"12px"}},InputProps:{sx:{fontSize:"16px"}},...b})})))},O7=aN;var X0=e=>{let{keyword:t,conversations:o,isLoading:n,isNextPageLoading:r,hasNextPage:i,loadNextPage:a,selectedIds:s,itemSize:l=60,onSelectItem:p,onRenderItem:u,emptyNode:c,sx:m,refetch:d}=e,f=i?o.length+1:o.length,h=!n&&!r&&o.length===0,_=(0,Ao.useCallback)(()=>{r||a()},[r,a]),g=L=>!i||L<o.length,y=(0,Ao.useCallback)(L=>{L?p?.(L):_()},[_,p]),C=(0,Ao.useRef)(null),b=(0,Ao.useMemo)(()=>As.getInstance(),[]),v=(0,Ao.useCallback)(L=>{b.emit("showRenameModal",L)},[b]),{inputMediator:S}=_e(),P=(0,Ao.useCallback)(()=>{requestAnimationFrame(()=>{if(lo){let L=b.getInputEl();L?.focus(),setTimeout(()=>{L?.focus()},100)}else S.focus()})},[b,S]),k=(0,Ao.useCallback)(async()=>{await d(),b.emit("reset"),C.current?.scrollToItem(0)},[b,d]);return Ao.default.createElement(x,{flex:1,height:0,spacing:1,p:1,boxSizing:"border-box",className:"conversation-list",sx:m},Ao.default.createElement(O7,{onRefetch:k,onClose:P}),Ao.default.createElement(Wn,{loading:n},Ao.default.createElement(L7,{isItemLoaded:g,itemCount:f,loadMoreItems:_},({onItemsRendered:L,ref:H})=>Ao.default.createElement($C,null,({height:W,width:O})=>Ao.default.createElement(qC,{ref:D=>{C.current=D,H(D)},height:W,width:O,style:{flex:1},itemData:o,itemSize:l,itemCount:f,onItemsRendered:L,className:"maxai--conversation-list",...e},D=>{let V=D.data[D.index];return V&&u?u(V,{conversation:V,keyword:t,selected:s?.includes(V.id),onClick:y,style:D.style,order:D.index+1,onRename:v}):V?Ao.default.createElement(A7,{conversation:V,keyword:t,selected:s?.includes(V.id),onClick:y,style:D.style,order:D.index+1}):(n||r)&&Ao.default.createElement(x,{style:D.style,width:"100%",alignItems:"center",justifyContent:"center",sx:{my:"16px"}},Ao.default.createElement(Jt,{size:16,sx:{m:"0 auto"}}))})))),h?c:null)},o9e=Ao.default.memo(X0);var sN=e=>{let{conversationIds:t,conversationType:o}=re(C=>({conversationIds:C.conversationIds.slice(0,C.layout),conversationType:C.conversationType})),{switchConversation:n,asyncUpdateConversation:r}=qe(),{conversationType:i=o,selectedIds:a=t,onSelectItem:s,queryOptions:l,onClose:p,onChangeConversations:u,...c}=e,{conversations:m,isLoading:d,isFetchingNextPage:f,fetchNextPage:h,hasNextPage:_,refetch:g}=oy(i,l),y=(0,Wp.useCallback)(async C=>{if(a.includes(C.id)){p?.();return}C.id&&(await un.getService().addOrUpdateConversation(C.id,C,{syncToRemote:!1,isPartialUpdate:!1,updateUpdatedAt:!1}),C.updated_at=new Date().toISOString(),await fy(),await n(C.id,C),s?.(C),r(C.id))},[a,s,p]);return(0,Wp.useEffect)(()=>{u&&u(m)},[m,u]),Wp.default.createElement(X0,{conversations:m,keyword:l?.keyword,isLoading:d,isNextPageLoading:f,hasNextPage:_,loadNextPage:h,selectedIds:a,onSelectItem:y,refetch:g,...c})},B7=sN;var Y0=I(w()),lN=e=>{let{sx:t}=e,{t:o}=E();return Y0.default.createElement(x,{"data-testid":"conversation-empty-view",alignItems:"center",justifyContent:"center",height:"40px",sx:t},Y0.default.createElement(T,{fontSize:14,lineHeight:1.5,textAlign:"center",color:"text.tertiary"},o("package__features:chat__history_view__empty__title")))},D7=lN;var ln=I(w());var kr=I(w()),pN=e=>{let{conversation:t,displaysText:o,onClose:n,onClickRename:r,onClickDelete:i,sx:a}=e,{deleteConversation:s}=qe(),{t:l}=E(),[p,u]=(0,kr.useState)(null),[c,m]=(0,kr.useState)(!1),d=h=>{h.preventDefault(),h.stopPropagation(),u(null),n?.()},f=async()=>{i?i():await s(t.id)&&m(!1)};return kr.default.createElement(kr.default.Fragment,null,kr.default.createElement(ne,{title:l("package__common:more"),placement:"top",tooltipProps:{disableInteractive:!0},onClick:h=>{h.stopPropagation(),u(h.currentTarget)},sx:{...a}},kr.default.createElement(U,{icon:"More",size:16})),kr.default.createElement(Fr,{anchorEl:p,open:!!p,onClose:d,onClick:d,slotProps:{paper:{elevation:0,sx:{overflow:"unset",background:"transparent"}}}},kr.default.createElement(Da,{offset:{top:0,right:0,bottom:0,left:0},options:[{value:"rename",testid:"chat-conversation--rename-chat-button",icon:kr.default.createElement(U,{icon:"DefaultIcon"}),label:l("package__common:rename")},{value:"delete",testid:"chat-conversation--delete-chat-button",icon:kr.default.createElement(U,{icon:"Delete",sx:{color:"rgba(255, 14, 39, 1)!important"}}),label:l("package__common:delete"),labelSx:{color:"rgba(255, 14, 39, 1)!important"}}],sx:{width:200},onSelectOption:h=>{h==="rename"?r?.():h==="delete"&&m(!0),u(null)}})),kr.default.createElement(S1,{displaysText:o,open:c,onClose:h=>{h?.stopPropagation?.(),m(!1)},onDelete:()=>f()}))},F7=pN;var cN=e=>{let{conversation:t,selected:o,onClick:n,sx:r,style:i,order:a,onRename:s}=e,[l,p]=(0,ln.useState)(!1),{editingNameRef:u,editing:c,setEditing:m,updateConversationName:d}=Kl(),{displaysText:f,displaysTime:h}=Km({...t,name:u.current||t.name}),_=()=>{let g=t.last_msg||t.match_message;if((g?.meta?.chatMode||g?.originalMessage?.metadata?.chatMode)==="free_chat")return ln.default.createElement(Nr,{sx:{fontSize:22}});let C=g?.originalMessage?.metadata?.AIModel||g?.meta?.AIModel||t.meta.AIModel;return C?ln.default.createElement(Do,{size:24,provider:t.meta.AIProvider,model:C}):ln.default.createElement(Nr,{sx:{fontSize:22}})};return ln.default.createElement(x,{id:`conversation-item-${t.id}`,"data-testid":a?`conversation-item-${a}`:"conversation-item",spacing:1,style:i,sx:r},ln.default.createElement(x,{direction:"row",alignItems:"center",pl:1.5,pr:1,height:40,onMouseOver:()=>{p(!0)},onMouseOut:()=>{p(!1)},onClick:()=>n?.(t),sx:{cursor:"pointer",borderRadius:"6px",userSelect:"none",...o||c?{bgcolor:g=>g.palette.mode==="dark"?"#383838":"#F0F0F0"}:{"&:hover":{bgcolor:g=>g.palette.mode==="dark"?"rgba(255, 255, 255, .1)":"rgba(0, 0, 0, 0.04)"}}},spacing:2},ln.default.createElement(x,{width:"24px",height:"24px",alignItems:"center",justifyContent:"center"},_()),ln.default.createElement(x,{width:0,flex:1,position:"relative",direction:"row",alignItems:"center",gap:"2px"},c?ln.default.createElement(wa,{mouseEvent:"onMouseDown",onClickAway:()=>d(t)},ln.default.createElement(Ct,{onClick:g=>{g.stopPropagation()},variant:"standard","data-testid":"maxai--conversation--rename-chat--input",size:"small",ref:g=>{g&&setTimeout(()=>{g.querySelector("input")?.focus()},0)},defaultValue:f,onChange:g=>{g.stopPropagation(),u.current=g.target.value.trim()},onKeyDownCapture:g=>{g.stopPropagation(),g.key==="Enter"&&d(t),g.key==="Escape"&&m(!1)},onPaste:g=>{g.stopPropagation()},sx:{flex:1,"& input":{fontSize:"14px"}}})):ln.default.createElement(T,{color:"text.primary",fontSize:"14px",lineHeight:"24px",noWrap:!0,width:0,flex:1,textAlign:"left"},f),ln.default.createElement(T,{flexShrink:0,color:"text.secondary",fontSize:"12px",lineHeight:"16px",sx:{display:o||l?"none":"block",textAlign:"right",width:"40px"}},h),ln.default.createElement(x,{flexDirection:"row",sx:{width:"40px",justifyContent:"flex-end",...o||l?null:{position:"absolute",right:0,opacity:0}}},ln.default.createElement(F7,{conversation:t,displaysText:f,onClose:()=>p(!1),onClickRename:()=>{s?.(t)}})))))},H7=(0,ln.memo)(cN,zm);var Z0=I(w()),uN=e=>{let{open:t,onClose:o,onConfirm:n}=e,{t:r}=E(),i=r("package__features:chat__conversation_list__delete_all_chat__dialog__title"),a=r("package__features:chat__conversation_list__delete_all_chat__dialog__description");return Z0.default.createElement(Wr,{show:t,onClose:o,title:i,onConfirm:n,confirmBtnText:r("package__common:delete"),wrapSx:{width:"auto"},confirmBtnSx:{backgroundColor:"rgba(237, 80, 80, 1)",color:"rgba(255, 255, 255, 1)","&:hover":{backgroundColor:"rgba(237, 99, 99, 1)",color:"rgba(255, 255, 255, 1)"}}},Z0.default.createElement(T,{fontSize:"16px",color:"text.primary",px:"24px"},a))},N7=uN;var Jr=I(w()),mN=e=>{let{onDeleted:t,deleteOption:o,...n}=e,{t:r}=E(),{layout:i,conversationType:a,setConversationIds:s}=re(h=>({layout:h.layout,conversationType:h.conversationType,setConversationIds:h.setConversationIds})),{createConversation:l,deleteConversationsByType:p}=qe(),[u,c]=(0,Jr.useState)(null),[m,d]=(0,Jr.useState)(!1),f=async()=>{try{await p(a);let _=(await l(a,{reason:"initCreate"})).filter((g,y)=>y<i).map(g=>g.id);s(_),t?.()}catch{}finally{d(!1)}};return Jr.default.createElement(Jr.default.Fragment,null,Jr.default.createElement(ne,{title:r("package__common:more"),placement:"left",onClick:h=>{c(h.currentTarget)},...n},Jr.default.createElement(U,{icon:"More",size:20})),Jr.default.createElement(Fr,{anchorEl:u,open:!!u,onClose:()=>{c(null)},slotProps:{paper:{elevation:0,sx:{overflow:"unset",background:"transparent"}}}},Jr.default.createElement(Da,{offset:{top:0,right:0,bottom:0,left:0},options:[{value:"delete",icon:Jr.default.createElement(U,{icon:"Delete",sx:o?.disabled?null:{color:"rgba(255, 14, 39, 1)!important"}}),label:r("package__features:chat__conversation_list__delete_all_chat__button__title"),labelSx:o?.disabled?null:{color:"rgba(255, 14, 39, 1)!important"},testid:"maxai-clear-all-chat-button",...o}],sx:{width:200},onSelectOption:h=>{h==="delete"&&d(!0),c(null)}})),Jr.default.createElement(N7,{open:m,onClose:()=>d(!1),onConfirm:f}))},z7=mN;var V7=I(Xm()),R7=I(dc());var _a=I(w()),dN=e=>{let{value:t,onChangeValue:o,InputProps:n,...r}=e,{t:i}=E(),a=(0,_a.useCallback)(s=>{As.getInstance().setInputEl(s)},[]);return _a.default.createElement(Ct,{size:"small",id:"filter-conversations",inputRef:a,value:t,placeholder:i("package__features:chat__chat_history_view__search_input__placeholder"),InputProps:{startAdornment:_a.default.createElement(zn,{position:"start",sx:{mr:"4px"}},_a.default.createElement(R7.default,{sx:{fontSize:"24px"}})),endAdornment:t?_a.default.createElement(zn,{position:"end"},_a.default.createElement(Ve,{onClick:()=>o?.(""),sx:{p:.5,mr:-.5},edge:"end"},_a.default.createElement(V7.default,{sx:{fontSize:"18px"}}))):null,...n,sx:{fontSize:16,pl:"6px",pr:1,"& input":{padding:0,height:36},...n?.sx}},inputProps:{autoComplete:"off",maxLength:ac},sx:{width:"100%"},autoFocus:!0,onChange:s=>{let l=s.target.value.replaceAll(/\<|\>|\*/g,"");o?.(l)},onKeyUp:s=>{s.stopPropagation()},onKeyDown:s=>{s.stopPropagation()},...r})},U7=dN;var W7=I(ir()),G7=I(dc());var ao=I(w()),fN=e=>{let{onClose:t}=e,{t:o}=E(),n=re(m=>m.conversationType),[r,i]=(0,ao.useState)([]),[a,s]=(0,ao.useState)(""),[l,p]=(0,ao.useState)(""),u=(0,ao.useMemo)(()=>Rn(d=>{p(d.trim())},500),[]),c=(0,ao.useMemo)(()=>As.getInstance(),[]);return gm(c,{reset:()=>{s(""),p("")}}),ao.default.createElement(x,{height:"100%"},ao.default.createElement(x,{direction:"row",spacing:1,alignItems:"center",px:2,pt:2,position:"relative"},ao.default.createElement(ne,{sx:{"& svg":{fontSize:"22px"}},onClick:t},ao.default.createElement(W7.default,null)),ao.default.createElement(T,{fontSize:16,fontWeight:500,lineHeight:2,flex:1,textAlign:"center"},o("package__features:chat__inputbox__button__chat_history__tooltip")),ao.default.createElement(z7,{deleteOption:{disabled:r.length===0},onDeleted:()=>{t()},placement:"top",sx:{"& svg":{fontSize:"22px"}}})),ao.default.createElement(x,{direction:"column",spacing:1,alignItems:"center",px:2,pt:2,pb:2,position:"relative"},ao.default.createElement(U7,{value:a,InputProps:{startAdornment:ao.default.createElement(zn,{position:"start"},ao.default.createElement(G7.default,null)),sx:{pl:1}},onChangeValue:m=>{s(m),u(m)}})),ao.default.createElement(ft,null),ao.default.createElement(B,{flex:1,overflow:"hidden"},ao.default.createElement(B7,{key:n,conversationType:n,queryOptions:{keyword:l},itemSize:48,emptyNode:ao.default.createElement(D7,null),onRenderItem:(m,d)=>ao.default.createElement(H7,{...d}),onChangeConversations:i,onSelectItem:t,onClose:t,sx:{p:2,height:"100%"}})))},j7=fN;var hN=e=>{let{open:t,onClose:o,paperRef:n}=e;return Om((r,i)=>{r==="SyncContextMenuConversationInSidebar"&&t&&o?.()}),v1.default.createElement(Pa,{open:t,onClose:o,anchor:"bottom",disableEnforceFocus:!0,sx:{zIndex:1502,position:"absolute",[`& .${Aa.paper}`]:{position:"absolute",borderTopRightRadius:16,borderTopLeftRadius:16,height:"90vh",bgcolor:"background.paper"}},slotProps:{backdrop:{sx:{position:"absolute"}}}},v1.default.createElement(vn,{tabIndex:-1,onKeyDown:r=>{t&&r.key==="Escape"&&o()},ref:n,elevation:0,sx:{boxSizing:"border-box",width:"100%",height:"100%",borderRadius:0}},t&&v1.default.createElement(j7,{onClose:o})))},K7=hN;var gN=e=>{let{placement:t="bottom-start",tooltipProps:o,sx:n,iconSx:r,onHistoryModalToggle:i}=e,{betaSettings:a}=En(),{t:s}=E(),{loaded:l,isLogin:p}=Mn(),[u,c]=$t.default.useState(!1),m=(0,$t.useRef)(null),{conversationId:d,conversationType:f}=re(z=>({conversationId:z.conversationIds[0],conversationType:z.conversationType})),h=tn(d),{switchConversation:_,asyncUpdateConversation:g}=qe(),{chatHubLoading:y}=ot(),C=(0,$t.useCallback)(()=>{c(!1)},[]);(0,$t.useEffect)(()=>{N.current&&(C(),N.current=!1)},[f,C]);let b=s("package__features:chat__inputbox__button__chat_history__tooltip"),[v,S]=(0,$t.useState)(!1),P=h.length===0,[k,L]=(0,$t.useState)(!1),H=(0,$t.useMemo)(()=>p&&a?.appearance_v2_enabled&&P&&lo?[{testid:"maxai--chat-history-button--options--clear-history",value:"continue-last-chat",label:s("package__features:chat__chat_history_button__continue_last_chat"),icon:k?$t.default.createElement(U,{sx:{width:"20px",fontSize:"16px"},icon:"Loading"}):$t.default.createElement(U,{sx:{fontSize:"20px"},icon:"HistoryOne"}),sx:{paddingLeft:k?"14px":"10px"}},{testid:"maxai--chat-history-button--options--chat-history",value:"chat-history",label:s("package__features:chat__inputbox__button__chat_history__tooltip"),icon:$t.default.createElement(U,{icon:"History"})}]:[],[a?.appearance_v2_enabled,P,k,p,s]),W=(0,$t.useCallback)(async z=>{await un.getService().addOrUpdateConversation(z.id,z,{syncToRemote:!1,isPartialUpdate:!1,updateUpdatedAt:!0}),z.updated_at=new Date().toISOString(),await _(z.id,z),await g(z.id)},[g,_]),O=Ke(i),D=!v&&k,V=(0,$t.useCallback)(async()=>{let z=null;L(!0);let j=await un.getService().getPaginationConversationsByType(f,{page:0,pageSize:10,sortKey:"updated_at"}),G=j.data.filter(q=>q.lastMessageId);if(j.success&&G.length>0&&(z=G[0]),!z){oo.info(s("package__features:chat__conversation_list__no_conversation__title"),{autoHideDuration:1500,disableWindowBlurListener:!0}),L(!1);return}await W(z),L(!1)},[f,W,s]);(0,$t.useEffect)(()=>{u&&setTimeout(()=>{m.current?.focus()},100),O.current&&O.current(u)},[u]);let N=(0,$t.useRef)(!1);return $t.default.createElement($t.default.Fragment,null,$t.default.createElement(ne,{placement:t||"bottom",title:H.length<1?b:null,"data-testid":"maxai-chat-history-button",disabled:y,tooltipProps:{placement:"bottom",...o},sx:n,OptionsCardProps:{sx:{width:"188px"}},options:H,onPopupStateChange:z=>{S(z)},defaultOptionValue:"chat-history",onClick:async()=>{if(H.length>0||!l)return;let z=p;z||(z=await Fe({emitEvent:!0})),z&&c(!0)},onSelectOption:async z=>{z==="chat-history"?(setTimeout(()=>{m.current?.focus()},100),c(!0)):z==="continue-last-chat"&&await V()}},$t.default.createElement(U,{icon:D?"Loading":"History",sx:{fontSize:"20px",scale:D?"0.8":"1",...r}})),$t.default.createElement(K7,{open:u,onClose:C,paperRef:m}),$t.default.createElement(M7,null))},q7=gN;var Cn=I(w());var xN=e=>{let{anchorElementSelectors:t='[data-testid="sidebar-nav--new-chat-button"]',placement:o=lo?"bottom-start":"left-end",...n}=e,{t:r}=E(),[i,a]=Cn.default.useState(!1),[s,l]=Cn.default.useState(!0),p=re(h=>h.conversationIds),u=tn(p[0]),c=xe(p[0]),m=(0,Cn.useRef)(!1),d=(0,Cn.useCallback)(async()=>{let h=await Ge.getOnboardingDataByKey(Uc),_=await Ge.getOnboardingDataByKey(Jd),g=h&&_,y=u.find(b=>b.type==="ai"),C=y&&y.originalMessage?.metadata?.chatMode==="pro_chat";(g||C)&&u.length>0&&c===!1&&m.current===!0&&a(!0)},[u,c]),{extensionTourOnBoardingOpened:f}=pr();return(0,Cn.useEffect)(()=>{f&&Ge.getOnboardingDataByKey(Wc).then(h=>l(!!h))},[f]),(0,Cn.useEffect)(()=>{s||d()},[s,d]),(0,Cn.useEffect)(()=>{c&&(m.current=!0)},[c]),s?null:Cn.default.createElement(Cn.default.Fragment,null,Cn.default.createElement(Lt,{trigger:i,placement:o,anchorElementSelectors:t,onShow:()=>{Ge.setOnboardingData(Wc,!0)},CtaButtonProps:{"data-button-clicked-name":"Onboarding > New chat > Got it"},...n},Cn.default.createElement(x,{spacing:.5},Cn.default.createElement(T,{fontSize:20,lineHeight:1.4,color:"text.primary",fontWeight:700,textAlign:"left"},r("package__features:onboarding__onboarding_popover__new_chat__title")),Cn.default.createElement(T,{fontSize:14,lineHeight:1.4,color:"text.primary",fontWeight:400,textAlign:"left"},r("package__features:onboarding__onboarding_popover__new_chat__description")))))},Q0=xN;var fr=I(w()),_N=e=>{let{variant:t="text",sx:o,title:n,tooltipProps:r,...i}=e,{t:a}=E(),{createConversation:s}=qe(),{chatHubLoading:l}=ot(),{resetMyOwnToolsType:p}=Un(),{layout:u,conversationType:c,setConversationIds:m,setCurrentDocument:d,setEnableSearch:f}=re(g=>({layout:g.layout,conversationType:g.conversationType,setConversationIds:g.setConversationIds,setCurrentDocument:g.setCurrentDocument,setEnableSearch:g.setEnableSearch})),{setLocalSettings:h}=L_(),_=async()=>{if(!await Fe({emitEvent:!0}))return;let C=(await s(c,{reason:"manualClick"})).filter((b,v)=>v<u).map(b=>b.id);m(C),p(),d(b=>b&&{...b,selected:!0}),f(!1),h({chatSource:{enableCurrent:!0,enableSearch:!1}})};return t==="text"?fr.default.createElement(ce,{"data-testid":"sidebar-nav--new-chat-button",startIcon:fr.default.createElement(U,{icon:"NewChat",sx:{fontSize:"24px"}}),sx:{height:"32px",padding:"8px 12px!important",borderRadius:"8px",border:"1px solid",borderColor:g=>g.palette.mode==="dark"?"rgba(255, 255, 255, 0.12)!important":"rgba(0, 0, 0, 0.12)!important",color:g=>g.palette.mode==="dark"?"rgba(255, 255, 255)":"rgba(0, 0, 0, 0.6)",fontSize:"16px",lineHeight:"20px",...o},onClick:_,...i},a("package__features:chat__create_button__chat_action__title")):t==="outlined"?fr.default.createElement(fr.default.Fragment,null,fr.default.createElement(ce,{"data-testid":"sidebar-nav--new-chat-button",variant:"outlined",color:"primary",startIcon:fr.default.createElement(U,{icon:"NewChat",sx:{fontSize:14}}),onClick:_,disabled:l,sx:{borderRadius:"6px",borderWidth:"1px",borderColor:g=>g.palette.text.primary,[`.${Ea.startIcon}`]:{marginRight:"10px"},...o},...i},fr.default.createElement(T,{component:"h2",sx:{fontSize:"inherit",fontWeight:"inherit"}},a("package__features:chat__create_button__chat_action__title"))),fr.default.createElement(Q0,null)):fr.default.createElement(fr.default.Fragment,null,fr.default.createElement(ne,{tooltipProps:{placement:"left",...r},title:n||a("package__features:chat__navbar__button__new_chat"),testid:"sidebar-nav--new-chat-button",onClick:_,disabled:l,sx:o,...i},fr.default.createElement(U,{icon:"NewChat"})),fr.default.createElement(Q0,null))},yu=_N;var jp=I(Mi()),_o=I(w()),CN=e=>_o.default.createElement(jp.default,{...e},_o.default.createElement("svg",{width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg"},_o.default.createElement("path",{d:"M10.8004 2.00012H5.20037C4.08026 2.00012 3.52021 2.00012 3.09239 2.21811C2.71606 2.40986 2.4101 2.71582 2.21835 3.09214C2.00037 3.51996 2.00037 4.08002 2.00037 5.20012V10.8001C2.00037 11.9202 2.00037 12.4803 2.21835 12.9081C2.4101 13.2844 2.71606 13.5904 3.09239 13.7821C3.52021 14.0001 4.08026 14.0001 5.20037 14.0001H10.8004C11.9205 14.0001 12.4805 14.0001 12.9083 13.7821C13.2847 13.5904 13.5906 13.2844 13.7824 12.9081C14.0004 12.4803 14.0004 11.9202 14.0004 10.8001V5.20012C14.0004 4.08002 14.0004 3.51996 13.7824 3.09214C13.5906 2.71582 13.2847 2.40986 12.9083 2.21811C12.4805 2.00012 11.9205 2.00012 10.8004 2.00012Z",stroke:"currentColor",strokeOpacity:"0.87",strokeWidth:"1.33333",strokeLinecap:"round",strokeLinejoin:"round"}))),$7=e=>_o.default.createElement(jp.default,{...e},_o.default.createElement("svg",{width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg"},_o.default.createElement("path",{d:"M8 2V14M5.2 2H10.8C11.9201 2 12.4802 2 12.908 2.21799C13.2843 2.40973 13.5903 2.71569 13.782 3.09202C14 3.51984 14 4.0799 14 5.2V10.8C14 11.9201 14 12.4802 13.782 12.908C13.5903 13.2843 13.2843 13.5903 12.908 13.782C12.4802 14 11.9201 14 10.8 14H5.2C4.07989 14 3.51984 14 3.09202 13.782C2.71569 13.5903 2.40973 13.2843 2.21799 12.908C2 12.4802 2 11.9201 2 10.8V5.2C2 4.07989 2 3.51984 2.21799 3.09202C2.40973 2.71569 2.71569 2.40973 3.09202 2.21799C3.51984 2 4.0799 2 5.2 2Z",stroke:"currentColor",strokeWidth:"1.33333",strokeLinecap:"round",strokeLinejoin:"round"}))),yN=e=>_o.default.createElement(jp.default,{...e},_o.default.createElement("svg",{width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg"},_o.default.createElement("path",{d:"M6 2V14M10 2V14M5.2 2H10.8C11.9201 2 12.4802 2 12.908 2.21799C13.2843 2.40973 13.5903 2.71569 13.782 3.09202C14 3.51984 14 4.0799 14 5.2V10.8C14 11.9201 14 12.4802 13.782 12.908C13.5903 13.2843 13.2843 13.5903 12.908 13.782C12.4802 14 11.9201 14 10.8 14H5.2C4.07989 14 3.51984 14 3.09202 13.782C2.71569 13.5903 2.40973 13.2843 2.21799 12.908C2 12.4802 2 11.9201 2 10.8V5.2C2 4.07989 2 3.51984 2.21799 3.09202C2.40973 2.71569 2.71569 2.40973 3.09202 2.21799C3.51984 2 4.0799 2 5.2 2Z",stroke:"currentColor",strokeWidth:"1.33333",strokeLinecap:"round",strokeLinejoin:"round"}))),bN=e=>_o.default.createElement(jp.default,{...e},_o.default.createElement("svg",{width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg"},_o.default.createElement("path",{d:"M2 8H14M8 2V14M5.2 2H10.8C11.9201 2 12.4802 2 12.908 2.21799C13.2843 2.40973 13.5903 2.71569 13.782 3.09202C14 3.51984 14 4.0799 14 5.2V10.8C14 11.9201 14 12.4802 13.782 12.908C13.5903 13.2843 13.2843 13.5903 12.908 13.782C12.4802 14 11.9201 14 10.8 14H5.2C4.07989 14 3.51984 14 3.09202 13.782C2.71569 13.5903 2.40973 13.2843 2.21799 12.908C2 12.4802 2 11.9201 2 10.8V5.2C2 4.07989 2 3.51984 2.21799 3.09202C2.40973 2.71569 2.71569 2.40973 3.09202 2.21799C3.51984 2 4.0799 2 5.2 2Z",stroke:"currentColor",strokeWidth:"1.33333",strokeLinecap:"round",strokeLinejoin:"round"}))),IN=e=>_o.default.createElement(jp.default,{...e},_o.default.createElement("svg",{width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg"},_o.default.createElement("path",{d:"M6 14L6 2M10 14V2M2 8H14M2 10.8L2 5.2C2 4.07989 2 3.51984 2.21799 3.09202C2.40973 2.71569 2.71569 2.40973 3.09202 2.21799C3.51984 2 4.0799 2 5.2 2H10.8C11.9201 2 12.4802 2 12.908 2.21799C13.2843 2.40973 13.5903 2.71569 13.782 3.09202C14 3.51984 14 4.07989 14 5.2V10.8C14 11.9201 14 12.4802 13.782 12.908C13.5903 13.2843 13.2843 13.5903 12.908 13.782C12.4802 14 11.9201 14 10.8 14H5.2C4.07989 14 3.51984 14 3.09202 13.782C2.71569 13.5903 2.40973 13.2843 2.21799 12.908C2 12.4802 2 11.9201 2 10.8Z",stroke:"currentColor",strokeWidth:"1.33333",strokeLinecap:"round",strokeLinejoin:"round"}))),SN=e=>{let{layout:t,...o}=e;switch(t){case 1:return _o.default.createElement(CN,{...o});case 2:return _o.default.createElement($7,{...o});case 3:return _o.default.createElement(yN,{...o});case 4:return _o.default.createElement(bN,{...o});case 6:return _o.default.createElement(IN,{...o});default:return _o.default.createElement($7,{...o})}},T1=SN;var tr=I(w());var vN=e=>{let{anchorElementSelectors:t='[data-testid="maxai--chat-hub--layout-selector--item--1"]',placement:o="top-start",...n}=e,{t:r}=E(),[i,a]=tr.default.useState(!1),[s,l]=tr.default.useState(!0),p=re(h=>h.conversationIds),u=tn(p[0]),c=xe(p[0]),m=(0,tr.useRef)(!1),d=(0,tr.useCallback)(async()=>{let h=await Ge.getOnboardingDataByKey(Gc),_=await Ge.getOnboardingDataByKey("ON_BOARDING__RECORD_FIRST_SELECTOR_AI_MODEL");h&&u.length>0&&c===!1&&_&&m.current===!0&&a(!0)},[u,c]),{extensionTourOnBoardingOpened:f}=pr();return(0,tr.useEffect)(()=>{f&&Ge.getOnboardingDataByKey(Eg).then(h=>l(!!h))},[f]),(0,tr.useEffect)(()=>{s||d()},[s,d]),(0,tr.useEffect)(()=>{c&&(m.current=!0)},[c]),s?null:tr.default.createElement(Lt,{placement:o,trigger:i,anchorElementSelectors:t,onShow:()=>{Ge.setOnboardingData(Eg,!0)},CtaButtonProps:{"data-button-clicked-name":"Onboarding > Compare answers side by side > Got it"},...n},tr.default.createElement(x,{spacing:.5},tr.default.createElement(T,{fontSize:20,lineHeight:1.4,color:"text.primary",fontWeight:700,textAlign:"left"},r("package__features:onboarding__onboarding_popover__cha_hub_selector__title")),tr.default.createElement(T,{fontSize:14,lineHeight:1.4,color:"text.primary",fontWeight:400,textAlign:"left"},r("package__features:onboarding__onboarding_popover__cha_hub_selector__description"))))},X7=vN;var Xt=I(w()),ex=[{layout:1,tooltip:"package__features:chat__provider__chat_hub__layout__one__tooltip"},{layout:2,tooltip:"package__features:chat__provider__chat_hub__layout__two__tooltip"},{layout:3,tooltip:"package__features:chat__provider__chat_hub__layout__three__tooltip"},{layout:4,tooltip:"package__features:chat__provider__chat_hub__layout__four__tooltip"},{layout:6,tooltip:"package__features:chat__provider__chat_hub__layout__six__tooltip"}],TN=e=>{let{disabled:t,mode:o,size:n="medium",sx:r}=e,{conversationIds:i,conversationType:a,layout:s,setConversationIds:l,setLayout:p}=re(P=>({conversationIds:P.conversationIds,conversationType:P.conversationType,layout:P.layout,setConversationIds:P.setConversationIds,setLayout:P.setLayout})),{t:u}=E(),{createConversation:c}=qe(),{chatHubLoading:m}=ot(),d=t||m,f=async P=>{let k=await Wm(a);if(await ey(P),i.length<P){let L=await c(a,{reason:"createChatHub",triggerChange:!1,syncToRemote:!1}),H=[...i,...L.slice(i.length).map(W=>W.id)];l(H)}p(P),e.onChange?.(P,k)},h=(0,Xt.useMemo)(()=>({p:"0px 0px",borderRadius:"6px",transition:"background-color 250ms cubic-bezier(0.4, 0, 0.2, 1)",gap:"2px",border:"1px solid",borderColor:"border.main",padding:"1px","& > button":{minWidth:"unset",color:"text.secondary",padding:n==="small"?"2px":"6px",borderRadius:"4px","&:hover,&.selected":{color:"text.primary",bgcolor:P=>P.palette.mode==="dark"?"rgba(255, 255, 255, 0.06)":"rgba(0, 0, 0, 0.06)"}}}),[n]),[_,g]=(0,Xt.useState)(!1),[y,C]=(0,Xt.useState)(!1),b=(0,Xt.useRef)(null),v=(0,Xt.useCallback)(P=>{C(P),P||g(!1)},[C]),S=(0,Xt.useCallback)(()=>{v(!1),b.current?.matches(":hover")&&g(!0)},[v]);if(o==="mini"){let P=ex.find(k=>s===k.layout);return Xt.default.createElement(Ka,{width:220,sx:{zIndex:2147483621},open:y,onOpenChange:v,placement:"bottom-start",isMirror:!0,modifiers:[{name:"RTLSupport",enabled:typeof document<"u"&&document.querySelector("body")?.getAttribute("dir")==="rtl",phase:"main",fn({state:k}){if(k.modifiersData.popperOffsets){let H=k.rects.reference.x+k.rects.reference.width-k.rects.popper.width;H>0&&(k.modifiersData.popperOffsets.x=H)}}},{name:"offset",options:{offset:[0,5]}},{name:"flip",options:{fallbackPlacements:["top-start"]}}],referenceElement:Xt.default.createElement(he,{title:P?u(P.tooltip):null,open:_&&!y},Xt.default.createElement(ce,{disableRipple:!0,disabled:d,ref:b,"data-testid":"maxai--chat-hub--layout-selector--button","aria-controls":y?"composition-menu":void 0,"aria-expanded":y?"true":void 0,"aria-haspopup":"true",onClick:()=>C(!y),sx:{position:"relative",display:"flex",justifyContent:"center",alignItems:"center",cursor:"pointer",p:.5,pl:"6px",height:32,minWidth:"auto"},onMouseEnter:()=>{y||g(!0)},onMouseLeave:()=>{y||g(!1)}},Xt.default.createElement(T1,{sx:{fontSize:18},layout:P?.layout||1}),Xt.default.createElement(U,{icon:"ExpandMore",sx:{color:"text.secondary",fontSize:"16px",transform:y?"rotate(180deg)":"rotate(0)"}})))},Xt.default.createElement(Dr,{disableListWrap:!0,"data-testid":"maxai--chat-hub--layout-selector--group",sx:{overflowY:"auto",overflowX:"hidden",flexShrink:0,py:"6px",boxSizing:"border-box",bgcolor:k=>k.palette.mode==="dark"?"rgba(61, 61, 61, 1)":"#fff",...r}},ex.map(k=>Xt.default.createElement(ct,{"data-testid":`maxai--chat--layout-selector--item--${k.layout}`,key:k.layout,selected:k.layout===s,onClick:()=>{f(k.layout),S()},sx:{borderRadius:"6px",mx:"6px",minHeight:"unset",p:"6px 10px 6px 8px","&:hover":{backgroundColor:L=>L.palette.mode==="dark"?"rgba(255, 255, 255, .1)":"rgba(0, 0, 0, 0.04)"},...k.layout===s&&{backgroundColor:L=>L.palette.mode==="dark"?"rgba(255, 255, 255, 0.1)":"rgba(0, 0, 0, 0.04)"}}},Xt.default.createElement(x,{alignItems:"center",direction:"row",spacing:1,sx:{flex:1,height:24}},Xt.default.createElement(T1,{sx:{fontSize:18,color:"text.primary"},layout:k.layout}),Xt.default.createElement(fs,{fontSize:"14px",lineHeight:"21px"},u(k.tooltip)))))))}return Xt.default.createElement(x,{"data-testid":"maxai--chat-hub--layout-selector--group",direction:"row",alignItems:"center",sx:h},ex.map(P=>Xt.default.createElement(he,{title:u(P.tooltip),key:P.layout,disableInteractive:!0},Xt.default.createElement(ce,{"data-testid":`maxai--chat-hub--layout-selector--item--${P.layout}`,className:s===P.layout?"selected":"",disabled:d,key:P.layout,onClick:()=>f(P.layout)},Xt.default.createElement(T1,{sx:{fontSize:"16px"},layout:P.layout})))),Xt.default.createElement(X7,null))},Y7=TN;var Yo=I(w());var MN=()=>re(t=>t.conversationType)==="Art"?Yo.default.createElement(DS,null):Yo.default.createElement(gs,null),tx=()=>{let{variant:e}=_e();return{newChatButton:Yo.default.createElement(yu,{variant:"icon"}),aiModelSelector:e!=="chatHubInput"&&Yo.default.createElement(MN,null),chatHubLayoutSelector:Yo.default.createElement(Y7,null),aiLanguageSelector:Yo.default.createElement(ds,null),proChatSwitch:Yo.default.createElement(ms,null),portalRoot:Yo.default.createElement(x,{direction:"row",alignItems:"center",gap:"4px","data-testid":"maxai--chat-box--tools--left-container--portal-root",sx:{"&:empty":{display:"none"}}})}},wN=e=>{let{renderLeftNode:t,renderRightNode:o}=e,n=tx(),r={advancedButton:Yo.default.createElement(T7,null),historyButton:Yo.default.createElement(q7,null),newChatButton:Yo.default.createElement(yu,{variant:"icon"})},i=t?t(n):Yo.default.createElement(Yo.default.Fragment,null,n.proChatSwitch,n.aiModelSelector,n.chatHubLayoutSelector,n.aiLanguageSelector,n.portalRoot),a=o?o(r):Yo.default.createElement(Yo.default.Fragment,null,r.advancedButton,r.historyButton);return Yo.default.createElement(x,{direction:"row",justifyContent:"space-between",sx:{mb:1,gap:"8px"}},Yo.default.createElement(x,{direction:"row",alignItems:"center","data-testid":"maxai--chat-box--tools--left-container",sx:{flexWrap:"wrap",gap:"4px","&:empty":{display:"none"}}},i),Yo.default.createElement(x,{direction:"row",spacing:.5,alignItems:"start","data-testid":"maxai--chat-box--tools--right-container",sx:{"&:empty":{display:"none"}}},a))},Z7=wN;var EN=e=>{let{isMessageEmpty:t,isMessageLoading:o,renderHeaderNode:n,renderHeaderLeftNode:r,renderHeaderRightNode:i,renderFooterLeftNode:a,renderFooterRightNode:s,renderFooterNode:l,...p}=e,u=v=>!v.chatScreenshots.length&&!v.selectionContent,c=tx(),m={documentSelector:ut.default.createElement(l7,null),screenshotList:ut.default.createElement(Kv,null),artReferenceImageList:ut.default.createElement(Rv,null),selectionContent:ut.default.createElement($v,null),currentDocumentButton:ut.default.createElement(Cu,{enableState:u},ut.default.createElement(lv,null)),enableSearchButton:ut.default.createElement(Cu,{enableState:u},ut.default.createElement(cv,null)),selectDocumentButton:ut.default.createElement(Cu,{enableState:u},ut.default.createElement(Nv,null)),screenshotButton:ut.default.createElement(Cu,{enableState:u},ut.default.createElement(Fv,null)),betaFeaturesButton:ut.default.createElement(sv,null),upgradePlanButton:ut.default.createElement(zv,null),feedbackButton:ut.default.createElement(fv,null),usePromptButton:ut.default.createElement(h1,null),myOwnToolsButton:ut.default.createElement(Pv,null),autoSuggestion:ut.default.createElement(Mf,{isMessageEmpty:t,isMessageLoading:o}),uploadReferenceImageButton:ut.default.createElement(by,null),...c},d=n?n(m):ut.default.createElement(x,{gap:1,pt:"10px",pl:"10px",pr:"10px",mb:"-10px",sx:{"&:empty":{display:"none"}},"data-testid":"maxai--chat-box--chat-input--header"},m.screenshotList,m.selectionContent),f=r?r(m):ut.default.createElement(ut.default.Fragment,null,m.currentDocumentButton,m.enableSearchButton,m.selectDocumentButton),h=i?i(m):ut.default.createElement(ut.default.Fragment,null,m.screenshotButton),_=a?a(m):ut.default.createElement(ut.default.Fragment,null,m.myOwnToolsButton,m.upgradePlanButton),g=s?s(m):null,y=l?l(m):ut.default.createElement(ut.default.Fragment,null,m.autoSuggestion),[C,b]=(0,ut.useState)(!1);return ut.default.createElement(Gv,{minLine:3,headerNode:d,headerLeftNode:f,headerRightNode:h,footerLeftNode:_,footerRightNode:g,footerNode:y,...p,sx:{boxShadow:v=>C?v.palette.mode==="dark"?"0px 0px 0px 1px rgba(255, 255, 255, 0.12)":"0px 0px 0px 1px rgba(0, 0, 0, 0.12)":void 0,...p.sx},textareaProps:{onFocus:()=>b(!0),onBlur:()=>b(!1),...p.textareaProps}})},Q7=EN;var AN=e=>{let{toolsProps:t,inputProps:o,footerPrefix:n,sx:r,isMessageEmpty:i,isMessageLoading:a,updateChatBoxHeight:s,slotBottom:l}=e,{conversationId:p}=_e(),u=Gl(p),[c,m]=(0,Ps.useState)(!1);return u&&Hl(u)?null:Ps.default.createElement(B,{"data-testid":"maxai--chat-panel--footer",sx:{width:"100%",display:"flex",flexDirection:"column",justifyContent:"flex-start",overflow:"hidden",alignItems:"center",backgroundColor:d=>d.palette.background.default,...r}},Ps.default.createElement(x,{sx:{width:"100%",maxWidth:"var(--max-width)",margin:"0 auto",overflow:"hidden",p:1.5}},n,Ps.default.createElement(g3,{onShow:()=>m(!0),onClose:()=>m(!1)}),!c&&Ps.default.createElement(Z7,{...t}),!c&&Ps.default.createElement(Q7,{isMessageEmpty:i,isMessageLoading:a,...o}),l))},M1=AN;var J7=I(QM()),ox=I(w()),PN=e=>{let{needSystemOrThirdMessage:t=!1}=e,{t:o}=E(),{conversationId:n,conversationMessages:r,getConversation:i}=Bi();return r.filter(s=>t?!0:s.type!=="system"&&s.type!=="third").length===0||!n?null:ox.default.createElement(Vm,{title:o("package__features:chat__navbar__conversation_share__download_button__tooltip"),"data-testid":"history-text-download-button",sx:{border:s=>s.palette.mode==="dark"?"1px solid rgba(255, 255, 255, 0.12)":"1px solid rgba(0, 0, 0, 0.12)",borderRadius:"8px",padding:"6px"},onClick:async()=>{let s=await i(n);if(s?.title){let l=await yC(s,t),p=new Blob([l],{type:"text/plain;charset=utf-8"}),u=URL.createObjectURL(p),c=document.createElement("a");c.href=u,c.download=`MaxAI_Chat_${(0,J7.default)().format("YYYY_MM_DD_HH:mm")}.txt`,c.click(),URL.revokeObjectURL(u)}}},ox.default.createElement(U,{icon:"FileDownload",sx:{fontSize:"18px",color:"text.secondary"}}))},eT=PN;var Je=I(w()),tT=e=>`${nr}/share/?id=${e}`,kN=()=>{let{t:e}=E(),{features:t,loaded:o}=QC(),{conversation:n,conversationMessages:r,updateConversation:i,getConversation:a}=Bi(),[s,l]=(0,Je.useState)(!1),[p,u]=(0,Je.useState)(!1),[c,m]=(0,Je.useState)(null),d=n?.share?.enable===!0,f=n?.share?.id,h=b=>{m(b.currentTarget)},_=()=>{m(null)},g=(b=e("package__features:chat__navbar__conversation_share__share_panel__error_tip"))=>{oo.error(b,{anchorOrigin:{vertical:"top",horizontal:"center"}})},y=async b=>{if(n?.id)try{u(!0);let v=(await un.getService().shareConversation(n.id,b))?.share;v?.id?await i(n.id,{share:{enable:v.enable,id:v.id}}):g()}catch{g()}finally{u(!1)}},C=async b=>{if(!n?.id)return;let v=b.currentTarget.parentElement,S="";if(f)d||await y(!0),S=f;else try{if(!S){l(!0);let L=await a(n.id);if(!L){g();return}await un.getService().checkUpdate(n.id),await Ur.getService().checkUpdate(n.id);let H=(await un.getService().shareConversation(L.id,!0))?.share;H?.id&&H.enable&&(S=H.id,await i(L.id,{share:{enable:!0,id:H.id}}))}}catch{g()}finally{l(!1)}let P=tT(S);navigator.clipboard.writeText(P);let k=v?.querySelector('button[data-testid="maxai--conversation--share-button"]');h({currentTarget:b.currentTarget||k})};return o&&!t.chat_sync||r.length<=0?null:Je.default.createElement(x,{direction:"row",alignItems:"center",gap:1},d&&f&&Je.default.createElement(Gn,{copyText:tT(f),copyToClipboardTooltip:e("package__features:chat__navbar__conversation_share__copy_button__copy_link"),icon:Je.default.createElement(U,{icon:"Link"}),sx:{display:"flex",alignItems:"center",justifyContent:"center",border:b=>b.palette.mode==="dark"?"1px solid rgba(255, 255, 255, 0.12)":"1px solid rgba(0, 0, 0, 0.12)",borderRadius:"8px",minWidth:"unset",height:"32px",width:"32px"}}),Je.default.createElement(si,{"data-testid":"maxai--conversation--share-button",variant:"contained",sx:{display:"flex",alignItems:"center",height:"32px",gap:.5,borderRadius:"8px",padding:"8px"},loading:s,onClick:C},d?Je.default.createElement(U,{sx:{fontSize:"18px"},icon:"IosShare"}):Je.default.createElement(U,{sx:{fontSize:"18px"},icon:"Lock"}),Je.default.createElement(T,{component:"span",fontSize:"12px"},e("package__features:chat__navbar__conversation_share__share_button__title"))),Je.default.createElement(Fr,{PaperProps:{sx:{mt:1,boxShadow:"0px 4px 8px 0px rgba(0, 0, 0, 0.16)"}},elevation:1,anchorOrigin:{vertical:"bottom",horizontal:"right"},transformOrigin:{vertical:"top",horizontal:"right"},open:!!c,anchorEl:c,onClose:_},Je.default.createElement(x,{py:1,px:2,width:320,gap:1},Je.default.createElement(T,{fontSize:16,fontWeight:500},e("package__features:chat__navbar__conversation_share__share_panel__title")),Je.default.createElement(x,{sx:{"& > button":{border:"1px solid",width:"100%",p:1,borderColor:"border.main",borderRadius:"0 0 8px 8px",alignItems:"center",justifyContent:"start","&:not(:last-child)":{borderBottom:"none",borderRadius:"8px 8px 0 0"}}}},Je.default.createElement(ce,{"data-testid":"maxai--conversation--share-private-button",disabled:p,onClick:async()=>{await y(!1)}},Je.default.createElement(x,{width:"100%"},Je.default.createElement(x,{direction:"row",alignItems:"center",gap:1},p?Je.default.createElement(Jt,{size:16}):Je.default.createElement(U,{icon:"Lock",sx:{fontSize:"16px"}}),Je.default.createElement(T,{textAlign:"left",fontSize:"14px",color:"text.primary"},e("package__features:chat__navbar__conversation_share__share_panel__private_button__title")),!d&&Je.default.createElement(U,{icon:"GreenCircleCheck",sx:{ml:"auto",mr:0,fontSize:"20px"}})),Je.default.createElement(T,{textAlign:"left",fontSize:"12px",color:"text.secondary"},e("package__features:chat__navbar__conversation_share__share_panel__private_button__description")))),Je.default.createElement(ce,{disabled:p,onClick:async()=>{await y(!0)}},Je.default.createElement(x,{width:"100%"},Je.default.createElement(x,{direction:"row",alignItems:"center",gap:1},p?Je.default.createElement(Jt,{size:16}):Je.default.createElement(U,{icon:"Share",sx:{fontSize:"16px"}}),Je.default.createElement(T,{textAlign:"left",fontSize:"14px",color:"text.primary"},e("package__features:chat__navbar__conversation_share__share_panel__public_button__title")),d&&Je.default.createElement(U,{icon:"GreenCircleCheck",sx:{ml:"auto",mr:0,fontSize:"20px"}})),Je.default.createElement(T,{textAlign:"left",fontSize:"12px",color:"text.secondary"},e("package__features:chat__navbar__conversation_share__share_panel__public_button__description"))))),d&&Je.default.createElement(x,{direction:"row",alignItems:"center",gap:1},Je.default.createElement(U,{icon:"GreenCircleCheck",sx:{fontSize:"16px"}}),Je.default.createElement(T,{textAlign:"left",fontSize:"12px",color:"#379837"},e("package__features:chat__navbar__conversation_share__share_panel__copied_tip"))))))},oT=kN;var ei=I(w());var nT=I(w()),LN=()=>{let e=Il(),t=Bx(e.breakpoints.down("md")),o=Ra();return{isMiniScreen:(0,nT.useMemo)(()=>Hu()?t:o==="xs"||o==="sm",[o,t])}},w1=LN;var Iu=I(w());var nx="MAXAI_CLIENT__FEATURES__LAYOUT__WEBSITE_STATE";var rT="MAXAI_CLIENT__UI__HOME_NAVBAR_STATE",ON="MAXAI_SIDEBAR_FOLD_STATUS",bu=()=>({chatHistoryOpen:!0,toolbarCollapsed:!1,miniScreenToolbarOpen:!1,rightToolbarCollapsed:!1,rightMiniScreenToolbarOpen:!1}),rx=()=>{let e=bu();try{let t=window.localStorage.getItem(nx);if(t){let o=JSON.parse(t);Object.assign(e,o)}}catch{}try{let t=window.localStorage.getItem(rT);if(t){let o=JSON.parse(t);Object.assign(e,{chatHistoryOpen:o.conversationListPanelOpen??e.chatHistoryOpen})}}catch{}return window.localStorage.removeItem(rT),window.localStorage.removeItem(ON),{...e,miniScreenToolbarOpen:!1,rightMiniScreenToolbarOpen:!1}},iT=e=>{let t=rx(),o=Jo([t,e]);window.localStorage.setItem(nx,JSON.stringify(o))};var ix=vi({key:"AppWebsiteLayoutState",default:bu(),effects:[({onSet:e})=>{e(t=>{iT(t)})}]}),BN=vi({key:"AppWebsiteLayoutToolbarWidgetState",default:{disableExtensionAdCard:!1}});var DN=()=>{let e=vt(ix),{isLogin:t}=Mn(),{hasExtension:o}=gc(),{isMiniScreen:n}=w1(),r=!t||!o||n;return{...e,isMiniScreen:n,disabledCollapse:r,toolbarCollapsed:r?!1:e.toolbarCollapsed,rightToolbarCollapsed:n?!1:e.rightToolbarCollapsed}},FN=()=>{let e=po(ix),t=()=>{e(rx())},o=(u,c)=>{e(m=>m[u]===c?m:{...m,[u]:c})};return{syncLocalState:t,setChatHistoryOpen:u=>{o("chatHistoryOpen",u)},setToolbarCollapsed:u=>{o("toolbarCollapsed",u)},setToolbarWidth:u=>{o("toolbarWidth",u)},setMiniScreenToolbarOpen:u=>{o("miniScreenToolbarOpen",u)},setRightToolbarCollapsed:u=>{o("rightToolbarCollapsed",u)},setRightToolbarWidth:u=>{o("rightToolbarWidth",u)},setRightMiniScreenToolbarOpen:u=>{o("rightMiniScreenToolbarOpen",u)}}},E1=()=>{let e=DN(),t=FN();return{...e,...t}};var ax=I(w());var _Me=(0,ax.createContext)({...bu(),setToolbarCollapsed:()=>null,setMiniScreenToolbarOpen:()=>null,setRightToolbarCollapsed:()=>null,setRightMiniScreenToolbarOpen:()=>null});var A1=I(w()),HN=e=>{let{...t}=e,{chatHistoryOpen:o,setChatHistoryOpen:n}=E1(),{t:r}=E();return A1.default.createElement(he,{placement:"bottom",title:r(o?"package__features:chat__navbar__button__hide_chat_history":"package__features:chat__navbar__button__show_chat_history")},A1.default.createElement(Ve,{"data-testid":"sidebar-nav-topbar-show-or-hide-chat-history-button",onClick:()=>n(!o),...t},A1.default.createElement(U,{icon:"LayoutLeftIcon",sx:{fontSize:"24px",color:i=>i.palette.mode==="dark"?"rgba(255, 255, 255)":"rgba(0, 0, 0, 0.6)"}})))},aT=HN;var NN=e=>{let{newChatProps:t,switchVisibilityProps:o,sx:n}=e,{isMiniScreen:r}=w1();return Iu.default.createElement(x,{direction:"row",justifyContent:"space-between",alignItems:"center",sx:n},r?Iu.default.createElement(B,{sx:{height:"40px"}}):Iu.default.createElement(aT,{...o}),Iu.default.createElement(yu,{...t,tooltipProps:{placement:"bottom",...t?.tooltipProps},sx:{p:1,height:"auto",minWidth:"auto","& svg":{fontSize:24},...t?.sx}}))},sT=NN;var lT=I(w()),zN=e=>{let{topBarProps:t}=e,{isMiniScreen:o,chatHistoryOpen:n}=E1(),{chatHubOrder:r,variant:i}=_e();return i==="chatHub"&&r>0||o||n?null:lT.default.createElement(sT,{...t,sx:{pl:1,...t?.sx},newChatProps:{variant:"icon",...t?.newChatProps}})},pT=zN;var VN=e=>{let{leftNode:t,rightNode:o,footerNode:n,renderLeftNode:r,renderRightNode:i,sx:a}=e,s={actionsGroup:ei.default.createElement(pT,null)},l={downloadButton:ei.default.createElement(eT,null),shareButton:ei.default.createElement(oT,null)},p=r?r(s):ei.default.createElement(ei.default.Fragment,null,s.actionsGroup,t),u=i?i(l):ei.default.createElement(ei.default.Fragment,null,o,l.downloadButton,l.shareButton);return ei.default.createElement(x,{sx:{marginBottom:"-16px",...a},"data-testid":"maxai--chat-box-header"},ei.default.createElement(x,{"data-testid":"maxai--chat-box-header--first-line",sx:{flexDirection:"row"}},ei.default.createElement(x,{direction:"row",alignItems:"center",gap:1,pl:1},p),ei.default.createElement(x,{direction:"row",flex:1,width:0,justifyContent:"end",alignItems:"center",gap:1,pr:1},u)),n)},P1=VN;var RN=e=>{let{headerProps:t,messageProps:o,toolsProps:n,inputProps:r,footerPrefix:i,footerProps:a,emptyNode:s,sx:l}=e,p=re(G=>G.conversationType),{betaSettings:u}=En(),c=p==="ContextMenu",{conversationId:m}=_e(),d=xe(m),[f,h]=(0,Vt.useState)(0),_=p==="Art",g=G=>Vt.default.createElement(M1,{...a,...G,inputProps:{...r,textareaProps:{...r?.textareaProps,disabled:r?.textareaProps?.disabled||d}},toolsProps:n,footerPrefix:i,updateChatBoxHeight:h}),y=({isMessageEmpty:G,isMessageLoading:q,...A})=>c?G?null:g({isMessageEmpty:G,isMessageLoading:q,...A}):u?.appearance_v2_enabled?q&&!G?null:g({isMessageEmpty:G,isMessageLoading:q,...A}):g({isMessageEmpty:G,isMessageLoading:q,...A}),C=co(),[b,v]=(0,Vt.useState)(48);(0,Vt.useEffect)(()=>{let G=()=>{if(C){let q=C.querySelector('[data-testid="maxai--chat-box-header"]');q&&v(q.clientHeight)}};G(),setTimeout(()=>{G()},1e3)},[]);let[S,P]=(0,Vt.useState)("100%");(0,Vt.useEffect)(()=>{let G=()=>{let q=Math.max(window.innerHeight-b,500);P(`${q}px`)};return G(),window.addEventListener("resize",G),()=>{window.removeEventListener("resize",G)}},[b]);let[k,L]=(0,Vt.useState)(null),{rect:H}=nC({target:k,windowScroll:!0,observeOptions:{childList:!0,subtree:!0}}),W=500;(0,Vt.useEffect)(()=>{if(H){let G=H.height;D(Math.max(G,W))}},[H]);let[O,D]=(0,Vt.useState)(W),V=b-106,N="26dvh",z=b+32,j=(G,q)=>Vt.default.createElement(x,{ref:L,"data-testid":"maxai--chat-box--center--container",sx:{"--chatGptMarginTopContainHeader":Or?"48px":"0px","--chatGptMarginTopExcludeAIReplyDescription":"0px","--headerHeight":`${b}px`,"--homeViewMinHeight":`${O}px`,"--minReservationHeight":`calc(var(--homeViewMinHeight) + ${z}px)`,width:"100%",alignItems:"center",marginTop:`max(${V}px, min(calc(100dvh - var(--minReservationHeight)), calc(${N} + var(--chatGptMarginTopContainHeader) - var(--chatGptMarginTopExcludeAIReplyDescription))))`,maxHeight:S}},Vt.default.createElement(qS,{isMessageEmpty:G,chatBoxHeight:f,sx:{display:G?"flex":"none"}}),y({isMessageEmpty:G,isMessageLoading:q}));return Vt.default.createElement(x,{className:"maxai--chat-box",sx:{flex:1,height:0,width:"100%","& *":{boxSizing:"border-box"},...d?{}:{[`.${Ul}`]:{display:"none"}},...l}},Vt.default.createElement(P1,{...t}),Vt.default.createElement(x,{sx:{flex:1,justifyContent:"center",flexDirection:"row",height:0,width:"100%",maxHeight:"100%"}},Vt.default.createElement(yg.Provider,{value:o||PI},Vt.default.createElement(Rp,{emptyNode:s},({isShowHomeView:G,isLoading:q,listNode:A})=>Vt.default.createElement(x,{className:"maxai--chat-box--content","data-message-empty":G,"data-message-loading":q,sx:{flex:1,width:"100%",alignItems:"center",overflow:"hidden",justifyContent:"flex-start"}},_?Vt.default.createElement(Vt.default.Fragment,null,G&&Vt.default.createElement(KS,{sx:{"--minReservationHeight":"380px",marginTop:`max(${V}px, min(calc(100dvh - var(--minReservationHeight)), ${N}))`}}),A,y({isMessageEmpty:G,isMessageLoading:q,slotBottom:G?Vt.default.createElement(x,{alignItems:"center",maxWidth:768,mx:"auto",width:"100%",py:1.5,gap:1.5},Vt.default.createElement(Cf,null)):null})):G?j(G,q):Vt.default.createElement(Vt.default.Fragment,null,A,y({isMessageEmpty:G,isMessageLoading:q})))))))},cT=RN;var hr=I(w()),UN=({isFullscreen:e,children:t,onClose:o})=>{let{t:n}=E(),r=(0,hr.useCallback)(l=>{l.key==="Escape"&&o()},[o]);(0,hr.useEffect)(()=>(e&&document.addEventListener("keydown",r),()=>{document.removeEventListener("keydown",r)}),[e,r]);let i=(0,hr.useMemo)(()=>({width:"100%!important",height:"100%!important",maxWidth:"100%!important",maxHeight:"100%!important",position:"fixed",top:0,left:0,zIndex:1502,backgroundColor:"rgba(0, 0, 0, 0.5)",display:"flex",justifyContent:"center",alignItems:"center"}),[]),a=(0,hr.useMemo)(()=>({backgroundColor:"background.default",height:"95vh",padding:"24px",boxSizing:"border-box",maxHeight:"calc(100vh - 32px)",maxWidth:"768px!important",position:"relative",borderRadius:"8px",width:"calc(100vw - 32px)"}),[]),s=(0,hr.useMemo)(()=>({border:"1px solid",borderColor:"border.main",borderRadius:"8px",flex:1,height:"0"}),[]);return hr.default.createElement(B,{sx:{width:"100%",height:"100%",position:"relative",...e?i:{}},onClick:()=>o()},hr.default.createElement(x,{sx:{width:"100%",height:"100%",gap:"24px",...e?a:{}},onClick:l=>l.stopPropagation()},hr.default.createElement(x,{"data-testid":"chat-hub-chat-box-wrapper",sx:{width:"100%",height:"100%",...e?s:{}}},t),e&&hr.default.createElement(x,{sx:{flexDirection:"row",justifyContent:"flex-end"}},hr.default.createElement(ce,{variant:"contained",onClick:()=>o()},n("package__features:chat__chat_hub_box__exit_full_screen")))))},uT=UN;var pn=I(w());var WN=e=>{let{headerProps:t,emptyNode:o,sx:n}=e,{t:r}=E(),i=re(u=>u.layout),[a,s]=(0,pn.useState)(!1),{chatHubOrder:l}=_e(),{chatHubLoading:p}=ot();return pn.default.createElement(x,{component:"div",position:"relative",sx:{width:"100%","& *":{boxSizing:"border-box"},...p?{}:{[`.${Ul}`]:{display:"none"}},...n}},pn.default.createElement(uT,{isFullscreen:a,onClose:()=>s(!1)},pn.default.createElement(P1,{...t}),pn.default.createElement(x,{sx:{flex:1,justifyContent:"center",flexDirection:"row",height:0,width:"100%"}},pn.default.createElement(x,{sx:{flex:1,width:"100%"}},pn.default.createElement(Rp,{emptyNode:o},({isShowHomeView:u,listNode:c})=>pn.default.createElement(pn.default.Fragment,null,u&&pn.default.createElement("div",{style:{flex:1}}),c)),a?null:pn.default.createElement(x,{sx:{p:"12px",flexDirection:"row",justifyContent:"space-between"}},pn.default.createElement(ef,null,u=>u==="pro_chat"?pn.default.createElement(FS,{order:l}):pn.default.createElement("div",null)),i>1&&pn.default.createElement(ne,{placement:"top",title:r("package__features:chat__chat_hub_box__full_screen"),onClick:()=>s(!a)},pn.default.createElement(n2,{sx:{color:"text.secondary"}})))))))},mT=WN;var k1=I(w()),GN=e=>{let{sx:t,footerProps:o,inputProps:n,footerPrefix:r,toolsProps:i}=e;return k1.default.createElement(x,{component:"div",position:"relative",sx:{flex:1,width:"100%","& *":{boxSizing:"border-box"},...t}},k1.default.createElement(x,{sx:{flex:1,width:"100%"}},k1.default.createElement(M1,{...o,inputProps:n,toolsProps:i,footerPrefix:r})))},dT=GN;var fl=I(w());var jN=e=>{let{emptyNode:t,sx:o}=e,{conversationId:n}=_e(),r=xe(n);return fl.default.createElement(x,{sx:{flex:1,width:"100%","& *":{boxSizing:"border-box"},...r?{}:{[`.${Ul}`]:{display:"none"}},...o}},fl.default.createElement(x,{sx:{flex:1,justifyContent:"center",flexDirection:"row",height:0,width:"100%"}},fl.default.createElement(x,{sx:{flex:1,width:"100%"}},fl.default.createElement(Rp,{emptyNode:t},({listNode:i})=>fl.default.createElement(fl.default.Fragment,null,i)))))},fT=jN;var ks=I(w()),KN=e=>{let{children:t,variant:o,conversationId:n,chatHubOrder:r,inputMediator:i=kt("Chat"),...a}=e,s=(0,ks.useMemo)(()=>({variant:o,conversationId:n,chatHubOrder:r,inputMediator:i}),[o,n,r,i]);return ks.default.createElement(JC.Provider,{value:s},o==="normal"&&ks.default.createElement(cT,{...a}),o==="chatHub"&&ks.default.createElement(mT,{...a}),o==="chatHubInput"&&ks.default.createElement(dT,{...a}),o==="share"&&ks.default.createElement(fT,{...a}),o==="custom"&&t)},L1=KN;var hT=I(w()),qN=({children:e,...t})=>{let{sx:o,...n}=t;return hT.default.createElement(Pa,{anchor:"bottom",open:!0,sx:{display:"flex",zIndex:1502,position:"absolute",[`& .${Aa.paper}`]:{position:"absolute",borderTopRightRadius:8,borderTopLeftRadius:8,height:"80vh",bgcolor:"background.paper",backgroundImage:"unset"},"& .maxai--browser-window":{border:"none !important",borderRadius:"0px !important",boxShadow:"none !important"},...o},disableScrollLock:!0,disableEnforceFocus:!0,slotProps:{root:{},backdrop:{sx:{position:"absolute"}}},...n},e)},gT=qN;var $i=I(w()),$N=e=>{let{children:t,reference:o,offset:n=16,sx:r}=e,[i,a]=(0,$i.useState)(0),[s,l]=(0,$i.useState)(0),[p,u]=(0,$i.useState)(0),c=(0,$i.useCallback)(()=>{if(!o)return;let d=o.getBoundingClientRect(),f=n*2,h=Math.min(616,d.left-f),_=Math.max(n,d.left-h-n);u(d.top),l(_),a(h)},[n,o]);(0,$i.useEffect)(()=>{if(!o)return;let d=li(()=>{c()},0),f=new ResizeObserver(d);return f.observe(o),window.addEventListener("resize",d),()=>{window.removeEventListener("resize",d),f.disconnect()}},[c,o]);let m=dm("maxai-animation-slide-in",{duration:250});return $i.default.createElement(x,{sx:{position:"fixed",zIndex:1e3,width:i,marginTop:`${n}px`,height:`calc(100vh - ${n*2}px)`,left:s,top:p,display:i>0?"flex":"none",flexDirection:"column","&:empty":{display:"none"},...m,...r}},t)},xT=$N;var Ls=I(w());var hl=I(w());var Hn=I(w());var XN=()=>{let e=re(o=>o.conversationIds);return ry(e)>0?null:Hn.default.createElement(qd,{sx:{position:"relative",bottom:0,mb:1,mt:-.5,zIndex:1501}})},YN=e=>{let{footerProps:t,inputProps:o,toolsProps:n,footerPrefix:r}=e,i=re(O=>O),{conversationIds:a,conversationType:s,layout:l}=i,{askAIWithShortcuts:p,askAIWithShortcutsV2:u,stopGenerate:c}=Ne(),m=Ke({askAIWithShortcuts:p,askAIWithShortcutsV2:u,stopGenerate:c}),d=a.slice(0,l),f=d[0],{updateConversation:h,getConversation:_}=qe(),{getDefaultValueModel:g,getChatHubDefaultValueModel:y}=$l(),C=(0,Hn.useCallback)(async O=>O===0?await g():await y(O),[g,y]),b=Fo.use.chatHub(),v=Fo.use.chat(),S=(0,Hn.useCallback)(async(O,D)=>{if(!await _(O))return;let N=D===0?v:b[D],j=Ph(N)?await C(D):N,G=en(j.AIProvider,j.AIModel);G&&await h(O,{meta:{AIProvider:G.AIProvider,AIModel:G.value,maxTokens:G.maxTokens}})},[h,_,C,v,b]),P=(0,Hn.useCallback)(async(O,D,V)=>{let N=i.layout;D[D.length-1].type==="SET_VARIABLES_MODAL"&&(N=1);let[z,j]=await Promise.all([P_.getLocalSettings(),EC.getBetaSettings()]);return z.chatMode!=="pro_chat"&&(N=1,i.setLayout(1)),await Promise.all(d.slice(0,N).map(async(G,q)=>{let A=q===0?v:b[q],Q=Ph(A)?await C(q):A,M=De(D).map(K=>(K.parameters.ActionChatMessageOperationType==="add"&&K.parameters.ActionChatMessageConfig&&(K.parameters.ActionChatMessageConfig.conversationId=G,K.parameters.ActionChatMessageType==="system"&&(K.parameters.ActionChatMessageConfig.originalMessage={...K.parameters.ActionChatMessageConfig.originalMessage,metadata:{...K.parameters.ActionChatMessageConfig.originalMessage?.metadata,AIModel:Q.AIModel}})),K.parameters.AskChatGPTActionQuestion&&(K.parameters.AskChatGPTActionQuestion.conversationId=G),K));return j.appearance_v2_enabled?m.current.askAIWithShortcutsV2(M,{...V,conversationId:G,disabledMaxAIDocumentIds:!0,onBeforeRun:async()=>{await S(G,q)}}):m.current.askAIWithShortcuts(M,{...V,conversationId:G,onBeforeRun:async()=>{await S(G,q)}})})),null},[d,v,b,C,S]),k=(0,Hn.useCallback)(()=>(d.forEach(O=>{m.current.stopGenerate(O)}),!0),[d]),L=(0,Hn.useMemo)(()=>x_(O=>({...i,onRunShortcutsActions:P,onStopShortcutsActions:k})),[]);(0,Hn.useEffect)(()=>{L.setState({...i,onRunShortcutsActions:P,onStopShortcutsActions:k})},[i,P,k]);let{chatHubLoading:H}=ot(),W=(0,Hn.useMemo)(()=>{let O=o?.(f,0,{conversationId:f});return{...O,textareaProps:{...O?.textareaProps,disabled:O?.textareaProps?.disabled||H},sendButtonProps:{...O?.sendButtonProps,loading:O?.sendButtonProps?.loading||H}}},[o,f,H]);return Hn.default.createElement(R_.Provider,{value:L},Hn.default.createElement(x,{sx:{flexShrink:0,"--max-width":"768px"}},Hn.default.createElement(L1,{chatHubOrder:0,inputMediator:kt(s),variant:"chatHubInput",conversationId:f,toolsProps:n?.(f,0,{conversationId:f}),inputProps:W,footerProps:t?.(f,0,{conversationId:f}),footerPrefix:r?.(f,0,{conversationId:f})}),Hn.default.createElement(XN,null)))},_T=YN;var ZN=e=>{let{chatHubSlot:t,children:o,...n}=e,r=re(a=>({conversationIds:a.conversationIds,layout:a.layout,conversationType:a.conversationType})),i=(0,hl.useMemo)(()=>{let a={flex:1,height:0,display:"flex",flexDirection:"row",flexWrap:"wrap"};return r.layout===1?{...a,"& > div":{width:"100%",maxWidth:"100%",height:"100%",borderBottom:"1px solid",borderRight:"1px solid",borderColor:"border.main",display:"none!important","&:nth-of-type(-n+1)":{display:"flex!important"}}}:r.layout===2?{...a,"& > div":{width:"50%",maxWidth:"50%",height:"100%",borderBottom:"1px solid",borderRight:"1px solid",borderColor:"border.main",display:"none!important","&:nth-of-type(-n+2)":{display:"flex!important"},"&:nth-of-type(2n)":{borderRight:"none"}}}:r.layout===3?{...a,"& > div":{width:"33.33%",maxWidth:"33.33%",height:"100%",borderBottom:"1px solid",borderRight:"1px solid",borderColor:"border.main",display:"none!important","&:nth-of-type(-n+3)":{display:"flex!important"},"&:nth-of-type(3n)":{borderRight:"none"}}}:r.layout===4?{...a,"& > div":{maxWidth:"50%",width:"50%",height:"50%",borderBottom:"1px solid",borderRight:"1px solid",borderColor:"border.main",display:"none!important","&:nth-of-type(-n+4)":{display:"flex!important"},"&:nth-of-type(2n),&:nth-of-type(4n)":{borderRight:"none"}}}:r.layout===6?{...a,"& > div":{maxWidth:"33.33%",width:"33.33%",height:"50%",borderBottom:"1px solid",borderRight:"1px solid",borderColor:"border.main",display:"none!important","&:nth-of-type(-n+6)":{display:"flex!important"},"&:nth-of-type(3n),&:nth-of-type(6n)":{borderRight:"none"}}}:a},[r.layout]);return r.conversationIds.length<=1||r.layout===1?hl.default.createElement(x,{className:"maxai-client--chat-hub--container",flex:1,width:"100%",height:"100%",sx:{backgroundColor:"background.default"}},y2(o)?o.slice(0,1):o):hl.default.createElement(x,{className:"maxai-client--chat-hub--container",flex:1,width:"100%",height:"100%",sx:{flexDirection:"column",backgroundColor:"background.default"}},t,hl.default.createElement(x,{sx:i},o),hl.default.createElement(_T,{...n}))},CT=ZN;var QN=e=>{let{variant:t,leftPanelSide:o="flexbox",leftPanelContent:n,rightPanelSide:r="flexbox",rightPanelContent:i,chatHubSlot:a,chatHubSx:s,children:l,onPanelClose:p,headerProps:u,footerProps:c,inputProps:m,toolsProps:d,footerPrefix:f,messageProps:h,sx:_}=e,{conversationIds:g,conversationType:y,layout:C}=re(S=>({conversationIds:S.conversationIds,conversationType:S.conversationType,layout:S.layout})),b=Ls.default.useRef(null),v=(S,P)=>{if(!P)return null;if(S==="separateWindow"&&b.current)return Ls.default.createElement(xT,{reference:b.current,sx:{top:0}},P);if(S==="flexbox")return Ls.default.createElement(x,{flex:1,sx:{"&:empty":{display:"none"}}},P);if(S==="custom")return P;if(S==="drawer"&&b.current)return Ls.default.createElement(gT,{onClose:p},P)};return Ls.default.createElement(x,{ref:b,className:"maxai--chat-hub",sx:{width:"100%",height:"100%",flex:1,flexDirection:"row","--max-width":C>1||lo?"100%":"768px","& *":{boxSizing:"border-box"},...s}},v(o,n),Ls.default.createElement(CT,{chatHubSlot:a,...e},g.map((S,P)=>Ls.default.createElement(L1,{inputMediator:kt(y),chatHubOrder:P,variant:t||(C>1?"chatHub":"normal"),conversationId:S,key:g.length===1?P:S,headerProps:u?.(S,P,{conversationId:S}),footerProps:c?.(S,P,{conversationId:S}),inputProps:m?.(S,P,{conversationId:S}),toolsProps:d?.(S,P,{conversationId:S}),footerPrefix:f?.(S,P,{conversationId:S}),messageProps:h?.(S,P,{conversationId:S}),sx:_?.(S,P,{conversationId:S})},l))),v(r,i))},yT=QN;var Nn=I(w());var Os=I(w());var JN=()=>{let[{stack:e},t]=Br(g6),o=Ei(e),n=!!o,{t:r}=E(["client","common"]),i=(0,Os.useCallback)(async u=>{o&&(await u6.send("DiscardModalClose",{discardId:o.discardId,confirm:u==="confirm",cancel:u==="cancel"}),t(c=>({...c,stack:c.stack.slice(0,c.stack.length-1)})))},[o,t]),a=(0,Os.useCallback)(()=>i("confirm"),[i]),s=(0,Os.useCallback)(()=>i("cancel"),[i]),l=Ke(s),p=Ke(n);return(0,Os.useEffect)(()=>{let u=c=>{p.current&&c.key==="Escape"&&(c.stopPropagation(),c.preventDefault(),l.current?.())};return window.addEventListener("keydown",u,!0),()=>{window.removeEventListener("keydown",u)}},[p,l]),Os.default.createElement(Wr,{show:n,title:o?.content||"",onConfirm:a,onClose:s,modalSx:{zIndex:2147483621},wrapSx:{width:"288px"},variant:"danger",confirmBtnText:r("common:discard"),cancelBtnText:r("common:cancel"),isFixed:!0})},bT=JN;var le=I(w());var et=I(w());var Kp=24,IT=8,ez=(e=window.innerHeight*.5)=>Math.max(Math.floor(e/24)||5),gl=(e,t=0,o=0,n=0,r)=>{let i=e?.parentElement?.parentElement;if(e&&i){let a=window.getComputedStyle(e),s=Number(e.getAttribute("data-min-line"))||1,l=parseInt(a.paddingTop??IT,10)+parseInt(a.paddingBottom??IT,10);e.style.cssText="height:0px";let p=e.value?e.scrollHeight:Kp*s+l,u=Math.min(Kp*ez(r),p);n===0&&(n=e?.previousElementSibling?.offsetHeight||0);let c=Math.max(Kp*s+l,n||0);u=Math.max(c,u),e.style.cssText=`height: ${u}px`;let m=u+t+o;i.style.cssText=`height: ${m}px`}},tz=(e,t=0,o=0,n=0,r)=>{gl(e,t,o,n,r),setTimeout(()=>{gl(e,t,n,r);let i=e.value;e.focus(),e.setSelectionRange(i.length,i.length)},100)},O1=(e,t=0,o=0,n=0)=>{if(!e)return;let r="",i=document.querySelector('div[data-testid=sentinelStart][tabindex="0"]');if(i?.nextElementSibling&&i.nextElementSibling.getAttribute("tabindex")==="-1"&&(r="mui",i.nextElementSibling.removeAttribute("tabindex")),window.location.host==="www.linkedin.com"){let a=document.querySelector('div[tabindex="-1"][role="dialog"]');a&&(r="linkedin",a.removeAttribute("tabindex"),document.activeElement?.blur(),setTimeout(()=>{a.setAttribute("tabindex","-1")},100))}e.isSameNode(B_())||e.isSameNode(D_())||tz(e,t,o,n)},oz=e=>{let{defaultValue:t,onChange:o,onEnter:n,onKeydown:r,onKeydownCapture:i,loading:a,children:s,error:l=!1,InputId:p=yl,stopPropagation:u=!0,placeholder:c="Ask AI...",expandNode:m,sx:d,minLine:f=1,maxHeight:h,autoFocus:_,prefixNode:g,onControlledValueChange:y}=e,C=vt(W2),{currentSidebarConversationId:b,currentSidebarConversationType:v}=op(),S=vt(Jl),P=(0,et.useRef)(null),k=(0,et.useRef)(!1),L=(0,et.useRef)(!1),[H,W]=(0,et.useState)(t||""),O=(0,et.useRef)(0),D=(0,et.useRef)(0),V=(0,et.useRef)(0),N=(0,et.useRef)(null),z=(0,et.useRef)(null),j=(0,et.useRef)(null),G=(0,et.useMemo)(()=>li(gl,200),[]),q=(0,et.useRef)(xc()),A=K=>[O.current,V.current,D.current,h],Y=(0,et.useCallback)(K=>{let F=K.target.value;p===yl?kt("chatBoxInputMediator").updateInputValue(F):p===Si&&kt("floatingMenuInputMediator").updateInputValue(F),W(F),o&&o(F,{includeHistory:!L.current})},[o]),Q=(0,et.useRef)({});(0,et.useEffect)(()=>{if(p===yl){let K=(F,pe)=>{pe&&(Q.current=pe),F.startsWith("``NO_HISTORY_&#``\n")&&(F=F.replace("``NO_HISTORY_&#``\n",""),L.current=!0),W(F)};return kt("chatBoxInputMediator").subscribe(K),()=>{kt("chatBoxInputMediator").unsubscribe(K)}}else if(p===Si){let K=(F,pe)=>{F.startsWith("``NO_HISTORY_&#``\n")&&(F=F.replace("``NO_HISTORY_&#``\n",""),L.current=!0),W(F),pe?.selectAll&&setTimeout(()=>{P.current?.focus(),P.current?.setSelectionRange(0,F.length)},50)};return kt("floatingMenuInputMediator").subscribe(K),()=>{kt("floatingMenuInputMediator").unsubscribe(K)}}},[p]),(0,et.useEffect)(()=>{L.current=!1,Q.current={}},[a]),(0,et.useEffect)(()=>{G(P.current,...A("inputValue1")),setTimeout(()=>{P.current&&gl(P.current,...A("inputValue2"))},0)},[H]),(0,et.useEffect)(()=>{let K=new ResizeObserver(ae=>{for(let te of ae)setTimeout(()=>{O.current=te.target?.offsetHeight||0,P.current&&gl(P.current,...A("children"))},30)}),F=new ResizeObserver(()=>{setTimeout(()=>{(j.current?.offsetHeight??0)!==V.current&&(V.current=j.current?.offsetHeight||0,P.current&&gl(P.current,...A()))},0)}),pe=new ResizeObserver(ae=>{for(let te of ae)setTimeout(()=>{D.current=te.target?.offsetHeight||0,P.current&&gl(P.current,...A("expand"))},100)});return z.current&&pe.observe(z.current),N.current&&K.observe(N.current),j.current&&F.observe(j.current),()=>{K.disconnect(),pe.disconnect(),F.disconnect()}},[]),(0,et.useEffect)(()=>{S&&P.current&&p===Si&&O1(P.current,...A("floatingDropdownMenu"))},[S]),(0,et.useEffect)(()=>{(C.open||q.current)&&P.current&&p===yl&&!Ym()&&O1(P.current,...A("appState"))},[C.open,a,v,b]),cn(()=>{if(p===yl&&q.current){let K=setTimeout(()=>{O1(P.current,...A("appState"))},100);return()=>clearTimeout(K)}});let M=nd(y);return(0,et.useEffect)(()=>{M.current?.(H,p)},[p,H,M]),et.default.createElement(B,{component:"div",className:a?"chat-box__input--loading":"",borderRadius:"8px",border:"1px solid",borderColor:`${l?"rgb(239, 83, 80)":"border.main"}`,width:"100%",minHeight:34,sx:{display:"flex",alignItems:"center",flexDirection:"row",flexWrap:"wrap",overflow:"hidden","& .chat-box__input-skeleton":{opacity:0,zIndex:-1,position:"absolute",top:0,padding:"8px",left:0,width:"100%",display:"none"},"&.chat-box__input--loading":{maxHeight:"106.5px",overflow:"hidden",position:"relative","& textarea":{opacity:0},"& .chat-box__input-skeleton":{opacity:1,zIndex:1,display:"block"}},...d}},et.default.createElement(B,{component:"div",className:"chat-box__input-skeleton"},et.default.createElement(vo,{height:Kp})),et.default.createElement(B,{ref:j,className:"chat-box__input\u2014prefix",sx:{width:"100%"}},g),et.default.createElement(x,{alignItems:"start",width:"100%",direction:"row",sx:{"& > textarea":{p:1,maxHeight:a?Kp*f+16:"unset",color:K=>K.palette.mode==="dark"?"#fff":"rgba(0,0,0,.87)!important",my:1.5,fontSize:"16px",lineHeight:Kp+"px",background:"transparent!important",borderColor:"transparent!important",margin:"0!important",border:"0!important",outline:"0!important",boxShadow:"none!important",width:"100%",resize:"none",overflow:"hidden",overflowY:"auto",fontFamily:'"Roboto","Helvetica","Arial",sans-serif!important',"&::-webkit-scrollbar":{width:0,background:"transparent"},"&::-webkit-scrollbar-thumb":{background:"transparent"}}}},et.default.createElement(x,{ref:z,className:"max-ai-user-input__expand",sx:{"&:has(> div)":{py:1,pl:1},alignSelf:"start"}},m),et.default.createElement("textarea",{id:p,placeholder:c,disabled:a,ref:P,value:H,rows:1,"data-min-line":f,onCopy:K=>{K.stopPropagation()},onCut:K=>{K.stopPropagation()},onKeyUp:K=>{u&&K.stopPropagation()},onKeyPress:K=>{u&&K.stopPropagation()},onKeyDown:K=>{if(!(i&&i(K))){if(u){if((K.key==="ArrowUp"||K.key==="ArrowDown"||K.key==="ArrowLeft"||K.key==="ArrowRight"||K.key==="Escape")&&p===Si)return;K.stopPropagation()}if(!k.current){if(!(K.key==="Enter"&&K.shiftKey)){if(K.key==="Enter"){K.preventDefault();let F=K.currentTarget.value;n&&n(F,{includeHistory:!L.current,meta:Q.current}),L.current=!1,Q.current={}}else if(K.code==="Space"){K.stopPropagation();return}}r&&r(K)}}},onClick:K=>{O1(K.currentTarget,...A("click"))},onCompositionUpdate:K=>{u&&K.stopPropagation()},onCompositionStart:K=>{u&&K.stopPropagation(),k.current=!0},onCompositionEnd:K=>{u&&K.stopPropagation(),k.current=!1,Y(K)},onInput:K=>{u&&K.stopPropagation(),k.current?W(K.currentTarget.value):Y(K)},onBlur:K=>{G(K.currentTarget,...A("blur"))},autoFocus:_})),et.default.createElement(x,{ref:N,width:"100%"},s))},ST=oz;var Su=I(w());var sx=()=>{let{t:e}=E(["client"]),{setUserSettings:t,userSettings:o}=sr(),{conversationId:n="",conversationMessages:r}=Mt(),{getConversation:i}=qe(),{continueConversationInSidebar:a}=op(),{floatingDropdownMenuOpen:s}=os(),l=o?.alwaysContinueInSidebar,p=async()=>{if(!await Fe({emitEvent:!0}))return;let u=!l,c=await i(n);c?.lastMessageId&&u&&a(c.id),await t({...o,alwaysContinueInSidebar:u})};return!s||r.length?null:Su.default.createElement(zr,{title:e(l?"floating_menu__always_unpin_to_sidebar":"floating_menu__always_pin_to_sidebar"),onClick:p,floatingMenuTooltip:!0,placement:"top"},Su.default.createElement("span",null,Su.default.createElement(ne,{"data-testid":l?"maxai--context-window--always-responses-in-contextmenu--button":"maxai--context-window--always-responses-in-sidebar--button",sx:{width:32,height:32}},Su.default.createElement(U,{icon:l?"AlwaysResponsesInContextMenu":"AlwaysResponsesInSidebar"}))))};var B1=I(w());var lx=e=>{let{sx:t,TooltipProps:o}=e,{t:n}=E(["client"]),{hideFloatingContextMenu:r}=os(),{betaSettings:i}=En();if(i?.appearance_v2_enabled)return null;let a=async()=>{let s=bm();if(s){r(),ra();let l=await Fh(s,'button[data-testid="maxai--sidebar--contextmenu_tab"]',50,5e3);if(!l)return;l?.click(),await new Promise(u=>setTimeout(u,1e3)),(await Fh(s,'button[data-testid="maxai-chat-history-button"]',50,5e3))?.click()}};return B1.default.createElement(zr,{title:n("client:sidebar__speed_dial__chat_history__button"),placement:"bottom",...o},B1.default.createElement(Ve,{onClick:a,"data-testid":"maxai-context-window-history-button",sx:{width:"28px",height:"28px",color:"text.primary",minWidth:"unset",borderRadius:"8px",border:"1px solid",borderColor:"border.main",...t},TouchRippleProps:{center:!1}},B1.default.createElement(U,{icon:"History",sx:{fontSize:"20px"}})))};var Xi=I(w());var D1={ChatInSidebar:{value:"chat-in-sidebar",label:"client:context_menu__button__chat_in_sidebar__title",icon:Xi.default.createElement(U,{icon:"ChatInSidebar"})},AlwaysChatInSidebar:{value:"always-chat-in-sidebar",label:"client:context_menu__button__always_chat_in_sidebar__title",icon:Xi.default.createElement(U,{icon:"AlwaysResponsesInSidebar"})}},px=()=>{let{t:e}=E(),{setUserSettings:t,userSettings:o}=sr(),{conversationId:n,conversationMessages:r}=Mt(),{continueConversationInSidebar:i}=op(),a=(0,Xi.useMemo)(()=>Object.values(D1).map(p=>({...p,label:e(p.label)})),[e]),s=(0,Xi.useMemo)(()=>o?.alwaysContinueInSidebar?D1.AlwaysChatInSidebar:D1.ChatInSidebar,[o]),l=async p=>{n&&(i(n),p===D1.AlwaysChatInSidebar.value&&await t({...o,alwaysContinueInSidebar:!0}))};return r.length?Xi.default.createElement(Ka,{isMirror:!0,hoverOpen:!0,placement:"bottom-start",headless:!0,referenceElement:Xi.default.createElement(ne,{"data-testid":"maxai-context-window-continue-chat-button",onClick:p=>{p.stopPropagation(),l(s.value)}},s.icon,Xi.default.createElement(T,{sx:{fontSize:"14px"}},e(s.label))),sx:{zIndex:2147483602},modifiers:[{name:"offset",options:{offset:[0,6]}}]},Xi.default.createElement(Da,{sx:{width:"240px"},defaultValue:s.value,options:a,onSelectOption:l})):null};var cx=I(w());var rz=I(w());var vT=I(Mi()),Bs=I(w());var _Pe=e=>Bs.default.createElement(vT.default,{...e},Bs.default.createElement("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},Bs.default.createElement("path",{d:"M6.38095 14.8256L5.71627 11.8449H6.39567L6.78114 13.8211L7.24333 11.8449H7.82387L8.2904 13.8233L8.67364 11.8449H9.35093L8.68626 14.8256H7.98793L7.53225 12.9908L7.08348 14.8256H6.38095Z",fill:"currentColor"}),Bs.default.createElement("path",{d:"M10.9345 14.8256L10.2699 11.8449H10.9493L11.3347 13.8211L11.7969 11.8449H12.3775L12.844 13.8233L13.2272 11.8449H13.9045L13.2398 14.8256H12.5415L12.0858 12.9908L11.6371 14.8256H10.9345Z",fill:"currentColor"}),Bs.default.createElement("path",{d:"M15.4881 14.8256H16.1906L16.6394 12.9908L17.0951 14.8256H17.7934L18.4581 11.8449H17.7808L17.3976 13.8233L16.931 11.8449H16.3505L15.8883 13.8211L15.5028 11.8449H14.8234L15.4881 14.8256Z",fill:"currentColor"}),Bs.default.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M17.6308 10.0915H19.7672C20.2492 10.0915 20.6399 10.484 20.6399 10.9682V15.3516C20.6399 15.8358 20.2492 16.2283 19.7672 16.2283H17.7263C16.6592 18.2615 14.5343 19.6474 12.0872 19.6474C9.64007 19.6474 7.5152 18.2615 6.44802 16.2283H4.40718C3.92519 16.2283 3.53446 15.8358 3.53446 15.3516V10.9682C3.53446 10.484 3.92519 10.0915 4.40718 10.0915H6.54358C7.63879 8.15442 9.71108 6.84773 12.0872 6.84773C14.4633 6.84773 16.5356 8.15442 17.6308 10.0915ZM10.4088 7.6193C9.05129 8.02721 7.90098 8.91722 7.15483 10.0915H9.04299C9.18875 9.61479 9.36687 9.17588 9.5724 8.78527C9.81055 8.33266 10.0917 7.93482 10.4088 7.6193ZM9.59245 10.0915H11.8254V7.39749C11.1699 7.51643 10.5359 8.07982 10.0353 9.03108C9.86806 9.349 9.71911 9.70472 9.59245 10.0915ZM12.349 10.0915H14.5819C14.4553 9.70472 14.3063 9.349 14.139 9.03108C13.6385 8.07982 13.0045 7.51643 12.349 7.39749V10.0915ZM15.1314 10.0915H17.0195C16.2734 8.91722 15.1231 8.02721 13.7655 7.6193C14.0826 7.93482 14.3638 8.33266 14.602 8.78527C14.8075 9.17588 14.9856 9.61479 15.1314 10.0915ZM7.04767 16.2283C7.78831 17.4892 8.98451 18.4479 10.4088 18.8759C10.0917 18.5603 9.81055 18.1625 9.5724 17.7099C9.34191 17.2718 9.14588 16.773 8.99133 16.2283H7.04767ZM9.5372 16.2283C9.67503 16.6833 9.84308 17.0987 10.0353 17.4641C10.5359 18.4153 11.1699 18.9787 11.8254 19.0977V16.2283H9.5372ZM12.349 16.2283V19.0977C13.0045 18.9787 13.6385 18.4153 14.139 17.4641C14.3313 17.0987 14.4993 16.6833 14.6372 16.2283H12.349ZM15.183 16.2283C15.0285 16.773 14.8325 17.2718 14.602 17.7099C14.3638 18.1625 14.0826 18.5603 13.7655 18.8759C15.1899 18.4479 16.3861 17.4892 17.1267 16.2283H15.183ZM4.05809 10.9682C4.05809 10.7745 4.21439 10.6175 4.40718 10.6175H19.7672C19.96 10.6175 20.1163 10.7745 20.1163 10.9682V15.3516C20.1163 15.5453 19.96 15.7023 19.7672 15.7023H4.40718C4.21439 15.7023 4.05809 15.5453 4.05809 15.3516V10.9682Z",fill:"currentColor"}),Bs.default.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M1.96355 2.72728C1.48159 2.72728 1.09082 3.11978 1.09082 3.60397V20.0858C1.09082 20.7636 1.63785 21.3131 2.31264 21.3131H21.6872C22.362 21.3131 22.909 20.7636 22.909 20.0858V3.60397C22.909 3.11978 22.5182 2.72728 22.0363 2.72728H1.96355ZM1.789 20.0858V5.88337H22.2108V20.0858C22.2108 20.3763 21.9764 20.6118 21.6872 20.6118H2.31264C2.02344 20.6118 1.789 20.3763 1.789 20.0858ZM3.18537 4.30532C3.18537 4.59584 2.95091 4.83134 2.66173 4.83134C2.37255 4.83134 2.13809 4.59584 2.13809 4.30532C2.13809 4.01481 2.37255 3.77931 2.66173 3.77931C2.95091 3.77931 3.18537 4.01481 3.18537 4.30532ZM4.58173 4.30532C4.58173 4.59584 4.34727 4.83134 4.05809 4.83134C3.76892 4.83134 3.53446 4.59584 3.53446 4.30532C3.53446 4.01481 3.76892 3.77931 4.05809 3.77931C4.34727 3.77931 4.58173 4.01481 4.58173 4.30532ZM5.45446 4.83134C5.74363 4.83134 5.97809 4.59584 5.97809 4.30532C5.97809 4.01481 5.74363 3.77931 5.45446 3.77931C5.16528 3.77931 4.93082 4.01481 4.93082 4.30532C4.93082 4.59584 5.16528 4.83134 5.45446 4.83134ZM20.1163 4.30532C20.1163 4.20849 20.1944 4.12999 20.2908 4.12999H21.6872C21.7836 4.12999 21.8617 4.20849 21.8617 4.30532C21.8617 4.40215 21.7836 4.48066 21.6872 4.48066H20.2908C20.1944 4.48066 20.1163 4.40215 20.1163 4.30532Z",fill:"currentColor"})));var ux=I(w());var jo=I(w());var mx=({onRegenerate:e})=>{let{conversationId:t}=Mt(),o=xe(t),n=(0,jo.useRef)(!1),{currentFloatingContextMenuDraft:r}=jn(),i=(0,jo.useMemo)(()=>!!(o&&r),[o,r]),{stopGenerate:a,regenerate:s}=Ne(),l=(0,jo.useRef)(s),p=(0,jo.useRef)(a);l.current=s,p.current=a;let u=(0,jo.useCallback)(async c=>{c==="s"&&(n.current=!1,await p.current()),c==="r"&&(n.current=!0,await p.current(),e?.(),await l.current(t))},[t]);return(0,jo.useEffect)(()=>{if(!i)return;let c=async m=>{let d=m.key;Ym()&&["r","s","o","c"].includes(d)&&(m.preventDefault(),m.stopPropagation(),await u(d))};return window.addEventListener("keydown",c),()=>{window.removeEventListener("keydown",c)}},[i,u]),i?jo.default.createElement(x,{direction:"row",spacing:1,sx:{ml:"auto!important","& .usechatgpt-floating-menu__button__shortcut":{fontSize:"12px",opacity:.7,ml:"4px"}}},jo.default.createElement(ce,{sx:{height:"24px"},variant:"text",onClick:async()=>{await u("r")}},jo.default.createElement(T,{component:"span",fontSize:"14px",color:"primary.main"},"Try again",jo.default.createElement("span",{className:"usechatgpt-floating-menu__button__shortcut"},"R"))),jo.default.createElement(ce,{sx:{height:"24px"},variant:"text",onClick:async()=>{await u("s")}},jo.default.createElement(T,{component:"span",fontSize:"14px",color:"primary.main"},"Stop",jo.default.createElement("span",{className:"usechatgpt-floating-menu__button__shortcut"},"S")))):jo.default.createElement(jo.default.Fragment,null)};var mt=I(w());var TT=(0,mt.forwardRef)((e,t)=>{let{t:o}=E(["prompt","client"]),{draftUserMessage:n}=jn(),r=(0,mt.useMemo)(()=>{let i=n?.meta?.MaxAIPromptActionConfig?.prompt_id;if(i)return mt.default.createElement(x,{fontSize:"14px",direction:"column",alignItems:"flex-start"},mt.default.createElement(B,null,o(`prompt:${i}`)),mt.default.createElement(B,null,o("client:floating_menu__contextmenu__click_to_retry")));let a=n?.text?.replace(/^(.*?)\s*:\s*""".*?"""/s,"$1");return a?mt.default.createElement(x,{fontSize:"14px",direction:"column",alignItems:"flex-start"},mt.default.createElement(B,null,a),mt.default.createElement(B,null,o("client:floating_menu__contextmenu__click_edit_prompt_and_retry"))):""},[n]);return mt.default.createElement(zr,{title:r,placement:"right",floatingMenuTooltip:!0,slotProps:{popper:{modifiers:[{name:"offset",options:{offset:[0,3]}}]}}},mt.default.createElement(ad,{...e,label:o("package__features:context_menu__prompt__6b9f9cb4-b1b1-4897-9156-903dbc52b2a1"),menuItem:e.menuItem,ref:t}))});TT.displayName="TryAgainItem";var vu=(0,mt.forwardRef)((e,t)=>{let{menuItem:o,root:n,referenceElement:r,referenceElementOpen:i,rootMenu:a,customOpen:s,onClickContextMenu:l,menuWidth:p,...u}=e,{t:c}=E(),m=(0,mt.useCallback)(f=>{let h=`context_menu__prompt__${f.prompt_id.replace(mn,"")}`,_=`package__features:${h}`,g=c(_);return g!==_&&g!==h?g:f.prompt_title},[c]),d=(0,mt.useMemo)(()=>m(o),[o.prompt_title,m]);return o.type==="group"?mt.default.createElement(yc,{zIndex:e.zIndex,ref:t,root:n,label:d,menuWidth:p,onClickContextMenu:l,referenceElement:mt.default.createElement(ad,{...u,label:d,menuItem:o}),needAutoUpdate:u.needAutoUpdate},(o.children??[]).map(f=>mt.default.createElement(vu,{...u,root:n,key:f.prompt_id,menuItem:f}))):o.prompt_id===Yl.TRY_AGAIN?mt.default.createElement(TT,{...u,menuItem:o,ref:t}):mt.default.createElement(ad,{...u,label:d,menuItem:o,ref:t})});vu.displayName="RenderDropdownItem";var F1=e=>mt.default.createElement(B,{"data-testid":"max-ai-context-menu-divider","aria-disabled":!0,key:`${e}_group_spector`,onClick:t=>{t.stopPropagation(),t.preventDefault()},component:"div",sx:{pointerEvents:"none",borderTop:"1px solid",borderColor:"border.main",my:.5}}),iz=e=>{let{root:t,referenceElement:o,referenceElementOpen:n,referenceElementRef:r,menuList:i,customOpen:a,needAutoUpdate:s,defaultPlacement:l,defaultFallbackPlacements:p,onClickContextMenu:u,menuWidth:c,onClickReferenceElement:m,hoverOpen:d,hoverIcon:f,isFirstLevelFlatten:h=!0,..._}=e,{t:g}=E(),y=(0,mt.useMemo)(()=>{let C=[];return i.forEach((b,v)=>{let S=`context_menu__prompt__${b.prompt_id.replace(mn,"")}`,P=`package__features:${S}`,k=g(P);k=k!==P&&k!==S?k:b.prompt_title,b.type==="group"&&h?(v>0&&C.push(F1(b.prompt_id)),C.push(mt.default.createElement(B,{key:b.prompt_id+"_group_name",component:"div","aria-disabled":!0,"data-testid":`max-ai-context-menu-group-label__${b.prompt_id}`,sx:{display:"flex",justifyContent:"space-between",alignItems:"center",width:"100%",boxSizing:"border-box",direction:"row",pl:"8px"},onMouseDownCapture:L=>{L.stopPropagation(),L.preventDefault()}},mt.default.createElement(B,{sx:{p:"6px 0 8px 0",pointerEvents:"none"}},mt.default.createElement(T,{textAlign:"left",fontSize:12,color:"text.secondary"},k)),b.prompt_id===mn&&mt.default.createElement(Ip,null))),(b.children??[]).forEach((L,H)=>{Lh.includes(L.prompt_id)&&C.push(F1(b.prompt_id)),C.push(mt.default.createElement(vu,{menuWidth:c,hoverIcon:f,onClickContextMenu:u,zIndex:2147483602,needAutoUpdate:s,..._,key:L.prompt_id,menuItem:L,root:t}))})):b.type==="chat_complete"?(v>0&&C.push(F1(b.prompt_id)),C.push(mt.default.createElement(vu,{menuWidth:c,hoverIcon:f,onClickContextMenu:u,needAutoUpdate:s,key:b.prompt_id,menuItem:b,root:t,zIndex:2147483602}))):(Lh.includes(b.prompt_id)&&C.push(F1(b.prompt_id)),C.push(mt.default.createElement(vu,{menuWidth:c,hoverIcon:f,onClickContextMenu:u,needAutoUpdate:s,key:b.prompt_id,menuItem:b,root:t,zIndex:2147483602})))}),C},[i,g,h]);return mt.default.createElement(yc,{zIndex:2147483601,label:"",root:t,customOpen:a,needAutoUpdate:s,referenceElement:o,referenceElementOpen:n,referenceElementRef:r,defaultPlacement:l,defaultFallbackPlacements:p,onClickContextMenu:u,onClickReferenceElement:m,hoverOpen:d,menuWidth:c,hoverIcon:f},n===!1?null:y)},MT=iz;var ti=I(w());var wT="context-menu-dom-event-manager";var PT=I(ir()),kT=I(ET()),LT=I(AT());var Yi=I(w());var mz=({loading:e})=>{let{t}=E(["common","client"]),{hideFloatingContextMenu:o}=rd(),{floatingDropdownMenuPin:n,setFloatingDropdownMenuPin:r}=x6(),i=()=>{r(!n)};return Yi.default.createElement(Yi.default.Fragment,null,Yi.default.createElement(zr,{title:t(n?"client:floating_menu__pin_button__pinned__title":"client:floating_menu__pin_button__unpinned__title"),placement:"top",floatingMenuTooltip:!0},Yi.default.createElement(Ve,{"data-testid":"maxai-context-window-pin-button",size:"small",sx:{width:28,height:28,color:"text.secondary","&:hover":{color:"text.primary"},padding:"0 3px"},onClick:i},n?Yi.default.createElement(kT.default,{sx:{fontSize:16,transform:"rotate(45deg)"},color:"primary"}):Yi.default.createElement(LT.default,{sx:{fontSize:16,transform:"rotate(45deg)"}}))),Yi.default.createElement(zr,{title:t("client:floating_menu__close_button__title"),description:"Esc",placement:"top",floatingMenuTooltip:!0},Yi.default.createElement(Ve,{"data-testid":"maxai-context-window-close-button",size:"small",sx:{width:28,height:28,color:"text.secondary","&:hover":{color:"text.primary"},padding:"3px",marginRight:"-3px"},disabled:e,onClick:()=>o(!0)},Yi.default.createElement(PT.default,{sx:{fontSize:17}}))))},z1=mz;var DT=I(OT()),FT=I(BT());var xl=I(w());var Cz=()=>{let{activeResponseMessageIndex:e,goToNextMessage:t,goToPreviousMessage:o,totalResponseCount:n}=jn(),{conversationId:r}=Mt(),i=xe(r),a=e===0,s=e===n-1;return n===0?null:xl.default.createElement(x,{flexShrink:0,direction:"row",gap:.5,height:"32px",lineHeight:"32px",alignItems:"center"},xl.default.createElement(Ve,{sx:{width:"24px",height:"24px"},disabled:i||a,onClick:o},xl.default.createElement(DT.default,{sx:{fontSize:"20px",p:"2px",color:"text.secondary",cursor:"pointer",opacity:a?.4:1}})),xl.default.createElement(T,{fontSize:"12px",color:"text.secondary",fontWeight:400,lineHeight:"24px"},`${e+1} of ${n}`),xl.default.createElement(Ve,{sx:{width:"24px",height:"24px"},disabled:i||s,onClick:t},xl.default.createElement(FT.default,{sx:{fontSize:"20px",p:"2px",color:"text.secondary",cursor:"pointer",opacity:s?.4:1}})))},HT=Cz;var yz=({showModelSelector:e,showUsageButton:t,loading:o})=>{let{conversationMessages:n}=Mt(),{localSettings:r}=yt(),i=r?.chatMode==="pro_chat",a=()=>{let p=wn()?.querySelector(`#${Si}`);p&&p?.focus()},s=()=>{a()},l=()=>{a()};return ti.default.createElement(x,{direction:"row",justifyContent:"space-between",alignItems:"center",sx:{wordBreak:"break-word",color:p=>p.palette.mode==="dark"?"#FFFFFFDE":"rgba(0,0,0,0.87)",paddingBottom:n.length?"0":"4px",paddingTop:n.length?"10px":"0"},component:"div"},ti.default.createElement(x,{direction:"row",gap:"4px",alignItems:"center",flexWrap:"wrap"},ti.default.createElement(ms,{hideOnboarding:!0,disabled:o}),e&&i&&ti.default.createElement(gs,{onChanged:s,disabled:!e||o,size:"small",tooltipProps:{placement:"top"},domEventManagerId:wT}),i&&ti.default.createElement(ds,{onChanged:l,tooltipProps:{placement:"top"},disabled:o}),ti.default.createElement(x,{direction:"row",alignItems:"center",gap:"4px","data-testid":"maxai--chat-box--tools--left-container--portal-root",sx:{display:i?"flex":"none","&:empty":{display:"none"}}})),ti.default.createElement(x,{direction:"row",justifyContent:"end",alignItems:"center",sx:{alignSelf:"flex-start",height:32,gap:.5}},ti.default.createElement(x,{direction:"row",alignItems:"center"},ti.default.createElement(lx,{TooltipProps:{placement:"top",floatingMenuTooltip:!0},sx:{mr:1}}),!o&&!n.length&&ti.default.createElement(z1,{loading:o}),ti.default.createElement(HT,null))))},NT=yz;var Et=I(w());var hLe=3*24,dx=e=>{let t=e.scrollTop,o=e.scrollHeight,n=e.clientHeight;return Math.abs(n+t-o)>8},bz=({onChange:e,contextMenuDefaultHeight:t})=>{let o=Il(),n=vt(Jl),r=po(f6),{conversationId:i}=Mt(),a=xe(i),{currentFloatingContextMenuDraft:s,activeResponseMessage:l}=jn(),p=(0,Et.useRef)(null),u=(0,Et.useRef)(null),c=(0,Et.useRef)(),[m,d]=(0,Et.useState)(!1),f=()=>{let y=u.current;y&&(y.scrollTo(0,y.scrollHeight),d(!1))},h=(0,Et.useMemo)(()=>s.replace(/^\s+/,""),[s]);(0,Et.useEffect)(()=>{a||(r(y=>({...y,lastOutput:s})),e?.(s))},[s,n,a]),(0,Et.useEffect)(()=>{let y=C=>{if((C.metaKey||C.ctrlKey)&&(C.stopPropagation(),C.key==="C"||C.key==="c"||C.key==="x"||C.key==="X")){let b=window.getSelection();if(b&&b.rangeCount>0){let S=b.getRangeAt(0).toString()||b.toString();S&&(C.preventDefault(),navigator.clipboard.writeText(S))}}};u.current?.addEventListener("keydown",y,!0)},[]),(0,Et.useEffect)(()=>{let y=u.current;if(!y)return;let C=new ResizeObserver(()=>{d(dx(y))});C.observe(y);let b=li(()=>{d(dx(y))},100);return y.addEventListener("wheel",b),()=>{C.disconnect(),y.removeEventListener("wheel",b)}},[]);let _=(0,Et.useRef)(a);(0,Et.useEffect)(()=>{_.current=a},[a]),(0,Et.useEffect)(()=>{let y=u.current;y&&d(dx(y))},[h]);let g=l&&ki(l);return Et.default.createElement(x,{ref:p,className:"chat-message--text max-ai__writing-message-box",whiteSpace:"pre-wrap",width:"100%",sx:{position:"relative",wordBreak:"break-word",borderBottomLeftRadius:0,flex:1,overflowY:"auto",color:y=>y.palette.mode==="dark"?"#FFFFFFDE":"rgba(0,0,0,0.87)","& .markdown-body":{userSelect:"text",overflowY:"auto","*":{fontFamily:'"Roboto","Helvetica","Arial",sans-serif!important'}}},component:"div"},g&&Et.default.createElement(n1,{message:l,sx:{boxSizing:"border-box",my:1}}),Et.default.createElement(x,{"data-testid":"maxai--contextmenu--writing-message-box","data-disabled-button-clicked":!0,tabIndex:-1,ref:u,sx:{flex:1,height:0,width:"100%",overflowY:"auto"}},l&&xr(l)&&Et.default.createElement(If,{message:l},Et.default.createElement(Zf,{message:l})),!g&&Et.default.createElement("div",{style:{textAlign:"left",overflowY:"unset",padding:h?"16px 0":"0"},className:`markdown-body ${o.palette.mode==="dark"?"markdown-body-dark":""}`},h?Et.default.createElement(Ya,{message:l||void 0},h):t?Et.default.createElement(Et.default.Fragment,null,Et.default.createElement(vo,{variant:"text",sx:{fontSize:"1.5rem"}}),Et.default.createElement(vo,{variant:"text",sx:{fontSize:"1.5rem"},width:"70%"}),t>218&&Et.default.createElement(vo,{variant:"text",sx:{fontSize:"1.5rem"},width:"50%"})):null),m&&Et.default.createElement(c1,{onClick:()=>f()})))},zT=bz;var Ds=I(w());var Tu={sceneType:"FLOATING_CONTEXT_MENU_INPUT_BOX_AFTER_AI_RESPONSE",id:"ONBOARDING_TOOLTIP__FLOATING_CONTEXT_MENU_INPUT_BOX_AFTER_AI_RESPONSE",anchorElementSelectors:"div#ONBOARDING_TOOLTIP__FLOATING_CONTEXT_MENU_INPUT_BOX__REFERENCE_ELEMENT",CtaButtonClickedName:"Onboarding > ContextMenu > RewriteMenu > Got it"},Iz=e=>{let{showStateTrigger:t,...o}=e,{t:n}=E(),[r,i]=(0,Ds.useState)(!1);return(0,Ds.useEffect)(()=>{t?np(500).then(async()=>{if(!await _r(Tu.sceneType)){let s=wn();if(bc("FLOATING_CONTEXT_MENU_REPLACE_SELECTION_MENUITEM",s)||bc("FLOATING_CONTEXT_MENU_LIST_BOX",s))return;Gr(Tu.sceneType).then(()=>{i(!0)})}}):i(!1)},[t]),Ds.default.createElement(Lt,{hideBackdrop:!0,sx:{visibility:"hidden"},placement:"left",fallbackPlacements:["bottom-start","top-start"],offset:[0,8],trigger:r,anchorElementSelectors:Tu.anchorElementSelectors,CtaButtonProps:{"data-button-clicked-name":Tu.CtaButtonClickedName},arrowSx:{'&[data-custom-popover-placement*="bottom"]':{marginLeft:"15px"}},id:Tu.id,...o},Ds.default.createElement(x,null,Ds.default.createElement(T,{fontSize:14,lineHeight:1.5},n("onboarding:onboarding_tooltip__FLOATING_CONTEXT_MENU_INPUT_BOX_AFTER_AI_RESPONSE__text1"))))},VT=Iz;var Fs=I(w());var Mu={sceneType:"FLOATING_CONTEXT_MENU_INPUT_BOX",id:"ONBOARDING_TOOLTIP__FLOATING_CONTEXT_MENU_INPUT_BOX",anchorElementSelectors:"div#ONBOARDING_TOOLTIP__FLOATING_CONTEXT_MENU_INPUT_BOX__REFERENCE_ELEMENT",CtaButtonClickedName:"Onboarding > ContextMenu > RewriteMenu > Got it"},Sz=e=>{let{showStateTrigger:t,...o}=e,{t:n}=E(),[r,i]=(0,Fs.useState)(!1);return(0,Fs.useEffect)(()=>{t?Promise.all([_r(Mu.sceneType),_r("FLOATING_CONTEXT_MENU_LIST_BOX")]).then(async([a,s])=>{if(!a){await np(50);let l=wn(),p=!!bc("FLOATING_CONTEXT_MENU_LIST_BOX",l);if(!s||p)return;Gr(Mu.sceneType).then(()=>{i(!0)})}}):i(!1)},[t]),Fs.default.createElement(Lt,{hideBackdrop:!0,sx:{visibility:"hidden"},placement:"left",fallbackPlacements:["bottom-start","top-start"],trigger:r,anchorElementSelectors:Mu.anchorElementSelectors,CtaButtonProps:{"data-button-clicked-name":Mu.CtaButtonClickedName},arrowSx:{'&[data-custom-popover-placement*="bottom"]':{marginLeft:"10px"}},id:Mu.id,...o},Fs.default.createElement(x,null,Fs.default.createElement(T,{fontSize:14,lineHeight:1.5},n("onboarding:onboarding_tooltip__FLOATING_CONTEXT_MENU_INPUT_BOX__text2"))))},RT=Sz;var Ca=I(w());var wu={sceneType:"FLOATING_CONTEXT_MENU_REPLACE_SELECTION_MENUITEM",id:"ONBOARDING_TOOLTIP__FLOATING_CONTEXT_MENU_REPLACE_SELECTION_MENUITEM",anchorElementSelectors:`div[data-id="${Yl.REPLACE_SELECTION}"].floating-context-menu-item`,CtaButtonClickedName:"Onboarding > ContextMenu > ReplaceSelection > Got it"},vz=e=>{let{showStateTrigger:t,...o}=e,{t:n}=E(),[r,i]=(0,Ca.useState)(!1);(0,Ca.useEffect)(()=>{t?_r(wu.sceneType).then(s=>{s||Gr(wu.sceneType).then(()=>{i(!0)})}):i(!1)},[t]);let a={bgcolor:s=>s.palette.mode==="dark"?"rgba(255, 255, 255, 0.16) !important":"rgba(0, 0, 0, 0.08) !important",color:s=>s.palette.mode==="dark"?"rgba(255, 255, 255, 0.7) !important":"rgba(0, 0, 0, 0.7) !important"};return Ca.default.createElement(Lt,{hideBackdrop:!0,sx:{visibility:"hidden"},placement:"right-start",fallbackPlacements:["right-end","left-start","left-end"],offset:[0,8],trigger:r,anchorElementSelectors:wu.anchorElementSelectors,CtaButtonProps:{"data-button-clicked-name":wu.CtaButtonClickedName},arrowSx:{'&[data-custom-popover-placement*="bottom"]':{marginLeft:"15px"}},id:wu.id,...o},Ca.default.createElement(x,{gap:1},Ca.default.createElement(T,{fontSize:14,lineHeight:1.5},n("onboarding:onboarding_tooltip__FLOATING_CONTEXT_MENU_REPLACE_SELECTION_MENUITEM__text1")),Ca.default.createElement(Fa,{sx:a},"Enter")))},UT=vz;var WT=I(mw()),GT=I(dw());var Po=I(w());var Eu={sceneType:"FLOATING_CONTEXT_MENU_LIST_BOX",id:"ONBOARDING_TOOLTIP__FLOATING_CONTEXT_MENU_LIST_BOX",anchorElementSelectors:"div[role=menu].dropdown-menu",CtaButtonClickedName:"Onboarding > ContextMenu > RewriteMenu > Got it"},Tz=e=>{let{showStateTrigger:t,...o}=e,{t:n}=E(),[r,i]=(0,Po.useState)(!1),a={bgcolor:s=>s.palette.mode==="dark"?"rgba(255, 255, 255, 0.16) !important":"rgba(0, 0, 0, 0.08) !important",color:s=>s.palette.mode==="dark"?"rgba(255, 255, 255, 0.7) !important":"rgba(0, 0, 0, 0.7) !important"};return(0,Po.useEffect)(()=>{t?np(500).then(()=>{_r(Eu.sceneType).then(s=>{s||Gr(Eu.sceneType).then(()=>{i(!0)})})}):i(!1)},[t]),Po.default.createElement(Lt,{hideBackdrop:!0,sx:{visibility:"hidden"},placement:"left",fallbackPlacements:["right","bottom","top"],trigger:r,anchorElementSelectors:Eu.anchorElementSelectors,CtaButtonProps:{"data-button-clicked-name":Eu.CtaButtonClickedName},id:Eu.id,...o},Po.default.createElement(x,{spacing:"4px"},Po.default.createElement(x,{direction:"row",alignItems:"center",spacing:.5},Po.default.createElement(T,{fontSize:14,lineHeight:1.5},n("onboarding:onboarding_tooltip__FLOATING_CONTEXT_MENU_LIST_BOX__text1__part1")),Po.default.createElement(Fa,{sx:a},Po.default.createElement(WT.default,{sx:{fontSize:"12px",transform:"scale(1.6)"}})),Po.default.createElement(T,{fontSize:14,lineHeight:1.5},n("onboarding:onboarding_tooltip__FLOATING_CONTEXT_MENU_LIST_BOX__text1__part2"))),Po.default.createElement(x,{direction:"row",alignItems:"center",spacing:.5},Po.default.createElement(T,{fontSize:14,lineHeight:1.5},n("onboarding:onboarding_tooltip__FLOATING_CONTEXT_MENU_LIST_BOX__text2__part1")),Po.default.createElement(Fa,{sx:a},Po.default.createElement(GT.default,{sx:{fontSize:"12px",transform:"scale(1.6)"}})),Po.default.createElement(T,{fontSize:14,lineHeight:1.5},n("onboarding:onboarding_tooltip__FLOATING_CONTEXT_MENU_LIST_BOX__text2__part2"))),Po.default.createElement(x,{direction:"row",alignItems:"center",spacing:.5},Po.default.createElement(T,{fontSize:14,lineHeight:1.5},n("onboarding:onboarding_tooltip__FLOATING_CONTEXT_MENU_LIST_BOX__text3__part1")),Po.default.createElement(Fa,{sx:a},n("onboarding:onboarding_tooltip__FLOATING_CONTEXT_MENU_LIST_BOX__text3__part2")),Po.default.createElement(T,{fontSize:14,lineHeight:1.5},n("onboarding:onboarding_tooltip__FLOATING_CONTEXT_MENU_LIST_BOX__text3__part3")))))},jT=Tz;var Lr=I(w());var QT=I(Pm()),JT=I(z0());var Yt=I(w());var ya=I(w()),qT=I(ew());var Au=I(w());var Mz=e=>{let{title:t,placement:o,TooltipProps:n,loading:r=!1,children:i,PopperProps:a,...s}=e;return Au.default.createElement(zr,{placement:o||"top",title:t,PopperProps:{sx:{},...a},...n},Au.default.createElement("span",{className:"TextOnlyTooltip_IconButton_wrapper"},Au.default.createElement(Ve,{...s},r?Au.default.createElement(Jt,{size:16,sx:{m:"0 auto"}}):i)))},KT=Mz;var wz=e=>{let{copyText:t,onCopy:o,sx:n,defaultIconSx:r,icon:i,copyToClipboardTooltip:a,copiedTooltip:s,TooltipProps:l,PopperProps:p,tooltipPlacement:u,...c}=e,{t:m}=E(["common"]),[d,f]=(0,ya.useState)(!1),h=(0,ya.useMemo)(()=>m(d?s||"common:copied":a||"common:copy_to_clipboard"),[m,d,a,s]);return ya.default.createElement(qT.CopyToClipboard,{text:t,options:{message:"Copied!",format:"text/plain"},onCopy:()=>{o?.(),f(!0),setTimeout(()=>{f(!1)},1e3)}},ya.default.createElement(KT,{title:h,sx:n,className:e.className,TooltipProps:l,PopperProps:p,placement:u,...c},d?ya.default.createElement(U,{icon:"Check",sx:{fontSize:"20px",...r}}):i||ya.default.createElement(U,{icon:"CopyTextOnly",sx:{fontSize:"20px",...r}}),e.children))},U1=wz;var Co=I(w());var yn=I(w()),XT=I(w());function $T(e){return e.substring(2).toLowerCase()}function Ez(e,t){return t.documentElement.clientWidth<e.clientX||t.documentElement.clientHeight<e.clientY}function Az(e,t){typeof e=="function"?e(t):e&&(e.current=t)}function Pz(...e){return yn.useMemo(()=>e.every(t=>t==null)?null:t=>{e.forEach(o=>{Az(o,t)})},e)}var fx=e=>{if(e){let t=bm();if(t&&t.contains(e))return t;if(t=wn(),t){let o=t.querySelector(`#${bl}`);return o instanceof HTMLElement?o:t}}return document.documentElement};function kz(e){let{children:t,disableReactTree:o=!1,mouseEvent:n="onClick",onClickAway:r,touchEvent:i="onTouchEnd"}=e,a=yn.useRef(!1),s=yn.useRef(null),l=yn.useRef(!1),p=yn.useRef(!1);yn.useEffect(()=>(setTimeout(()=>{l.current=!0},0),()=>{l.current=!1}),[]);let u=Pz(t.ref,s),c=(0,XT.useCallback)(f=>{let h=p.current;p.current=!1;let _=fx(s.current);if(!l.current||!s.current||"clientX"in f&&Ez(f,_.ownerDocument))return;if(a.current){a.current=!1;return}let g;f.composedPath?g=f.composedPath().indexOf(s.current)>-1:g=!_.ownerDocument.documentElement.contains(f.target)||s.current.contains(f.target),!g&&(o||!h)&&r(f)},[]),m=f=>h=>{p.current=!0;let _=t.props[f];_&&_(h)},d={ref:u};return i!==!1&&(d[i]=m(i)),yn.useEffect(()=>{if(i!==!1){let f=$T(i),h=fx(s.current),_=()=>{a.current=!0};return h.addEventListener(f,c),h.addEventListener("touchmove",_),()=>{h.removeEventListener(f,c),h.removeEventListener("touchmove",_)}}},[c,i]),n!==!1&&(d[n]=m(n)),yn.useEffect(()=>{if(n!==!1){let f=$T(n),h=fx(s.current);return h.addEventListener(f,c),()=>{h.removeEventListener(f,c)}}},[c,n]),yn.createElement(yn.Fragment,null,yn.cloneElement(t,d))}var YT=kz;var Lz=rr(({className:e,...t})=>Co.default.createElement(Hr,{...t,classes:{popper:e}}))(({theme:e})=>({[`& > .${Vn.tooltip}`]:{background:e.palette.mode==="dark"?"#2C2C2C":"#ffffff",color:"rgba(0, 0, 0, 0.87)",fontSize:12,boxShadow:"0px 12px 16px -4px rgba(0, 0, 0, 0.08), 0px 4px 6px -2px rgba(0, 0, 0, 0.03)",maxWidth:"none",borderRadius:e.spacing(1),border:`1px solid ${e.palette.border.main}`,backgroundClip:"padding-box"},[`& .${Vn.arrow}`]:{color:e.palette.mode==="dark"?"#2C2C2C":"#ffffff","&::before":{border:`1px solid ${e.palette.border.main}`,background:e.palette.mode==="dark"?"#2C2C2C":"#ffffff",backgroundClip:"padding-box"}}})),Oz=(0,Co.forwardRef)(function({variable:t,sx:o,container:n,children:r,virtualRect:i,popperSx:a,suffix:s,anchorElSx:l,descriptionEl:p},u){let[c,m]=(0,Co.useState)(!1),d=(0,Co.useRef)(null);(0,Co.useImperativeHandle)(u,()=>({close:()=>m(!1)}));let f=t.key==="Selected Text"||t.key==="Draft"?"Context":t.key,h={container:n,sx:{zIndex:2147483619,...a},transition:!0};return i&&(h.anchorEl={getBoundingClientRect(){return i}}),Co.default.createElement(YT,{onClickAway:_=>{c&&_.target instanceof HTMLElement&&(d.current?.contains(_.target)||d.current===_.target)||m(!1)}},Co.default.createElement(x,{direction:"row",width:"100%",sx:o},Co.default.createElement(Lz,{open:c,PopperProps:h,title:Co.default.createElement(x,{direction:"column",maxHeight:"min(500px, 40vh)",overflow:"hidden",height:"max-content"},Co.default.createElement(x,{direction:"row",width:"100%",gap:1.25,p:1.25,ref:d,boxSizing:"border-box",flexGrow:1,overflow:"hidden"},Co.default.createElement(B,{width:"2px",minWidth:"2px",bgcolor:_=>_.palette.mode==="dark"?"rgba(255, 255, 255, 0.12)":"rgba(0, 0, 0, 0.12)"}),Co.default.createElement(x,{direction:"column",flexGrow:1,overflow:"hidden"},Co.default.createElement(x,{direction:"row",gap:1.25,alignItems:"center",maxWidth:"100%"},Co.default.createElement(T,{fontSize:"14px",overflow:"hidden",textOverflow:"ellipsis",noWrap:!0,color:_=>_.palette.mode==="dark"?"rgba(255, 255, 255, 0.50)":"rgba(0, 0, 0, 0.38)"},f),Co.default.createElement(U1,{sx:{padding:"5px",fontSize:"20px",borderRadius:"4px",color:"text.secondary"},defaultIconSx:{fontSize:"15px"},PopperProps:{container:n,placement:"top"},copyText:t.value})),p,Co.default.createElement(T,{width:"100%",whiteSpace:"pre-wrap",color:"text.primary",textAlign:"left",lineHeight:"24px",fontSize:"16px",flexGrow:1,overflow:"auto"},t.value))),s),placement:"top",arrow:!0,disableFocusListener:!0,disableHoverListener:!0,disableTouchListener:!0},Co.default.createElement(B,{onClick:()=>{m(!c)},sx:l},typeof r=="function"?r({variable:t,open:c}):r))))}),ZT=Oz;var Bz=rr(({className:e,...t})=>Yt.default.createElement(Hr,{...t,classes:{popper:e}}))(({theme:e})=>({[`& > .${Vn.tooltip}`]:{background:e.palette.mode==="dark"?"#2C2C2C":"#ffffff",color:"rgba(0, 0, 0, 0.87)",fontSize:12,boxShadow:"0px 12px 16px -4px rgba(0, 0, 0, 0.08), 0px 4px 6px -2px rgba(0, 0, 0, 0.03)",maxWidth:"none",borderRadius:e.spacing(1),backgroundClip:"padding-box",border:`1px solid ${e.palette.border.main}`},[`& .${Vn.arrow}`]:{color:e.palette.mode==="dark"?"#2C2C2C":"#ffffff","&::before":{border:`1px solid ${e.palette.border.main}`,background:e.palette.mode==="dark"?"#2C2C2C":"#ffffff",backgroundClip:"padding-box"}}})),Dz=({quoteText:e,variables:t,container:o,title:n})=>{let{t:r}=E(["client"]),[i,a]=(0,Yt.useState)(!1),s=(0,Yt.useRef)(null),l=2147483617,p=2147483618;(0,Yt.useEffect)(()=>{let c=wn()?.querySelector(`#${bl}`);if(c instanceof HTMLElement){let m=()=>{a(!1)};return c?.addEventListener("click",m),document.body.addEventListener("click",m),()=>{c?.removeEventListener("click",m),document.body.removeEventListener("click",m)}}},[]);let u=(0,Yt.useMemo)(()=>e?Yt.default.createElement(B,{sx:{display:"flex",flexDirection:"row",justifyContent:"flex-end",width:"100%"}},Yt.default.createElement(ZT,{variable:{key:"Quote",value:e},sx:{width:"auto"},popperSx:{boxSizing:"border-box",zIndex:p,maxWidth:s.current?.clientWidth??"500px"},container:o},Yt.default.createElement(x,{gap:1,direction:"row",color:c=>c.palette.mode==="dark"?"rgba(255, 255, 255, 0.38)":"rgba(0, 0, 0, 0.38)",width:"100%"},Yt.default.createElement(JT.default,{sx:{fontSize:"18px"}}),Yt.default.createElement(Ry,{maxLine:2,fontSize:"14px",flex:1},e.trim())))):null,[e,p,o]);return Yt.default.createElement(Bz,{open:i,PopperProps:{container:o,sx:{zIndex:l}},disableFocusListener:!0,disableHoverListener:!0,disableTouchListener:!0,placement:"top",arrow:!0,title:Yt.default.createElement(x,{component:"div",direction:"column",maxWidth:"500px",maxHeight:"min(50vh, 500px)",ref:s,padding:"10px",boxSizing:"border-box",onClick:c=>c.stopPropagation(),sx:{boxSizing:"border-box",background:c=>c.palette.mode==="dark"?"#2C2C2C":"#ffffff"}},u,Yt.default.createElement(x,{maxWidth:"100%",width:"auto",direction:"row",sx:{"& .maxai-user-message-copy-icon":{opacity:0,transition:"opacity 0.2s ease-in-out"},"&:hover .maxai-user-message-copy-icon":{opacity:1}}},Yt.default.createElement(B,null,Yt.default.createElement(U1,{tabIndex:-1,tooltipPlacement:"top",sx:{marginRight:"5px",padding:"5px",fontSize:"20px",borderRadius:"4px",color:"text.secondary"},defaultIconSx:{fontSize:"15px"},className:"maxai-user-message-copy-icon",PopperProps:{container:o,sx:{zIndex:p}},copyText:n})),Yt.default.createElement(x,{direction:"column",gap:1,sx:{whiteSpace:"pre-wrap",wordBreak:"break-word",p:c=>c.spacing(1.5),bgcolor:c=>c.palette.background.secondary,borderRadius:c=>c.spacing(1),color:"text.primary",flexWrap:"wrap",flexGrow:1,overflow:"hidden"}},Yt.default.createElement(T,{fontSize:"16px"},n),t.map(c=>Yt.default.createElement(i1,{key:c.key,variable:c,getMessageContainer:()=>s.current,container:o,zIndex:p})))))},Yt.default.createElement(ce,{variant:"text",sx:{gap:"4px",padding:"6px"},onClick:c=>{a(!i),c.stopPropagation()}},Yt.default.createElement(T,{color:"text.primary",fontSize:"14px",noWrap:!0},r("floating_menu__button__show_detail")),Yt.default.createElement(QT.default,{sx:{color:"#D9D9D9",height:"16px",width:"16px",transition:"all 0.2s",transform:`rotate(${i?.5:0}turn)`}})))},eM=Dz;var Fz=({loading:e=!1})=>{let t=(0,Lr.useRef)(wn()),{draftUserMessage:o}=jn(),{conversationMessages:n}=Mt(),r=(0,Lr.useMemo)(()=>{if(!o)return"";let a=_C(o),s=a.indexOf(`:
"""
`);return s===-1?a:a.slice(0,s)},[o]),i=(0,Lr.useMemo)(()=>gu(o?.meta?.contexts,o?.meta?.MaxAIPromptActionConfig?.variables),[o?.meta?.contexts,o?.meta?.MaxAIPromptActionConfig?.variables]);return Lr.default.createElement(Nu,{in:!!o},Lr.default.createElement(x,{direction:"row",gap:"8px",alignItems:"center",height:"auto",width:"100%",paddingBottom:"4px"},Lr.default.createElement(x,{direction:"row",flex:1,alignItems:"center",overflow:"hidden",gap:"8px"},Lr.default.createElement(T,{color:"text.primary",fontSize:"18px",fontWeight:600,lineHeight:"150%"},r),Lr.default.createElement(T,{overflow:"hidden",textOverflow:"ellipsis",color:a=>a.palette.mode==="dark"?"rgba(255,255,255,0.5)":"rgba(0,0,0,0.38)",flex:1,fontSize:"14px",sx:{whiteSpace:"nowrap",userSelect:"none",cursor:"default"}},i?.text)),Lr.default.createElement(eM,{quoteText:i?.text,variables:i?.userVariables??[],container:t.current,title:r}),n.length&&Lr.default.createElement(z1,{loading:e})))},tM=Fz;var ba=I(w()),oM=I(w());var Hz=()=>{let{currentSelection:e}=ia(),{draftUserMessage:t}=jn(),{conversation:o,conversationId:n}=Mt(),r=xe(n),i=(0,oM.useMemo)(()=>(e?.selectionElement?.editableElementSelectionText||e?.selectionElement?.selectionText||"").trim().replace(/\u200B/g,""),[e]),[a,s]=(0,ba.useState)(!1);return(0,ba.useEffect)(()=>{let l=!!(!i||r||o?.lastMessageId&&t);s(l)},[i,r,o?.lastMessageId,t]),{showDraftTextPanel:!a,draftText:i}},Nz=()=>{let{showDraftTextPanel:e,draftText:t}=Hz(),{conversationMessages:o}=Mt();return o.length?null:ba.default.createElement(Nu,{in:e},ba.default.createElement(B,{sx:{display:"flex",flexDirection:"row",boxSizing:"border-box",padding:"8px",margin:"10px 0 0 0",borderRadius:"8px",alignItems:"center",gap:"8px",bgcolor:n=>n.palette.mode==="dark"?"rgba(59, 61, 62, 1)":"rgba(244, 244, 244, 1)",color:n=>n.palette.mode==="dark"?"rgba(255, 255, 255, 0.38)":"rgba(0, 0, 0, 0.38)",width:"100%"}},ba.default.createElement(qy,{sx:{fontSize:"16px"}}),ba.default.createElement(T,{sx:{flex:1,whiteSpace:"nowrap",textOverflow:"ellipsis",fontSize:"14px",fontWeight:"400",overflow:"hidden",textAlign:"left",cursor:"default",userSelect:"none"}},t)))},nM=Nz;var Zo=I(w());var zz=e=>{let{anchorSize:t="10px",onStart:o,onResize:n,onStop:r,disabledResizeHeight:i}=e,a=(0,Zo.useRef)(),s=(0,Zo.useRef)({onStart:o,onResize:n,onStop:r});s.current.onStart=o,s.current.onResize=n,s.current.onStop=r;let l=(0,Zo.useRef)(1);function p(y,C){l.current=Im(),a.current=C,document.body.style.cursor="se-resize",o?.(C),y.stopPropagation(),y.preventDefault()}(0,Zo.useEffect)(()=>{function y(b){a.current&&(s.current.onResize?.(b.movementX/l.current,b.movementY/l.current,a.current),b.stopPropagation())}function C(){a.current&&(s.current.onStop?.(),a.current=void 0,document.body.style.cursor="inherit")}return window.addEventListener("mousemove",y),window.addEventListener("mouseup",C),window.addEventListener("contextmenu",C),()=>{window.removeEventListener("mousemove",y),window.removeEventListener("mouseup",C),window.removeEventListener("contextmenu",C)}},[]);let{top:u,bottom:c,left:m,right:d,topLeft:f,topRight:h,bottomLeft:_,bottomRight:g}=(0,Zo.useMemo)(()=>{let y={position:"absolute",height:t,width:t,background:"none",backgroundColor:"none",zIndex:1};return{top:{...y,cursor:"n-resize",width:"100%",top:0,left:0},bottom:{...y,cursor:"s-resize",width:"100%",bottom:0,left:0},left:{...y,cursor:"w-resize",height:"100%",top:0,left:0},right:{...y,cursor:"e-resize",height:"100%",top:0,right:0},topLeft:{...y,cursor:"nw-resize",top:0,left:0},topRight:{...y,cursor:"ne-resize",top:0,right:0},bottomLeft:{...y,cursor:"sw-resize",bottom:0,left:0},bottomRight:{...y,cursor:"se-resize",bottom:0,right:0}}},[t]);return Zo.default.createElement(Zo.default.Fragment,null,!i&&Zo.default.createElement(B,{sx:u,onMouseDown:y=>p(y,"top")}),!i&&Zo.default.createElement(B,{sx:c,onMouseDown:y=>p(y,"bottom")}),Zo.default.createElement(B,{sx:m,onMouseDown:y=>p(y,"left")}),Zo.default.createElement(B,{sx:d,onMouseDown:y=>p(y,"right")}),!i&&Zo.default.createElement(B,{sx:f,onMouseDown:y=>p(y,"top-left")}),!i&&Zo.default.createElement(B,{sx:h,onMouseDown:y=>p(y,"top-right")}),!i&&Zo.default.createElement(B,{sx:_,onMouseDown:y=>p(y,"bottom-left")}),!i&&Zo.default.createElement(B,{sx:g,onMouseDown:y=>p(y,"bottom-right")}))},rM=zz;var Vz=!0,Rz={x:0,y:0,top:0,left:0,right:0,bottom:0,width:0,height:0},iM=e=>{let{root:t}=e,{t:o}=E(["common","client"]),{loading:n,askAIWithContextWindow:r,inputValue:i,contextWindowList:a,isSettingCustomVariables:s,setIsSettingCustomVariables:l,setIsEditedCustomVariables:p}=_6(),{open:u}=_m(),{mode:c,changeMode:m}=uo(),{refetch:d}=nn(),{closeContextMenu:f,hideFloatingContextMenu:h}=rd(),{currentFloatingContextMenuDraft:_,activeResponseMessage:g}=jn(),{floatingDropdownMenuPin:y}=os(),C=vt(ui),b=nd(C),[v,S]=(0,le.useState)(!1),P=g||n,{defaultWidth:k,defaultHeight:L,updateLayout:H}=y6(C.rootRect),W=P&&L?Math.max(L,200):0,O=P?200:142,D=(0,le.useMemo)(()=>{let $="bottom-start",fe="bottom-start";if(C.rootRect&&k){let ie=["bottom","top","left","right"];if(C.miniMenuPlacement)switch(C.miniMenuPlacement){case"bottom-end":{ie=["bottom","right","top","left"];break}case"top-start":{ie=["top","left","bottom","right"];break}case"top-end":{ie=["top","right","bottom","left"];break}}let R=Yy(C.rootRect,k,(W||O)+400,{offset:8,directions:ie});R.y>C.rootRect.top?($="bottom-start",fe="bottom-start"):R.y<C.rootRect.top&&($="top-start",fe="top-start"),R.x>C.rootRect.left+300?$="right-start":R.x<C.rootRect.left-300&&($="left-start")}return{inputPlacement:$,contextMenuPlacement:fe}},[C.rootRect,C.miniMenuPlacement,k]),V=(0,le.useRef)(null),N=(0,le.useRef)({x:0,y:0,dragged:!1}),z=(0,le.useRef)({dx:0,dy:0,width:0,height:0,minWidth:550,maxWidth:0,minHeight:200,maxHeight:620,resized:!1,resizeDir:"",startWidth:0,startHeight:0,startLeft:0,startRight:0,startTop:0,startBottom:0});z.current.width=k,z.current.height=W,z.current.minHeight=O,P||(z.current.height=0);let j=(0,le.useCallback)(($,fe,ie)=>Sl($,fe,ie,{animationFrame:!0}),[]),G=(0,le.useRef)(!1),{x:q,y:A,strategy:Y,refs:Q,context:M,update:K}=Ga({open:C.open,strategy:"fixed",onOpenChange:async($,fe,ie)=>{if(!($||!C.open||G.current||v)&&!(!$&&fe?.target instanceof Element&&F_()?.contains(fe.target))&&!Sh("#MAX_AI_PRICING_MODAL")&&!(ie!=="escape-key"&&y)&&(ie==="outside-press"||ie==="escape-key")){if(Sh(`#${lC}`)?.getAttribute("data-status")==="open"){sC();return}if(ie==="outside-press"){let Z=wn();if(Z){let de=new MouseEvent("click",{view:window,bubbles:!0,cancelable:!0});Z.dispatchEvent(de)}}if(u||n||s&&ie==="outside-press")return;if(ie==="escape-key"){h(!0);return}G.current=!0,f().catch(()=>{}).finally(()=>{G.current=!1});return}},placement:D.inputPlacement,middleware:o6(N,V,z),whileElementsMounted:j}),F=Mm(M),pe=wm(M,{capture:{escapeKey:!0,outsidePress:!0},outsidePressEvent:"pointerdown"}),{getFloatingProps:ae}=Nl([pe,F]),te=le.default.useRef(!1),Te=(0,le.useRef)(1),Ie=$=>{$.preventDefault(),te.current=!0,Te.current=Im()},{floatingPosition:Nt,startResize:lt,handleResize:Le,stopResize:nt}=b6({x:q,y:A,refs:Q,update:K,dragOffsetRef:N,floatingSizeOffsetRef:z,rootRect:C.rootRect}),{refreshChatAIModelSelector:At}=$l();(0,le.useEffect)(()=>{C.open?(At(),d()):(N.current={x:0,y:0,dragged:!1},z.current.dx=0,z.current.dy=0,z.current.resized=!1,z.current.resizeDir="",K(),m("list"))},[C.open,At]),(0,le.useEffect)(()=>{let $=ie=>{te.current&&(ie.preventDefault(),te.current=!1)},fe=ie=>{if(!te.current)return;let R=ie.movementX/Te.current,Z=ie.movementY/Te.current;N.current={x:N.current.x+R,y:N.current.y+Z,dragged:!0},V.current&&(V.current.style.marginLeft?V.current.style.marginLeft="":V.current.style.marginLeft="0.5px"),K(),ie.preventDefault()};return document.addEventListener("mousemove",fe),document.addEventListener("mouseup",$),()=>{document.removeEventListener("mousemove",fe),document.removeEventListener("mouseup",$)}},[K,C.open]),(0,le.useEffect)(()=>{if(C.rootRect){let $=Zy(C.rootRect);if(!Vz){document.querySelector("#rangeBorderBox")?.remove();let fe=document.createElement("div");fe.id="rangeBorderBox",Object.assign(fe.style,{position:"absolute",left:$.left+"px",top:$.top+window.scrollY+"px",width:$.width+"px",height:$.height+"px",border:"1px solid green",zIndex:"9999",pointerEvents:"none"}),document.body.appendChild(fe)}}},[C.rootRect]),(0,le.useEffect)(()=>{Q.setPositionReference({getBoundingClientRect(){return De(b.current.rootRect)||Rz}})},[b]);let Ze=(0,le.useMemo)(()=>C.open?o(g?"client:floating_menu__input__placeholder__after_ai_response":"client:floating_menu__input__placeholder"):"",[o,C.open,g]);(0,le.useEffect)(()=>{},[k,W]),(0,le.useEffect)(()=>{P||(z.current.dx=0,z.current.dy=0,z.current.resized=!1,z.current.resizeDir=""),K()},[P]);let{draftUserMessage:dt}=jn(),It=kt("floatingMenuInputMediator"),Zt=async()=>{await Fe({emitEvent:!0})&&await r()},[pt,Lo]=(0,le.useState)(!0),St=(0,le.useCallback)(()=>{Lo(!1),setTimeout(()=>{Lo(!0)},50)},[]);return le.default.createElement(Tm,{root:t},le.default.createElement("div",{ref:Q.setFloating,id:bl,"data-testid":"maxai--floating-context-menu-reference-element","data-disabled-button-clicked":!0,onKeyUp:$=>$.stopPropagation(),onKeyDown:$=>{$.key!=="Escape"&&$.stopPropagation()},style:{position:Y,zIndex:C.open?2147483601:-1,opacity:C.open?1:0,visibility:C.open?"visible":"hidden",...Nt,width:k,height:W},"aria-hidden":C.open?"false":"true",...ae()},P?le.default.createElement(rM,{onStart:lt,onResize:Le,onStop:()=>{nt(),H(P?{width:z.current.width,height:z.current.height}:{width:z.current.width})}}):null,le.default.createElement(MT,{customOpen:!0,defaultPlacement:D.contextMenuPlacement,needAutoUpdate:!0,hoverOpen:!1,menuList:a,isFirstLevelFlatten:!_||!!_&&i.length!==0,referenceElementOpen:C.open,referenceElementRef:V,referenceElement:le.default.createElement(B,{ref:V,component:"div",sx:{boxSizing:"border-box",background:$=>$.palette.background.paper,borderRadius:"8px",border:$=>$.palette.mode==="dark"?"1px solid rgba(255,255,255,0.08)":"1px solid rgba(0,0,0,0.08)",boxShadow:"0px 4px 6px -2px rgba(16, 24, 40, 0.03), 0px 12px 16px -4px rgba(16, 24, 40, 0.08)",overflow:"hidden",isolation:"isolate",display:"flex",flexDirection:"column",width:"100%",padding:"10px"},onKeyDown:$=>{$.stopPropagation()}},C.open&&le.default.createElement(le.default.Fragment,null,n||s?null:le.default.createElement(B,{id:"ONBOARDING_TOOLTIP__FLOATING_CONTEXT_MENU_INPUT_BOX__REFERENCE_ELEMENT",sx:{width:10,height:10,position:"absolute",left:0,bottom:"20px",pointerEvents:"none",zIndex:-1}})),le.default.createElement(B,{sx:{position:"absolute",width:"100%",left:0,top:0,cursor:"grab",height:"28px"},onMouseDown:Ie}),s?le.default.createElement(B,{sx:{flex:1}}):C.open&&le.default.createElement(le.default.Fragment,null,le.default.createElement(tM,{loading:n}),le.default.createElement(zT,{contextMenuDefaultHeight:W})),C.open&&le.default.createElement(le.default.Fragment,null,le.default.createElement(NT,{showModelSelector:C.showModelSelector,showUsageButton:!0,loading:n})),le.default.createElement(nM,null),C.open&&le.default.createElement(sf,{showCloseButton:!1,onInputCustomVariable:({data:$,variables:fe})=>{let ie=fe?.some(R=>R.name?!1:$[R.name]);p(R=>R||!!ie)},onBeforeRunShortcuts:()=>l(!1),onClose:$=>{l(!1)},onShow:()=>{l(!0)},modelKey:"FloatingContextMenu",autoFocusAfterBlur:!0}),(!s||n)&&le.default.createElement(x,{width:"100%",gap:.5,sx:{marginTop:"8px"}},le.default.createElement(x,{direction:"row",justifyContent:"flex-end",alignItems:"end",gap:1},le.default.createElement(x,{direction:"row",width:0,flex:1,alignItems:"center",spacing:1,justifyContent:"left",marginBottom:"4px",sx:{display:v?"none":"flex"}},n?le.default.createElement(le.default.Fragment,null,le.default.createElement(T,{fontSize:"16px",color:$=>$.palette.mode==="dark"?"rgba(255, 255, 255, 0.38)":"rgba(0, 0, 0, 0.38)"},o(dt?"client:floating_menu__input__running_placeholder":"client:floating_menu__input__reading_placeholder")),le.default.createElement(Jt,{size:"16px",sx:{color:$=>$.palette.mode==="dark"?"rgba(255, 255, 255, 0.38)":"rgba(0, 0, 0, 0.38)"}})):le.default.createElement(le.default.Fragment,null,le.default.createElement(ST,{minLine:1,maxHeight:z.current.height?z.current.height/2:void 0,stopPropagation:!0,autoFocus:C.open,onKeydownCapture:$=>C.open&&a.length?!1:$.key==="ArrowUp"||$.key==="ArrowDown"?($.stopPropagation(),!0):!1,placeholder:Ze,InputId:Si,sx:{border:"none","& > div":{"& > div":{p:0},"& > textarea":{p:0},"& > .max-ai-user-input__expand":{"&:has(> div)":{pr:1}}},borderRadius:0,minHeight:s?0:"24px",height:s?"0!important":"unset",visibility:s?"hidden":"visible"},onEnter:async()=>{a.length>0&&c==="list"||(m("list"),await Zt())},onControlledValueChange:($,fe)=>{fe===Si&&$.length<1&&It.resetInputValue()}})),le.default.createElement(mx,null)),!n&&le.default.createElement(le.default.Fragment,null,!v&&le.default.createElement(le.default.Fragment,null,C.open&&le.default.createElement(px,null),le.default.createElement(sx,null)),le.default.createElement(ps,{value:{isVoiceInput:v,setIsVoiceInput:S,isUseInternalState:!1}},le.default.createElement(yp,{inputMediator:It,onClick:Zt,onSpeechToTextSuccess:$=>{It.updateInputValue(It.getInputValue()+$)},tooltipProps:{placement:"bottom"},disabled:i.length===0})))))),root:t})),a.length>0&&le.default.createElement(jT,{showStateTrigger:C.open&&a.length>0,onClose:()=>{St()}}),le.default.createElement(UT,{showStateTrigger:C.open&&a.length>0&&a.some($=>$.prompt_id===Yl.REPLACE_SELECTION)}),!n&&!s?le.default.createElement(le.default.Fragment,null,le.default.createElement(RT,{showStateTrigger:C.open&&!g&&!s&&a.length>0&&a.some($=>$.prompt_id==="30f27496-1faf-4a00-87cf-b53926d35bfd")&&(_===""||i.length>0)&&pt})):null,n?null:le.default.createElement(le.default.Fragment,null,le.default.createElement(VT,{showStateTrigger:C.open&&!!g&&g.type==="ai"})))};var gx=I(w());var Qo=I(w());var aM=I(w()),Uz=e=>{let{sx:t,...o}=e;return aM.default.createElement(ce,{sx:y_({transition:"all 0.15s",height:"32px",padding:"0px",minWidth:"initial",color:n=>n.palette.mode==="dark"?"#fff":"rgba(0, 0, 0, 0.6)","&:hover":{backgroundColor:n=>n.palette.mode==="dark"?"rgba(255, 255, 255, 0.08)":"rgba(0, 0, 0, 0.06)",color:n=>n.palette.mode==="dark"?"#fff":"rgba(0, 0, 0, 0.87)"}},t),...o},e.children)},Hs=Uz;var bi=I(w());var hx=I(w());var Wz=e=>{let{sx:t,...o}=e,{t:n}=E(["client","common"]),{hideMenu:r}=tp(),{updateAppSettings:i}=I6(),a=p=>{p.stopPropagation(),Ua({key:"options",query:"?id=floating-image-mini-menu#/appearance"})},s=async p=>{p.stopPropagation();let u=await pc.getAppSettings();await pc.setAppSettings({floatingImageMiniMenu:{visibility:{...u.floatingImageMiniMenu.visibility,blacklist:[...u.floatingImageMiniMenu.visibility.blacklist,Za()]}}}),i(),r()},l=async p=>{p.stopPropagation();let u=await pc.getAppSettings();await pc.setAppSettings({floatingImageMiniMenu:{visibility:{...u.floatingImageMiniMenu.visibility,isWhitelistMode:!0}}}),i(),r()};return hx.default.createElement(B,{sx:{marginLeft:"0px!important",color:"#fff",position:"absolute",top:"calc(100% - 6px)",left:"0px",...t},...o},hx.default.createElement(sd,{sx:{marginTop:"10px"},hideThisSiteItemDataButtonClickedName:"max_ai__floating_image_menu__hide_menu__this_site",hideThisSiteItemText:n("client:floating_menu__mini_menu__image__close_item__hide_on_this_site"),hideThisSiteConfirmCardTitle:n("client:floating_menu__mini_menu__image__confirm_card__hide_this_site__title"),hideThisSiteConfirmCardOkText:n("client:floating_menu__mini_menu__image__close_item__hide_on_this_site"),hideThisSiteConfirmCardCancelText:n("common:cancel"),onHideThisSiteConfirmCardClickOk:s,onHideThisSiteConfirmCardClickCancel:()=>{},hideAllSitesItemDataButtonClickedName:"max_ai__floating_image_menu__hide_menu__all_sites",hideAllSitesItemText:n("client:floating_menu__mini_menu__image__close_item__hide_always"),hideAllSitesConfirmCardTitle:n("client:floating_menu__mini_menu__image__confirm_card__hide_all_sites__title"),hideAllSitesConfirmCardOkText:n("client:floating_menu__mini_menu__image__close_item__hide_always"),hideAllSitesConfirmCardCancelText:n("common:cancel"),onHideAllSitesConfirmCardClickOk:l,onHideAllSitesConfirmCardClickCancel:()=>{},openSettingsItemTextI18nKey:"client:floating_menu__mini_menu__image__close_item__settings_tips",onClickSettings:a}))},sM=Wz;var Gz=()=>{let{floatingImageMiniMenuKey:e}=(0,bi.useContext)(es),{t}=E(["client"]),{hideMenu:o}=tp(),n=r=>{r.stopPropagation(),od(e).disable=!0,o()};return bi.default.createElement(x,{sx:{flexDirection:"row",alignItems:"center","&:hover":{".maxai_close_button":{borderRadius:"6px"},".maxai_more_close_options":{margin:"0px",opacity:"1"}}}},bi.default.createElement(he,{placement:"top",title:t("client:floating_menu__mini_menu__image__close_item__hide_until_next_visit")},bi.default.createElement("span",null,bi.default.createElement(Hs,{onClick:n,className:"maxai_close_button",sx:{width:"32px",fontSize:"16px",borderRadius:"4px 16px 16px 4px",backgroundColor:r=>r.palette.mode==="dark"?"transparent":"#fff",zIndex:"1"}},bi.default.createElement(U,{size:18,icon:"Close"})))),bi.default.createElement(Hs,{className:"maxai_more_close_options",sx:{marginLeft:"-32px",opacity:"0",width:"32px",fontSize:"16px",borderRadius:"4px 16px 16px 4px",backgroundColor:r=>r.palette.mode==="dark"?"transparent":"#fff","&:hover":{".maxai__floating_image_menu__close_menu":{transform:"scale(1)"}}},disableRipple:!0},bi.default.createElement(U,{icon:"Power"}),bi.default.createElement(sM,{className:"maxai__floating_image_menu__close_menu",sx:{zIndex:"1",transform:"scale(0)",transformOrigin:"left top"}})))},lM=Gz;var jz=Qo.default.forwardRef(function({sx:t,className:o},n){let{t:r}=E(["client"]);return Qo.default.createElement(B,{sx:{overflow:"hidden",transition:"width 0.2s",marginLeft:"0px!important",...t||{}},ref:n,className:o},Qo.default.createElement(B,{sx:{height:"100%",fontSize:"12px",fontWeight:"initial",color:i=>i.palette.mode==="dark"?"#fff":"rgba(0, 0, 0, 0.87)",lineHeight:"16px",overflow:"hidden",marginLeft:"0px!important",whiteSpace:"nowrap"}},r("client:floating_menu__mini_menu__image__menu_item__chat_with_image")))}),W1=e=>{let{filterImage:t,dataTestId:o}=e,{floatingImageMiniMenuKey:n}=(0,Qo.useContext)(es),r=vt(td(n)),{showMenu:i,hideMenu:a}=tp(),s=(0,Qo.useRef)(null),l=od(n),{hover:p,onMouseEnter:u,onMouseLeave:c}=id(100);S6({filterImage:t}),(0,Qo.useEffect)(()=>{p?(s.current&&clearTimeout(s.current),l.mouseInMenu=!0,i()):(l.mouseInMenu=!1,s.current=setTimeout(()=>{l.mouseInImage||a()},50))},[p]);let m=async()=>{a(),ts()||ra(),Lm("ContextMenuChatWithImage",{image:l.currentHoverImage,imageSrc:l.currentHoverImageSrc})};return Qo.default.createElement(x,{className:"MAX_AI_FLOATING_IMAGE_MINI_MENU","data-testid":o,onMouseEnter:u,onMouseLeave:c,alignItems:"center",justifyContent:"center",sx:{boxSizing:"border-box",zIndex:2147483601,display:r.show?"flex":"none",cursor:"pointer",position:"fixed",top:`calc(${r.position.top} + 15px)`,left:`calc(${r.position.left} + 15px)`,...p&&{".max_ai_floating_image_dot_button":{opacity:"0",transform:"scale(5)"},".max_ai_floating_image_text_button":{opacity:"1",transform:"scale(1)"}}}},Qo.default.createElement(x,{sx:{transition:"all 0.15s",justifyContent:"center",alignItems:"center",width:"16px",height:"16px",boxSizing:"border-box"}},Qo.default.createElement(B,{className:"max_ai_floating_image_dot_button",sx:{width:"8px",height:"8px",borderRadius:"50%",backgroundColor:"rgba(144, 101, 176, 1)",border:"1px solid rgba(255, 255, 255, 0.08)",boxSizing:"border-box"}})),Qo.default.createElement(x,{direction:"row",className:"max_ai_floating_image_text_button",sx:{opacity:"0",transform:"scale(0)",transformOrigin:"15px 15px",transition:"all 0.15s",position:"absolute",top:"0px",left:"0px",boxSizing:"border-box",alignItems:"center",padding:"2px",height:"36px",borderRadius:"18px",bgcolor:d=>d.palette.mode==="dark"?"rgba(44,44,44,0.95)":"#fff",backdropFilter:"blur(4px)",margin:"-8px",boxShadow:"0px 4px 8px 0px rgba(0, 0, 0, 0.12), 0px 0px 1px 0px rgba(0, 0, 0, 0.08)"}},Qo.default.createElement(Hs,{onClick:()=>m(),sx:{borderRadius:"16px 4px 4px 16px",padding:"0px 8px",[`.${Ea.startIcon}`]:{margin:"0px",marginRight:"8px"}},startIcon:Qo.default.createElement(Nr,{sx:{boxSizing:"border-box",fontSize:"16px!important"}})},Qo.default.createElement(jz,null)),Qo.default.createElement(ft,{orientation:"vertical",sx:{height:"18px",mx:"4px"}}),Qo.default.createElement(lM,null)))};var qz=()=>gx.default.createElement(es.Provider,{value:{floatingImageMiniMenuKey:"ALL_IMAGE"}},gx.default.createElement(W1,{filterImage:e=>ep.commonFirstEnterImage!==e})),pM=qz;var Zi=I(w());var Ia=I(w());var Pu={sceneType:"FLOATING_IMAGE_MENU_BUTTON",id:"ONBOARDING_TOOLTIP__FLOATING_IMAGE_MENU_BUTTON",anchorElementSelectors:'[data-testid="maxai__floating_image_mini_menu__first_enter_image"]',CtaButtonClickedName:"Onboarding > ChatWithImage > Got it"},$z=e=>{let{showStateTrigger:t,onClosed:o,onOpened:n,...r}=e,{t:i}=E(),[a,s]=(0,Ia.useState)(!1);return(0,Ia.useEffect)(()=>{t?_r(Pu.sceneType).then(l=>{l||Gr(Pu.sceneType).then(()=>{s(!0),n?.()})}):s(!1)},[n,t]),Ia.default.createElement(Lt,{hideBackdrop:!0,sx:{visibility:"hidden"},placement:"bottom-start",fallbackPlacements:["top-start"],trigger:a,anchorElementSelectors:Pu.anchorElementSelectors,CtaButtonProps:{"data-button-clicked-name":Pu.CtaButtonClickedName},id:Pu.id,footerLeft:Ia.default.createElement(ld,null),onClose:o,...r},Ia.default.createElement(x,{spacing:.5},Ia.default.createElement(T,{fontSize:14,lineHeight:1.4,color:"text.primary",fontWeight:400,textAlign:"left"},i("onboarding:onboarding_tooltip__FLOATING_IMAGE_MENU_BUTTON__text"))))},cM=$z;var Xz=()=>{let[e,t]=(0,Zi.useState)(!1),o=vt(td("ON_BOARDING"));(0,Zi.useEffect)(()=>{o.show&&t(!0)},[o.show]);let n=()=>{ep.onboardingTooltipShowing=!1},r=()=>{ep.onboardingTooltipShowing=!0};return Zi.default.createElement(Zi.default.Fragment,null,Zi.default.createElement(es.Provider,{value:{floatingImageMiniMenuKey:"ON_BOARDING"}},Zi.default.createElement(W1,{dataTestId:"maxai__floating_image_mini_menu__first_enter_image",filterImage:i=>ep.commonFirstEnterImage===i})),o.show&&Zi.default.createElement(cM,{showStateTrigger:e,onClosed:n,onOpened:r}))},uM=Xz;var _t=I(w());var Qi=I(w());var ku={sceneType:"CONTEXT_MENU_CTA_MINI_ICON_BUTTON",id:"ONBOARDING_TOOLTIP__CONTEXT_MENU_CTA_MINI_ICON_BUTTON",anchorElementSelectors:"#max_ai__floating_context_menu__mini_hide_button",CtaButtonClickedName:"Onboarding > ContextMenu > MiniIconButton > Got it"},Yz=e=>{let{showStateTrigger:t,...o}=e,{t:n}=E(),{chatBoxShortCutKey:r}=Cc(),[i,a]=(0,Qi.useState)(!1);(0,Qi.useEffect)(()=>{t?_r(ku.sceneType).then(l=>{l||Gr(ku.sceneType).then(()=>{a(!0)})}):a(!1)},[t]);let s={bgcolor:l=>l.palette.mode==="dark"?"rgba(255, 255, 255, 0.16) !important":"rgba(0, 0, 0, 0.08) !important",color:l=>l.palette.mode==="dark"?"rgba(255, 255, 255, 0.7) !important":"rgba(0, 0, 0, 0.7) !important"};return Qi.default.createElement(Lt,{hideBackdrop:!0,sx:{visibility:"hidden"},placement:"bottom-start",fallbackPlacements:["top-start"],trigger:i,anchorElementSelectors:ku.anchorElementSelectors,CtaButtonProps:{"data-button-clicked-name":ku.CtaButtonClickedName},id:ku.id,footerLeft:Qi.default.createElement(ld,null),...o},Qi.default.createElement(x,{spacing:.5},Qi.default.createElement(T,{fontSize:14,lineHeight:1.4,color:"text.primary",fontWeight:400,textAlign:"left"},n("client:floating_menu__button__cta__tooltip")),r&&Qi.default.createElement(Fa,{sx:s},r)))},mM=Yz;var Zz={"top-start":[-3,0],"top-end":[-3,0],"bottom-start":[-3,0],"bottom-end":[-3,0]},dM=e=>Zz[e]||[0,0];var Sa=I(w());var xx=I(w()),Qz=({showDivider:e=!0,boxSx:t,dividerProps:o})=>{let{orientation:n="vertical"}=o||{};return e?xx.default.createElement(x,{flex:1,sx:{p:"7px 4px",...t}},xx.default.createElement(ft,{orientation:n,...o})):null},Lu=Qz;var Jz=e=>{let{placement:t,onClick:o,btnGroupSx:n}=e,{t:r}=E(["common","client","prompt"]),{contextMenuPath:i}=uo(),{contextMenuSuggestions:a}=Ja(i||"",3),s=a.sort((l,p)=>+!!p.prompt_icon-+!!l.prompt_icon);return Sa.default.createElement(Sa.default.Fragment,null,Sa.default.createElement(x,{direction:"row",alignItems:"center",className:"max-ai__click-menu-button--box","data-button-clicked-name":"max_ai__floating_context_menu__favorite_menu_group",sx:n},s?.map(l=>{let p=l.prompt_title,u=l.prompt_id.replace(mn,""),c=`prompt:${u}`;r(c)!==u&&(p=r(c));let m=String(p[0]||"").toUpperCase();return Sa.default.createElement(rp,{TooltipProps:{floatingMenuTooltip:!0,placement:t||"bottom"},title:p,key:l.prompt_id,sx:{minWidth:"unset",p:l.prompt_icon?"8px!important":"6px!important"},onMouseUp:d=>{d.stopPropagation(),d.preventDefault()},onMouseDown:d=>{d.stopPropagation(),d.preventDefault()},onClick:async d=>{d.stopPropagation(),d.preventDefault(),await Fe({emitEvent:!0})&&o?.(l)}},l.prompt_icon?Sa.default.createElement(U,{icon:l.prompt_icon,sx:{fontSize:"18px",color:"primary.main"}}):Sa.default.createElement(x,{className:"max-ai__click-menu-button--box__text-icon",alignItems:"center",justifyContent:"center",sx:{width:"16px",height:"16px",boxSizing:"border-box",borderRadius:"4px",bgcolor:d=>d.palette.mode==="dark"?"#4f4f4f":"#F5F6F7",color:d=>d.palette.mode==="dark"?"rgba(255,255,255,.87)":"rgba(0,0,0,.6)"}},Sa.default.createElement(T,{component:"span",fontSize:"13px",color:"inherit"},m)))})),s?.length>0&&Sa.default.createElement(Lu,null))},fM=Jz;var va=I(w());var _x=I(w());var eV=e=>{let{parentX:t,parentY:o,sx:n,...r}=e,{t:i}=E(["common","client"]),{hideRangy:a}=ia(),{updateButtonSettingsWithDomain:s,toggleButtonSettings:l}=Qm(),p=d=>{d.stopPropagation(),Ua({key:"options",query:"#/mini-menu"})},u=async()=>{await s("textSelectPopupButton")},c=async()=>{await l("textSelectPopupButton",!1)},m=t&&o&&t+Xy+240>window.innerWidth;return _x.default.createElement(B,{sx:{marginLeft:"0px!important",color:"#fff",position:"absolute",top:"calc(100% - 6px)",left:m?"auto":0,right:m?0:"auto",zIndex:2147483611,...n},...r},_x.default.createElement(sd,{sx:{marginTop:"10px"},hideThisSiteItemDataButtonClickedName:"max_ai__floating_context_menu__hide_menu__this_site",hideThisSiteItemText:i("client:floating_menu__button__hide_menu__this_site"),hideThisSiteConfirmCardTitle:i("client:floating_menu__button__hide_menu__this_site__tooltip__title"),hideThisSiteConfirmCardOkText:i("client:floating_menu__button__hide_menu__this_site__tooltip__confirm"),hideThisSiteConfirmCardCancelText:i("common:cancel"),onHideThisSiteConfirmCardClickOk:u,onHideThisSiteConfirmCardClickCancel:()=>a(),hideAllSitesItemDataButtonClickedName:"max_ai__floating_context_menu__hide_menu__all_sites",hideAllSitesItemText:i("client:floating_menu__button__hide_menu__all_sites"),hideAllSitesConfirmCardTitle:i("client:floating_menu__button__hide_menu__all_sites__tooltip__title"),hideAllSitesConfirmCardOkText:i("client:floating_menu__button__hide_menu__all_sites__tooltip__confirm"),hideAllSitesConfirmCardCancelText:i("common:cancel"),onHideAllSitesConfirmCardClickOk:c,onHideAllSitesConfirmCardClickCancel:()=>a(),openSettingsItemTextI18nKey:"client:floating_menu__button__menu_settings",onClickSettings:p}))},hM=eV;var tV=({parentX:e,parentY:t})=>{let{t:o}=E(["client"]),n=po(Jm),r=po(ui),i=async()=>{r({open:!1,rootRect:null,showModelSelector:!1,miniMenuPlacement:null}),n(a=>({...a,closeBeforeRefresh:!0}))};return va.default.createElement(x,{component:"div",sx:{flexDirection:"row",alignItems:"center","&:hover":{".maxai_close_button":{borderRadius:"6px"},".maxai_more_close_options":{margin:"0px",opacity:"1"}}}},va.default.createElement(he,{placement:"top",title:o("client:floating_menu__button__hide_menu__until_next_visit")},va.default.createElement("span",null,va.default.createElement(Hs,{onClick:i,className:"maxai_close_button",sx:{width:"32px",fontSize:"16px",borderRadius:"4px 16px 16px 4px",backgroundColor:a=>a.palette.mode==="dark"?"transparent":"#fff",zIndex:"1"}},va.default.createElement(U,{size:18,icon:"Close"})))),va.default.createElement(Hs,{className:"maxai_more_close_options",sx:{marginLeft:"-32px",opacity:"0",width:"32px",fontSize:"16px",borderRadius:"4px 16px 16px 4px",backgroundColor:a=>a.palette.mode==="dark"?"transparent":"#fff","&:hover":{".maxai__floating_mini_menu__close_menu":{transform:"scale(1)"}}},disableRipple:!0},va.default.createElement(U,{icon:"Power"}),va.default.createElement(hM,{parentX:e,parentY:t,className:"maxai__floating_mini_menu__close_menu",sx:{transform:"scale(0)",transformOrigin:"left top"}})))},gM=tV;var G1=I(w());var oV=e=>{let{placement:t,TooltipProps:o,selectionText:n,btnGroupSx:r}=e,{t:i}=E(["common","client"]),{hideRangy:a}=ia();return G1.default.createElement(x,{direction:"row",alignItems:"center",className:"max-ai__click-menu-button--box",sx:r},G1.default.createElement(rp,{TooltipProps:{floatingMenuTooltip:!0,placement:t||"bottom",...o},id:"max_ai__floating_context_menu__ai_search_button",title:i("client:floating_menu__mini_menu__ai_search__button__tooltip"),sx:{minWidth:"unset",p:"8px!important"},onMouseUp:s=>{s.stopPropagation(),s.preventDefault()},onMouseDown:s=>{s.stopPropagation(),s.preventDefault()},onClick:async s=>{if(s.stopPropagation(),s.preventDefault(),!await Fe({emitEvent:!0}))return;let l=window.getSelection()?.toString();a(),ra();for(let p=0;p<30&&(await _2(200),!ts());p++);(l||n)&&Lm("ContextMenuQuickSearchSelectedText",{question:l||n})}},G1.default.createElement(U,{icon:"Search",sx:{fontSize:"18px",color:s=>s.palette.mode==="dark"?"rgba(255,255,255,.87)":"rgba(0,0,0,.6)"}})))},xM=oV;var Cx={div:{display:"flex"},position:"relative",display:"flex",alignItems:"center",justifyContent:"center",bgcolor:"transparent","&:hover":{"&:has(button)&::after":{display:"none"}},"& button":{minWidth:"unset",padding:"7px 8px!important",boxSizing:"border-box",borderRadius:"6px","&:hover":{bgcolor:e=>e.palette.mode==="dark"?"rgba(255, 255, 255, 0.08)":"rgba(0, 0, 0, 0.06)"},"&:has(.max-ai__click-menu-button--box__text-icon)":{height:"32px",width:"34px"}}},nV=()=>{let{t:e}=E(["common","client"]),{tempSelection:t,lastMousePosition:o,show:n,hideRangy:r}=ia(),{chatBoxShortCutKey:i}=Cc(),{buttonSettings:a}=Qm(),s=(0,_t.useMemo)(()=>a?.textSelectPopupButton.visibility?r_(a.textSelectPopupButton.visibility):!0,[a?.textSelectPopupButton.visibility]),l=po(h6),{conversationId:p}=Mt(),u=xe(p),c=po(ed),{closeBeforeRefresh:m}=vt(Jm),{showFloatingContextMenu:d}=os(),[f,h]=Br(ui),_=(0,_t.useMemo)(()=>n&&s&&!m&&!f.open,[n,s,m,f.open]),{hover:g,onMouseEnter:y,onMouseLeave:C}=id(100);(0,_t.useEffect)(()=>{C()},[s,C]),(0,_t.useEffect)(()=>{_||C()},[_,C]);let{scrollState:b,inParentScrollView:v}=M_(t?.activeElement??null,t,-1),S=F=>({name:"miniMiniMiddleware",fn:pe=>{let{rects:ae}=pe,te=ae.reference,Ie=[{placement:"top-start",x:te.x,y:te.y},{placement:"top-end",x:te.x+te.width,y:te.y},{placement:"bottom-start",x:te.x,y:te.y+te.height},{placement:"bottom-end",x:te.x+te.width,y:te.y+te.height}].filter(({x:St,y:$})=>!(St>window.innerWidth+window.scrollX||St<0||$>window.innerHeight+window.scrollY||$<0)).map(St=>({...St,distance:Math.pow(St.x-F.x,2)+Math.pow(St.y-F.y,2)})),Nt=b_(Ie,St=>St.distance);if(!Nt)return{x:te.x-Pn,y:te.y+te.height};let{placement:lt,x:Le,y:nt}=Nt,At=Le-Pn<0,Ze=Le+Pn>window.innerWidth+window.scrollX,dt=nt-Pn<0,It=nt+Pn>window.innerHeight+window.scrollY,Zt=()=>{let St={"top-start":{x:At?Le+12:Le-Pn*.5,y:dt?nt+12:nt-Pn*.5},"top-end":{x:Ze?Le-Pn:Le,y:dt?nt+12:nt-Pn*.5},"bottom-start":{x:At?Le+12:Le-Pn*.5,y:It?nt-Pn:nt},"bottom-end":{x:Ze?Le-Pn:Le,y:It?nt-Pn:nt}};return St[lt]||St["bottom-start"]},{x:pt,y:Lo}=Zt();return{x:pt,y:Lo,reset:{placement:lt}}}}),{x:P,y:k,strategy:L,refs:H,placement:W}=Ga({placement:"bottom-start",middleware:o?[S(o)]:[]});(0,_t.useEffect)(()=>{_&&h(F=>({...F,miniMenuPlacement:W}))},[W,_]);let O=(0,_t.useRef)(null);(0,_t.useEffect)(()=>{if(!t?.selectionRect||!_){O.current?.remove(),O.current=null;return}let F=Qy(t.selectionRect);oa||(O.current||(O.current=document.createElement("div"),O.current.style.position="absolute",O.current.style.zIndex="9999",O.current.style.pointerEvents="none",document.body.appendChild(O.current)),O.current.style.display=v?"block":"none",O.current.style.left=F.left+b.x+"px",O.current.style.top=F.top+window.scrollY+b.y+"px",O.current.style.width=F.width+"px",O.current.style.height=F.height+"px",O.current.style.border="2px solid red",O.current.style.zIndex="9999",O.current.style.pointerEvents="none"),H.setPositionReference({getBoundingClientRect(){return{...F,x:F.left,y:F.top}}})},[_,t,b,v]);let D=()=>{if(H.floating.current){if(getComputedStyle(H.floating.current).opacity==="0")return;r(),C6()}};(0,_t.useEffect)(()=>{let F=pe=>{pe.key==="Escape"&&D()};return document.addEventListener("keydown",F,!0),()=>{document.removeEventListener("keydown",F,!0)}},[]),(0,_t.useEffect)(()=>{u&&setTimeout(()=>{D()},1e3)},[u]),(0,_t.useEffect)(()=>{let F=()=>{C()};return window.addEventListener("blur",F),window.removeEventListener("blur",F)},[]);let V=F=>({popper:{modifiers:[{name:"offset",options:{offset:({placement:ae})=>dM(ae)}},{name:"flip",enabled:!0,options:{fallbackPlacements:F?["top","bottom-start","bottom"]:["top","bottom","bottom-start"]}}]}}),{contextMenuPath:N}=uo(),{contextMenuSuggestions:z}=Ja(N||"",3),j=4*Pn+2*Oh,G=j+z.length*Pn+Oh,q=P+j>window.innerWidth+window.scrollX,A=P+G>window.innerWidth+window.scrollX,Y=(0,_t.useRef)(null),Q=P+b.x,M=k+b.y,{open:K}=_m();return _t.default.createElement(B,{component:"div",ref:F=>{Y.current=F,H.setFloating(F)},className:`max-ai__click-context-menu ${_?"open":"close"}`,sx:{zIndex:_?2147483600:-1,position:L,top:M||0,left:Q||0,cursor:"pointer"}},_t.default.createElement(B,{onMouseEnter:y,onMouseLeave:()=>{K||C()},sx:{position:"relative",overflow:"visible","&:hover":{".mini-icon-button":{visibility:"hidden",userSelect:"none",zIndex:-1}}}},_&&g&&_t.default.createElement(x,{className:"max_ai_floating_mini_menu_content",direction:"row",alignItems:"center",sx:{display:"flex",transformOrigin:"15px 15px",borderRadius:"18px",position:"absolute",left:0,top:0,margin:"-8px",boxShadow:"0px 4px 8px 0px rgba(0, 0, 0, 0.12), 0px 0px 1px 0px rgba(0, 0, 0, 0.08)",bgcolor:F=>F.palette.mode==="dark"?"rgba(44,44,44,0.95)":"#fff",backdropFilter:"blur(4px)",alignItems:"stretch",p:"2px"}},_t.default.createElement(B,{component:"div",sx:{...Cx,"&:first-of-type":{"& button":{borderRadius:q?"16px":"16px 4px 4px 16px"}}}},_t.default.createElement(rp,{TooltipProps:{floatingMenuTooltip:!0,placement:"top-start",description:i,sx:{maxWidth:340},slotProps:V(!0)},title:e("client:floating_menu__button__cta__tooltip"),className:"usechatgpt-ai__context-menu--handle-button",id:"max_ai__floating_context_menu__cta_button","data-testid":"max_ai__floating_context_menu__cta_button",size:"small",variant:"text",onMouseUp:F=>{F.stopPropagation(),F.preventDefault()},onMouseDown:F=>{F.stopPropagation(),F.preventDefault()},onClick:F=>{F.stopPropagation(),F.preventDefault();let pe=window.getSelection()?.rangeCount;if(pe&&pe>0){let ae=window.getSelection()?.getRangeAt(0)?.cloneRange();c({range:ae||null,selectionText:window?.getSelection()?.toString()||""})}t&&d()}},_t.default.createElement(Nr,{sx:{fontSize:"18px"}}))),!q&&_t.default.createElement(_t.default.Fragment,null,_t.default.createElement(Lu,null),!A&&_t.default.createElement(fM,{btnGroupSx:Cx,placement:"top",onClick:F=>{l(pe=>({...pe,selectedContextMenuId:F.prompt_id})),t&&d({openAutoExecute:!0})}}),_t.default.createElement(xM,{btnGroupSx:Cx,placement:"top",selectionText:t?.selectionText,TooltipProps:{slotProps:V(!1)}}),_t.default.createElement(Lu,null),_t.default.createElement(gM,{parentX:P??0,parentY:k??0}))),_t.default.createElement(x,{className:"mini-icon-button",sx:{top:2,left:2,position:"absolute",width:"16px",height:"16px",visibility:g?"hidden":"inherit",opacity:_&&v?1:0,transition:_?"opacity .25s":"none"},alignItems:"center",justifyContent:"center",id:"max_ai__floating_context_menu__mini_hide_button"},_t.default.createElement(B,{sx:{borderRadius:"50%",height:"8px",width:"8px",backgroundColor:"rgba(144, 101, 176, 1)"}}))),_t.default.createElement(mM,{showStateTrigger:_}))},_M=nV;var Ji=I(w()),bM=I(ec());var j1=I(w()),yx=(0,j1.createContext)({caret:null,selection:null,focus:!1}),CM=()=>(0,j1.useContext)(yx);var bn=I(w());var K1=class{constructor(){this._events=new Map}on(t,o){this._events.has(t)||this._events.set(t,[]),this._events.get(t).push(o)}off(t,o){let n=this._events.get(t);n&&n.length&&this._events.set(t,n.filter(r=>r!==o))}emit(t,...o){let n=this._events.get(t);n&&n.length&&n.forEach(r=>{r(...o)})}addListener(t,o){this.on(t,o)}removeListener(t,o){this.off(t,o)}removeAllListeners(t){t?this._events.delete(t):this._events.clear()}};var oi=new Cm("ContextMenu/GoogleDocHelper");var q1=class extends K1{constructor(){super();this.disabled=!1;this.editable=!0;this.initialized=!1;this.lastCaret=null;this.lastSelection=null;this.observer=null;this.debounceCaretOrSelectionChange=Rn(()=>{this.checkCaretChange(),this.checkSelectionChange()},20);this._onScroll=o=>{oi.info("onScroll"),this.emit("scroll",o)};this._onMouseUp=o=>{oi.info("onMouseUp"),o.MAX_AI_IGNORE=!0,this.emit("mouseup",o)};this.onKeyUp=o=>{oi.info("onKeyUp"),o.MAX_AI_IGNORE=!0,this.emit("keyup",o)};this._onFocus=o=>{oi.info("onFocus"),this.emit("focus",o)};this._onBlur=o=>{oi.info("onBlur"),this.emit("blur",o)};this.disabled=!location.href.startsWith("https://docs.google.com/document"),this.editable=!!document.querySelector("#docs-insert-menu")}init(){this.disabled||this.initialized||(this.initElement(),this.initListener())}initElement(){this.editorElement=document.querySelector("div.kix-appview-editor"),this.scrollElement=document.querySelector("div.kix-scrollareadocumentplugin"),this.iframeElement=document.querySelector("iframe.docs-texteventtarget-iframe"),this.inputElement=this.iframeElement?.contentDocument?.querySelector('div[contenteditable="true"]'),this.caretElement=document.querySelector("#kix-current-user-cursor-caret")}initListener(){let o=document.querySelector("div.kix-cursor");this.observer=new MutationObserver(n=>{n.some(r=>r.target.classList?.contains("kix-cursor"))&&(oi.info("\u5149\u6807\u79FB\u52A8"),this.debounceCaretOrSelectionChange())}),o&&this.observer.observe(o,{attributes:!0,attributeFilter:["style"],childList:!1,characterData:!1,subtree:!1}),this.editorElement?.addEventListener("scroll",this._onScroll),this.editorElement?.addEventListener("mouseup",this._onMouseUp),this.inputElement?.addEventListener("keyup",this.onKeyUp),this.inputElement?.addEventListener("focus",this._onFocus),this.inputElement?.addEventListener("blur",this._onBlur)}destroy(){this.initialized=!1,this.observer?.disconnect(),this.editorElement?.addEventListener("scroll",this._onScroll),this.editorElement?.removeEventListener("mouseup",this._onMouseUp),this.inputElement?.removeEventListener("keyup",this.onKeyUp),this.inputElement?.removeEventListener("focus",this._onFocus),this.inputElement?.removeEventListener("blur",this._onBlur),this.removeAllListeners()}isSelectionChange(o,n){return!(o===n||o&&n&&o.layouts.length===n.layouts.length&&o.layouts.every((r,i)=>!Bh(r,n.layouts[i])))}isCaretChange(o,n){if(o===n)return!1;if(!(o&&n&&!Bh(o.layout,n.layout)))return!0}isFocus(){return document.activeElement===this.iframeElement}checkSelectionChange(){let o=this.getCurrentSelection();this.isSelectionChange(o,this.lastSelection)&&(this.lastSelection=o,this.emit("selection-change",this.lastSelection))}checkCaretChange(){let o=this.getCurrentCaret();this.isCaretChange(o,this.lastCaret)&&(this.lastCaret=o,this.emit("caret-change",this.lastCaret))}calculateRelativeLayout(o){return this.scrollElement?t6(this.scrollElement?.getBoundingClientRect(),o):Jy}replaceSelection(o){oi.info(o);let n=new DataTransfer;n.setData("text/plain",o),this.inputElement?.focus(),this.inputElement?.dispatchEvent(new ClipboardEvent("paste",{clipboardData:n,bubbles:!0,cancelable:!0}))}insertBelowSelection(o){if(oi.info(o),this.inputElement?.focus(),this.lastSelection){let n={code:"ArrowRight",key:"ArrowRight",keyCode:39,bubbles:!0,repeat:!1};this.inputElement?.dispatchEvent(new KeyboardEvent("keydown",n))}this.replaceSelection(`
${o}`)}insertAboveSelection(o){if(oi.info(o),this.inputElement?.focus(),this.lastSelection){let n={charCode:0,code:"ArrowLeft",key:"ArrowLeft",keyCode:37,bubbles:!0,repeat:!1};this.inputElement?.dispatchEvent(new KeyboardEvent("keydown",n))}this.replaceSelection(`${o}
`)}copySelection(o=!1){oi.info(o),this.inputElement?.focus(),o?this.iframeElement?.contentDocument?.execCommand("copy"):this.inputElement?.dispatchEvent(new ClipboardEvent("copy",{bubbles:!0,cancelable:!0}));let n=this.inputElement?.innerText||"";return n.endsWith(`
`)?n.slice(0,-1):n}selectContent(o){if(!this.editorElement||!this.inputElement)return;let n=o<0?"ArrowLeft":"ArrowRight",r=o<0?37:39;this.inputElement.focus();for(let i=0;i<Math.abs(o);i++)this.inputElement.dispatchEvent(new KeyboardEvent("keydown",{charCode:0,code:n,key:n,keyCode:r,bubbles:!0,repeat:!1,shiftKey:!0}))}getCaretBeforeContent(o){if(!this.editorElement||!this.inputElement)return"";let n=o.rect.left+o.rect.width/2,r=o.rect.top+o.rect.height/2,i="";return this.getParagraphElements().sort((a,s)=>a.getBoundingClientRect().bottom-s.getBoundingClientRect().bottom).some(a=>{let s="",l=null;return this.getTextElements(a).some(p=>{let u=this.parseTextElement(p);if(u.rect.bottom<r||u.rect.top<r&&u.rect.right<n)l&&u.rect.top>=l.rect.bottom?s+=`
${u.content}`:s+=u.content,l=u;else if(_c(n,r,[u.rect])){let c=this.getCaretOffset(u,o.rect);if(c>0){let m=u.content.slice(0,c);s+=m}return!0}}),s&&(i?i+=`

${s}`:i=s),a.getBoundingClientRect().bottom>r}),i}getCaretAfterContent(o){if(!this.editorElement||!this.inputElement)return"";let n=o.rect.left+o.rect.width/2,r=o.rect.top+o.rect.height/2,i="";return this.getParagraphElements().sort((a,s)=>a.getBoundingClientRect().bottom-s.getBoundingClientRect().bottom).filter(a=>a.getBoundingClientRect().bottom>r).forEach(a=>{let s="",l=null;this.getTextElements(a).forEach(p=>{let u=this.parseTextElement(p);if(u.rect.top>r||u.rect.bottom>r&&u.rect.left>n)l&&u.rect.top>=l.rect.bottom?s+=`
${u.content}`:s+=u.content,l=u;else if(_c(n,r,[u.rect])){let c=this.getCaretOffset(u,o.rect);if(c>0){let m=u.content.slice(c);s+=m}return!0}}),s&&(i?i+=`

${s}`:i=s)}),i}async selectSelection(o){if(!this.editorElement||!this.scrollElement)return;let{layouts:n}=o,r=n[0],i=n[n.length-1],a=this.scrollElement.getBoundingClientRect(),s={bubbles:!0,clientX:a.left+r.left,clientY:a.top+r.top+r.height/2},l={bubbles:!0,clientX:a.left+i.right,clientY:a.top+i.top+i.height/2},p=Math.max(r.bottom,i.bottom),u=Math.max(r.top,i.top);if(this.editorElement.scrollTop+this.editorElement.offsetHeight<p)return this.editorElement.scrollTo({top:u,behavior:"auto"}),await new Promise(m=>setTimeout(m,50)),this.selectSelection(o);[new MouseEvent("click",s),new MouseEvent("mousedown",s),new MouseEvent("mousemove",l),new MouseEvent("mouseup",l)].forEach(m=>this.editorElement?.dispatchEvent(m)),await new Promise(m=>setTimeout(m,50)),this.inputElement?.dispatchEvent(new KeyboardEvent("keyup",{shiftKey:!0,key:"Shift",code:"ShiftLeft"}))}getCurrentSelection(){if(!this.editorElement)return null;let o=[],n=[],r=this.getSelectionElements();if(r.forEach(s=>{let l=s.getBoundingClientRect().toJSON();o.push(this.calculateRelativeLayout(l)),n.push(l)}),!r.length)return null;let i=this.getParagraphElements().filter(s=>n.some(l=>e6(l,s.getBoundingClientRect()))).map(s=>this.parseParagraphElement(s)),a=this.copySelection();return oi.info({paragraphs:i,rects:n,layouts:o,content:a}),{elements:r,rects:n,paragraphs:i,layouts:o,content:a}}getCurrentCaret(){if(!this.editorElement||!this.caretElement)return null;let o=this.caretElement,n=this.caretElement.getBoundingClientRect(),r=this.calculateRelativeLayout(n);return oi.info({element:o,rect:n,layout:r}),{element:o,rect:n,layout:r}}getCaretOffset(o,n){let{left:r,top:i,width:a,height:s}=n,l=r+a/2,p=i+s/2;if(l<o.rect.left||p<o.rect.top)return 0;if(l>o.rect.right||p>o.rect.bottom)return o.content.length;let{element:u,content:c}=o,m=document.createTextNode(c),d=this.createTextOverlay(u,m);if(!d)return 0;let{width:f,left:h}=d.getBoundingClientRect(),_=document.createRange(),g=m.nodeValue?.length||0,y=f/g,C={},b=Math.floor((l-h)/y);for(;b<=g;){_.setStart(m,0),_.setEnd(m,b);let v=_.getClientRects()[0].toJSON(),S=C[b-1],P=S?S.right+(v.right-S.right)/2:v.left+v.width;if(l<P)if(S){b=Math.max(b-1,0);break}else{b--;continue}C[b]=v,b++}return d.remove(),b}parseTextElement(o){let n=o.getAttribute("aria-label")||"",r=o.getAttribute("data-font-css")||"",[i,a,s]=r.split(" "),l=o.getBoundingClientRect().toJSON(),p=this.calculateRelativeLayout(l);return{element:o,content:n,rect:l,layout:p,style:{top:p.top,left:p.left,width:p.width,height:p.height,fontWeight:i,fontSize:a,fontFamily:s?.replaceAll('"',"")}}}parseParagraphElement(o){let n=o.getBoundingClientRect().toJSON(),r=this.calculateRelativeLayout(n),i=this.getTextElements(o).map(a=>this.parseTextElement(a));return{element:o,rect:n,layout:r,texts:i,style:{top:r.top,left:r.left,width:r.width,height:r.height}}}getSelectionElements(){return this.editorElement?Array.from(this.editorElement.querySelectorAll(".kix-canvas-tile-selection rect")).filter(o=>o.parentElement?.tagName!=="clipPath"&&["rgba(118,167,250,0.5)","rgba(0,0,0,0.15)"].includes(o.getAttribute("fill")||"")):[]}getParagraphElements(){return this.editorElement?Array.from(this.editorElement.querySelectorAll('canvas ~ .kix-canvas-tile-content:not(.kix-canvas-tile-selection) g[role="paragraph"]')):[]}getTextElements(o){return o?Array.from(o.querySelectorAll("rect")).filter(n=>n.parentElement?.tagName!=="clipPath"):this.editorElement?Array.from(this.editorElement.querySelectorAll('canvas ~ .kix-canvas-tile-content:not(.kix-canvas-tile-selection) g[role="paragraph"] rect')).filter(n=>n.parentElement?.tagName!=="clipPath"):[]}getTextElementFromPoint(o,n){let r=this.getParagraphElements().find(i=>_c(o,n,[i.getBoundingClientRect()]));return r?this.getTextElements(r).find(i=>_c(o,n,[i.getBoundingClientRect()])):null}getElementFromPoint(o,n){this.styleElement||(this.styleElement=document.createElement("style"),this.styleElement.id="enable-pointer-events-on-rect",this.styleElement.textContent=[".kix-canvas-tile-content{pointer-events:none!important;}","#kix-current-user-cursor-caret{pointer-events:none!important;}",".kix-canvas-tile-content svg>g>rect{pointer-events:all!important; stroke-width:7px !important;}"].join(`
`),(document.head||document.documentElement).appendChild(this.styleElement)),this.styleElement.disabled=!1;let r=document.elementFromPoint(o,n);return this.styleElement.disabled=!0,r}createTextOverlay(o,n){if(!o||o.tagName!=="rect")return null;let r=document.createElementNS("http://www.w3.org/2000/svg","text"),i=o.getAttribute("transform")||"",a=o.getAttribute("data-font-css")||"";r.setAttribute("x",o.getAttribute("x")||""),r.setAttribute("y",o.getAttribute("y")||""),r.appendChild(n),r.style.setProperty("all","initial","important"),r.style.setProperty("transform",i,"important"),r.style.setProperty("font",a,"important"),r.style.setProperty("text-anchor","start","important"),o.parentNode?.appendChild(r);let s=o.getBoundingClientRect(),l=r.getBoundingClientRect(),p=(s.top-l.top+(s.bottom-l.bottom))*.5;return r.style.setProperty("transform",`translate(0px,${p}px) ${i}`,"important"),r}};var $1=Bo(),iV=()=>{let{control:e,focus:t,caret:o,selection:n}=CM(),r=vt(Jl),i=po(ui),[a,s]=Br(m6),l=po(ed),p=(0,bn.useRef)({}),u=(0,bn.useRef)(null),c=(0,bn.useRef)(a);c.current=a;let m=(0,bn.useRef)(n);m.current=n;let d=(0,bn.useCallback)(()=>Dh(Object.values(p.current).filter(Boolean).map(y=>y.getBoundingClientRect().toJSON())),[]),f=(0,bn.useCallback)(()=>u.current?.getBoundingClientRect().toJSON(),[]),h=(0,bn.useCallback)((y,C,b=C,v="")=>{window.postMessage({id:ph,type:"iframeSelection",data:{virtual:!0,iframeId:$1,tagName:"",id:$1,className:"",windowRect:document.body.getBoundingClientRect().toJSON(),targetRect:y,selectionRect:y,iframeSelectionRect:y,iframePosition:[0,0],selectionText:C,selectionHTML:C,editableElementSelectionText:b,editableElementSelectionHTML:b,eventType:"keyup",isEmbedPage:!1,isEditableElement:!!e?.editable,caretOffset:1,startMarkerId:"",endMarkerId:"",relatedContent:v}},"*")},[]);(0,bn.useEffect)(()=>{if(!r){let y=[];return l(C=>(C.range&&y.push(setTimeout(()=>{let b=new KeyboardEvent("keyup",{key:" ",code:"Space",bubbles:!0,cancelable:!0});b.MAX_AI_IGNORE=!0,document.body.dispatchEvent(b)},1)),C)),e?.inputElement?.focus(),()=>{y.forEach(C=>clearTimeout(C))}}},[r]),(0,bn.useEffect)(()=>{if(!e)return;let y=Rn(()=>{if((c.current.currentSelection?.selectionElement||c.current.tempSelection?.selectionElement)?.id!==$1)return;let b=m.current?.content?d():f();i(v=>({...v,rootRect:b})),s(v=>({...v,tempSelection:v.tempSelection?{...v.tempSelection,selectionRect:b}:v.tempSelection}))},200);return e.addListener("scroll",y),()=>{e.removeListener("scroll",y),y.cancel()}},[e]),(0,bn.useEffect)(()=>{if(!(!t||!e)){if(n&&n.content){let y="",C=n.rects[0],b=n.rects[n.rects.length-1],v=2e3;if(C&&b&&n.content.length<=v*.75){let S={element:null,rect:{...C,width:1,right:C.left+1},layout:{...C,width:1,right:C.left+1}},P={element:null,rect:{...b,width:1,left:b.right-1},layout:{...b,width:1,left:b.right-1}},k=e.getCaretBeforeContent(S),L=e.getCaretAfterContent(P),H=Math.ceil((v-n.content.length)/2),W=k.slice(-H),O=v-H,D=L.slice(0,O);y=`${W}${n.content}${D}`.trim()}h(Dh(n.rects),n.content,n.content,y);return}if(o&&t&&e?.editable){h(o.rect,e?.getCaretBeforeContent(o)||"","");return}c.current.show&&(e?.editable||h(d(),"",""),s({show:!1,tempSelection:null,currentSelection:null,lastCursorPosition:null}))}},[n,o,t,e]),Zl(async(y,C,b)=>{if(y!=="Client_listenUpdateIframeInput"||C.id!==$1)return;let{type:v,value:S}=C;switch(v){case"INSERT_BELOW":e?.insertBelowSelection(S);break;case"INSERT":e?.replaceSelection(S);break;case"INSERT_ABOVE":e?.insertAboveSelection(S);break;case"REPLACE_SELECTION":e?.replaceSelection(S);break}});let _=oa?0:1,g=oa?-1:9999;return bn.default.createElement("div",{style:{opacity:_}},n?.layouts.map((y,C)=>bn.default.createElement("div",{ref:b=>{p.current[C]=b},key:C,style:{position:"absolute",border:oa?void 0:"1px solid red",opacity:_,zIndex:g,...y}})),o&&bn.default.createElement("div",{ref:u,style:{position:"absolute",border:oa?void 0:"1px solid blue",opacity:_,zIndex:g,...o.layout}}))},yM=iV;var aV=()=>{let e=(0,Ji.useMemo)(()=>new q1,[]),[t,o]=(0,Ji.useState)(e.lastCaret),[n,r]=(0,Ji.useState)(e.lastSelection),[i,a]=(0,Ji.useState)(!1);return cn(()=>{if(e.init(),e.disabled)return;let s=c=>{r(c)},l=c=>{o(c)},p=()=>{a(!0)},u=()=>{a(!1)};return e.addListener("selection-change",s),e.addListener("caret-change",l),e.addListener("focus",p),e.addListener("blur",u),e.isFocus()&&(e.checkSelectionChange(),e.checkCaretChange(),a(!0)),()=>{e.removeListener("selection-change",s),e.removeListener("caret-change",l),e.removeListener("focus",p),e.removeListener("blur",u),e.destroy()}}),!e||!e.scrollElement||e.disabled?null:Ji.default.createElement(yx.Provider,{value:{control:e,caret:t,selection:n,focus:i}},(0,bM.createPortal)(Ji.default.createElement(yM,null),e.scrollElement))},IM=Ji.default.memo(aV);var ko=I(w());var sV=e=>{let{...t}=e,{onResetConversation:o,onCreateConversation:n,onUpdateConversation:r,onSwitchConversation:i,onStopShortcutsActions:a,onRunShortcutsActions:s,onAskAIQuestion:l}=t,p=re(_=>_.setOnCreateConversation),u=re(_=>_.setOnUpdateConversation),c=re(_=>_.setOnSwitchConversation),m=re(_=>_.setOnResetConversation),d=re(_=>_.setOnAskAIQuestion),f=re(_=>_.setOnRunShortcutsActions),h=re(_=>_.setOnStopShortcutsActions);return(0,ko.useEffect)(()=>{n&&p(n)},[n]),(0,ko.useEffect)(()=>{r&&u(r)},[r]),(0,ko.useEffect)(()=>{i&&c(i)},[i]),(0,ko.useEffect)(()=>{o&&m(o)},[o]),(0,ko.useEffect)(()=>{l&&d(l)},[l]),(0,ko.useEffect)(()=>{s&&f(s)},[s]),(0,ko.useEffect)(()=>{a&&h(a)},[a]),lV(),ko.default.createElement(ko.default.Fragment,null)},SM=new Map,lV=()=>{let e=re(h=>h.conversationIds),{getConversation:t}=qe(),{addMessagesToPagination:o,syncLocalMessages:n,updateMessagesToPagination:r,removeMessagesToPagination:i}=Di(),[a,s]=(0,ko.useState)(e),{paywallShowDebounce:l}=Wa();(0,ko.useEffect)(()=>{s(h=>o_(h.concat(e)))},[e]);let p=(0,ko.useRef)(null),u=oh(({set:h,snapshot:_})=>async(g,y)=>{p.current&&(clearTimeout(p.current),p.current=null);let C=await _.getPromise(Eh(g));h(Eh(g),y===null?null:Jo([C,y]))}),c=oh(({set:h})=>(_,g)=>{h(Um(_),g)});(0,ko.useEffect)(()=>{a.length>0&&a.map(h=>{t(h)})},[a]);let{debounceRefreshModelUsage:m}=Ai();(0,ko.useEffect)(()=>{a.forEach(h=>{if(SM.has(h))return;let _=pi.getShortcutsEngine(h),g=async(y,C)=>{if(y==="shortcutsEngineStatus"&&((C.shortcutsEngine.status==="complete"||C.shortcutsEngine.status==="stop")&&(u(h,null),t(h)),c(h,C.shortcutsEngine.status)),y==="actionCustomEvent"&&C.actionCustomEventName==="updateWritingMessage"){let b=C.actionCustomEventData;b?u(h,{...b,conversationId:h}):p.current=setTimeout(()=>{u(h,null)},1e3)}if(y==="shortcutsExternalEngine"){if(C.shortcutsExternalEngineType==="shortcutsExternalEngineChatConversationService"){let{functionName:b,params:v}=C.shortcutsExternalEngineData;b==="addOrUpdateConversation"&&t(v[0])}if(C.shortcutsExternalEngineType==="shortcutsExternalEngineChatMessageService"){let{functionName:b,params:v}=C.shortcutsExternalEngineData;if(b==="addMessages"){let S=v[1].map(H=>H.messageId),P=await Ur.getService().getMessagesByMessageIds(h,S),k=P.find(H=>ki(H)&&H.meta.paywallData||xr(H)&&H.originalMessage?.metadata?.embeddedPaywall);if(k&&ki(k)){let H=k.meta.paywallData;l({conversationId:h,paywallType:"response",paywallData:H}),Us.flush(),u(h,null)}k&&xr(k)&&(l({conversationId:h,paywallType:"response",paywallReason:"ProChat"}),Us.flush());let L=P.find(H=>ki(H)&&H.meta?.status==="error");if(L){let H=await Ur.getService().getMessageByType(h,"user","latest");OC("ask_ai",{conversationId:h,latestUserMessage:H,errorMessage:L.text,AIModel:L.meta?.AIModel,chatMode:L.meta?.chatMode})}o(h,P),await n(h),t(h)}else if(b==="updateMessages"){let S=v[1].map(k=>k.messageId),P=await Ur.getService().getMessagesByMessageIds(h,S);r(h,P),await n(h),t(h)}else if(b==="deleteMessages"){let S=v[1];i(h,S),await n(h),t(h)}}}(y==="afterRunAction"&&(C.currentAction?.type==="ASK_CHATGPT"||C.currentAction?.type==="MAXAI_RESPONSE_RELATED")&&C.currentAction?.status==="complete"||C.shortcutsEngine?.status==="stop")&&m()};SM.set(h,g),_.addListener(g)})},[a]);let{refreshChatAIModelSelector:d,refreshChatHubAIModelSelector:f}=$l();(0,ko.useEffect)(()=>{d(),f()},[d,f])},vM=(0,ko.memo)(sV);var In=I(w());var pV=()=>(Sm(),km("floatingMenu"),In.default.createElement(In.default.Fragment,null,In.default.createElement(cV,null))),cV=()=>{let{conversationType:e,setConversationIds:t,setConversationType:o}=re(y=>({conversationType:y.conversationType,setConversationIds:y.setConversationIds,setConversationType:y.setConversationType})),{appSettings:n}=sr(),{betaSettings:r}=En(),{getLocalSettings:i,setLocalSettings:a}=yt(),{refreshModelUsageOnce:s}=mm(),[l,p]=Br(d6),{createConversation:u,updateConversation:c,getConversation:m}=qe(),[d]=Br(ui),f=Wl(l),h=(0,In.useRef)(f);h.current=f,(0,In.useEffect)(()=>{n.userSettings&&(r?.appearance_v2_enabled?o("Chat"):o("ContextMenu"))},[n.userSettings,r?.appearance_v2_enabled]),(0,In.useEffect)(()=>{l&&t([l])},[l]),(0,In.useEffect)(()=>{d.open?(e==="Chat"&&Wm("Chat").then(y=>{let C=y[0];h.current&&C&&h.current.meta.AIModel!==C.value&&c(h.current.id,{meta:{AIProvider:C.AIProvider,AIModel:C.value,maxTokens:C.maxTokens}},{syncToRemote:!1})}),s()):u(e,{reason:"initCreate",conversation:{meta:{isContextMenu:!0}}}).then(y=>{p(y[0]?.id||"")}).catch()},[e,d.open]),Ol(async()=>{if(l){let{sidebarSettings:y}=await i(),C=y?.contextMenu?.currentAIModel,b=await m(l);if(C&&b?.type==="ContextMenu"&&b?.meta.AIModel!==C){let v=en(void 0,C);v&&await c(l,{meta:{AIProvider:v.AIProvider,AIModel:v.value,maxTokens:v.maxTokens}},{syncToRemote:!1})}}});let _=(0,In.useCallback)(async y=>{let{sidebarSettings:C}=await i();if(y.type==="ContextMenu"){let b=C?.contextMenu?.currentAIModel;if(b){let v=en(void 0,b);if(v)return{...y,meta:{...y.meta,AIProvider:v.AIProvider,AIModel:v.value,maxTokens:v.maxTokens}}}}return y},[i]),g=(0,In.useCallback)(y=>{a({sidebarSettings:{contextMenu:{currentAIModel:y.meta.AIModel}}})},[a]);return In.default.createElement(In.default.Fragment,null,In.default.createElement(vM,{onCreateConversation:_,onUpdateConversation:g}),d.open&&In.default.createElement(Mb,null))},TM=pV;var uV=()=>(v6(),Nn.default.createElement(pC,{containerId:Ax,wrapperId:Px},({rootContainer:e})=>Nn.default.createElement(G2,{shadowRootElement:e},Nn.default.createElement(U_,{conversationType:"ContextMenu"},Nn.default.createElement(TM,null),Nn.default.createElement(yT,{variant:"custom"},Nn.default.createElement(Vy,null,Nn.default.createElement(as,{defaultContextMenuPath:"/rewrite"},Nn.default.createElement(iM,{root:e}),Nn.default.createElement(_M,null)),Nn.default.createElement(pM,null),Nn.default.createElement(uM,null),Nn.default.createElement(IM,null),Nn.default.createElement(bT,null))))))),MM=(0,Nn.memo)(uV);var Y1=I(w());var PM=I(w());var mV={inviteLink:e=>(document.querySelector("#appMaxAIReferralShareOneClickText")?.innerText||"").trim()||`Sign up on MaxAI using my link and both of us will get a free week of MaxAI Pro rewards. It lets you use AI on any webpage with one click, powered by ChatGPT, Claude, Bard, and Bing AI. Here is my link: https://app.maxai.me?invite=${e}`},_l=mV;var bx=I(wM()),EM=I(Ex());var qp=async(e,t,o="",n)=>{let r=await cm.getUserInfo(),i=r?.user_id||"",a=r?.email||"",{getBrowser:s,getOS:l}=new bx.UAParser,p=s(),u=l(),c={env:oa?"prod":"dev",type:e,app:"MAXAI",data:{title:t,message:o,...n},user_id:i,email:a,app_version:j2,browser:p.name,browser_version:p.version,platform:u.name,platform_version:u.version,languages:navigator.languages},m=f2(c,"MaxAI");return M6("https://api.extensions-hub.com/extensionhub/send_notification",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({msg:m})}).then().catch()},AM=async()=>{let{getBrowser:e,getOS:t}=new bx.UAParser;await EM.default.storage.local.set({MAXAI_BROWSER_INFO:JSON.stringify({browser:e(),os:t()})})};var dV=()=>{let{userInfo:e}=Tt(),{conversationId:t}=Mt(),{createConversation:o}=qe(),{askAIWithShortcuts:n}=Ne(),r=xe(t);return{autoFacebookReferral:(0,PM.useCallback)(async()=>{if(!r){let a=_l.inviteLink(e?.referral_code||""),s=(c,m)=>{let d=m.currentAction;if(c==="afterRunAction"&&d?.type==="SET_VARIABLE"&&d.parameters?.VariableKey==="AutoTwitterReferralResult"){let f=d.parameters.WFFormValues?.Value===!0;qp("REFERRAL",`[Referral] One-click button [Facebook] ${f?"Success":"Fail"}`,JSON.stringify({email:e?.email||"unknown",success:f},null,4),{uuid:"608156c7-e65d-4a69-a055-6c10a6ba7217"}).then().catch(),f&&ip("/user/complete_referral",{referral_types:["FACEBOOK_SHARE"]}).then()}},p=(await o("Chat",{reason:"manualClick",syncToRemote:!1}))[0].id,u=pi.getShortcutsEngine(p);return u?.addListener(s),await n([{type:"OPEN_URLS",parameters:{URLActionURL:"https://www.facebook.com/sharer/sharer.php?u=https://app.maxai.me"}},{type:"SET_VARIABLE",parameters:{VariableKey:"OperationElementTabID"}},{type:"OPERATION_ELEMENT",parameters:{OperationElementConfig:{elementSelectors:["textarea[title]"],actionType:"insertText",actionExtraData:{clearBeforeInsertText:!0,text:_l.inviteLink(e?.referral_code||"")},beforeDelay:2e3}}},{type:"OPERATION_ELEMENT",parameters:{OperationElementConfig:{elementSelectors:['button[name="__CONFIRM__"]'],actionType:"click",afterDelay:3e3}}},{type:"CLOSE_URLS",parameters:{}},{type:"OPEN_URLS",parameters:{URLActionURL:"https://www.facebook.com/profile.php"}},{type:"SET_VARIABLE",parameters:{VariableKey:"OperationElementTabID"}},{type:"OPERATION_ELEMENT",parameters:{OperationElementConfig:{elementSelectors:['div[data-ad-preview="message"]','div[data-ad-comet-preview="message"]'],executeElementCount:10,actionType:"getText",beforeDelay:2e3}}},{type:"SCRIPTS_CONDITIONAL",parameters:{WFCondition:"Contains",WFMatchTextCaseSensitive:!1,WFFormValues:{Value:a.slice(0,10),WFSerializationType:"WFDictionaryFieldValue"},WFConditionalIfTrueActions:[{type:"SET_VARIABLE",parameters:{VariableKey:"AutoTwitterReferralResult",WFFormValues:{Value:!0,WFSerializationType:"WFDictionaryFieldValue"}}}],WFConditionalIfFalseActions:[{type:"SET_VARIABLE",parameters:{VariableKey:"AutoTwitterReferralResult",WFFormValues:{Value:!1,WFSerializationType:"WFDictionaryFieldValue"}}}]}},{type:"CLOSE_URLS",parameters:{}},{type:"OPEN_URLS",parameters:{URLActionURL:"current_page"}}],{conversationId:p}),u?.removeListener(s),!0}return!1},[r,n,e?.referral_code,e?.email]),autoFacebookReferralLoading:r}},kM=dV;var LM=I(w());var fV=()=>{let{userInfo:e}=Tt(),{conversationId:t}=Mt(),{createConversation:o}=qe(),{askAIWithShortcuts:n}=Ne(),r=xe(t);return{autoLinkedinReferral:(0,LM.useCallback)(async()=>{if(!r){let a=_l.inviteLink(e?.referral_code||""),s="",l=(m,d)=>{let f=d.currentAction;if(m==="afterRunAction"&&f?.type==="SET_VARIABLE"){if(f.parameters?.VariableKey==="SHARE_POST_LINK")s=f.output;else if(f.parameters?.VariableKey==="AutoTwitterReferralResult"){let h=f.parameters.WFFormValues?.Value===!0;qp("REFERRAL",`[Referral] One-click button [Linkedin] ${h?"Success":"Fail"}`,JSON.stringify({email:e?.email||"unknown",success:h,shareLink:`[ ${s} ]`},null,4),{uuid:"608156c7-e65d-4a69-a055-6c10a6ba7217"}).then().catch(),h&&ip("/user/complete_referral",{referral_types:["LINKEDIN_SHARE"]})}}},u=(await o("Chat",{reason:"manualClick",syncToRemote:!1}))[0].id,c=pi.getShortcutsEngine(u);return c?.addListener(l),await n([{type:"OPEN_URLS",parameters:{URLActionURL:"https://www.linkedin.com/shareArticle/?url=https%3A%2F%2Fapp.maxai.me%3Finvite%3DIPn7Xnby"}},{type:"SET_VARIABLE",parameters:{VariableKey:"OperationElementTabID"}},{type:"OPERATION_ELEMENT",parameters:{OperationElementConfig:{elementSelectors:["button.artdeco-button"],actionType:"click",beforeDelay:2e3,afterDelay:2e3}}},{type:"OPERATION_ELEMENT",parameters:{OperationElementConfig:{elementSelectors:['div[contenteditable="true"]'],actionType:"insertText",actionExtraData:{clearBeforeInsertText:!0,text:a},afterDelay:1e3}}},{type:"OPERATION_ELEMENT",parameters:{OperationElementConfig:{elementSelectors:["button.share-actions__primary-action"],actionType:"click",afterDelay:3e3}}},{type:"OPERATION_ELEMENT",parameters:{OperationElementConfig:{elementSelectors:["a.inshare-success-state__view-btn"],actionType:"getLink"}}},{type:"SET_VARIABLE",parameters:{VariableKey:"SHARE_POST_LINK"}},{type:"OPERATION_ELEMENT",parameters:{OperationElementConfig:{elementSelectors:["a.inshare-success-state__continue-btn"],actionType:"getText"}}},{type:"SCRIPTS_CONDITIONAL",parameters:{WFCondition:"Contains",WFMatchTextCaseSensitive:!1,WFFormValues:{Value:"linkedin",WFSerializationType:"WFDictionaryFieldValue"},WFConditionalIfTrueActions:[{type:"SET_VARIABLE",parameters:{VariableKey:"AutoTwitterReferralResult",WFFormValues:{Value:!0,WFSerializationType:"WFDictionaryFieldValue"}}}],WFConditionalIfFalseActions:[{type:"SET_VARIABLE",parameters:{VariableKey:"AutoTwitterReferralResult",WFFormValues:{Value:!1,WFSerializationType:"WFDictionaryFieldValue"}}}]}},{type:"CLOSE_URLS",parameters:{}},{type:"OPEN_URLS",parameters:{URLActionURL:"current_page"}}],{conversationId:u}),c?.removeListener(l),!0}return!1},[n,r,e?.referral_code,e?.email]),autoLinkedinReferralLoading:r}},OM=fV;var BM=I(w());var hV=()=>{let{userInfo:e}=Tt(),{conversationId:t}=Mt(),{createConversation:o}=qe(),{askAIWithShortcuts:n}=Ne(),r=xe(t);return{autoTwitterReferral:(0,BM.useCallback)(async()=>{if(!r){let a=_l.inviteLink(e?.referral_code||""),s="",l=(m,d)=>{let f=d?.currentAction;if(m==="afterRunAction"&&f?.type==="SET_VARIABLE"){if(f.parameters?.VariableKey==="SHARE_POST_LINK")s=f.output;else if(f.parameters?.VariableKey==="AutoTwitterReferralResult"){let h=f.parameters.WFFormValues?.Value===!0;qp("REFERRAL",`[Referral] One-click button [Linkedin] ${h?"Success":"Fail"}`,JSON.stringify({email:e?.email||"unknown",success:h,shareLink:`[ ${s} ]`},null,4),{uuid:"608156c7-e65d-4a69-a055-6c10a6ba7217"}).then().catch(),h&&ip("/user/complete_referral",{referral_types:["TWITTER_SHARE"]})}}},u=(await o("Chat",{reason:"manualClick",syncToRemote:!1}))[0].id,c=pi.getShortcutsEngine(u);return c?.addListener(l),await n([{type:"OPEN_URLS",parameters:{URLActionURL:`https://twitter.com/intent/tweet?text=${a}`}},{type:"SET_VARIABLE",parameters:{VariableKey:"OperationElementTabID"}},{type:"OPERATION_ELEMENT",parameters:{OperationElementConfig:{elementSelectors:['button[data-testid="tweetButton"]'],actionType:"click",beforeDelay:2e3,afterDelay:2e3}}},{type:"OPERATION_ELEMENT",parameters:{OperationElementConfig:{elementSelectors:['a[data-testid="AppTabBar_Profile_Link"]'],actionType:"click",afterDelay:2e3}}},{type:"OPERATION_ELEMENT",parameters:{OperationElementConfig:{elementSelectors:['article[data-testid="tweet"] div[data-testid="User-Name"] a[role="link"]'],actionType:"getLink"}}},{type:"SET_VARIABLE",parameters:{VariableKey:"SHARE_POST_LINK"}},{type:"OPERATION_ELEMENT",parameters:{OperationElementConfig:{elementSelectors:['div[data-testid="tweetText"]'],actionType:"getText",executeElementCount:10}}},{type:"SCRIPTS_CONDITIONAL",parameters:{WFCondition:"Contains",WFMatchTextCaseSensitive:!1,WFFormValues:{Value:a.slice(0,10),WFSerializationType:"WFDictionaryFieldValue"},WFConditionalIfTrueActions:[{type:"SET_VARIABLE",parameters:{VariableKey:"AutoTwitterReferralResult",WFFormValues:{Value:!0,WFSerializationType:"WFDictionaryFieldValue"}}},{type:"CLOSE_URLS",parameters:{}},{type:"OPEN_URLS",parameters:{URLActionURL:"https://twitter.com/MaxAI_HQ"}},{type:"SET_VARIABLE",parameters:{VariableKey:"OperationElementTabID"}},{type:"OPERATION_ELEMENT",parameters:{OperationElementConfig:{elementSelectors:['[data-testid="1667007582270296064-follow"]'],actionType:"click",beforeDelay:2e3,afterDelay:3e3}}}],WFConditionalIfFalseActions:[{type:"SET_VARIABLE",parameters:{VariableKey:"AutoTwitterReferralResult",WFFormValues:{Value:!1,WFSerializationType:"WFDictionaryFieldValue"}}}]}},{type:"CLOSE_URLS",parameters:{}},{type:"OPEN_URLS",parameters:{URLActionURL:"current_page"}}],{conversationId:u,isSaveLastRunShortcuts:!1}),c?.removeListener(l),!0}return!1},[r,n,e?.referral_code,e?.email]),autoTwitterReferralLoading:r}},DM=hV;var gV=()=>{let{autoTwitterReferral:e}=DM(),{autoFacebookReferral:t}=kM(),{autoLinkedinReferral:o}=OM(),n=(0,Y1.useRef)({});(0,Y1.useEffect)(()=>{n.current={twitter:e,linkedin:o,facebook:t}},[e,o,t]),cn(()=>{nr&&location.href.includes(nr)&&setInterval(()=>{let i=document.querySelector("#appMaxAIReferralShareOneClickContainer"),a=document.querySelector("#appMaxAIReferralShareOneClickButton");if(i&&a){if(!i.classList.contains("loaded"))i.classList.add("loaded");else return;a.addEventListener("click",async()=>{let s=Array.from(document.querySelectorAll('.app-maxai-me__one-click-share-status-card[data-checked="true"]'));for(let u=0;u<s.length;u++){let m=s[u].getAttribute("data-name"),d=n.current?.[m];d&&await d()}await Rs(3e3);let l=new URL(window.location.href),p=new URLSearchParams(l.search);p.set("show_completed","true"),l.search=p.toString(),window.location.href=l.toString()})}},1e3)})},FM=gV;var Ix=I(Ex());var HM=async(e,t)=>{let{rootElementSelector:o,isShadowElement:n=!1,elementSelectors:r,beforeDelay:i=0,afterDelay:a=0,executeElementCount:s=1,durationTimes:l=30*1e3,rotationTimes:p=3e3,rotationInterval:u=1e3,actionType:c="click",actionExtraData:m}=t||{},d={success:!1,elementsInnerText:"",link:""},f=document,h=o?f.querySelector(o):f;if(n&&(h=h.shadowRoot),!r||r?.length===0||!h){Ix.default.runtime.sendMessage({event:"ShortCuts_OperationPageElementResponse",data:{taskId:e,success:d.success,data:d}});return}if(h){let _=async()=>{await Rs(i);let g=[],y=0;for(;g.length===0&&y<p;)g=C_(...r.map(C=>Array.from(h.querySelectorAll(C)))),g.length===0&&(y+=u,await Rs(u));return g.length===0||(g=g.slice(0,s),g.forEach(C=>{switch(c){case"click":C.click();break;case"insertText":{let b=m?.text||m?.value.toString()||"";if(C.focus(),C.getAttribute("contenteditable")==="true"){let v=window.getSelection(),S=document.createRange();S.selectNodeContents(C),v?.removeAllRanges(),v?.addRange(S)}m?.clearBeforeInsertText&&(C.tagName==="INPUT"||C.tagName==="TEXTAREA")&&(C.select(),f.execCommand("Delete",!1,"")),f.execCommand("insertText",!1,b)}break;case"getText":{let b=C?.innerText||"";d.elementsInnerText+=b}break;case"getLink":C.tagName==="A"?(d.link&&(d.link+=","),d.link+=C.href):C.tagName==="IMG"||C.tagName==="VIDEO"||C.tagName==="IFRAME"||C.tagName==="EMBED"||C.tagName==="SOURCE"||C.tagName==="TRACK"?(d.link&&(d.link+=","),d.link+=C.src):(d.link&&(d.link+=","),d.link+=C?.innerText||"");break;default:break}}),d.success=!0,await Rs(a)),d};await Promise.race([_(),Rs(l)]),Ix.default.runtime.sendMessage({event:"ShortCuts_OperationPageElementResponse",data:{taskId:e,data:{success:d.success,message:d.success?"ok":"error",data:d}}})}};var NM=()=>{Zm(async(e,t,o)=>{switch(e){case"ShortCuts_ClientExecuteOperationPageElement":{let{taskId:n,OperationElementConfig:r}=t;return n?(await HM(n,r),{success:!0,data:!0,message:"ok"}):{success:!1,message:"No taskId",data:null}}break;default:break}})};var or=I(w());var xV=new ym({runtime:"client"}),_V=()=>{let{pageUrl:e,startListen:t}=vf(),o=(0,or.useRef)(""),n=(0,or.useRef)({}),r=(0,or.useRef)({}),i=(0,or.useRef)(!1),a=(0,or.useCallback)(m=>{o.current!==m&&(n.current={},r.current={},o.current=m)},[]),s=(0,or.useCallback)(m=>{n.current["6ccd02db210a323454547913a88d465d0a08630e"]?n.current["6ccd02db210a323454547913a88d465d0a08630e"].indexOf(m)===-1&&n.current["6ccd02db210a323454547913a88d465d0a08630e"].push(m):n.current["6ccd02db210a323454547913a88d465d0a08630e"]=[m]},[]),l=(0,or.useCallback)(m=>{n.current.f31d0f92fbcd0d80473bfebb56bc33071b09dcb7?n.current.f31d0f92fbcd0d80473bfebb56bc33071b09dcb7.indexOf(m)===-1&&n.current.f31d0f92fbcd0d80473bfebb56bc33071b09dcb7.push(m):n.current.f31d0f92fbcd0d80473bfebb56bc33071b09dcb7=[m]},[]),p=(0,or.useCallback)(m=>{n.current.b7c238015309231550a4aee6b6e2bb382eb6fd17?n.current.b7c238015309231550a4aee6b6e2bb382eb6fd17.indexOf(m)===-1&&n.current.b7c238015309231550a4aee6b6e2bb382eb6fd17.push(m):n.current.b7c238015309231550a4aee6b6e2bb382eb6fd17=[m]},[]),u=(0,or.useCallback)(m=>{n.current.ed31666fb5d75e1637ea42ab1988a4f7daa374ac?n.current.ed31666fb5d75e1637ea42ab1988a4f7daa374ac.indexOf(m)===-1&&n.current.ed31666fb5d75e1637ea42ab1988a4f7daa374ac.push(m):n.current.ed31666fb5d75e1637ea42ab1988a4f7daa374ac=[m]},[]),c=(0,or.useCallback)(()=>{let m={},d=[],f=0;if(Object.keys(n.current).forEach(h=>{let _=n.current[h]||[];r.current[h]||(r.current[h]=[]);let g=r.current[h],y=_.filter(C=>!g.includes(C)).slice(0,20);f+=y.length,y.length>0&&(m[h]=y),d.push(()=>{r.current[h].push(...y)})}),f>=1){i.current=!0;let h=0;d.forEach(_=>_()),setTimeout(()=>{gr.setItem(it("4d415841495f4150495f4b45595f37346262313966652d663631392d343165352d616532332d313765386664373539643564"),em(JSON.stringify({...m,"93011c6a4cf334810533dc067238764a0b4b39ff":o.current}))).then(()=>{xV.postMessage({event:"Client_sendContextUpdate",data:{}})})},h)}},[]);(0,or.useEffect)(()=>{t()},[]),(0,or.useEffect)(()=>{if(e){i.current=!1;let m=setTimeout(()=>{let d=Qp();if(i.current)return;let f=em(d);if(!["696e7374616772616d2e636f6d","747769747465722e636f6d","782e636f6d","74696b746f6b2e636f6d","796f75747562652e636f6d","6c696e6b6564696e2e636f6d","66616365626f6f6b2e636f6d"].includes(f))return;let h=em(e);if(Qp())switch(f){case"696e7374616772616d2e636f6d":{if(a("9958532dbed0fe0b5997f55cb43ccba1edf19015"),h==="68747470733a2f2f7777772e696e7374616772616d2e636f6d"||h==="68747470733a2f2f7777772e696e7374616772616d2e636f6d2f"){let _=Array.from(document.querySelectorAll('div[data-visualcompletion="ignore-dynamic"] a')).reverse()[0],g=_&&_.getAttribute("href")?.split("/")?.[1]||"";g&&s(g);let y=[...new Set(Array.from(document.querySelectorAll("article a:has(>div>div>span)")).map(C=>C.getAttribute("href")?.split("/")?.[1]||"").filter(Boolean))];y.length>0&&y.forEach(p)}if(/\/p\/\w{11}\//.test(e)){let _=Array.from(document.querySelectorAll("article:has(header) header a")).map(g=>g.getAttribute("href")?.split("/")?.[1]||"").filter(Boolean)[0]||document.querySelector('meta[name="twitter:title"]')?.getAttribute("content")?.split("(@")[1]?.split(")")[0];_&&l(_)}break}case"747769747465722e636f6d":case"782e636f6d":{if(a("b56d7211de49aa1b8a73ee960d7dc8cea32643d8"),h==="68747470733a2f2f782e636f6d2f686f6d65"||h==="68747470733a2f2f782e636f6d2f686f6d652f"){let _=document.querySelector(it("6469765b646174612d7465737469645e3d557365724176617461722d436f6e7461696e65725d"))?.getAttribute("data-testid")?.slice(21)||"";_&&s(_);let g=[...new Set(Array.from(document.querySelectorAll("article:not(:has(a[id]))")).filter(y=>!Array.from(y.querySelectorAll('div[style^="color"] span')).find(b=>b.innerText.trim()==="Ad")).map(y=>y.querySelector('div[data-testid="User-Name"] a')?.getAttribute("href")?.split("/")?.[1]||"").filter(Boolean))];g.length>0&&g.forEach(p)}if(/\/status\/\d+/.test(e)){let _=[...new Set(Array.from(document.querySelectorAll("article:not(:has(a[id]))")).filter(g=>!Array.from(g.querySelectorAll('div[style^="color"] span')).find(C=>C.innerText.trim()==="Ad")).map(g=>g.querySelector('div[data-testid="User-Name"] a')?.getAttribute("href")?.split("/")?.[1]||"").filter(Boolean))][0]||"";_&&l(_)}break}case"74696b746f6b2e636f6d":{if(a("ab11cfb35cdd097e03d1d8f76189e59de871317e"),h==="68747470733a2f2f7777772e74696b746f6b2e636f6d"||h==="68747470733a2f2f7777772e74696b746f6b2e636f6d2f"){let _=document.querySelector(it("615B646174612D6532653D226E61762D70726F66696C65225D"))?.getAttribute("href")?.split("/")?.[1]||"";s(_);let g=[...new Set(Array.from(document.querySelectorAll(it("615B646174612D6532653D22766964656F2D617574686F722D617661746172225D"))).map(y=>y.getAttribute("href")?.split("/")?.[1]||"").filter(Boolean))];g.length>0&&g.forEach(p)}if(/\/video\/\d+/.test(e)){let _=e.split("@")?.[1]?.split("/")?.[0]||"";_&&l(`@${_}`)}break}case"796f75747562652e636f6d":{if(a("67393bf26626a32781ecd6a86af58b8e73e3ffa4"),h==="68747470733a2f2f7777772e796f75747562652e636f6d2f666565642f796f75"||h==="68747470733a2f2f7777772e796f75747562652e636f6d2f666565642f796f752f"){let _=Array.from(document.querySelectorAll(it("79742D636F6E74656E742D6D657461646174612D766965772D6D6F64656C207370616E"))).map(g=>g.innerText.trim()).find(g=>g.startsWith("@"));_&&s(_)}if(e_.retrieveVideoId(e)){let _=document.querySelector(it("7974642D766964656F2D6F776E65722D72656E646572657220612E7974642D766964656F2D6F776E65722D72656E6465726572"))?.getAttribute("href")?.split("/")?.[1]||"";_&&l(_)}if(h==="68747470733a2f2f7777772e796f75747562652e636f6d"||h==="68747470733a2f2f7777772e796f75747562652e636f6d2f"){let _=[...new Set(Array.from(document.querySelectorAll(it("23636F6E74656E7473207974642D726963682D677269642D6D656469613A68617328236176617461722D636F6E7461696E65722920236176617461722D6C696E6B"))).map(g=>g.getAttribute("href")?.split("/")?.[1]||"").filter(Boolean))];_.length>0&&_.forEach(p)}break}case"6c696e6b6564696e2e636f6d":{a("32cbb537fc5dc82cd024931689ba47571f5f9c46");let _=()=>{let g=it("6469762e666565642d7368617265642d7570646174652d76325f5f636f6e74726f6c2d6d656e752d636f6e7461696e6572"),y=it("2e7570646174652d636f6d706f6e656e74732d6163746f725f5f6465736372697074696f6e202e76697375616c6c792d68696464656e2c202e7570646174652d636f6d706f6e656e74732d6163746f725f5f7375622d6465736372697074696f6e202e76697375616c6c792d68696464656e");return Array.from(document.querySelectorAll(g)).filter(b=>!Array.from(b.querySelectorAll(y)).find(S=>S.innerText===it("50726F6D6F746564"))).map(b=>{let v=b?.querySelector("a:has(img)")?.getAttribute("href")||"";if(v){if(v.startsWith(it("68747470733a2f2f7777772e6c696e6b6564696e2e636f6d2f636f6d70616e792f"))){let S=v.replace(it("68747470733a2f2f7777772e6c696e6b6564696e2e636f6d2f636f6d70616e792f"),"")?.split("/")?.[0]?.split("?")?.[0];if(S)return it("2f636f6d70616e792f")+S}if(v.startsWith(it("68747470733a2f2f7777772e6c696e6b6564696e2e636f6d2f696e2f"))){let S=v.replace(it("68747470733a2f2f7777772e6c696e6b6564696e2e636f6d2f696e2f"),"")?.split("/")?.[0]?.split("?")?.[0];if(S)return it("2f696e2f")+S}}return""}).filter(Boolean)};if(h==="68747470733a2f2f7777772e6c696e6b6564696e2e636f6d2f66656564"||h==="68747470733a2f2f7777772e6c696e6b6564696e2e636f6d2f666565642f"){let g=Array.from(document.querySelectorAll("code"))?.map(C=>C?.innerText)?.find(C=>C?.includes(it("7075626C69634964656E746966696572")))?.split(it("7075626C69634964656E746966696572"))?.[1]?.split(':"')?.[1]?.split('"')?.[0];g&&s(g);let y=_();y.length>0&&y.forEach(p)}if(/\/in\/\w+/.test(e)){let g=e.replace(it("68747470733a2f2f7777772e6c696e6b6564696e2e636f6d2f696e2f"),"")?.split("/")?.[0]?.split("?")?.[0];g&&l(g)}if(/\/company\/\w+/.test(e)){let g=e.replace(it("68747470733a2f2f7777772e6c696e6b6564696e2e636f6d2f636f6d70616e792f"),"")?.split("/")?.[0]?.split("?")?.[0];g&&l(`${it("2f636f6d70616e792f")}${g}`)}if(/\/posts\/\w+/.test(e)){let g=_();g.length>0&&l(g[0])}break}case"66616365626f6f6b2e636f6d":{a("9ec34cffb43810b9099303039ceee8e704ac4533");let _=it("2f67726f7570732f");if(h==="68747470733a2f2f7777772e66616365626f6f6b2e636f6d"||h==="68747470733a2f2f7777772e66616365626f6f6b2e636f6d2f"||h==="68747470733a2f2f7777772e66616365626f6f6b2e636f6d2f67726f7570732f66656564"||h==="68747470733a2f2f7777772e66616365626f6f6b2e636f6d2f67726f7570732f666565642f"){let g=Array.from(document.querySelectorAll('div[role="navigation"] div[data-visualcompletion="ignore-dynamic"] a')).map(b=>b.getAttribute("href")?.split("/")?.reverse()?.[0]||"")[0];g&&s(g);let y=it("6469765b726f6c653d2261727469636c65225d3a6e6f74283a68617328615b687265665e3d222f616473225d2929206469765b646174612d61642d72656e646572696e672d726f6c653d2270726f66696c655f6e616d65225d20683420612c206469765b726f6c653d2261727469636c65225d3a6e6f74283a68617328615b687265665e3d222f616473225d2929206469765b646174612d61642d72656e646572696e672d726f6c653d2270726f66696c655f6e616d65225d2068332061"),C=Array.from(document.querySelectorAll(y)).map(b=>{let v=(b.getAttribute("href")||"").replace(it("68747470733a2f2f7777772e66616365626f6f6b2e636f6d"),"");if(!v)return"";if(v.startsWith(_))return _+(v.split(_)?.[1]?.split("/")?.[0]||"");if(v.startsWith("/")){let S=it("70726F66696C652E7068703F69643D");return v.split(S).length===2?S+(v.split(S)?.[1]?.split("?")?.[0]?.split("&")?.[0]||""):v?.split("/")?.[1]?.split("?")?.[0]||""}return""}).filter(Boolean);C.length>0&&C.forEach(b=>b.startsWith(_)?u(b):p(b))}else{let g=it("70726F66696C652E7068703F69643D");if(e.split(g).length===2){let b=e.replace(it("68747470733a2f2f7777772e66616365626f6f6b2e636f6d"),"").split(g)?.[1]?.split("?")?.[0]?.split("&")?.[0];b&&l(`${g}${b}`)}let y=e.replace(it("68747470733a2f2f7777772e66616365626f6f6b2e636f6d2f"),"")?.split("/")?.[0]?.split("?")?.[0];y&&(document.querySelector(`a[href*="/${y}/${it("667269656e64735f6c696b6573")}/"]`)||document.querySelector(`a[href*="/${y}/${it("666f6c6c6f77657273")}/"]`)||document.querySelector(`a[href*="/${y}/${it("666F6C6C6F77696E67")}/"]`))&&l(y);let C=e.replace(it("68747470733a2f2f7777772e66616365626f6f6b2e636f6d"),"")?.split(_)?.[1]?.split("/")?.[0]?.split("?")?.[0];/\d+/.test(C)&&l(`${_}${C}`)}}}c()},5e3);return()=>clearTimeout(m)}},[e])},zM=_V;var Z1=I(w());var VM=vi({key:"HaveFilledOutSurveyAtom",default:{feedback:!1}}),RM=vi({key:"firstFetchSurveyStatusLoadedAtom",default:!1}),fVe=vi({key:"FunnelSurveyPopupOpenStateAtom",default:{}}),hVe=vi({key:"FunnelSurveyPopupOpenTimerAtom",default:{}});var CV=()=>{let e=po(VM),t=po(RM),{isLogin:o}=Mn(),n=(0,Z1.useRef)(!1),r=async(i=!1)=>{let a=await E6(i);a&&Object.keys(a).length>0&&e(s=>({...s,...a}))};return(0,Z1.useEffect)(()=>{n.current||o&&A6().then(i=>{r(!i).then(()=>{t(!0),n.current=!0})})},[o]),Zl(async(i,a)=>{if(n.current&&i==="Client_listenSurveyStatusUpdated"){let s=a;return e(l=>({...l,...s})),{success:!0,message:"ok",data:{}}}}),null},UM=CV;var yV=Rn(()=>{if(Za()==="youtube.com"){ts()&&(document.body.style.position=""),document.documentElement.style.position==="relative"&&(document.documentElement.style.position="unset",document.querySelector(`#${eh}`)?.classList.replace("open","close"));let t=document.querySelector(`#${th}`);t&&(t.style.display="none")}},100),bV=Rn(()=>{if(Za()==="youtube.com"){document.documentElement.style.position==="unset"&&(document.documentElement.style.position="relative",document.querySelector(`#${eh}`)?.classList.replace("close","open")),ts()&&(document.body.style.position="relative");let t=document.querySelector(`#${th}`);t&&(t.style.display=""),setTimeout(()=>{window.dispatchEvent(new Event("resize"))},300)}},100),IV=()=>{let e=Za();cn(()=>{if(e==="youtube.com"){let t=new MutationObserver(n=>{n.forEach(r=>{r.target&&(r.target.hasAttribute("scrolling")?yV():bV())})}),o=document.querySelector("ytd-app");o&&t.observe(o,{attributes:!0,childList:!1,subtree:!1})}})},WM=IV;var $p=I(w());var SV=({children:e,...t})=>{let o=$p.default.useRef(null);return $p.default.createElement(s_,{maxSnack:3,preventDuplicate:!0,hideIconVariant:!0,autoHideDuration:3e3,ref:o,anchorOrigin:{vertical:"bottom",horizontal:"left"},action:n=>$p.default.createElement("svg",{focusable:"false","aria-hidden":"true",viewBox:"0 0 24 24",style:{width:"1em",height:"1em",display:"inline-block",fill:"currentcolor",fontSize:18,cursor:"pointer"},onClick:()=>{if(o?.current){let r=o?.current;r.closeSnackbar&&r.closeSnackbar(n)}}},$p.default.createElement("path",{d:"M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"})),...t},$p.default.createElement(l_,null),e)},GM=SV;var Xp=I(w()),jM=I(ZM());var vV="MAXAI_SNACKBAR_CONTAINER";var TV=()=>Xp.default.createElement(GM,{classes:{containerRoot:"maxai-snackbar-container-root"}},Xp.default.createElement("span",null)),KM=()=>{let e=document.createElement("div");e.id=vV,e.style.zIndex="21474836470",e.style.color="#fff",e.style.position="absolute",document.body.appendChild(e),(0,jM.createRoot)(e).render(Xp.default.createElement(Xp.default.StrictMode,null,Xp.default.createElement(TV,null)))};var MV=new Cm("AppInit"),wV=()=>window.location.host==="www.usechatgpt.ai"||window.location.host==="www.maxai.me"||window.location.host==="www.maxai.co"||window.location.host==="app.maxai.me"?Sn.default.createElement(ce,{onClick:()=>{Ua({key:"shortcuts"})},id:"usechatgpt-www-to-shortcuts",sx:{position:"absolute",width:1,height:1,zIndex:-1,opacity:0}}):Sn.default.createElement(Sn.default.Fragment,null),EV=()=>{let{setAppSettingsState:e}=sr(),{getLocalSettings:t}=yt(),{isLogin:o}=Mn();return T6(),(0,Sn.useEffect)(()=>{let n=async()=>{let r=await vh();r&&(e({...r}),MV.info(" get appSettings",r)),t()};return n(),window.addEventListener("focus",n),()=>{window.removeEventListener("focus",n)}},[]),(0,Sn.useEffect)(()=>{o&&setTimeout(()=>{vh().then(n=>{n&&e({...n})})},1e3)},[o]),Sn.default.createElement(Sn.default.Fragment,null)},AV=()=>{let{syncUserInfo:e}=Tt(),{fetchPlanPricing:t}=vm(!0);return cn(()=>{if(e().then(),String(nr).includes(Za())){let o=window.location.pathname;["/account/your-plan/","/pricing/","/account/get-started/","/payment/error/","/payment/success/"].includes(o)&&setTimeout(()=>{e(!0).then().catch()},500),["/account/your-plan/","/pricing/"].includes(o)&&setTimeout(()=>{t().then()},500)}}),null},PV=()=>{let e=po($2),t=po(q2),{syncUserInfo:o,setUserInfo:n}=Tt();return Zl(async(r,i)=>{if(r==="Client_AuthMaxAITokenComplete"){if(i?.hasToken){let a=await za.getAuthTokens(),l=!(a?.refreshToken?za.isTokenExpired(a.refreshToken):!0)&&!!a;a&&l?(o(),t(p=>p.isLogin===l?p:{...p,isLogin:l,authTokens:a})):t(p=>p.isLogin===l?p:{...p,isLogin:!1,authTokens:null})}else t(a=>({...a,isLogin:!1,authTokens:null}));return e(!0),n(a=>({...a,user:null})),{success:!0,message:"ok",data:{}}}}),null},kV=()=>{WM(),A_(),w6(),f_(!1),d_(!1),Ll(),PV(),AI(),O_(),cn(()=>{xc()&&ra(),KM(),NM(),AM().then().catch(),wI()}),FM(),UM(),Pb(),km(),H_(),Sm(),zM(),wb(),Hy(),n6(),Py(),Ay();let e=xc();return Sn.default.createElement(Sn.default.Fragment,null,Sn.default.createElement(AV,null),!e&&Sn.default.createElement(MM,null),Sn.default.createElement(EV,null),Sn.default.createElement(wV,null),Sn.default.createElement(cC,null),Sn.default.createElement(uC,null))},ERe=kV;export{P6 as a,as as b,ab as c,_b as d,Cb as e,Mb as f,wb as g,IE as h,lk as i,pr as j,sj as k,dX as l,wg as m,ef as n,fs as o,vf as p,wf as q,v3 as r,T3 as s,sv as t,mv as u,j0 as v,Fv as w,zv as x,Cu as y,q7 as z,yu as A,yT as B,_Pe as C,MT as D,vM as E,wM as F,qp as G,VM as H,RM as I,KM as J,EV as K,ERe as L};
/*! Bundled license information:

chnl/dist/channel.cjs.js:
  (* chnl v1.2.0 by Vitaliy Potapov @preserve *)
*/
