import{a as d}from"./Q25QR6DL.js";import{i as l}from"./UXYD27MU.js";import{q as h}from"./VE4EMEBO.js";import{a as b}from"./PJ57C2TE.js";import{f as w}from"./GAV6HCJA.js";var u=(s,e="")=>{let t=s,n=e;if(t.startsWith("data:")){let[o,c]=t.split(",");n||(n=o.split(";")[0].split(":")[1]),t=c}let r=atob(t),a=[];for(let o=0;o<r.length;o+=512){let c=r.slice(o,o+512),p=new Array(c.length);for(let i=0;i<c.length;i++)p[i]=c.charCodeAt(i);let m=new Uint8Array(p);a.push(m)}return new Blob(a,{type:n})};var A=(s,e)=>new File([s],e,{type:s.type});var f=w(b()),y="x_fid",P=()=>new Promise(s=>{s("")}),g=async()=>{let e=(await f.default.storage.local.get(y))[y];return e?e.replace(/"/g,""):await P()};var _=async(s,e,t)=>{try{e||(e={}),e.method||(e.method="GET");let n=new d,r=await n.postMessage({event:"Client_proxyFetchAPI",data:{url:s,options:e,abortTaskId:t}});if(e.method==="GET"&&r.data.redirected&&r?.data?.response?.url){let a=await n.postMessage({event:"Client_proxyFetchAPI",data:{url:r?.data?.response?.url,options:e,abortTaskId:t}});r.data.data=a?.data?.data,r.data.response=a?.data?.response}return e?.parse==="blob"&&r?.data?.data?.base64&&(r.data.data=u(r.data.data.base64,e?.blobContentType||r.data.data.contentType)),{success:r.success,data:r?.data?.data,responseRaw:r?.data?.response,message:r.message,error:""}}catch(n){return{success:!1,data:null,error:n?.message||n,responseRaw:null,message:""}}},R=async s=>{try{let t=await new d().postMessage({event:"Client_abortProxyFetchAPI",data:{abortTaskId:s}});return{success:t.success,data:t.data,error:t.message}}catch(e){return{success:!1,data:null,error:e?.message||e}}},S=async(s,e,t={})=>{try{let n=new d,r=await g(),a=await h.getAccessToken();t.body=JSON.stringify(e),t.headers||(t.headers={"Content-Type":"application/json",Authorization:`Bearer ${a}`,fp:`${r}`}),t.method||(t.method="POST"),l&&!s.startsWith(l)&&(s=l+s);let o=await n.postMessage({event:"Client_proxyFetchAPI",data:{url:s,options:t,abortTaskId:t.abortTaskId}});return{success:o.success,responseRaw:o?.data?.response,data:o?.data?.data,message:o.message,error:""}}catch(n){return{success:!1,responseRaw:null,data:null,error:n?.message||n,message:""}}};export{A as a,_ as b,R as c,S as d};
